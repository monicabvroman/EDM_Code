# TO START WITH ML, READ ALL PREPROCESSED DATA L 5192

# READ F20 data: L4520
# READ F22 data: L7051
# Start building datasets (aggregate): L 14,735


# To TWEAK THINGS:

# Traditional Data with no correlations and no variables with low variance
# ends up being saved in saved_data_no_var_no_corr 

# Read Data:
# Intro, Canvas, SAS
# Autolab Data Lines 61-527, then preprocess to create new dataset

# EDA Scatterplots, etc. 
# Line 600: starts Canvas Data
# Line 803 Intro Survey data 
# Line 900 SAS Data

# Data Analysis Line 966
# Merging data minus autolab and data with autolab up to week 7.

# Models with ALL Features Line 987
# Adding ATTITUDES: Lines 1044 - 1414
# Remove highly correlated attributes and constant attributes Line 1420
# One-hot encoding of categorical var Line 1531
# Feature Importance Line 1604
# Build Models: Line 1680
# Sensitivity: Lines 1996 and 2088 for regular and autolab data respectively.
# NOTE: Autolab data does not make sense here because 
#it's with models using all the data!

# Models using MOST PREDICTIVE features : Line 2144


# MODELS WITH DATA AVAIABLE DURING WEEK 3: 
# Unbalanced Data: Line 2369
# Balanced Data: Line 2590

# MODELS WITH DATA AVAIABLE DURING WEEK 4 
# Unbalanced Data: Line 2678
# Balanced Data: Line 2875

# # MODELS WITH DATA AVAIABLE DURING WEEK 7 
# Unbalanced Data: Line 2962
# Balanced but no models built: Line 3170
# Autolab Data: Line 3196: including merging the data



# L121 initializes data with Canvas data. This is for testing that the models
# "make sense". This gives the most data (n=1700+)

# L127 - 142: What constitutes success: 2 classes, 3 classes, Canvas score, grade, etc.

# Experiment 1: Boxplots of all features BEFORE balancing the data


# Experiment #2: ML Models with all the data

# Experiment #3: ML Models with most correlated features

# Anonymize ID files

# The remove_netids* files were created from the MLiSS consent form which started being filled
# out in Spring 2022. 

# For data before Spring 2022, need to use intro survey.

setwd("Anon")

remove_netids_fall22 <- read.csv("remove_netids_f22.csv", header = TRUE)
remove_netids_fall23 <- read.csv("remove_netids_f23.csv", header = TRUE)
remove_netids_spring23 <- read.csv("remove_netids_s23.csv", header = TRUE)

#remove_netids_fall24 <- read.csv("remove_netids_f24.csv", header = TRUE)


# READ INTRO SURVEY DATA

setwd("Anon")
data_intro_s21_111 <- read.csv("111_Spring21_Intro.csv", header =  TRUE)
data_intro_s23_111 <- read.csv("Spring2023_Intro_CS111.csv", header = TRUE)
data_intro_f22_111 <- read.csv("111_Fall22_Intro.csv", header = TRUE)
data_intro_f23_111 <- read.csv("Fall2023_Intro_CS111.csv", header =  TRUE)
data_intro_f20_111 <- read.csv("Fall20_Intro_CS111.csv", header =  TRUE)

names(data_intro_s21_111)
names(data_intro_s23_111)

names(data_intro_f23_111)

table(data_intro_f20_111$Q4)

data_intro_f20_111_cleaned <- data_intro_f20_111[data_intro_f20_111$Q4 %in% c("AP CS Principles", "AP CSA (Java)", "College class or classes", "High school class or classes other than AP","I have no previous knowledge of computer science","Other, please explain"),]

opar <- par(lwd = 0.9)
par(mar = c(7,4,3,1))
#ylim = c(0, 1)
barplot(table(data_intro_f20_111_cleaned$Q4),  las=2, names.arg = c("AP CS P","AP Java", "College", "High-school", "None", "Other"))
#,names.arg = c("American Indian","","Black", "Hispanic", "Puerto Rican", "White", "Asian", "No response", "Multiple", "Unknown"))

table(data_intro_f20_111_cleaned$Q4)

barplot(table(data_intro_f20_111$Q4))

# READ CANVAS DATA


setwd("Anon")
data_canvas_s21_111 <- read.csv("Canvas_111_S21.csv", header = TRUE)
data_canvas_f22_111 <- read.csv("Canvas_F22_111.csv", header = TRUE)
data_canvas_s23_111 <- read.csv("Canvas_S23_111.csv", header = TRUE)
data_canvas_f23_111 <- read.csv("CanvasF23_111.csv", header = TRUE)
data_canvas_f20_111 <- read.csv("Canvas_111_F20.csv", header = TRUE)
data_canvas_f21_111 <- read.csv("Canvas_111_F21.csv", header = TRUE)

names(data_canvas_s21_111)
# Rename columns for easy equivallence between semesters
data_canvas_s21_111 <- plyr::rename(data_canvas_s21_111, c("X0..Pseudocode..1323312." = "X0",
                                                           "X1..HelloWorld..1321629." = "X1",
                                                           "X2..Wind.Chill..1321738." = "X2",
                                                           "X3..Order.Check..1321757." = "X3",
                                                           "X4..Largest.of.Five..1321768." = "X4",
                                                           "X5..Check.Digit..1321789." = "X5",
                                                           "X6..Random.Walker..1321792." = "X6",
                                                           "X7..Find.Duplicate..1321853." = "X7",
                                                           "X8..RU.Rotten.Tomatoes..1321857." = "X8",
                                                           "X9..Polygon.Transform..1341197." = "X9",
                                                           "X10..Weather.Generator..1341208." = "X10",
                                                           "X11..Sierpinski..1346601." = "X11",
                                                           "X12..RecursiveAppend..1359445." = "X12",
                                                           "X13..Vehicle.Scenario.Analysis..1359453." = "X13",
                                                           "X14..Heart.Transplant..1381303." = "X14",
                                                           "X15..Written.Assignment.10..1383034." = "X15",
                                                           "Week.2..1385408." = "RecWeek2",
                                                           "Week.3..1385407." = "RecWeek3",
                                                           "Week.4..1385404." = "RecWeek4",
                                                           "Week.5..1385405." = "RecWeek5",
                                                           "Week.6..1385399." = "RecWeek6",
                                                           "Week.7..1385406." = "RecWeek7",
                                                           "Week.8..1385400." = "RecWeek8",
                                                           "Week.10..1385402." = "RecWeek10",
                                                           "Week.11..1385398." = "RecWeek11",
                                                           "Week.12..1385403." = "RecWeek12",
                                                           "Week.13..1385401." = "RecWeek13",
                                                           "Week.14..1385409." = "RecWeek14",
                                                           "Week.15..1385666." = "RecWeek15",
                                                           "Midterm.1..1323316." = "Exam1",
                                                           "Midterm.2..1371557." = "Exam2",
                                                           "Midterm.3..1371558." = "Exam3",
                                                           "Final..1389238." = "Exam4"
                                                           ))
# Rename columns for easy equivallence between semesters

names(data_canvas_s23_111)
data_canvas_s23_111 <- plyr::rename(data_canvas_s23_111, c("Assignment.1...Pseudocode..2547522." = "X0",
                                                           "X1..HelloWorld..2487686." = "X1",
                                                           "X2..Wind.Chill..2487732." = "X2",
                                                           "X3..Order.Check..2487744." = "X3",
                                                           "X4..Largest.of.Five..2487949." = "X4",
                                                           "X5..Check.Digit..2487991." = "X5",
                                                           "X6..Random.Walker..2488269." = "X6",
                                                           "X7..Find.Duplicate..2512787." = "X7",
                                                           "X8..RU.Rotten.Tomatoes..2512795." = "X8",
                                                           "X9..Polygon.Transform..2512807." = "X9",
                                                           "X10..Weather.Generator..2538554." = "X10",
                                                           "X11..Sierpinski..2538607." = "X11",
                                                           "X12..RecursiveAppend..2538621." = "X12",
                                                           "X13..Art.Collage..2551917." = "X13",
                                                           "Assignment.10...Searching..sorting.and.performance..2548844." = "X15",
                                                           "Pre.Recitation.Quiz..01..2455737." = "RecWeek2",
                                                           "Pre.Recitation.Quiz..02..2462841." = "RecWeek3",
                                                           "Pre.Recitation.Quiz..03..2468046." = "RecWeek4",
                                                           "Pre.Recitation.Quiz..04..2474128." = "RecWeek5",
                                                           "Pre.Recitation.Quiz..05..2479095." = "RecWeek6",
                                                           "Pre.Recitation.Quiz..06..2484797." = "RecWeek7",
                                                           "Pre.Recitation.Quiz..07..2490905." = "RecWeek8",
                                                           "Pre.Recitation..08..2498972." = "RecWeek10",
                                                           "Pre.Recitation.Quiz..09..2504510." = "RecWeek11",
                                                           "Pre.Recitation.Quiz..10..2510138." = "RecWeek12",
                                                           "Pre.Recitation.Quiz..11..2515084." = "RecWeek13",
                                                           "Pre.Recitation.Quiz..12..2518693." = "RecWeek14",
                                                           "Pre.Recitation.Quiz..13..2526935." = "RecWeek15",
                                                           "Exam.One..2551745." = "Exam1",
                                                           "Exam.Two..2551897." = "Exam2",
                                                           "Final.Exam..2552518." = "Exam4"
))

# Rename columns for easy equivallence between semesters

names(data_canvas_f22_111)
data_canvas_f22_111 <- plyr::rename(data_canvas_f22_111, c("X0..Pseudocode..2341212." = "X0",
                                                          "X1..HelloWorld..2245837." = "X1",
                                                           "X2..Wind.Chill..2245864." = "X2",
                                                           "X3..Order.Check..2245891." = "X3",
                                                           "X4..Largest.of.Five..2256718." = "X4",
                                                           "X5..Check.Digit..2256724." = "X5",
                                                           "X6..Random.Walker..2256731." = "X6",
                                                           "X7..Find.Duplicate..2262435." = "X7",
                                                           "X8..RU.Rotten.Tomatoes..2262443." = "X8",
                                                           "X9..Polygon.Transform..2271591." = "X9",
                                                           "X10..Weather.Generator..2297214." = "X10",
                                                           "X11..Sierpinski..2308113." = "X11",
                                                           "X12..RecursiveAppend..2308126." = "X12",
                                                           "X13..Leasing.Cost..2338076." = "X13",
                                                           "X14..Heart.Transplant..2341391." = "X14",
                                                           "X15..Sort.Detective..2341406." = "X15",
                                                           "Pre.recitation.Quiz..01..2211922." = "RecWeek2",
                                                           "Pre.recitation.Quiz..02..2213360." = "RecWeek3",
                                                           "Pre.recitation.Quiz..03..2213363." = "RecWeek4",
                                                           "Pre.recitation.Quiz..04..2213368." = "RecWeek5",
                                                           "Pre.recitation.Quiz..05..2213372." = "RecWeek6",
                                                           "Pre.recitation.Quiz..06..2213374." = "RecWeek7",
                                                           "Pre.recitation.Quiz..07..2213377." = "RecWeek8",
                                                           "Pre.recitation.Quiz..08..2213380." = "RecWeek10",
                                                           "Pre.recitation.Quiz..09..2213383." = "RecWeek11",
                                                           "Pre.recitation.Quiz..10..2213386." = "RecWeek12",
                                                           "Pre.recitation.Quiz..11..2213394." = "RecWeek13",
                                                           "Pre.recitation.Quiz..12..2213387." = "RecWeek14",
                                                           "Post.Recitation.Quiz.13..free.4.points..no.need.to.complete...2337769." = "RecWeek15",
                                                           "Exam.One..2341567." = "Exam1",
                                                           "Exam.Two..2341590." = "Exam2",
                                                           "Final.Exam..2341742." = "Exam4"
))

names(data_canvas_f23_111)
data_canvas_f23_111 <- plyr::rename(data_canvas_f23_111, c("X0..Pseudocode..2862327." = "X0",
                                                           "X1..Welcome..2800831." = "X1",
                                                           "X2..Gravitational.Force..2800885." = "X2",
                                                           "X3..Palindrome..2800902." = "X3",
                                                           "X4..Buses.LX.H..2811002." = "X4",
                                                           "X5..Dog.Walker..2811036." = "X5",
                                                           "X6..RU.Bus.Stop..2821267." = "X6",
                                                           "X7..Staircase.Builder..2821421." = "X7",
                                                           "X8..Air.Particles..2824249." = "X8",
                                                           "X9..ISBN..2824264." = "X9",
                                                           "X10..Climate.and.Economic.Justice.Analysis..2876419." = "X10",
                                                           "X11..RecursiveAppend..2876449." = "X11",
                                                           "X12..DNA..2876501." = "X12",
                                                           "X13..Stop.and.Frisk..2876507." = "X13",
                                                           "X14..Searching.Sorting..2874986." = "X14",
                                                           "Intro.to.Pseudocode.Pre.Recitation.Quiz..2700298." = "RecWeek2",
                                                           "JDK.and.Pseudocode.Pre.Recitation.Quiz..2700297." = "RecWeek3",
                                                           "Java.Basics.Pre.Recitation.Quiz..2700289." = "RecWeek4",
                                                           "Conditionals.and.Loops.Pre.Recitation.Quiz..2700292." = "RecWeek5",
                                                           "Arrays.Pre.Recitation.Quiz..2700281." = "RecWeek6",
                                                           "Input.and.Output.Pre.Recitation.Quiz..2700291." = "RecWeek7",
                                                           "Methods.Pre.Recitation.Quiz..2700301." = "RecWeek8",
                                                           "Recursion.Pre.Recitation.Quiz..2700282." = "RecWeek10",
                                                           "Strings.Pre.Recitation.Quiz..2700306." = "RecWeek11",
                                                           "OOP.Pre.Recitation.Quiz...2700283." = "RecWeek12",
                                                           "Big.O...Efficiency.Analysis.Pre.Recitation.Quiz...2700293." = "RecWeek13",
                                                           "Searching.and.Sorting.Pre.Recitation.Quiz..2700299." = "RecWeek14",
                                                           "Recursive.Sorting.and.Searching.Pre.Recitation.Quiz..2700304." = "RecWeek15",
                                                           "Midterm.1..2700321." = "Exam1",
                                                           "Midterm.2..2700308." = "Exam2",
                                                           "Final..2700319." = "Exam4"
))


names(data_canvas_f21_111)
data_canvas_f21_111 <- plyr::rename(data_canvas_f21_111, c("Pseudocode...1672508." = "X0",
                                                           "X1..HelloWorld..1667249." = "X1",
                                                           "X2..Wind.Chill..1667295." = "X2",
                                                           "X3..Order.Check..1667326." = "X3",
                                                           "X4..Largest.Of.Five..1680700." = "X4",
                                                           "X5..Check.Digit..1680718." = "X5",
                                                           "X6..Random.Walker..1680751." = "X6",
                                                           "X7..Find.Duplicate..1685920." = "X7",
                                                           "X8..RU.Rotten.Tomatoes..1685975." = "X8",
                                                           "X9..Polygon.Transform..1694939." = "X9",
                                                           "X10..Weather.Generator..1705403." = "X10",
                                                           "X11..Sierpinski..1717476." = "X11",
                                                           "X12..RecursiveAppend..1732626." = "X12",
                                                           "X13..LeasingCost..1732683." = "X13",
                                                           "X14..Heart.Transplant..1757223." = "X14",
                                                           "Recitation.Quiz.1..1641346." = "RecWeek1",
                                                           "Recitation.Quiz.2..1650445." = "RecWeek2",
                                                           "Recitation.Quiz.3..1656958." = "RecWeek3",
                                                           "Recitation.Quiz.4..1661571." = "RecWeek4",
                                                           "Recitation.Quiz.5..1667969." = "RecWeek5",
                                                           "Recitation.Quiz.6..1676852." = "RecWeek6",
                                                           "Recitation.Quiz.7..1683448." = "RecWeek7",
                                                           "Recitation.Quiz.8..1689790." = "RecWeek8",
                                                           "Recitation.Quiz.9..1696155." = "RecWeek9",
                                                           "Recitation.Quiz.10..1703255." = "RecWeek10",
                                                           "Recitation.Quiz.11...1708968." = "RecWeek11",
                                                           "Recitation.Quiz.12..1723431." = "RecWeek12",
                                                           "Recitation.Quiz.13..1731133." = "RecWeek13",
                                                           "Exam.1..1678216." = "Exam1",
                                                           "Exam.2..1706565." = "Exam2",
                                                           "Exam.3..1736589." = "Exam4"
))


names(data_canvas_f20_111)
data_canvas_f20_111 <- plyr::rename(data_canvas_f20_111, c("X0..Pseudocode..1127307." = "X0",
                                                           "X1..HelloWorld..1067474." = "X1",
                                                           "X2..Wind.Chill..1067488." = "X2",
                                                           "X3..Order.Check..1067507." = "X3",
                                                           "X4..Largest.Of.Five..1067512." = "X4",
                                                           "X5..Check.Digit..1067522." = "X5",
                                                           "X6..Two.Smallest..1067529." = "X6",
                                                           "X7..Random.Walker..1067533." = "X7",
                                                           "X8..Find.Duplicate..1067540." = "X8",
                                                           "X9..RU.Rotten.Tomatoes..1067618." = "X9",
                                                           "X10..Polygon.Transform..1126937." = "X10",
                                                           "X11..Sierpinski..1126948." = "X11",
                                                           "X12..Weather.Generator..1126951." = "X12",
                                                           "X13..RecursiveAppend..1126971." = "X13",
                                                           "X14..Vehicle.Scenario.Analysis..1126976." = "X14",
                                                           "X15..Heart.Transplant..1126986." = "X15",
                                                           "X16..Assignment.8...Complexity.Analysis..1129495." = "X16",
                                                           "Recitation.2..1129729." = "RecWeek2",
                                                           "Recitation.3..1129730." = "RecWeek3",
                                                           "Recitation.4..1129733." = "RecWeek4",
                                                           "Recitation.5..1129735." = "RecWeek5",
                                                           "Recitation.6..1129726." = "RecWeek6",
                                                           "Recitation.7..1129732." = "RecWeek7",
                                                           "Recitation.8..1129736." = "RecWeek8",
                                                           "Recitation.9..1129727." = "RecWeek10",
                                                           "Recitation.10..1129728." = "RecWeek11",
                                                           "Recitation.11..1129738." = "RecWeek12",
                                                           "Recitation.12..1129734." = "RecWeek13",
                                                           "Recitation.13..1129737." = "RecWeek14",
                                                           "Quiz.1..1068907." = "Exam1",
                                                           "Quiz.2..1127309." = "Exam2",
                                                           "Quiz.3..1127314." = "Exam3",
                                                           "Quiz.4..1129289." = "Exam4"
))

names(data_canvas_f20_111)
hist(data_canvas_f20_111$Exam1, main = "Exam 1 Scores", xlab = "Score")
hist(data_canvas_f20_111$X2, main = "Assignment 2 Scores", xlab = "Score")

prop.table(table(data_canvas_f20_111$X1))
prop.table(table(data_canvas_f20_111$X2))
prop.table(table(data_canvas_f20_111$X3))
prop.table(table(data_canvas_f20_111$X4))
prop.table(table(data_canvas_f20_111$X5))
prop.table(table(data_canvas_f20_111$X6))
prop.table(table(data_canvas_f20_111$X7))
prop.table(table(data_canvas_f20_111$X8))
prop.table(table(data_canvas_f20_111$X9))

hist(data_canvas_f20_111$X7, main = "Assignment 7 Scores", xlab = "Score")

# READ REGISTRAR/SAS Data


setwd("anon")


# SAS data was preprocessed to only include CS couses...

data_sas_s21 <- read.csv("SAS_Data_s21.csv")
data_sas_s23 <- read.csv("SAS_Data_s23.csv")
data_sas_f22 <- read.csv("SAS_Data_f22.csv")
data_sas_f23 <- read.csv("SAS_Data_f23.csv")
data_sas_f20 <- read.csv("SAS_Data_f20.csv")
data_sas_f21 <- read.csv("SAS_Data_f21.csv")


data_sas_s21_111 <- data_sas_s21[data_sas_s21$course_no=="111",]
data_sas_s23_111 <- data_sas_s23[data_sas_s23$course_no=="111",]
data_sas_f22_111 <- data_sas_f22[data_sas_f22$course_no=="111",]
data_sas_f23_111 <- data_sas_f23[data_sas_f23$course_no=="111",]
data_sas_f20_111 <- data_sas_f20[data_sas_f20$course_no=="111",]
data_sas_f21_111 <- data_sas_f21[data_sas_f21$course_no=="111",]

hist(data_sas_f20_111$gender_cd)
table(data_sas_f20_111$ethnic_cd)
data_sas_f20_111_cleaned <- data_sas_f20_111[data_sas_f20_111$ethnic_cd %in% c("1", "3", "4", "5", "6", "8", "N", "T", "U"),]

opar <- par(lwd = 0.9)
par(mar = c(3,4,1,1))
barplot(table(data_sas_f20_111_cleaned$ethnic_cd))#,names.arg = c("American Indian","","Black", "Hispanic", "Puerto Rican", "White", "Asian", "No response", "Multiple", "Unknown"))

par(mar = c(3,4,1,1))
barplot(table(data_sas_f20_111$gender_cd))

# READ AUTOLAB DATA


setwd("")

data_autolab_s21 <- read.csv("Data_Autolab_Processed_S21.csv", header = TRUE)
data_autolab_s21_w4 <- read.csv("Data_Autolab_Processed_S21_W4.csv", header = TRUE)
data_autolab_s21_w5 <- read.csv("Data_Autolab_Processed_S21_W5.csv", header = TRUE)
data_autolab_s21_w7 <- read.csv("Data_Autolab_Processed_S21_W7.csv", header = TRUE)

data_autolab_s23 <- read.csv("Data_Autolab_Processed_S23.csv", header = TRUE)
data_autolab_s23_w4 <- read.csv("Data_Autolab_Processed_S23_W4.csv", header = TRUE)
data_autolab_s23_w5 <- read.csv("Data_Autolab_Processed_S23_W5.csv", header = TRUE)
data_autolab_s23_w7 <- read.csv("Data_Autolab_Processed_S23_W7.csv", header = TRUE)

data_autolab_f22 <- read.csv("Data_Autolab_Processed_F22.csv", header = TRUE)
data_autolab_f22_w4 <- read.csv("Data_Autolab_Processed_F22_W4.csv", header = TRUE)
data_autolab_f22_w5 <- read.csv("Data_Autolab_Processed_F22_W5.csv", header = TRUE)
data_autolab_f22_w7 <- read.csv("Data_Autolab_Processed_F22_W7.csv", header = TRUE)

data_autolab_f20 <- read.csv("Data_Autolab_Processed_F20.csv", header = TRUE)
data_autolab_f20_w4 <- read.csv("Data_Autolab_Processed_F20_W4.csv", header = TRUE)
data_autolab_f20_w5 <- read.csv("Data_Autolab_Processed_F20_W5.csv", header = TRUE)
data_autolab_f20_w7 <- read.csv("Data_Autolab_Processed_F20_W7.csv", header = TRUE)

data_autolab_f21 <- read.csv("Data_Autolab_Processed_F21.csv", header = TRUE)
data_autolab_f21_w4 <- read.csv("Data_Autolab_Processed_F21_W4.csv", header = TRUE)
data_autolab_f21_w5 <- read.csv("Data_Autolab_Processed_F21_W5.csv", header = TRUE)
data_autolab_f21_w7 <- read.csv("Data_Autolab_Processed_F21_W7.csv", header = TRUE)

data_autolab_f23 <- read.csv("Data_Autolab_Processed_F23.csv", header = TRUE)
data_autolab_f23_w4 <- read.csv("Data_Autolab_Processed_F23_W4.csv", header = TRUE)
data_autolab_f23_w5 <- read.csv("Data_Autolab_Processed_F23_W5.csv", header = TRUE)
data_autolab_f23_w7 <- read.csv("Data_Autolab_Processed_F23_W7.csv", header = TRUE)



# ELIMINATE PEOPLE WHO HAVE NOT GIVEN CONSENT!

# select anonymized netids of people who said yes and only keep them for research

data_intro_s21_111 <- data_intro_s21_111[data_intro_s21_111$Q38 != "No", ]
netids_research_s21 <- data_intro_s21_111$NetID
  
data_intro_f20_111 <- data_intro_f20_111[data_intro_f20_111$Q38 != "No", ]
netids_research_f20 <- data_intro_f20_111$NetID


# get rid of the students with netids in remove_netid files

data_intro_s23_111 <- data_intro_s23_111[!(data_intro_s23_111$NetID %in% remove_netids_spring23), ]
data_intro_f22_111 <- data_intro_f22_111[!(data_intro_f22_111$NetID %in% remove_netids_fall22), ]
data_intro_f23_111 <- data_intro_f23_111[!(data_intro_f23_111$NetID %in% remove_netids_fall23), ]

#####    FALL 2020 Data     #######

# Canvas data: 
# Intro survey data: 
# SAS data: 

names(data_intro_f20_111)
names(data_sas_f20_111)
names(data_canvas_f20_111)
# Merge all the data..

# Remove duplicates
data_intro_f20_111 <- data_intro_f20_111[!duplicated(data_intro_f20_111[1]),]# remove duplicated NetIDs
#data_sas_fall_22_111 <- data_sas_fall_22_111[!duplicated(data_sas_f22_111[2]),]# remove duplicated NetIDs
names(data_sas_fall_20_111)
# NEED TO MERGE EACH DATA SET WITH CANVAS (AND ONLY WITH CANVAS TO MAX 
# OF STUDENTS) TO CORRELATE FEATURES WITH FINAL GRADES!!

# Rename the common column
data_sas_f20_111 <- plyr::rename(data_sas_f20_111, c("netid" = "NetID"))
data_canvas_f20_111 <- plyr::rename(data_canvas_f20_111, c("SIS.Login.ID" = "NetID"))

# Remove duplicates
#data_canvas_f20_111 <- data_canvas_f20_111[!duplicated(data_canvas_f22_111[1]),]# remove duplicated NetIDs

# Select columns from SAS data..
names(data_sas_f20_111)
data_sas_f20_111_saved <- data_sas_f20_111
data_sas_f20_111 <- data_sas_f20_111_saved[,c("NetID","gender_cd", "ethnic_cd", "course_cnts_to_maj_avg_ind","course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","nj_county_of_res_cd","citizen_status_cd")]

data_canvas_and_sas_f20_111 <- merge(data_canvas_f20_111, data_sas_f20_111, by="NetID")
data_canvas_and_intro_f20_111 <- merge(data_canvas_f20_111, data_intro_f20_111, by = "NetID")

names(data_canvas_f22_111)

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_f20_111$SUCCESS[data_canvas_and_intro_f20_111$Final.Points >= 750] <- 1
data_canvas_and_intro_f20_111$SUCCESS[data_canvas_and_intro_f20_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_f20_111$SUCCESS[data_canvas_and_intro_f20_111$Final.Points > 600 & data_canvas_and_intro_f20_111$Final.Points < 750] <- 3

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$Final.Points >= 750] <- 1
data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$Final.Points <= 600] <- 2
data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$Final.Points > 600 & data_canvas_and_sas_f20_111$Final.Points < 750] <- 3

setwd("")


write.csv(data_canvas_and_sas_f20_111, "data_canvas_and_sas_f20_111.csv", row.names = FALSE)
write.csv(data_canvas_and_intro_f20_111, "data_canvas_and_intro_f20_111.csv", row.names = FALSE)



#####    FALL 2022 Data     #######

# Canvas data: 1370 obs
# Intro survey data: 475 obs
# SAS data: 6307 obs.

names(data_intro_f22_111)
names(data_sas_f22_111)
names(data_canvas_f22_111)
# Merge all the data..

# Remove duplicates
data_intro_f22_111 <- data_intro_f22_111[!duplicated(data_intro_f22_111[1]),]# remove duplicated NetIDs
#data_sas_fall_22_111 <- data_sas_fall_22_111[!duplicated(data_sas_f22_111[2]),]# remove duplicated NetIDs
names(data_sas_fall_22_111)
# NEED TO MERGE EACH DATA SET WITH CANVAS (AND ONLY WITH CANVAS TO MAX 
# OF STUDENTS) TO CORRELATE FEATURES WITH FINAL GRADES!!

# Rename the common column
data_sas_f22_111 <- plyr::rename(data_sas_f22_111, c("netid" = "NetID"))
data_canvas_f22_111 <- plyr::rename(data_canvas_f22_111, c("Neid" = "NetID"))

# Remove duplicates
#data_canvas_f20_111 <- data_canvas_f20_111[!duplicated(data_canvas_f22_111[1]),]# remove duplicated NetIDs

# Select columns from SAS data..
names(data_sas_fall_20_111)
data_sas_f22_111_saved <- data_sas_f22_111
data_sas_f22_111 <- data_sas_f22_111_saved[,c("NetID","gender_cd", "ethnic_cd", "course_cnts_to_maj_avg_ind","course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","nj_county_of_res_cd","citizen_status_cd")]

data_canvas_and_sas_f22_111 <- merge(data_canvas_f22_111, data_sas_f22_111, by="NetID")
data_canvas_and_intro_f22_111 <- merge(data_canvas_f22_111, data_intro_f22_111, by = "NetID")

names(data_canvas_f22_111)

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_f22_111$SUCCESS[data_canvas_and_intro_f22_111$Final.Points >= 750] <- 1
data_canvas_and_intro_f22_111$SUCCESS[data_canvas_and_intro_f22_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_f22_111$SUCCESS[data_canvas_and_intro_f22_111$Final.Points > 600 & data_canvas_and_intro_f22_111$Final.Points < 750] <- 3

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_f22_111$SUCCESS[data_canvas_and_sas_f22_111$Final.Points >= 750] <- 1
data_canvas_and_sas_f22_111$SUCCESS[data_canvas_and_sas_f22_111$Final.Points <= 600] <- 2
data_canvas_and_sas_f22_111$SUCCESS[data_canvas_and_sas_f22_111$Final.Points > 600 & data_canvas_and_sas_f22_111$Final.Points < 750] <- 3

setwd("")


write.csv(data_canvas_and_sas_f22_111, "data_canvas_and_sas_f22_111.csv", row.names = FALSE)
write.csv(data_canvas_and_intro_f22_111, "data_canvas_and_intro_f22_111.csv", row.names = FALSE)


#####    FALL 2023 Data     #######

# Canvas data:  obs
# Intro survey data:  obs
# SAS data: obs.

names(data_intro_f23_111)
names(data_sas_f23_111)
names(data_canvas_f23_111)
# Merge all the data..

# Remove duplicates
data_intro_f23_111 <- data_intro_f23_111[!duplicated(data_intro_f23_111[1]),]# remove duplicated NetIDs
#data_sas_fall_22_111 <- data_sas_fall_22_111[!duplicated(data_sas_f22_111[2]),]# remove duplicated NetIDs
names(data_sas_fall_23_111)
# NEED TO MERGE EACH DATA SET WITH CANVAS (AND ONLY WITH CANVAS TO MAX 
# OF STUDENTS) TO CORRELATE FEATURES WITH FINAL GRADES!!

# Rename the common column
data_sas_f23_111 <- plyr::rename(data_sas_f23_111, c("netid" = "NetID"))
data_canvas_f23_111 <- plyr::rename(data_canvas_f23_111, c("Netid" = "NetID"))

# Remove duplicates
#data_canvas_f20_111 <- data_canvas_f20_111[!duplicated(data_canvas_f22_111[1]),]# remove duplicated NetIDs

# Select columns from SAS data..
data_sas_f23_111_saved <- data_sas_f23_111
data_sas_f23_111 <- data_sas_f23_111_saved[,c("NetID","gender_cd", "ethnic_cd", "course_cnts_to_maj_avg_ind","course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","nj_county_of_res_cd","citizen_status_cd")]

data_canvas_and_sas_f23_111 <- merge(data_canvas_f23_111, data_sas_f23_111, by="NetID")
data_canvas_and_intro_f23_111 <- merge(data_canvas_f23_111, data_intro_f23_111, by = "NetID")

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_f23_111$SUCCESS[data_canvas_and_intro_f23_111$Final.Points >= 750] <- 1
data_canvas_and_intro_f23_111$SUCCESS[data_canvas_and_intro_f23_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_f23_111$SUCCESS[data_canvas_and_intro_f23_111$Final.Points > 600 & data_canvas_and_intro_f23_111$Final.Points < 750] <- 3

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_f23_111$SUCCESS[data_canvas_and_sas_f23_111$Final.Points >= 750] <- 1
data_canvas_and_sas_f23_111$SUCCESS[data_canvas_and_sas_f23_111$Final.Points <= 600] <- 2
data_canvas_and_sas_f23_111$SUCCESS[data_canvas_and_sas_f23_111$Final.Points > 600 & data_canvas_and_sas_f23_111$Final.Points < 750] <- 3

write.csv(data_canvas_and_sas_f23_111, "data_canvas_and_sas_f23_111.csv", row.names = FALSE)
write.csv(data_canvas_and_intro_f23_111, "data_canvas_and_intro_f23_111.csv", row.names = FALSE)


#####    SPRING 2021 Data     #######

# Canvas data:  obs
# Intro survey data:  obs
# SAS data: obs.

names(data_intro_s21_111)
names(data_sas_s21_111)
names(data_canvas_s21_111)
# Merge all the data..

# Remove duplicates
data_intro_s21_111 <- data_intro_s21_111[!duplicated(data_intro_s21_111[1]),]# remove duplicated NetIDs
#data_sas_fall_22_111 <- data_sas_fall_22_111[!duplicated(data_sas_f22_111[2]),]# remove duplicated NetIDs
names(data_sas_spring_21_111)
# NEED TO MERGE EACH DATA SET WITH CANVAS (AND ONLY WITH CANVAS TO MAX 
# OF STUDENTS) TO CORRELATE FEATURES WITH FINAL GRADES!!

# Rename the common column
data_sas_s21_111 <- plyr::rename(data_sas_s21_111, c("netid" = "NetID"))
data_canvas_s21_111 <- plyr::rename(data_canvas_s21_111, c("Netid" = "NetID"))

# Remove duplicates
#data_canvas_f20_111 <- data_canvas_f20_111[!duplicated(data_canvas_f22_111[1]),]# remove duplicated NetIDs

# Select columns from SAS data..
data_sas_s21_111_saved <- data_sas_s21_111
data_sas_s21_111 <- data_sas_s21_111_saved[,c("NetID","gender_cd", "ethnic_cd", "course_cnts_to_maj_avg_ind","course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","nj_county_of_res_cd","citizen_status_cd")]

data_canvas_and_sas_s21_111 <- merge(data_canvas_s21_111, data_sas_s21_111, by="NetID")
data_canvas_and_intro_s21_111 <- merge(data_canvas_s21_111, data_intro_s21_111, by = "NetID")

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points >= 750] <- 1
data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points > 600 & data_canvas_and_intro_s21_111$Final.Points < 750] <- 3

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points >= 750] <- 1
data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points <= 600] <- 2
data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points > 600 & data_canvas_and_sas_s21_111$Final.Points < 750] <- 3

write.csv(data_canvas_and_sas_s21_111, "data_canvas_and_sas_s21_111.csv", row.names = FALSE)
write.csv(data_canvas_and_intro_s21_111, "data_canvas_and_intro_s21_111.csv", row.names = FALSE)



#####    SPRING 2023 Data     #######

# Canvas data:  obs
# Intro survey data:  obs
# SAS data: obs.

names(data_intro_s23_111)
names(data_sas_s23_111)
names(data_canvas_s23_111)
# Merge all the data..

# Remove duplicates
data_intro_s23_111 <- data_intro_s23_111[!duplicated(data_intro_s23_111[1]),]# remove duplicated NetIDs
#data_sas_fall_22_111 <- data_sas_fall_22_111[!duplicated(data_sas_f22_111[2]),]# remove duplicated NetIDs
names(data_sas_spring_23_111)
# NEED TO MERGE EACH DATA SET WITH CANVAS (AND ONLY WITH CANVAS TO MAX 
# OF STUDENTS) TO CORRELATE FEATURES WITH FINAL GRADES!!

# Rename the common column
data_sas_s23_111 <- plyr::rename(data_sas_s23_111, c("netid" = "NetID"))
data_canvas_s23_111 <- plyr::rename(data_canvas_s23_111, c("Netid" = "NetID"))

# Remove duplicates
#data_canvas_f20_111 <- data_canvas_f20_111[!duplicated(data_canvas_f22_111[1]),]# remove duplicated NetIDs

# Select columns from SAS data..
data_sas_s23_111_saved <- data_sas_s23_111
data_sas_s23_111 <- data_sas_s23_111_saved[,c("NetID","gender_cd", "ethnic_cd", "course_cnts_to_maj_avg_ind","course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","nj_county_of_res_cd","citizen_status_cd")]

data_canvas_and_sas_s23_111 <- merge(data_canvas_s23_111, data_sas_s23_111, by="NetID")
data_canvas_and_intro_s23_111 <- merge(data_canvas_s23_111, data_intro_s23_111, by = "NetID")

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_s23_111$SUCCESS[data_canvas_and_intro_s23_111$Final.Points >= 750] <- 1
data_canvas_and_intro_s23_111$SUCCESS[data_canvas_and_intro_s23_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_s23_111$SUCCESS[data_canvas_and_intro_s23_111$Final.Points > 600 & data_canvas_and_intro_s23_111$Final.Points < 750] <- 3

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_s23_111$SUCCESS[data_canvas_and_sas_s23_111$Final.Points >= 750] <- 1
data_canvas_and_sas_s23_111$SUCCESS[data_canvas_and_sas_s23_111$Final.Points <= 600] <- 2
data_canvas_and_sas_s23_111$SUCCESS[data_canvas_and_sas_s23_111$Final.Points > 600 & data_canvas_and_sas_s23_111$Final.Points < 750] <- 3

write.csv(data_canvas_and_sas_s23_111, "data_canvas_and_sas_s23_111.csv", row.names = FALSE)
write.csv(data_canvas_and_intro_s23_111, "data_canvas_and_intro_s23_111.csv", row.names = FALSE)

# SKIP TO Line 1904 for Getting Data ready for building ML MODELS 

##########################################################
#
#   ANALYZE THE DATA: SCATTERPLOTS, CORRELATIONS, ETC
#
##########################################################

##########################################################
#
#    FALL 2020. AND SOME FALL 2022
#
##########################################################

# Use CANVAS DATA

data_canvas_f20_111$Final.Points <- as.numeric(data_canvas_f20_111$Final.Points)
str(data_canvas_f20_111)

data_canvas_f22_111$Final.Points <- as.numeric(data_canvas_f22_111$Final.Points)
data_canvas_f22_111 = data_canvas_f22_111[-1,] # get rid of NA Final.Points

data_canvas_f22_111_saved <- data_canvas_f22_111

data_canvas_f22_111_new <- data_canvas_f22_111 %>% drop_na(X1..HelloWorld..2245837.)
data_canvas_f22_111 <- data_canvas_f22_111_new

################################################################
# SCATTER PLOTS AND CORRELATIONS BETWEEN FINAL SCORE VS. QUIZZES
################################################################

# Quiz 1
plot(as.numeric(data_canvas_f20_111$Quiz.1..1068907.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$Quiz.1..1068907.,data_canvas_f20_111$Final.Points)#0.6912986
cor(data_canvas_f22_111$Exam.One..2341567.,data_canvas_f22_111$Final.Points)#0.8140045

# Quiz 2
plot(as.numeric(data_canvas_f20_111$Quiz.2..1127309.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$Quiz.2..1127309.,data_canvas_f20_111$Final.Points)#0.7257848


# Quiz 3
plot(as.numeric(data_canvas_f20_111$Quiz.3..1127314.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$Quiz.3..1127314.,data_canvas_f20_111$Final.Points)#0.7730193

# Quiz 4
plot(as.numeric(data_canvas_f20_111$Quiz.4..1129289.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$Quiz.4..1129289.,data_canvas_f20_111$Final.Points)#0.729891

####################################################################
# SCATTER PLOTS AND CORRELATIONS BETWEEN FINAL SCORE VS. ASSIGNMENTS
###################################################################

# ASSIGNMENT 0
plot(as.numeric(data_canvas_f20_111$X0..Pseudocode..1127307.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X0..Pseudocode..1127307.,data_canvas_f20_111$Final.Points)#0.6280136
cor(data_canvas_f22_111$X0..Pseudocode..2341212.,data_canvas_f22_111$Final.Points)#0.6161491


# ASSIGNMENT 1
plot(as.numeric(data_canvas_f20_111$X1..HelloWorld..1067474.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X1..HelloWorld..1067474.,data_canvas_f20_111$Final.Points, use = "complete.obs")#0.5668931
cor(data_canvas_f22_111$X1..HelloWorld..2245837.,data_canvas_f22_111$Final.Points)#0.6280136

# ASSIGNMENT 2
plot(as.numeric(data_canvas_f20_111$X2..Wind.Chill..1067488.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X2..Wind.Chill..1067488.,data_canvas_f20_111$Final.Points, use = "complete.obs")#0.5786268
cor(data_canvas_f22_111$X2..Wind.Chill..2245864.,data_canvas_f22_111$Final.Points)#0.6280136

# ASSIGNMENT 3
plot(as.numeric(data_canvas_f20_111$X3..Order.Check..1067507.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X3..Order.Check..1067507.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6178655
cor(data_canvas_f22_111$X3..Order.Check..2245891.,data_canvas_f22_111$Final.Points)#0.6280136


# ASSIGNMENT 4
plot(as.numeric(data_canvas_f20_111$X4..Largest.Of.Five..1067512.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X4..Largest.Of.Five..1067512.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6420392
cor(data_canvas_f22_111$X4..Largest.of.Five..2256718.,data_canvas_f22_111$Final.Points)#0.6280136

# ASSIGNMENT 5
plot(as.numeric(data_canvas_f20_111$X5..Check.Digit..1067522.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X5..Check.Digit..1067522.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6720691
cor(data_canvas_f22_111$X5..Check.Digit..2256724.,data_canvas_f22_111$Final.Points)#0.6280136

# ASSIGNMENT 6
plot(as.numeric(data_canvas_f20_111$X6..Two.Smallest..1067529.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X6..Two.Smallest..1067529.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6809866
cor(data_canvas_f22_111$X6..Random.Walker..2256731.,data_canvas_f22_111$Final.Points)#0.6280136

# ASSIGNMENT 7
plot(as.numeric(data_canvas_f20_111$X7..Random.Walker..1067533.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X7,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6755764
cor(data_canvas_f22_111$X7,data_canvas_f22_111$Final.Points, use = "complete.obs")# 0.6755764

str(data_canvas_f22_111$Final.Points)

# ASSIGNMENT 8
plot(as.numeric(data_canvas_f20_111$X8..Find.Duplicate..1067540. ),data_canvas_f20_111$Final.Points)
#cor(data_canvas_f20_111$X8..Find.Duplicate..1067540.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.730118
cor(data_canvas_f20_111$X8,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.730118
cor(data_canvas_f22_111$X8,data_canvas_f22_111$Final.Points, use = "complete.obs")# 0.730118


# ASSIGNMENT 9
plot(as.numeric(data_canvas_f20_111$X9..RU.Rotten.Tomatoes..1067618.),data_canvas_f20_111$Final.Points)
#cor(data_canvas_f20_111$X9..RU.Rotten.Tomatoes..1067618.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7076035
cor(data_canvas_f20_111$X9,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7076035
cor(data_canvas_f22_111$X9,data_canvas_f22_111$Final.Points, use = "complete.obs")# 0.7076035


# ASSIGNMENT 10
plot(as.numeric(data_canvas_f20_111$X10..Polygon.Transform..1126937.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X10..Polygon.Transform..1126937.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7609637

# ASSIGNMENT 11
plot(as.numeric(data_canvas_f20_111$X11..Sierpinski..1126948.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X11..Sierpinski..1126948.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6906472

# ASSIGNMENT 12
plot(as.numeric(data_canvas_f20_111$X12..Weather.Generator..1126951.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X12..Weather.Generator..1126951.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.6406886

# ASSIGNMENT 13
plot(as.numeric(data_canvas_f20_111$X13..RecursiveAppend..1126971.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X13..RecursiveAppend..1126971.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7523933

# ASSIGNMENT 14
plot(as.numeric(data_canvas_f20_111$X14..Vehicle.Scenario.Analysis..1126976.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X14..Vehicle.Scenario.Analysis..1126976.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7664125

# ASSIGNMENT 15
plot(as.numeric(data_canvas_f20_111$X15..Heart.Transplant..1126986.),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X15..Heart.Transplant..1126986.,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7919679

# ASSIGNMENT 16
plot(as.numeric(data_canvas_f20_111$X16..Assignment.8...Complexity.Analysis..1129495),data_canvas_f20_111$Final.Points)
cor(data_canvas_f20_111$X16..Assignment.8...Complexity.Analysis..1129495,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7931511


# scatterplots with classes

data_f20_x <- data_canvas_f20_111

data_f20_x$SUCCESS[data_f20_x$Final.Points >= 750] <- 1
data_f20_x$SUCCESS[data_f20_x$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_f20_x$SUCCESS[data_f20_x$Final.Points > 600 & data_f20_x$Final.Points < 750] <- 3

# three colors: CLASSES ARE VERY MIXED

plot(data_f20_x$Quiz.1..1068907., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.2..1127309., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.3..1127314., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.4..1129289., col=c("green","blue","red")[data_f20_x$SUCCESS])

# not sure how these assignments were chosen.. maybe cor > 0.75?, if yes then X10 was missed.

plot(data_f20_x$X16..Assignment.8...Complexity.Analysis..1129495., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X15..Heart.Transplant..1126986., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X14..Vehicle.Scenario.Analysis..1126976., col=c("green","blue","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X13..RecursiveAppend..1126971., col=c("green","blue","red")[data_f20_x$SUCCESS])


# two colors: struggling is red and non-struggling (successful or failing) is green
# CLASSES ARE VERY MIXED

plot(data_f20_x$Quiz.1..1068907., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.2..1127309., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.3..1127314., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$Quiz.4..1129289., col=c("green","green","red")[data_f20_x$SUCCESS])

plot(data_f20_x$X16..Assignment.8...Complexity.Analysis..1129495., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X15..Heart.Transplant..1126986., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X14..Vehicle.Scenario.Analysis..1126976., col=c("green","green","red")[data_f20_x$SUCCESS])
plot(data_f20_x$X13..RecursiveAppend..1126971., col=c("green","green","red")[data_f20_x$SUCCESS])

# BOXPLOTS !!!


#data_f20_numeric_attributes_0_to_15 <- data_f20[,names(data_f20) %in% c("BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]
#data_f20_numeric_attributes_0_to_10 <- data_f20_x[,names(data_f20_x) %in% c("X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.","X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.", "X16..Assignment.8...Complexity.Analysis..1129495.")]
#data_f20_numeric_attributes_0_to_100 <- data_f20_x[,names(data_f20_x) %in% c("Quiz.2..1127309.","Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.")]
#data_f20_numeric_attributes <- data_f20_x[,names(data_f20_x) %in% c("cum_gpa_ug_to_date","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]


#Bottom margin: 5.1
#Left margin: 4.1
#Top margin: 4.1
#Right margin: 2.1

#par(mar = c(1, 1, 1, 1))

#c(5.1,4.1,4.1,2.1)
#c(bottom, left, top, right)
#par(mfrow=c(1,5))

names(data_f20_saved)

# These are only necessary if the paragraph got messed up

#par(mar = c(5.1,4.1,4.1,2.1))
#par(mfrow=c(1,1))

boxplot(Final.Points~SUCCESS,data=data_f20_x, main="Final Points",
        xlab="SUCCESS", ylab="Score")

boxplot(Quiz.1..1068907.~SUCCESS,data=data_f20_x, main="Quiz 1",
        xlab="SUCCESS", ylab="Score")

boxplot(Quiz.2..1127309.~SUCCESS,data=data_f20_x, main="Quiz 2",
        xlab="SUCCESS", ylab="Score")

boxplot(Quiz.3..1127314.~SUCCESS,data=data_f20_x, main="Quiz 3",
        xlab="SUCCESS", ylab="Score")

boxplot(Quiz.4..1129289.~SUCCESS,data=data_f20_x, main="Quiz 4",
        xlab="SUCCESS", ylab="Score")

# ASSIGNMENTS

boxplot(X0..Pseudocode..1127307.~SUCCESS,data=data_f20_x, main="X0 Pseudocode",
        xlab="SUCCESS", ylab="Score")

boxplot(X1..HelloWorld..1067474.~SUCCESS,data=data_f20_x, main="X1 Hello World",
        xlab="SUCCESS", ylab="Score")

boxplot(X2..Wind.Chill..1067488.~SUCCESS,data=data_f20_x, main="X2 Wind Chill",
        xlab="SUCCESS", ylab="Score")

boxplot(X3..Order.Check..1067507.~SUCCESS,data=data_f20_x, main="X3 Order Check",
        xlab="SUCCESS", ylab="Score")

boxplot(X4..Largest.Of.Five..1067512.~SUCCESS,data=data_f20_x, main="X4 Largest",
        xlab="SUCCESS", ylab="Score")

boxplot(X5..Check.Digit..1067522.~SUCCESS,data=data_f20_x, main="X5 Check Digit",
        xlab="SUCCESS", ylab="Score")

boxplot(X6..Two.Smallest..1067529.~SUCCESS,data=data_f20_x, main="X6 Two Smallest",
        xlab="SUCCESS", ylab="Score")

boxplot(X7..Random.Walker..1067533.~SUCCESS,data=data_f20_x, main="X7 Random",
        xlab="SUCCESS", ylab="Score")


#Intro Survey Info

# Q1: If you had to declare your major(s) today, what would it/they be?
# Q32: If you had to declare your minor(s) today, what would it/they be?
# Q2: Why are you taking CS 111? - Selected Choice
# Q4: Please check all of your prior experience with computer science: - Selected Choice
# Q35: How difficult do you think this class will be?

# CHI-SQ TESTS!

#chisq <- chisq.test(housetasks)

#chisq.test(x=habitat.re$Gidgee, y=habitat.re$`Ian's Place`)
#chisq.test(x=habitat.re$`Ian's Place`, y=habitat.re$`Saw Mulga`)
#chisq.test(x=habitat.re$Gidgee, y=habitat.re$`Saw Mulga`)


names(data_common_columns_f20_a_all_normalized)

# Grouped bar charts


library(dplyr)
library(ggplot2)
names(data_canvas_and_intro_f20_111)

# Q1 vs SUCCESS ...

# chi-sq
chisq.test(x=data_canvas_and_intro_f20_111$Q1, y=data_canvas_and_intro_f20_111$SUCCESS)

# second attempt ..
#data.re <- data_canvas_and_intro_f20_111
#data.df<-data.matrix(data.re, rownames.force = NA)# convert to matrix table
#data.df<- data.df[,c("Q1", "SUCCESS")]
#rownames(data.df) <- data.re$COMMON.NAME #pull names from original
#chisq.test(data.df) #do chisquare test
##chisq.test(data.df)$expected #return predicted values
#fisher.test(data.df, simulate.p.value=T)


tb <- table(data_canvas_and_intro_f20_111$Q1, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 140.96, df = 78, p-value = 1.666e-05

tb <- table(data_canvas_and_intro_f20_111$Q2, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 17.995, df = 14, p-value = 0.207

tb <- table(data_canvas_and_intro_f20_111$Q4, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 29.277, df = 14, p-value = 0.009585

tb <- table(data_canvas_and_intro_f20_111$Q35, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 22.45, df = 10, p-value = 0.01297

tb <- table(data_canvas_and_intro_f20_111$Q38_1, data_canvas_and_intro_f20_111$SUCCESS)
#chisq.test(as.matrix(tb))# X-squared = 17.262, df = 8, p-value = 0.02749
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.02349

tb <- table(data_canvas_and_intro_f20_111$Q38_2, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 5.1382, df = 8, p-value = 0.7427
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.8696

tb <- table(data_canvas_and_intro_f20_111$Q38_3, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 22.042, df = 8, p-value = 0.004839
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.005997

tb <- table(data_canvas_and_intro_f20_111$Q38_4, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 15.994, df = 8, p-value = 0.04246
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.02949

tb <- table(data_canvas_and_intro_f20_111$Q38_5, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 15.213, df = 8, p-value = 0.05513
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.03998

tb <- table(data_canvas_and_intro_f20_111$Q38_6, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 10.212, df = 8, p-value = 0.2504
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.2234

tb <- table(data_canvas_and_intro_f20_111$Q38_7, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 13.312, df = 8, p-value = 0.1016
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.06947

tb <- table(data_canvas_and_intro_f20_111$Q38_8, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 17.899, df = 8, p-value = 0.022
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.02899

tb <- table(data_canvas_and_intro_f20_111$Q38_9, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 11.508, df = 8, p-value = 0.1746
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.1489

tb <- table(data_canvas_and_intro_f20_111$Q38_10, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 10.272, df = 8, p-value = 0.2465
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.2434

tb <- table(data_canvas_and_intro_f20_111$Q38_11, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 7.0083, df = 8, p-value = 0.5357
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.5447

tb <- table(data_canvas_and_intro_f20_111$Q38_12, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 13.561, df = 8, p-value = 0.09396
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.07446

tb <- table(data_canvas_and_intro_f20_111$Q39_1, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 20.258, df = 10, p-value = 0.0269
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.02649

tb <- table(data_canvas_and_intro_f20_111$Q39_2, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 11.98, df = 10, p-value = 0.2864
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.1969

tb <- table(data_canvas_and_intro_f20_111$Q39_3, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 8.4864, df = 10, p-value = 0.5814
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.7006

tb <- table(data_canvas_and_intro_f20_111$Q39_4, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 5.6269, df = 10, p-value = 0.8456
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.8741

tb <- table(data_canvas_and_intro_f20_111$Q39_5, data_canvas_and_intro_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 6.3088, df = 10, p-value = 0.7887
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.9245

########################### done with chi-sq for intro survey variables.

 
# GRAPHS..

df <- data_canvas_and_intro_f20_111[,c("Q1","SUCCESS")]
df_with_count<-df%>%group_by(Q1,SUCCESS)%>%mutate(count=n())

# x[!duplicated(x)]

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q1, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q1, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")


# Q2 vs SUCCESS ...

df <- data_canvas_and_intro_f20_111[,c("Q2","SUCCESS")]
df_with_count<-df%>%group_by(Q2,SUCCESS)%>%mutate(count=n())

# x[!duplicated(x)]

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q2, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q2, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Q4 vs SUCCESS ...

df <- data_canvas_and_intro_f20_111[,c("Q4","SUCCESS")]
df_with_count<-df%>%group_by(Q4,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q4, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q4, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Q35 vs SUCCESS ...

df <- data_canvas_and_intro_f20_111[,c("Q35","SUCCESS")]
df_with_count<-df%>%group_by(Q35,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q35, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q35, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")


# SAS DATA!


# chi-sq

#data.re <- data_canvas_and_sas_f20_111
#data.df<-data.matrix(data.re, rownames.force = NA)# convert to matrix table
#data.df<- data.df[,c("ethnic_cd","SUCCESS")]
#rownames(data.df) <- data.re$COMMON.NAME #pull names from original
#chisq.test(data.df) #do chisquare test
#fisher.test(data.df, simulate.p.value=T)
#chisq.test(data.df)$expected #return predicted values

tb <- table(data_canvas_and_sas_f20_111$ethnic_cd, data_canvas_and_sas_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 37.149, df = 18, p-value = 0.005011
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.004998

tb <- table(data_canvas_and_sas_f20_111$orig_admit_type_cd, data_canvas_and_sas_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 22.45, df = 10, p-value = 0.01297
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.01549

tb <- table(data_canvas_and_sas_f20_111$curr_admit_type_cd, data_canvas_and_sas_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 104.07, df = 14, p-value = 7.821e-16
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.0004998

tb <- table(data_canvas_and_sas_f20_111$sending_school_type_cd, data_canvas_and_sas_f20_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 19.279, df = 10, p-value = 0.03686
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.08096


# Ethnic vs SUCCESS ...

df <- data_canvas_and_sas_f20_111[,c("ethnic_cd","SUCCESS")]
df_with_count<-df%>%group_by(ethnic_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=ethnic_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=ethnic_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Admit_Type vs SUCCESS ...

df <- data_canvas_and_sas_f20_111[,c("orig_admit_type_cd","SUCCESS")]
df_with_count<-df%>%group_by(orig_admit_type_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=orig_admit_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=orig_admit_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Sending School vs SUCCESS ...

data_canvas_and_sas_f20_111$sending_school_type_cd <- as.factor(data_canvas_and_sas_f20_111$sending_school_type_cd)


df <- data_canvas_and_sas_f20_111[,c("sending_school_type_cd","SUCCESS")]
df_with_count<-df%>%group_by(sending_school_type_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=sending_school_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=sending_school_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Cumulative GPA up to Date: Boxplot
boxplot(cum_gpa_ug_to_date~SUCCESS,data=data_canvas_and_sas_f20_111, main="CGPA",
        xlab="SUCCESS", ylab="GPA")

# Scatterplot CGPA vs Final.Score

# basic scatterplot
ggplot(data_canvas_and_sas_f20_111, aes(x=Final.Points, y=cum_gpa_ug_to_date)) + 
  geom_point()

cor(data_canvas_and_sas_f20_111$cum_gpa_ug_to_date,data_canvas_and_sas_f20_111$Final.Points, use = "complete.obs")# 0.6385



names(data_canvas_and_sas_f20_111_research)
table(data_canvas_and_sas_f20_111_research$SUCCESS)

# EDA with Autolab data!!

#data_all1 <- merge(data_canvas_and_sas_f20_111_research, data_intro_f20_111, by = "NetID")
#data_all_plus_autolab_w7 <- merge(data_all1, new_data_autolab_w7)

# merge canvas and autolab data

data_canvas_and_autolab <- merge(data_canvas_f20_111, new_data_autolab_w7, by = "NetID")
data_canvas_and_autolab_research <- data_canvas_and_autolab[data_canvas_and_autolab$NetID %in% netids_research_f20,] 

names(data_canvas_and_autolab)

data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points >= 750] <- 1
data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points <= 600] <- 2
data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points > 600 & data_canvas_and_autolab_research$Final.Points < 750] <- 3

boxplot(max_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Submissions")

# with outliers
boxplot(max_time_f_l_subm~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w First and Last Submission (seconds)") #??/

# without outliers
boxplot(max_time_f_l_subm~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w First and Last Submission (seconds)", outline = FALSE) #??/

# with outliers
boxplot(max_time_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w Consecutive Submissions (seconds)") 

# without outliers
boxplot(max_time_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w Consecutive Submissions (seconds)", outline = FALSE) 

boxplot(max_score_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Score Improvement b/w Consecutive Submissions")

boxplot(min_score_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Score Improvement b/w Consecutive Submissions")

#boxplot(max_time_b4_deadline_first_submission~SUCCESS,data=data_canvas_and_autolab_research, main="",
#        xlab="SUCCESS", ylab="Max Time Before Deadine for First Submission (seconds)")

boxplot(max_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time Before Deadine for First Submission (hours)")

boxplot(min_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for First Submission (hours)")

boxplot(avg_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Time (hours)")


boxplot(max_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time Before Deadine for Last Submission (hours)")


# with outliers
boxplot(min_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for Last Submission (hours)")

# without outliers
boxplot(min_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for Last Submission (hours)", outline = FALSE)


# T-tests

students_success <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==1,]
students_fail <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==2,]
students_struggling <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==3,]

# average time before deadline first submission

t.test(students_success$avg_time_b4_deadline_first_submission, students_struggling$avg_time_b4_deadline_first_submission)
t.test(students_success$avg_time_b4_deadline_first_submission, students_fail$avg_time_b4_deadline_first_submission)
t.test(students_fail$avg_time_b4_deadline_first_submission, students_struggling$avg_time_b4_deadline_first_submission)

# min time before deadline first submission

t.test(students_success$min_time_b4_deadline_first_submission, students_struggling$min_time_b4_deadline_first_submission)
t.test(students_success$min_time_b4_deadline_first_submission, students_fail$min_time_b4_deadline_first_submission)
t.test(students_fail$min_time_b4_deadline_first_submission, students_struggling$min_time_b4_deadline_first_submission)

# max time before deadline first submission

t.test(students_success$max_time_b4_deadline_first_submission, students_struggling$max_time_b4_deadline_first_submission)
t.test(students_success$max_time_b4_deadline_first_submission, students_fail$max_time_b4_deadline_first_submission)
t.test(students_fail$max_time_b4_deadline_first_submission, students_struggling$max_time_b4_deadline_first_submission)

# max time between first and last submission - NOT STAT SIG!!!

t.test(students_success$max_time_f_l_subm, students_struggling$max_time_f_l_subm)
t.test(students_success$max_time_f_l_subm, students_fail$max_time_f_l_subm)
t.test(students_fail$max_time_f_l_subm, students_struggling$max_time_f_l_subm)

# max time between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$max_time_consecutive_submissions, students_struggling$max_time_consecutive_submissions)
t.test(students_success$max_time_consecutive_submissions, students_fail$max_time_consecutive_submissions)
t.test(students_fail$max_time_consecutive_submissions, students_struggling$max_time_consecutive_submissions)


# max score between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$max_score_consecutive_submissions, students_struggling$max_score_consecutive_submissions)
t.test(students_success$max_score_consecutive_submissions, students_fail$max_score_consecutive_submissions)
t.test(students_fail$max_score_consecutive_submissions, students_struggling$max_score_consecutive_submissions)


# min score between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$min_score_consecutive_submissions, students_struggling$min_score_consecutive_submissions)
t.test(students_success$min_score_consecutive_submissions, students_fail$min_score_consecutive_submissions)
t.test(students_fail$min_score_consecutive_submissions, students_struggling$min_score_consecutive_submissions)

# max time before deadline last submission

t.test(students_success$max_time_b4_deadline_last_submission, students_struggling$max_time_b4_deadline_last_submission)
t.test(students_success$max_time_b4_deadline_last_submission, students_fail$max_time_b4_deadline_last_submission)
t.test(students_fail$max_time_b4_deadline_last_submission, students_struggling$max_time_b4_deadline_last_submission)

# min time before deadline last submission

t.test(students_success$min_time_b4_deadline_last_submission, students_struggling$min_time_b4_deadline_last_submission)
t.test(students_success$min_time_b4_deadline_last_submission, students_fail$min_time_b4_deadline_last_submission)
t.test(students_fail$min_time_b4_deadline_last_submission, students_struggling$min_time_b4_deadline_last_submission)


##########################################################
#
#    SPRING 2021
#
##########################################################

# Use CANVAS DATA

################################################################
# SCATTER PLOTS AND CORRELATIONS BETWEEN FINAL SCORE VS. QUIZZES
################################################################

# remove first and last row which seem to contain nonsense..
data_canvas_s21_111_s <- data_canvas_s21_111[-c(1, 110, 619), ]

data_canvas_s21_111 <- data_canvas_s21_111_s

names(data_canvas_s21_111)
str(data_canvas_s21_111)
data_canvas_s21_111$Final.Points <- as.numeric(data_canvas_s21_111$Final.Points)

# Quiz 1
plot(as.numeric(data_canvas_s21_111$Midterm.1..1323316.), data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$Midterm.1..1323316.,data_canvas_s21_111$Final.Points) # 0.66

# Quiz 2
plot(as.numeric(data_canvas_s21_111$Midterm.2..1371557.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$Midterm.2..1371557.,data_canvas_s21_111$Final.Points) # 0.6844146

# Quiz 3
plot(as.numeric(data_canvas_s21_111$Midterm.3..1371558.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$Midterm.3..1371558.,data_canvas_s21_111$Final.Points) #0.5517325

# Quiz 4
plot(as.numeric(data_canvas_s21_111$Final..1389238.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$Final..1389238.,data_canvas_s21_111$Final.Points) # 0.8008156

####################################################################
# SCATTER PLOTS AND CORRELATIONS BETWEEN FINAL SCORE VS. ASSIGNMENTS
###################################################################

# ASSIGNMENT 0
plot(as.numeric(data_canvas_s21_111$X0..Pseudocode..1323312.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X0..Pseudocode..1323312.,data_canvas_s21_111$Final.Points)#0.6560152

# ASSIGNMENT 1
plot(as.numeric(data_canvas_s21_111$X1..HelloWorld..1321629.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X1..HelloWorld..1321629.,data_canvas_s21_111$Final.Points, use = "complete.obs")#0.6147674

# ASSIGNMENT 2
plot(as.numeric(data_canvas_s21_111$X2..Wind.Chill..1321738.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X2..Wind.Chill..1321738.,data_canvas_s21_111$Final.Points, use = "complete.obs")#0.6474182

# ASSIGNMENT 3
plot(as.numeric(data_canvas_s21_111$X3..Order.Check..1321757.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X3..Order.Check..1321757.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.682978

# ASSIGNMENT 4
plot(as.numeric(data_canvas_s21_111$X4..Largest.of.Five..1321768.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X4..Largest.of.Five..1321768.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.6749883

# ASSIGNMENT 5
plot(as.numeric(data_canvas_s21_111$X5..Check.Digit..1321789.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X5..Check.Digit..1321789.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7064231

# ASSIGNMENT 6
plot(as.numeric(data_canvas_s21_111$X6..Random.Walker..1321792.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X6..Random.Walker..1321792.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.692514

# ASSIGNMENT 7
plot(as.numeric(data_canvas_s21_111$X7..Find.Duplicate..1321853.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X7..Find.Duplicate..1321853.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7002616

# ASSIGNMENT 8
plot(as.numeric(data_canvas_s21_111$X8..RU.Rotten.Tomatoes..1321857.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X8..RU.Rotten.Tomatoes..1321857.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7124143

# ASSIGNMENT 9
plot(as.numeric(data_canvas_s21_111$X9..Polygon.Transform..1341197.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X9..Polygon.Transform..1341197.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.6932015

# ASSIGNMENT 10
plot(as.numeric(data_canvas_s21_111$X10..Weather.Generator..1341208.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X10..Weather.Generator..1341208.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7376694

# ASSIGNMENT 11
plot(as.numeric(data_canvas_s21_111$X11..Sierpinski..1346601.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X11..Sierpinski..1346601.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.6972002

# ASSIGNMENT 12
plot(as.numeric(data_canvas_s21_111$X12..RecursiveAppend..1359445.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X12..RecursiveAppend..1359445.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.8024429

# ASSIGNMENT 13
plot(as.numeric(data_canvas_s21_111$X13..Vehicle.Scenario.Analysis..1359453.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X13..Vehicle.Scenario.Analysis..1359453.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7899962

# ASSIGNMENT 14
plot(as.numeric(data_canvas_s21_111$X14..Heart.Transplant..1381303.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X14..Heart.Transplant..1381303.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.7802479

# ASSIGNMENT 15
plot(as.numeric(data_canvas_s21_111$X15..Written.Assignment.10..1383034.),data_canvas_s21_111$Final.Points)
cor(data_canvas_s21_111$X15..Written.Assignment.10..1383034.,data_canvas_s21_111$Final.Points, use = "complete.obs")# 0.800162

# ASSIGNMENT 16 : no assignment 16 during Spring 2021
#plot(as.numeric(data_canvas_f20_111$X16..Assignment.8...Complexity.Analysis..1129495),data_canvas_f20_111$Final.Points)
#cor(data_canvas_f20_111$X16..Assignment.8...Complexity.Analysis..1129495,data_canvas_f20_111$Final.Points, use = "complete.obs")# 0.7931511


# scatterplots with classes

data_s21_x <- data_canvas_s21_111

data_s21_x$SUCCESS[data_s21_x$Final.Points >= 750] <- 1
data_s21_x$SUCCESS[data_s21_x$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_s21_x$SUCCESS[data_s21_x$Final.Points > 600 & data_s21_x$Final.Points < 750] <- 3

# three colors: CLASSES ARE VERY MIXED

plot(data_s21_x$Midterm.1..1323316., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Midterm.2..1371557., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Midterm.3..1371558., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Final..1389238., col=c("green","blue","red")[data_s21_x$SUCCESS])

plot(data_s21_x$X15..Written.Assignment.10..1383034., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X14..Heart.Transplant..1381303., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X13..Vehicle.Scenario.Analysis..1359453., col=c("green","blue","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X12..RecursiveAppend..1359445., col=c("green","blue","red")[data_s21_x$SUCCESS])


# two colors: struggling is red and non-struggling (successful or failing) is green
# CLASSES ARE VERY MIXED

plot(data_s21_x$Midterm.1..1323316., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Midterm.2..1371557., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Midterm.3..1371558., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$Final..1389238., col=c("green","green","red")[data_s21_x$SUCCESS])

plot(data_s21_x$X15..Written.Assignment.10..1383034., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X14..Heart.Transplant..1381303., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X13..Vehicle.Scenario.Analysis..1359453., col=c("green","green","red")[data_s21_x$SUCCESS])
plot(data_s21_x$X12..RecursiveAppend..1359445., col=c("green","green","red")[data_s21_x$SUCCESS])

# BOXPLOTS !!!


#data_f20_numeric_attributes_0_to_15 <- data_f20[,names(data_f20) %in% c("BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]
#data_f20_numeric_attributes_0_to_10 <- data_f20_x[,names(data_f20_x) %in% c("X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.","X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.", "X16..Assignment.8...Complexity.Analysis..1129495.")]
#data_f20_numeric_attributes_0_to_100 <- data_f20_x[,names(data_f20_x) %in% c("Quiz.2..1127309.","Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.")]
#data_f20_numeric_attributes <- data_f20_x[,names(data_f20_x) %in% c("cum_gpa_ug_to_date","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]


#Bottom margin: 5.1
#Left margin: 4.1
#Top margin: 4.1
#Right margin: 2.1

#par(mar = c(1, 1, 1, 1))

#c(5.1,4.1,4.1,2.1)
#c(bottom, left, top, right)
#par(mfrow=c(1,5))

#names(data_f20_saved)

# These are only necessary if the paragraph got messed up

#par(mar = c(5.1,4.1,4.1,2.1))
#par(mfrow=c(1,1))

boxplot(Final.Points~SUCCESS,data=data_s21_x, main="Final Points",
        xlab="SUCCESS", ylab="Score")

boxplot(Midterm.1..1323316.~SUCCESS,data=data_s21_x, main="Midterm 1",
        xlab="SUCCESS", ylab="Score")

boxplot(Midterm.2..1371557.~SUCCESS,data=data_s21_x, main="Midterm 2",
        xlab="SUCCESS", ylab="Score")

boxplot(Midterm.3..1371558.~SUCCESS,data=data_s21_x, main="Midterm 3",
        xlab="SUCCESS", ylab="Score")

boxplot(Final..1389238.~SUCCESS,data=data_s21_x, main="Midterm 4",
        xlab="SUCCESS", ylab="Score")

names(data_s21_x)

# ASSIGNMENTS

boxplot(X0..Pseudocode..1323312.~SUCCESS,data=data_s21_x, main="X0 Pseudocode",
        xlab="SUCCESS", ylab="Score")

boxplot(X1..HelloWorld..1321629.~SUCCESS,data=data_s21_x, main="X1 Hello World",
        xlab="SUCCESS", ylab="Score")

boxplot(X2..Wind.Chill..1321738.~SUCCESS,data=data_s21_x, main="X2 Wind Chill",
        xlab="SUCCESS", ylab="Score")

boxplot(X3..Order.Check..1321757.~SUCCESS,data=data_s21_x, main="X3 Order Check",
        xlab="SUCCESS", ylab="Score")

boxplot(X4..Largest.of.Five..1321768.~SUCCESS,data=data_s21_x, main="X4 Largest",
        xlab="SUCCESS", ylab="Score")

boxplot(X5..Check.Digit..1321789.~SUCCESS,data=data_s21_x, main="X5 Check Digit",
        xlab="SUCCESS", ylab="Score")

boxplot(X6..Random.Walker..1321792.~SUCCESS,data=data_s21_x, main="X6 Two Smallest",
        xlab="SUCCESS", ylab="Score")

boxplot(X7..Find.Duplicate..1321853.~SUCCESS,data=data_s21_x, main="X7 Random",
        xlab="SUCCESS", ylab="Score")


#Intro Survey Info

# Q1: If you had to declare your major(s) today, what would it/they be?
# Q32: If you had to declare your minor(s) today, what would it/they be?
# Q2: Why are you taking CS 111? - Selected Choice
# Q4: Please check all of your prior experience with computer science: - Selected Choice
# Q35: How difficult do you think this class will be?

# CHI-SQ TESTS!

#chisq <- chisq.test(housetasks)

#chisq.test(x=habitat.re$Gidgee, y=habitat.re$`Ian's Place`)
#chisq.test(x=habitat.re$`Ian's Place`, y=habitat.re$`Saw Mulga`)
#chisq.test(x=habitat.re$Gidgee, y=habitat.re$`Saw Mulga`)


# Grouped bar charts

# Add SUCCESS variable to data_canvas_and_intro

data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points >= 750] <- 1
data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_canvas_and_intro_s21_111$SUCCESS[data_canvas_and_intro_s21_111$Final.Points > 600 & data_canvas_and_intro_s21_111$Final.Points < 750] <- 3

library(dplyr)
library(ggplot2)
names(data_canvas_and_intro_s21_111)

# Q1 vs SUCCESS ...

# chi-sq
chisq.test(x=data_canvas_and_intro_s21_111$Q1, y=data_canvas_and_intro_s21_111$SUCCESS) # p-value = 0.9854

# second attempt ..
#data.re <- data_canvas_and_intro_f20_111
#data.df<-data.matrix(data.re, rownames.force = NA)# convert to matrix table
#data.df<- data.df[,c("Q1", "SUCCESS")]
#rownames(data.df) <- data.re$COMMON.NAME #pull names from original
#chisq.test(data.df) #do chisquare test
##chisq.test(data.df)$expected #return predicted values
#fisher.test(data.df, simulate.p.value=T)


tb <- table(data_canvas_and_intro_s21_111$Q1, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 56.624, df = 82, p-value = 0.9854

tb <- table(data_canvas_and_intro_s21_111$Q2, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 24.282, df = 14, p-value = 0.04236

tb <- table(data_canvas_and_intro_s21_111$Q4, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 104.47, df = 86, p-value = 0.0856

tb <- table(data_canvas_and_intro_s21_111$Q35, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 29.79, df = 10, p-value = 0.0009271

tb <- table(data_canvas_and_intro_s21_111$Q38_1, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 32.059, df = 8, p-value = 9.089e-05
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.0004998

tb <- table(data_canvas_and_intro_s21_111$Q38_2, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 22.651, df = 8, p-value = 0.003842
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.01199

tb <- table(data_canvas_and_intro_s21_111$Q38_3, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 29.379, df = 8, p-value = 0.000272
fisher.test(as.matrix(tb), simulate.p.value=T) # 0.001499

tb <- table(data_canvas_and_intro_s21_111$Q38_4, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 18.724, df = 8, p-value = 0.01641
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.04048

tb <- table(data_canvas_and_intro_s21_111$Q38_5, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 20.483, df = 8, p-value = 0.008656
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.03198

tb <- table(data_canvas_and_intro_s21_111$Q38_6, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 23.004, df = 8, p-value = 0.003358
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.007496

tb <- table(data_canvas_and_intro_s21_111$Q38_7, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# X-squared = 24.671, df = 8, p-value = 0.001767
fisher.test(as.matrix(tb), simulate.p.value=T) # p-value = 0.009995

tb <- table(data_canvas_and_intro_s21_111$Q38_8, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q38_9, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q38_10, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q38_11, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) #

tb <- table(data_canvas_and_intro_s21_111$Q38_12, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q39_1, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q39_2, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q39_3, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q39_4, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_intro_s21_111$Q39_5, data_canvas_and_intro_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

########################### done with chi-sq for intro survey variables.


# GRAPHS..

df <- data_canvas_and_intro_s21_111[,c("Q1","SUCCESS")]
df_with_count<-df%>%group_by(Q1,SUCCESS)%>%mutate(count=n())

# x[!duplicated(x)]

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q1, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q1, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")


# Q2 vs SUCCESS ...

df <- data_canvas_and_intro_s21_111[,c("Q2","SUCCESS")]
df_with_count<-df%>%group_by(Q2,SUCCESS)%>%mutate(count=n())

# x[!duplicated(x)]

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q2, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q2, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Q4 vs SUCCESS ...

df <- data_canvas_and_intro_s21_111[,c("Q4","SUCCESS")]
df_with_count<-df%>%group_by(Q4,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q4, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q4, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Q35 vs SUCCESS ...

df <- data_canvas_and_intro_s21_111[,c("Q35","SUCCESS")]
df_with_count<-df%>%group_by(Q35,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=Q35, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=Q35, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")


# SAS DATA!

# Add SUCCESS variable to data_canvas_and_sas

data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points >= 750] <- 1
data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points <= 600] <- 2
data_canvas_and_sas_s21_111$SUCCESS[data_canvas_and_sas_s21_111$Final.Points > 600 & data_canvas_and_sas_s21_111$Final.Points < 750] <- 3

# chi-sq

#data.re <- data_canvas_and_sas_f20_111
#data.df<-data.matrix(data.re, rownames.force = NA)# convert to matrix table
#data.df<- data.df[,c("ethnic_cd","SUCCESS")]
#rownames(data.df) <- data.re$COMMON.NAME #pull names from original
#chisq.test(data.df) #do chisquare test
#fisher.test(data.df, simulate.p.value=T)
#chisq.test(data.df)$expected #return predicted values

tb <- table(data_canvas_and_sas_s21_111$ethnic_cd, data_canvas_and_sas_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_sas_s21_111$orig_admit_type_cd, data_canvas_and_sas_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 

tb <- table(data_canvas_and_sas_s21_111$sending_school_type_cd, data_canvas_and_sas_s21_111$SUCCESS)
chisq.test(as.matrix(tb))# 
fisher.test(as.matrix(tb), simulate.p.value=T) # 


# Ethnic vs SUCCESS ...

df <- data_canvas_and_sas_s21_111[,c("ethnic_cd","SUCCESS")]
df_with_count<-df%>%group_by(ethnic_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=ethnic_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=ethnic_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Admit_Type vs SUCCESS ...

df <- data_canvas_and_sas_s21_111[,c("orig_admit_type_cd","SUCCESS")]
df_with_count<-df%>%group_by(orig_admit_type_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=orig_admit_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=orig_admit_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Sending School vs SUCCESS ...

data_canvas_and_sas_s21_111$sending_school_type_cd <- as.factor(data_canvas_and_sas_s21_111$sending_school_type_cd)


df <- data_canvas_and_sas_s21_111[,c("sending_school_type_cd","SUCCESS")]
df_with_count<-df%>%group_by(sending_school_type_cd,SUCCESS)%>%mutate(count=n())

df_no_duplicates <- unique(df_with_count)

ggplot(df_no_duplicates, aes(fill=sending_school_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="dodge", stat="identity")

# percentages
ggplot(df_no_duplicates, aes(fill=sending_school_type_cd, y=count, x=SUCCESS)) + 
  geom_bar(position="fill", stat="identity")

# Cumulative GPA up to Date: Boxplot
boxplot(cum_gpa_ug_to_date~SUCCESS,data=data_canvas_and_sas_s21_111, main="CGPA",
        xlab="SUCCESS", ylab="GPA")

# Scatterplot CGPA vs Final.Score

# basic scatterplot
ggplot(data_canvas_and_sas_s21_111, aes(x=Final.Points, y=cum_gpa_ug_to_date)) + 
  geom_point()

cor(data_canvas_and_sas_s21_111$cum_gpa_ug_to_date,data_canvas_and_sas_s21_111$Final.Points, use = "complete.obs")# 

# SELECT ONLY STUDENTS WHO AGREED TO DO RESEARCH

data_canvas_and_sas_s21_111_research <- data_canvas_and_sas_s21_111[data_canvas_and_sas_s21_111$NetID %in% netids_research_s21,] 

table(data_canvas_and_sas_s21_111_research$SUCCESS)

# EDA with Autolab data

#data_all1 <- merge(data_canvas_and_sas_f20_111_research, data_intro_f20_111, by = "NetID")
#data_all_plus_autolab_w7 <- merge(data_all1, new_data_autolab_w7)

# merge canvas and autolab data

data_canvas_and_autolab <- merge(data_canvas_s21_111, new_data_autolab_w7_s21, by = "NetID")
data_canvas_and_autolab_research <- data_canvas_and_autolab[data_canvas_and_autolab$NetID %in% netids_research_s21,] 

names(data_canvas_and_autolab)

data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points >= 750] <- 1
data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points <= 600] <- 2
data_canvas_and_autolab_research$SUCCESS[data_canvas_and_autolab_research$Final.Points > 600 & data_canvas_and_autolab_research$Final.Points < 750] <- 3

boxplot(max_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Submissions")

# with outliers
boxplot(max_time_f_l_subm~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w First and Last Submission (seconds)") #??/

# without outliers
boxplot(max_time_f_l_subm~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w First and Last Submission (seconds)", outline = FALSE) #??/

# with outliers
boxplot(max_time_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w Consecutive Submissions (seconds)") 

# without outliers
boxplot(max_time_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time b/w Consecutive Submissions (seconds)", outline = FALSE) 

boxplot(max_score_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Score Improvement b/w Consecutive Submissions")

boxplot(min_score_consecutive_submissions~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Score Improvement b/w Consecutive Submissions")

#boxplot(max_time_b4_deadline_first_submission~SUCCESS,data=data_canvas_and_autolab_research, main="",
#        xlab="SUCCESS", ylab="Max Time Before Deadine for First Submission (seconds)")

boxplot(max_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time Before Deadine for First Submission (hours)")

boxplot(min_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for First Submission (hours)")

boxplot(avg_time_b4_deadline_first_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Time (hours)")


boxplot(max_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Max Time Before Deadine for Last Submission (hours)")


# with outliers
boxplot(min_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for Last Submission (hours)")

# without outliers
boxplot(min_time_b4_deadline_last_submission/3600~SUCCESS,data=data_canvas_and_autolab_research, main="",
        xlab="SUCCESS", ylab="Min Time Before Deadine for Last Submission (hours)", outline = FALSE)


# T-tests

students_success <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==1,]
students_fail <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==2,]
students_struggling <- data_canvas_and_autolab_research[data_canvas_and_autolab_research$SUCCESS==3,]

# average time before deadline first submission

t.test(students_success$avg_time_b4_deadline_first_submission, students_struggling$avg_time_b4_deadline_first_submission)
t.test(students_success$avg_time_b4_deadline_first_submission, students_fail$avg_time_b4_deadline_first_submission)
t.test(students_fail$avg_time_b4_deadline_first_submission, students_struggling$avg_time_b4_deadline_first_submission)

# min time before deadline first submission

t.test(students_success$min_time_b4_deadline_first_submission, students_struggling$min_time_b4_deadline_first_submission)
t.test(students_success$min_time_b4_deadline_first_submission, students_fail$min_time_b4_deadline_first_submission)
t.test(students_fail$min_time_b4_deadline_first_submission, students_struggling$min_time_b4_deadline_first_submission)

# max time before deadline first submission

t.test(students_success$max_time_b4_deadline_first_submission, students_struggling$max_time_b4_deadline_first_submission)
t.test(students_success$max_time_b4_deadline_first_submission, students_fail$max_time_b4_deadline_first_submission)
t.test(students_fail$max_time_b4_deadline_first_submission, students_struggling$max_time_b4_deadline_first_submission)

# max time between first and last submission - NOT STAT SIG!!!

t.test(students_success$max_time_f_l_subm, students_struggling$max_time_f_l_subm)
t.test(students_success$max_time_f_l_subm, students_fail$max_time_f_l_subm)
t.test(students_fail$max_time_f_l_subm, students_struggling$max_time_f_l_subm)

# max time between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$max_time_consecutive_submissions, students_struggling$max_time_consecutive_submissions)
t.test(students_success$max_time_consecutive_submissions, students_fail$max_time_consecutive_submissions)
t.test(students_fail$max_time_consecutive_submissions, students_struggling$max_time_consecutive_submissions)


# max score between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$max_score_consecutive_submissions, students_struggling$max_score_consecutive_submissions)
t.test(students_success$max_score_consecutive_submissions, students_fail$max_score_consecutive_submissions)
t.test(students_fail$max_score_consecutive_submissions, students_struggling$max_score_consecutive_submissions)


# min score between consecutive submissions - NOT STAT SIG!!!

t.test(students_success$min_score_consecutive_submissions, students_struggling$min_score_consecutive_submissions)
t.test(students_success$min_score_consecutive_submissions, students_fail$min_score_consecutive_submissions)
t.test(students_fail$min_score_consecutive_submissions, students_struggling$min_score_consecutive_submissions)

# max time before deadline last submission

t.test(students_success$max_time_b4_deadline_last_submission, students_struggling$max_time_b4_deadline_last_submission)
t.test(students_success$max_time_b4_deadline_last_submission, students_fail$max_time_b4_deadline_last_submission)
t.test(students_fail$max_time_b4_deadline_last_submission, students_struggling$max_time_b4_deadline_last_submission)

# min time before deadline last submission

t.test(students_success$min_time_b4_deadline_last_submission, students_struggling$min_time_b4_deadline_last_submission)
t.test(students_success$min_time_b4_deadline_last_submission, students_fail$min_time_b4_deadline_last_submission)
t.test(students_fail$min_time_b4_deadline_last_submission, students_struggling$min_time_b4_deadline_last_submission)


#####################################
#
#   DONE WITH EDA FOR SPRING 2022
#
####################################


#---------  Fall 2020 START HERE  !!  -------------


# LATER, WE'LL SKIP F20 BECAUSE WE'LL DO FALL 2022 and Fall 2023
# When I get Autolab Fall 2023 data

# intro survey has only students who have given consent for research
data_intro_f20_111_t <- data_intro_f20_111[data_intro_f20_111$Q38=="Yes",]
data_intro_f20_111 <- data_intro_f20_111_t

# STEP 1: Merge Canvas+SAS with Intro survey
data_all1 <- merge(data_canvas_and_sas_f20_111, data_intro_f20_111, by = "NetID")
data_all_plus_autolab_all <- merge(data_all1, data_autolab_f20, by = "NetID")
data_all_plus_autolab_w4 <- merge(data_all1, data_autolab_f20_w4, by = "NetID")
data_all_plus_autolab_w5 <- merge(data_all1, data_autolab_f20_w5, by = "NetID")
data_all_plus_autolab_w7 <- merge(data_all1, data_autolab_f20_w7, by = "NetID")
# Turn SUCCESS into a factor so we can do classification on it

data_all1$SUCCESS <- as.factor(data_all1$SUCCESS)
#table(data_all1$SUCCESS)
data_all_plus_autolab_all$SUCCESS <- as.factor(data_all_plus_autolab_all$SUCCESS)
data_all_plus_autolab_w4$SUCCESS <- as.factor(data_all_plus_autolab_w4$SUCCESS)
data_all_plus_autolab_w5$SUCCESS <- as.factor(data_all_plus_autolab_w5$SUCCESS)
data_all_plus_autolab_w7$SUCCESS <- as.factor(data_all_plus_autolab_w7$SUCCESS)

write.csv(data_all1, "F20_Beginnning_Of_Processing.csv", row.names = FALSE)



# ADD AUTOLAB FEATURES

# ALL
names(data_autolab_f20_w4)
data_all_plus_autolab_all$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_first_submission)
data_all_plus_autolab_all$max_time_f_l_subm <- as.integer(data_all_plus_autolab_all$max_time_f_l_subm)
data_all_plus_autolab_all$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_all$max_time_consecutive_submissions)
data_all_plus_autolab_all$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_last_submission)
data_all_plus_autolab_all$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_first_submission)
data_all_plus_autolab_all$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_last_submission)


# W4

data_all_plus_autolab_w4$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w4$max_time_f_l_subm)
data_all_plus_autolab_w4$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w4$max_time_consecutive_submissions)
data_all_plus_autolab_w4$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission)

# W5

data_all_plus_autolab_w5$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w5$max_time_f_l_subm)
data_all_plus_autolab_w5$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w5$max_time_consecutive_submissions)
data_all_plus_autolab_w5$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission)


# W7

data_all_plus_autolab_w7$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w7$max_time_f_l_subm)
data_all_plus_autolab_w7$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w7$max_time_consecutive_submissions)
data_all_plus_autolab_w7$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_f20 <- data_all1
data_f20_plus_autolab_all <- data_all_plus_autolab_all
data_f20_plus_autolab_week4 <- data_all_plus_autolab_w4
data_f20_plus_autolab_week5 <- data_all_plus_autolab_w5
data_f20_plus_autolab_week7 <- data_all_plus_autolab_w7

setwd("")
write.csv(data_f20_plus_autolab_all, "F20_ALL_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_f20_plus_autolab_week4, "F20_W4_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_f20_plus_autolab_week5, "F20_W5_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_f20_plus_autolab_week7, "F20_W7_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

names(data_all1)

table(data_f20$SUCCESS)

data_f20$SUCCESS <- as.factor(data_f20$SUCCESS)
data_f20_plus_autolab_all$SUCCESS <- as.factor(data_f20_plus_autolab_all$SUCCESS)
data_f20_plus_autolab_week4$SUCCESS <- as.factor(data_f20_plus_autolab_week4$SUCCESS)
data_f20_plus_autolab_week5$SUCCESS <- as.factor(data_f20_plus_autolab_week5$SUCCESS)
data_f20_plus_autolab_week7$SUCCESS <- as.factor(data_f20_plus_autolab_week7$SUCCESS)

# double check ...
table(data_f20$SUCCESS)

library(dplyr)

# Turn all numeric features into numbers

data_f20$Duration..in.seconds. <- as.numeric(data_f20$Duration..in.seconds.)
data_f20_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_f20_plus_autolab_all$Duration..in.seconds.)
data_f20_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_f20_plus_autolab_week4$Duration..in.seconds.)
data_f20_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_f20_plus_autolab_week5$Duration..in.seconds.)
data_f20_plus_autolab_week7$Duration..in.seconds. <- as.numeric(data_f20_plus_autolab_week7$Duration..in.seconds.)

# Turn features that should be categories into factors

data_f20$sending_school_type_cd <- as.factor(data_f20$sending_school_type_cd)
data_f20$orig_admit_type_cd <- as.factor(data_f20$orig_admit_type_cd)
data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)

data_f20_plus_autolab_all$sending_school_type_cd <- as.factor(data_f20_plus_autolab_all$sending_school_type_cd)
data_f20_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_all$orig_admit_type_cd)
data_f20_plus_autolab_all$citizen_status_cd <- as.factor(data_f20_plus_autolab_all$citizen_status_cd)
data_f20_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_all$curr_admit_type_cd)

data_f20_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week4$sending_school_type_cd)
data_f20_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week4$orig_admit_type_cd)
data_f20_plus_autolab_week4$citizen_status_cd <- as.factor(data_f20_plus_autolab_week4$citizen_status_cd)
data_f20_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week4$curr_admit_type_cd)

data_f20_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week5$sending_school_type_cd)
data_f20_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week5$orig_admit_type_cd)
data_f20_plus_autolab_week5$citizen_status_cd <- as.factor(data_f20_plus_autolab_week5$citizen_status_cd)
data_f20_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week5$curr_admit_type_cd)


data_f20_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week7$sending_school_type_cd)
data_f20_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week7$orig_admit_type_cd)
data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_f20_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week7$curr_admit_type_cd)



# remove students whose progress is not 100%
#table(data_f20$Progress)
#table(data_f20_plus_autolab_week7$Progress)

data_f20_temp <- data_f20[data_f20$Progress == "100",]
data_f20 <- data_f20_temp

data_f20_plus_autolab_all_temp <- data_f20_plus_autolab_all[data_f20_plus_autolab_all$Progress == "100",]
data_f20_plus_autolab_all <- data_f20_plus_autolab_all_temp

data_f20_plus_autolab_week4_temp <- data_f20_plus_autolab_week4[data_f20_plus_autolab_week4$Progress == "100",]
data_f20_plus_autolab_week4 <- data_f20_plus_autolab_week4_temp

data_f20_plus_autolab_week5_temp <- data_f20_plus_autolab_week5[data_f20_plus_autolab_week5$Progress == "100",]
data_f20_plus_autolab_week5 <- data_f20_plus_autolab_week5_temp

data_f20_plus_autolab_week7_temp <- data_f20_plus_autolab_week7[data_f20_plus_autolab_week7$Progress == "100",]
data_f20_plus_autolab_week7 <- data_f20_plus_autolab_week7_temp

data_f20$Assignments.Current.Points <- as.numeric(data_f20$Assignments.Current.Points)
data_f20$Assignments.Final.Points <- as.numeric(data_f20$Assignments.Final.Points)
data_f20$Assignments.Current.Score <- as.numeric(data_f20$Assignments.Current.Score)
data_f20$Assignments.Unposted.Current.Score <- as.numeric(data_f20$Assignments.Unposted.Current.Score)
data_f20$Assignments.Final.Score <- as.numeric(data_f20$Assignments.Final.Score)
data_f20$Assignments.Unposted.Final.Score <- as.numeric(data_f20$Assignments.Unposted.Final.Score)

data_f20$Quizzes.Current.Points <- as.numeric(data_f20$Quizzes.Current.Points)
data_f20$Quizzes.Final.Points <- as.numeric(data_f20$Quizzes.Final.Points)
data_f20$Quizzes.Current.Score <- as.numeric(data_f20$Quizzes.Current.Score)
data_f20$Quizzes.Unposted.Current.Score  <- as.numeric(data_f20$Quizzes.Unposted.Current.Score )
data_f20$Quizzes.Final.Score <- as.numeric(data_f20$Quizzes.Final.Score)
data_f20$Quizzes.Unposted.Final.Score <- as.numeric(data_f20$Quizzes.Unposted.Final.Score)

data_f20$Recitations.Current.Points <- as.numeric(data_f20$Recitations.Current.Points)
data_f20$Recitations.Final.Points <- as.numeric(data_f20$Recitations.Final.Points)
data_f20$Recitations.Current.Score <- as.numeric(data_f20$Recitations.Current.Score)
data_f20$Recitations.Unposted.Current.Score  <- as.numeric(data_f20$Recitations.Unposted.Current.Score )
data_f20$Recitations.Final.Score <- as.numeric(data_f20$Recitations.Final.Score)
data_f20$Recitations.Unposted.Final.Score <- as.numeric(data_f20$Recitations.Unposted.Final.Score)

data_f20$Current.Points <- as.numeric(data_f20$Current.Points)
data_f20$Final.Points <- as.numeric(data_f20$Final.Points)
data_f20$Current.Score <- as.numeric(data_f20$Current.Score)
data_f20$Unposted.Current.Score  <- as.numeric(data_f20$Unposted.Current.Score )
data_f20$Final.Score <- as.numeric(data_f20$Final.Score)
data_f20$Unposted.Final.Score <- as.numeric(data_f20$Unposted.Final.Score)
data_f20$Current.Grade <- as.numeric(data_f20$Current.Grade)
data_f20$Unposted.Current.Grade  <- as.numeric(data_f20$Unposted.Current.Grade)

data_f20_plus_autolab_all$Current.Points <- as.numeric(data_f20_plus_autolab_all$Current.Points)
data_f20_plus_autolab_all$Final.Points <- as.numeric(data_f20_plus_autolab_all$Final.Points)
data_f20_plus_autolab_all$Current.Score <- as.numeric(data_f20_plus_autolab_all$Current.Score)
data_f20_plus_autolab_all$Unposted.Current.Score  <- as.numeric(data_f20_plus_autolab_all$Unposted.Current.Score )
data_f20_plus_autolab_all$Final.Score <- as.numeric(data_f20_plus_autolab_all$Final.Score)
data_f20_plus_autolab_all$Unposted.Final.Score <- as.numeric(data_f20_plus_autolab_all$Unposted.Final.Score)
data_f20_plus_autolab_all$Current.Grade <- as.numeric(data_f20_plus_autolab_all$Current.Grade)
data_f20_plus_autolab_all$Unposted.Current.Grade  <- as.numeric(data_f20_plus_autolab_all$Unposted.Current.Grade)
data_f20_plus_autolab_all$Progress  <- as.numeric(data_f20_plus_autolab_all$Progress)
data_f20_plus_autolab_all$Duration..in.seconds.  <- as.numeric(data_f20_plus_autolab_all$Duration..in.seconds.)


data_f20_plus_autolab_week4$Current.Points <- as.numeric(data_f20_plus_autolab_week4$Current.Points)
data_f20_plus_autolab_week4$Final.Points <- as.numeric(data_f20_plus_autolab_week4$Final.Points)
data_f20_plus_autolab_week4$Current.Score <- as.numeric(data_f20_plus_autolab_week4$Current.Score)
data_f20_plus_autolab_week4$Unposted.Current.Score  <- as.numeric(data_f20_plus_autolab_week4$Unposted.Current.Score )
data_f20_plus_autolab_week4$Final.Score <- as.numeric(data_f20_plus_autolab_week4$Final.Score)
data_f20_plus_autolab_week4$Unposted.Final.Score <- as.numeric(data_f20_plus_autolab_week4$Unposted.Final.Score)
data_f20_plus_autolab_week4$Current.Grade <- as.numeric(data_f20_plus_autolab_week4$Current.Grade)
data_f20_plus_autolab_week4$Unposted.Current.Grade  <- as.numeric(data_f20_plus_autolab_week4$Unposted.Current.Grade)

data_f20_plus_autolab_week5$Current.Points <- as.numeric(data_f20_plus_autolab_week5$Current.Points)
data_f20_plus_autolab_week5$Final.Points <- as.numeric(data_f20_plus_autolab_week5$Final.Points)
data_f20_plus_autolab_week5$Current.Score <- as.numeric(data_f20_plus_autolab_week5$Current.Score)
data_f20_plus_autolab_week5$Unposted.Current.Score  <- as.numeric(data_f20_plus_autolab_week5$Unposted.Current.Score )
data_f20_plus_autolab_week5$Final.Score <- as.numeric(data_f20_plus_autolab_week5$Final.Score)
data_f20_plus_autolab_week5$Unposted.Final.Score <- as.numeric(data_f20_plus_autolab_week5$Unposted.Final.Score)
data_f20_plus_autolab_week5$Current.Grade <- as.numeric(data_f20_plus_autolab_week5$Current.Grade)
data_f20_plus_autolab_week5$Unposted.Current.Grade  <- as.numeric(data_f20_plus_autolab_week5$Unposted.Current.Grade)

data_f20_plus_autolab_week7$Current.Points <- as.numeric(data_f20_plus_autolab_week7$Current.Points)
data_f20_plus_autolab_week7$Final.Points <- as.numeric(data_f20_plus_autolab_week7$Final.Points)
data_f20_plus_autolab_week7$Current.Score <- as.numeric(data_f20_plus_autolab_week7$Current.Score)
data_f20_plus_autolab_week7$Unposted.Current.Score  <- as.numeric(data_f20_plus_autolab_week7$Unposted.Current.Score )
data_f20_plus_autolab_week7$Final.Score <- as.numeric(data_f20_plus_autolab_week7$Final.Score)
data_f20_plus_autolab_week7$Unposted.Final.Score <- as.numeric(data_f20_plus_autolab_week7$Unposted.Final.Score)
data_f20_plus_autolab_week7$Current.Grade <- as.numeric(data_f20_plus_autolab_week7$Current.Grade)
data_f20_plus_autolab_week7$Unposted.Current.Grade  <- as.numeric(data_f20_plus_autolab_week7$Unposted.Current.Grade)

# data_f20$unit_of_reg_cd <- as.factor(data_f20$unit_of_reg_cd)
# data_f20$subj_cd <- as.factor(data_f20$subj_cd)
# data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)
# data_f20$housing_status_cd <- as.factor(data_f20$housing_status_cd)
# data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
# data_f20$deg_earned_curric_cd1 <- as.factor(data_f20$deg_earned_curric_cd1)
# data_f20$deg_minor_curric_cd1 <- as.factor(data_f20$deg_minor_curric_cd1)

#data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_f20_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_all$curr_admit_type_cd)
data_f20_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week4$curr_admit_type_cd)
data_f20_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week5$curr_admit_type_cd)
data_f20_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f20_plus_autolab_week7$curr_admit_type_cd)

data_f20_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_all$orig_admit_type_cd)
data_f20_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week4$orig_admit_type_cd)
data_f20_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week5$orig_admit_type_cd)
data_f20_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f20_plus_autolab_week7$orig_admit_type_cd)

data_f20_plus_autolab_all$sending_school_type_cd <- as.factor(data_f20_plus_autolab_all$sending_school_type_cd)
data_f20_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week4$sending_school_type_cd)
data_f20_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week5$sending_school_type_cd)
data_f20_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f20_plus_autolab_week7$sending_school_type_cd)

data_f20_plus_autolab_all$citizen_status_cd <- as.factor(data_f20_plus_autolab_all$citizen_status_cd)
data_f20_plus_autolab_week4$citizen_status_cd <- as.factor(data_f20_plus_autolab_week4$citizen_status_cd)
data_f20_plus_autolab_week5$citizen_status_cd <- as.factor(data_f20_plus_autolab_week5$citizen_status_cd)
data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)

names(data_f20_plus_autolab_week7)

# Split data into numeric and not numeric features

str(data_f20_plus_autolab_week7)

data_num <- select_if(data_f20, is.numeric)
data_not_num <- data_f20[ , !(names(data_f20) %in% names(data_num))]

data_num_plus_autolab_all <- select_if(data_f20_plus_autolab_all, is.numeric)
data_not_num_plus_autolab_all <- data_f20_plus_autolab_all[ , !(names(data_f20_plus_autolab_all) %in% names(data_num_plus_autolab_all))]

names(data_num_plus_autolab_all)

data_num_plus_autolab_w4 <- select_if(data_f20_plus_autolab_week4, is.numeric)
data_not_num_plus_autolab_w4 <- data_f20_plus_autolab_week4[ , !(names(data_f20_plus_autolab_week4) %in% names(data_num_plus_autolab_w4))]

data_num_plus_autolab_w5 <- select_if(data_f20_plus_autolab_week5, is.numeric)
data_not_num_plus_autolab_w5 <- data_f20_plus_autolab_week5[ , !(names(data_f20_plus_autolab_week5) %in% names(data_num_plus_autolab_w5))]

data_num_plus_autolab_w7 <- select_if(data_f20_plus_autolab_week7, is.numeric)
data_not_num_plus_autolab_w7 <- data_f20_plus_autolab_week7[ , !(names(data_f20_plus_autolab_week7) %in% names(data_num_plus_autolab_w7))]

names(data_num_plus_autolab)
names(data_not_num_plus_autolab)


names(data_not_num)

table(data_not_num$Section) # out
table(data_not_num$Current.Grade) # out b/c it corr with predicted var
table(data_not_num$Unposted.Current.Grade) # out: same as the one before
table(data_not_num$Final.Grade) # ibid
table(data_not_num$Unposted.Final.Grade) # ibid

table(data_not_num$gender_cd) # can stay
table(data_not_num$ethnic_cd) # can stay
table(data_not_num$SUCCESS) # has to stay

table(data_not_num$EndDate) # can go, probably irrelevant
table(data_not_num$Progress) # can go after selecting students who completed it 100%
table(data_not_num$Finished) # same as before, can remove those for whom it's FALSE and then get rid of column
table(data_not_num$RecordedDate) # irrelevant
table(data_not_num$UserLanguage) # can go, everyone is ENG
table(data_not_num$Q38) # can go, everyone agrees to take part of research


table(data_not_num$Q1) # can stay, major

table(data_not_num$Q33) # second major, lots of NA, may not have enough variablilty.. 
table(data_not_num$Q32) # minor, 206 undecided.., may not be a great feature
table(data_not_num$Q30) # second minor, 406 none, may need to get rid of

table(data_not_num$Q2) # keep.. reason they are taking CS1

table(data_not_num$Q2_8_TEXT) # mostly empty, get rid of
table(data_not_num$Q2_6_TEXT) # mostly empty, get rid of
table(data_not_num$Q44) # empty, get rid of
table(data_not_num$Q44_8_TEXT) # empty, get rid of
table(data_not_num$Q44_6_TEXT) # empty, get rid of

table(data_not_num$Q4) # Keep, prior experience

table(data_not_num$Q4_6_TEXT) # mostly empty
table(data_not_num$Q34) # mostly empty

table(data_not_num$Q35) # Keep, how difficult do they think the class will be
table(data_not_num$Q37) # get rid of, how would they explain cs

# Q43 is empty: get rid of it!

table(data_not_num$Q43)

# 30 variables so far.

# attitudes are 24 questions/variables.

# attitude qs  Q3, Q5 - Q12, Q14 - 28  1 + 8 + 15 = 24 questions
table(data_not_num$Q3)
table(data_not_num$Q5)
table(data_not_num$Q6)
table(data_not_num$Q7)
table(data_not_num$Q8)


# etc.

# Q38: Which of the following have you done this year or do you plan to do? Check all that apply. 
# I have no interest in doing this 0 / I did this in the past year 3 / I plan to do this in the future 2 / I'm not sure 1

table(data_not_num$Q38_1) # Participate in social events sponsored by the CS Living Learning Community
table(data_not_num$Q38_2) # Take a 200-level computer science course
table(data_not_num$Q38_3) # Matriculate as a computer science major
table(data_not_num$Q38_4) # Become a learning assistant for a computer science course
table(data_not_num$Q38_5) # Become a learning assistant for a computer science course
table(data_not_num$Q38_6) # Become a peer mentor in computer science
table(data_not_num$Q38_7) # Participate in the Reboot program, supporting high schools with CS instruction
table(data_not_num$Q38_8) # Do an internship that involves computer science
table(data_not_num$Q38_9) # Do academic research in the computer science field
table(data_not_num$Q38_10) # Join a professional organization or attend a professional conference in computer science
table(data_not_num$Q38_11) # Pursue a career in computer science
table(data_not_num$Q38_12) # Pursue a career in a field related to computer science



data_num$ENGAGEMENT <- 0

data_num$E1[data_not_num$Q38_1 == "I did this in the past year"] <- 3
data_num$E1[data_not_num$Q38_1 == "I plan to do this in the future"] <- 2
data_num$E1[data_not_num$Q38_1 == "I'm not sure"] <- 1
data_num$E1[data_not_num$Q38_1 == "I have no interest in doing this"] <- 0
data_num$E1[data_not_num$Q38_1 == ""] <- 1.5

#table(data_num$E1)

data_num$E2[data_not_num$Q38_2 == "I did this in the past year"] <- 3
data_num$E2[data_not_num$Q38_2 == "I plan to do this in the future"] <- 2
data_num$E2[data_not_num$Q38_2 == "I'm not sure"] <- 1
data_num$E2[data_not_num$Q38_2 == "I have no interest in doing this"] <- 0
data_num$E2[data_not_num$Q38_2 == ""] <- 1.5

data_num$E3[data_not_num$Q38_3 == "I did this in the past year"] <- 3
data_num$E3[data_not_num$Q38_3 == "I plan to do this in the future"] <- 2
data_num$E3[data_not_num$Q38_3 == "I'm not sure"] <- 1
data_num$E3[data_not_num$Q38_3 == "I have no interest in doing this"] <- 0
data_num$E3[data_not_num$Q38_3 == ""] <- 1.5

data_num$E4[data_not_num$Q38_4 == "I did this in the past year"] <- 3
data_num$E4[data_not_num$Q38_4 == "I plan to do this in the future"] <- 2
data_num$E4[data_not_num$Q38_4 == "I'm not sure"] <- 1
data_num$E4[data_not_num$Q38_4 == "I have no interest in doing this"] <- 0
data_num$E4[data_not_num$Q38_4 == ""] <- 1.5

data_num$E5[data_not_num$Q38_5 == "I did this in the past year"] <- 3
data_num$E5[data_not_num$Q38_5 == "I plan to do this in the future"] <- 2
data_num$E5[data_not_num$Q38_5 == "I'm not sure"] <- 1
data_num$E5[data_not_num$Q38_5 == "I have no interest in doing this"] <- 0
data_num$E5[data_not_num$Q38_5 == ""] <- 1.5

data_num$E6[data_not_num$Q38_6 == "I did this in the past year"] <- 3
data_num$E6[data_not_num$Q38_6 == "I plan to do this in the future"] <- 2
data_num$E6[data_not_num$Q38_6 == "I'm not sure"] <- 1
data_num$E6[data_not_num$Q38_6 == "I have no interest in doing this"] <- 0
data_num$E6[data_not_num$Q38_6 == ""] <- 1.5

data_num$E7[data_not_num$Q38_7 == "I did this in the past year"] <- 3
data_num$E7[data_not_num$Q38_7 == "I plan to do this in the future"] <- 2
data_num$E7[data_not_num$Q38_7 == "I'm not sure"] <- 1
data_num$E7[data_not_num$Q38_7 == "I have no interest in doing this"] <- 0
data_num$E7[data_not_num$Q38_7 == ""] <- 1.5

data_num$E8[data_not_num$Q38_8 == "I did this in the past year"] <- 3
data_num$E8[data_not_num$Q38_8 == "I plan to do this in the future"] <- 2
data_num$E8[data_not_num$Q38_8 == "I'm not sure"] <- 1
data_num$E8[data_not_num$Q38_8 == "I have no interest in doing this"] <- 0
data_num$E8[data_not_num$Q38_8 == ""] <- 1.5

data_num$E9[data_not_num$Q38_9 == "I did this in the past year"] <- 3
data_num$E9[data_not_num$Q38_9 == "I plan to do this in the future"] <- 2
data_num$E9[data_not_num$Q38_9 == "I'm not sure"] <- 1
data_num$E9[data_not_num$Q38_9 == "I have no interest in doing this"] <- 0
data_num$E9[data_not_num$Q38_9 == ""] <- 1.5

data_num$E10[data_not_num$Q38_10 == "I did this in the past year"] <- 3
data_num$E10[data_not_num$Q38_10 == "I plan to do this in the future"] <- 2
data_num$E10[data_not_num$Q38_10 == "I'm not sure"] <- 1
data_num$E10[data_not_num$Q38_10 == "I have no interest in doing this"] <- 0
data_num$E10[data_not_num$Q38_10 == ""] <- 1.5

data_num$E11[data_not_num$Q38_11 == "I did this in the past year"] <- 3
data_num$E11[data_not_num$Q38_11 == "I plan to do this in the future"] <- 2
data_num$E11[data_not_num$Q38_11 == "I'm not sure"] <- 1
data_num$E11[data_not_num$Q38_11 == "I have no interest in doing this"] <- 0
data_num$E11[data_not_num$Q38_11 == ""] <- 1.5

data_num$E12[data_not_num$Q38_12 == "I did this in the past year"] <- 3
data_num$E12[data_not_num$Q38_12 == "I plan to do this in the future"] <- 2
data_num$E12[data_not_num$Q38_12 == "I'm not sure"] <- 1
data_num$E12[data_not_num$Q38_12 == "I have no interest in doing this"] <- 0
data_num$E12[data_not_num$Q38_12 == ""] <- 1.5

data_num$ENGAGEMENT <- data_num$E1 + data_num$E2 + data_num$E3 + data_num$E4 + data_num$E5 + data_num$E6 + data_num$E7 + data_num$E8 + data_num$E9 + data_num$E10 + data_num$E11 + data_num$E12

# ALL

# initial code: replace data_not_num_plus_autolab_all with data_not_num_plus_autolab_all

data_num_plus_autolab_all$E1[data_f20_plus_autolab_all$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E1[data_f20_plus_autolab_all$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E1[data_f20_plus_autolab_all$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E1[data_f20_plus_autolab_all$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E1[data_f20_plus_autolab_all$Q38_1 == ""] <- 1.5


data_num_plus_autolab_all$E2[data_f20_plus_autolab_all$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E2[data_f20_plus_autolab_all$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E2[data_f20_plus_autolab_all$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E2[data_f20_plus_autolab_all$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E2[data_f20_plus_autolab_all$Q38_2 == ""] <- 1.5

data_num_plus_autolab_all$E3[data_f20_plus_autolab_all$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E3[data_f20_plus_autolab_all$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E3[data_f20_plus_autolab_all$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E3[data_f20_plus_autolab_all$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E3[data_f20_plus_autolab_all$Q38_3 == ""] <- 1.5


data_num_plus_autolab_all$E4[data_f20_plus_autolab_all$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E4[data_f20_plus_autolab_all$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E4[data_f20_plus_autolab_all$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E4[data_f20_plus_autolab_all$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E4[data_f20_plus_autolab_all$Q38_4 == ""] <- 1.5

data_num_plus_autolab_all$E5[data_f20_plus_autolab_all$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E5[data_f20_plus_autolab_all$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E5[data_f20_plus_autolab_all$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E5[data_f20_plus_autolab_all$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E5[data_f20_plus_autolab_all$Q38_5 == ""] <- 1.5

data_num_plus_autolab_all$E6[data_f20_plus_autolab_all$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E6[data_f20_plus_autolab_all$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E6[data_f20_plus_autolab_all$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E6[data_f20_plus_autolab_all$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E6[data_f20_plus_autolab_all$Q38_6 == ""] <- 1.5

data_num_plus_autolab_all$E7[data_f20_plus_autolab_all$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E7[data_f20_plus_autolab_all$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E7[data_f20_plus_autolab_all$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E7[data_f20_plus_autolab_all$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E7[data_f20_plus_autolab_all$Q38_7 == ""] <- 1.5

data_num_plus_autolab_all$E8[data_f20_plus_autolab_all$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E8[data_f20_plus_autolab_all$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E8[data_f20_plus_autolab_all$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E8[data_f20_plus_autolab_all$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E8[data_f20_plus_autolab_all$Q38_8 == ""] <- 1.5

data_num_plus_autolab_all$E9[data_f20_plus_autolab_all$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E9[data_f20_plus_autolab_all$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E9[data_f20_plus_autolab_all$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E9[data_f20_plus_autolab_all$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E9[data_f20_plus_autolab_all$Q38_9 == ""] <- 1.5

data_num_plus_autolab_all$E10[data_f20_plus_autolab_all$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E10[data_f20_plus_autolab_all$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E10[data_f20_plus_autolab_all$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E10[data_f20_plus_autolab_all$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E10[data_f20_plus_autolab_all$Q38_10 == ""] <- 1.5

data_num_plus_autolab_all$E11[data_f20_plus_autolab_all$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E11[data_f20_plus_autolab_all$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E11[data_f20_plus_autolab_all$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E11[data_f20_plus_autolab_all$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E11[data_f20_plus_autolab_all$Q38_11 == ""] <- 1.5

data_num_plus_autolab_all$E12[data_f20_plus_autolab_all$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E12[data_f20_plus_autolab_all$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E12[data_f20_plus_autolab_all$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E12[data_f20_plus_autolab_all$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E12[data_f20_plus_autolab_all$Q38_12 == ""] <- 1.5

data_num_plus_autolab_all$ENGAGEMENT <- data_num_plus_autolab_all$E1 + data_num_plus_autolab_all$E2 + data_num_plus_autolab_all$E3 + data_num_plus_autolab_all$E4 + data_num_plus_autolab_all$E5 + data_num_plus_autolab_all$E6 + data_num_plus_autolab_all$E7 + data_num_plus_autolab_all$E8 + data_num_plus_autolab_all$E9 + data_num_plus_autolab_all$E10 + data_num_plus_autolab_all$E11 + data_num_plus_autolab_all$E12



# W4
# initial code: replace data_not_num_plus_autolab_w4 with data_not_num_plus_autolab_w4

data_num_plus_autolab_w4$E1[data_f20_plus_autolab_week4$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E1[data_f20_plus_autolab_week4$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E1[data_f20_plus_autolab_week4$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E1[data_f20_plus_autolab_week4$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E1[data_f20_plus_autolab_week4$Q38_1 == ""] <- 1.5


data_num_plus_autolab_w4$E2[data_f20_plus_autolab_week4$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E2[data_f20_plus_autolab_week4$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E2[data_f20_plus_autolab_week4$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E2[data_f20_plus_autolab_week4$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E2[data_f20_plus_autolab_week4$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w4$E3[data_f20_plus_autolab_week4$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E3[data_f20_plus_autolab_week4$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E3[data_f20_plus_autolab_week4$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E3[data_f20_plus_autolab_week4$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E3[data_f20_plus_autolab_week4$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w4$E4[data_f20_plus_autolab_week4$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E4[data_f20_plus_autolab_week4$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E4[data_f20_plus_autolab_week4$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E4[data_f20_plus_autolab_week4$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E4[data_f20_plus_autolab_week4$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w4$E5[data_f20_plus_autolab_week4$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E5[data_f20_plus_autolab_week4$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E5[data_f20_plus_autolab_week4$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E5[data_f20_plus_autolab_week4$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E5[data_f20_plus_autolab_week4$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w4$E6[data_f20_plus_autolab_week4$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E6[data_f20_plus_autolab_week4$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E6[data_f20_plus_autolab_week4$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E6[data_f20_plus_autolab_week4$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E6[data_f20_plus_autolab_week4$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w4$E7[data_f20_plus_autolab_week4$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E7[data_f20_plus_autolab_week4$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E7[data_f20_plus_autolab_week4$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E7[data_f20_plus_autolab_week4$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E7[data_f20_plus_autolab_week4$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w4$E8[data_f20_plus_autolab_week4$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E8[data_f20_plus_autolab_week4$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E8[data_f20_plus_autolab_week4$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E8[data_f20_plus_autolab_week4$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E8[data_f20_plus_autolab_week4$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w4$E9[data_f20_plus_autolab_week4$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E9[data_f20_plus_autolab_week4$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E9[data_f20_plus_autolab_week4$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E9[data_f20_plus_autolab_week4$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E9[data_f20_plus_autolab_week4$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w4$E10[data_f20_plus_autolab_week4$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E10[data_f20_plus_autolab_week4$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E10[data_f20_plus_autolab_week4$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E10[data_f20_plus_autolab_week4$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E10[data_f20_plus_autolab_week4$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w4$E11[data_f20_plus_autolab_week4$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E11[data_f20_plus_autolab_week4$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E11[data_f20_plus_autolab_week4$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E11[data_f20_plus_autolab_week4$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E11[data_f20_plus_autolab_week4$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w4$E12[data_f20_plus_autolab_week4$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E12[data_f20_plus_autolab_week4$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E12[data_f20_plus_autolab_week4$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E12[data_f20_plus_autolab_week4$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E12[data_f20_plus_autolab_week4$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w4$ENGAGEMENT <- data_num_plus_autolab_w4$E1 + data_num_plus_autolab_w4$E2 + data_num_plus_autolab_w4$E3 + data_num_plus_autolab_w4$E4 + data_num_plus_autolab_w4$E5 + data_num_plus_autolab_w4$E6 + data_num_plus_autolab_w4$E7 + data_num_plus_autolab_w4$E8 + data_num_plus_autolab_w4$E9 + data_num_plus_autolab_w4$E10 + data_num_plus_autolab_w4$E11 + data_num_plus_autolab_w4$E12

# Data Autolab W5

data_num_plus_autolab_w5$E1[data_f20_plus_autolab_week5$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E1[data_f20_plus_autolab_week5$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E1[data_f20_plus_autolab_week5$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E1[data_f20_plus_autolab_week5$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E1[data_f20_plus_autolab_week5$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab$E1)

data_num_plus_autolab_w5$E2[data_f20_plus_autolab_week5$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E2[data_f20_plus_autolab_week5$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E2[data_f20_plus_autolab_week5$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E2[data_f20_plus_autolab_week5$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E2[data_f20_plus_autolab_week5$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w5$E3[data_f20_plus_autolab_week5$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E3[data_f20_plus_autolab_week5$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E3[data_f20_plus_autolab_week5$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E3[data_f20_plus_autolab_week5$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E3[data_f20_plus_autolab_week5$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w5$E4[data_f20_plus_autolab_week5$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E4[data_f20_plus_autolab_week5$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E4[data_f20_plus_autolab_week5$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E4[data_f20_plus_autolab_week5$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E4[data_f20_plus_autolab_week5$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w5$E5[data_f20_plus_autolab_week5$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E5[data_f20_plus_autolab_week5$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E5[data_f20_plus_autolab_week5$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E5[data_f20_plus_autolab_week5$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E5[data_f20_plus_autolab_week5$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w5$E6[data_f20_plus_autolab_week5$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E6[data_f20_plus_autolab_week5$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E6[data_f20_plus_autolab_week5$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E6[data_f20_plus_autolab_week5$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E6[data_f20_plus_autolab_week5$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w5$E7[data_f20_plus_autolab_week5$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E7[data_f20_plus_autolab_week5$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E7[data_f20_plus_autolab_week5$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E7[data_f20_plus_autolab_week5$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E7[data_f20_plus_autolab_week5$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w5$E8[data_f20_plus_autolab_week5$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E8[data_f20_plus_autolab_week5$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E8[data_f20_plus_autolab_week5$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E8[data_f20_plus_autolab_week5$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E8[data_f20_plus_autolab_week5$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w5$E9[data_f20_plus_autolab_week5$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E9[data_f20_plus_autolab_week5$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E9[data_f20_plus_autolab_week5$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E9[data_f20_plus_autolab_week5$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E9[data_f20_plus_autolab_week5$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w5$E10[data_f20_plus_autolab_week5$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E10[data_f20_plus_autolab_week5$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E10[data_f20_plus_autolab_week5$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E10[data_f20_plus_autolab_week5$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E10[data_f20_plus_autolab_week5$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w5$E11[data_f20_plus_autolab_week5$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E11[data_f20_plus_autolab_week5$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E11[data_f20_plus_autolab_week5$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E11[data_f20_plus_autolab_week5$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E11[data_f20_plus_autolab_week5$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w5$E12[data_f20_plus_autolab_week5$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E12[data_f20_plus_autolab_week5$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E12[data_f20_plus_autolab_week5$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E12[data_f20_plus_autolab_week5$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E12[data_f20_plus_autolab_week5$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w5$ENGAGEMENT <- data_num_plus_autolab_w5$E1 + data_num_plus_autolab_w5$E2 + data_num_plus_autolab_w5$E3 + data_num_plus_autolab_w5$E4 + data_num_plus_autolab_w5$E5 + data_num_plus_autolab_w5$E6 + data_num_plus_autolab_w5$E7 + data_num_plus_autolab_w5$E8 + data_num_plus_autolab_w5$E9 + data_num_plus_autolab_w5$E10 + data_num_plus_autolab_w5$E11 + data_num_plus_autolab_w5$E12

# W7

data_num_plus_autolab_w7$E1[data_f20_plus_autolab_week7$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E1[data_f20_plus_autolab_week7$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E1[data_f20_plus_autolab_week7$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E1[data_f20_plus_autolab_week7$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E1[data_f20_plus_autolab_week7$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab$E1)

data_num_plus_autolab_w7$E2[data_f20_plus_autolab_week7$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E2[data_f20_plus_autolab_week7$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E2[data_f20_plus_autolab_week7$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E2[data_f20_plus_autolab_week7$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E2[data_f20_plus_autolab_week7$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w7$E3[data_f20_plus_autolab_week7$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E3[data_f20_plus_autolab_week7$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E3[data_f20_plus_autolab_week7$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E3[data_f20_plus_autolab_week7$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E3[data_f20_plus_autolab_week7$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w7$E4[data_f20_plus_autolab_week7$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E4[data_f20_plus_autolab_week7$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E4[data_f20_plus_autolab_week7$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E4[data_f20_plus_autolab_week7$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E4[data_f20_plus_autolab_week7$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w7$E5[data_f20_plus_autolab_week7$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E5[data_f20_plus_autolab_week7$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E5[data_f20_plus_autolab_week7$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E5[data_f20_plus_autolab_week7$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E5[data_f20_plus_autolab_week7$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w7$E6[data_f20_plus_autolab_week7$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E6[data_f20_plus_autolab_week7$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E6[data_f20_plus_autolab_week7$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E6[data_f20_plus_autolab_week7$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E6[data_f20_plus_autolab_week7$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w7$E7[data_f20_plus_autolab_week7$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E7[data_f20_plus_autolab_week7$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E7[data_f20_plus_autolab_week7$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E7[data_f20_plus_autolab_week7$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E7[data_f20_plus_autolab_week7$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w7$E8[data_f20_plus_autolab_week7$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E8[data_f20_plus_autolab_week7$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E8[data_f20_plus_autolab_week7$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E8[data_f20_plus_autolab_week7$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E8[data_f20_plus_autolab_week7$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w7$E9[data_f20_plus_autolab_week7$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E9[data_f20_plus_autolab_week7$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E9[data_f20_plus_autolab_week7$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E9[data_f20_plus_autolab_week7$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E9[data_f20_plus_autolab_week7$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w7$E10[data_f20_plus_autolab_week7$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E10[data_f20_plus_autolab_week7$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E10[data_f20_plus_autolab_week7$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E10[data_f20_plus_autolab_week7$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E10[data_f20_plus_autolab_week7$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w7$E11[data_f20_plus_autolab_week7$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E11[data_f20_plus_autolab_week7$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E11[data_f20_plus_autolab_week7$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E11[data_f20_plus_autolab_week7$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E11[data_f20_plus_autolab_week7$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w7$E12[data_f20_plus_autolab_week7$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E12[data_f20_plus_autolab_week7$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E12[data_f20_plus_autolab_week7$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E12[data_f20_plus_autolab_week7$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E12[data_f20_plus_autolab_week7$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w7$ENGAGEMENT <- data_num_plus_autolab_w7$E1 + data_num_plus_autolab_w7$E2 + data_num_plus_autolab_w7$E3 + data_num_plus_autolab_w7$E4 + data_num_plus_autolab_w7$E5 + data_num_plus_autolab_w7$E6 + data_num_plus_autolab_w7$E7 + data_num_plus_autolab_w7$E8 + data_num_plus_autolab_w7$E9 + data_num_plus_autolab_w7$E10 + data_num_plus_autolab_w7$E11 + data_num_plus_autolab_w7$E12


table(data_num$ENGAGEMENT)

# Q39 : To what extent do you agree with the following statements? 
# Strongly agree / Somewhat agree / Not sure / Somewhat disagree / Strongly disagree

table(data_not_num$Q39_1) # With hard work, anyone can become an expert in computer science
table(data_not_num$Q39_2) # Women and men have the same level of natural ability and talent in computer science
table(data_not_num$Q39_3) # Women are less capable of success in computer science than men
table(data_not_num$Q39_4) # Men are more likely to excel in careers that involve computing than women are
table(data_not_num$Q39_5) # Men are more capable than women at solving computing problems


data_num$A1[data_not_num$Q39_1 == "Strongly agree"] <- 3
data_num$A1[data_not_num$Q39_1 == "Somewhat agree"] <- 2
data_num$A1[data_not_num$Q39_1 == "Not sure"] <- 1.5
data_num$A1[data_not_num$Q39_1 == "Somewhat disagree"] <- 1
data_num$A1[data_not_num$Q39_1 == "Strongly disagree"] <- 0
data_num$A1[data_not_num$Q39_1 == ""] <- 1.5

data_num$A2[data_not_num$Q39_2 == "Strongly agree"] <- 3
data_num$A2[data_not_num$Q39_2 == "Somewhat agree"] <- 2
data_num$A2[data_not_num$Q39_2 == "Not sure"] <- 1.5
data_num$A2[data_not_num$Q39_2 == "Somewhat disagree"] <- 1
data_num$A2[data_not_num$Q39_2 == "Strongly disagree"] <- 0
data_num$A2[data_not_num$Q39_2 == ""] <- 1.5

# inverted scale
data_num$A3[data_not_num$Q39_3 == "Strongly disagree"] <- 3
data_num$A3[data_not_num$Q39_3 == "Somewhat disagree"] <- 2
data_num$A3[data_not_num$Q39_3 == "Not sure"] <- 1.5
data_num$A3[data_not_num$Q39_3 == "Somewhat agree"] <- 1
data_num$A3[data_not_num$Q39_3 == "Strongly sagree"] <- 0
data_num$A3[data_not_num$Q39_3 == ""] <- 1.5

data_num$A4[data_not_num$Q39_4 == "Strongly disagree"] <- 3
data_num$A4[data_not_num$Q39_4 == "Somewhat disagree"] <- 2
data_num$A4[data_not_num$Q39_4 == "Not sure"] <- 1.5
data_num$A4[data_not_num$Q39_4 == "Somewhat agree"] <- 1
data_num$A4[data_not_num$Q39_4 == "Strongly agree"] <- 0
data_num$A4[data_not_num$Q39_4 == ""] <- 1.5

data_num$A5[data_not_num$Q39_5 == "Strongly disagree"] <- 3
data_num$A5[data_not_num$Q39_5 == "Somewhat disagree"] <- 2
data_num$A5[data_not_num$Q39_5 == "Not sure"] <- 1.5
data_num$A5[data_not_num$Q39_5 == "Somewhat agree"] <- 1
data_num$A5[data_not_num$Q39_5 == "Strongly agree"] <- 0
data_num$A5[data_not_num$Q39_5 == ""] <- 1.5

data_num$ATTITUDES <- data_num$A1 + data_num$A2 + data_num$A3 + data_num$A4  + data_num$A5


# Autolab Data ALL

data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == ""] <- 1.5

data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == ""] <- 1.5

data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == ""] <- 1.5

data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == ""] <- 1.5

data_num_plus_autolab_all$ATTITUDES <- data_num_plus_autolab_all$A1 + data_num_plus_autolab_all$A2 + data_num_plus_autolab_all$A3 + data_num_plus_autolab_all$A4 + data_num_plus_autolab_all$A5


# Autolab Data W4

data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w4$ATTITUDES <- data_num_plus_autolab_w4$A1 + data_num_plus_autolab_w4$A2 + data_num_plus_autolab_w4$A3 + data_num_plus_autolab_w4$A4 + data_num_plus_autolab_w4$A5

# Autolab Data W5

data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w5$A1[data_not_num_plus_autolab_w5$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A2[data_not_num_plus_autolab_w5$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A3[data_not_num_plus_autolab_w5$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A4[data_not_num_plus_autolab_w5$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A5[data_not_num_plus_autolab_w5$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w5$ATTITUDES <- data_num_plus_autolab_w5$A1 + data_num_plus_autolab_w5$A2 + data_num_plus_autolab_w5$A3 + data_num_plus_autolab_w5$A4 + data_num_plus_autolab_w5$A5

# Autolab Data Week 7

data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w7$ATTITUDES <- data_num_plus_autolab_w7$A1 + data_num_plus_autolab_w7$A2 + data_num_plus_autolab_w7$A3 + data_num_plus_autolab_w7$A4 + data_num_plus_autolab_w7$A5



# Divide the value for ATTITUDES by 15, which is the max possible value

#data_num$ATTITUDES <- data_num$ATTITUDES/15
#data_num_plus_autolab$ATTITUDES <- data_num_plus_autolab$ATTITUDES/15


names(data_not_num)


str(data_num_plus_autolab)
str(data_not_num_plus_autolab)
names(data_f20_plus_autolab_week7)

# REPLACE ATTITUDES WITH NUMBERS

data_num$BELONGINGNESS <- 0
data_num$CONFIDENCE <- 0
data_num$INTEREST <- 0
data_num$USEFULNESS <- 0
data_num$ENCOURAGEMENT <- 0

data_num_plus_autolab_all$BELONGINGNESS <- 0
data_num_plus_autolab_all$CONFIDENCE <- 0
data_num_plus_autolab_all$INTEREST <- 0
data_num_plus_autolab_all$USEFULNESS <- 0
data_num_plus_autolab_all$ENCOURAGEMENT <- 0
data_num_plus_autolab_all$Q6_B <- 0 
data_num_plus_autolab_all$Q3_B <- 0 
data_num_plus_autolab_all$Q11_B <- 0 
data_num_plus_autolab_all$Q57_B <- 0 
data_num_plus_autolab_all$Q21_B <- 0 
data_num_plus_autolab_all$Q26_B <- 0


data_num_plus_autolab_w4$BELONGINGNESS <- 0
data_num_plus_autolab_w4$CONFIDENCE <- 0
data_num_plus_autolab_w4$INTEREST <- 0
data_num_plus_autolab_w4$USEFULNESS <- 0
data_num_plus_autolab_w4$ENCOURAGEMENT <- 0
data_num_plus_autolab_w4$Q6_B <- 0 
data_num_plus_autolab_w4$Q3_B <- 0 
data_num_plus_autolab_w4$Q11_B <- 0 
data_num_plus_autolab_w4$Q57_B <- 0 
data_num_plus_autolab_w4$Q21_B <- 0 
data_num_plus_autolab_w4$Q26_B <- 0

data_num_plus_autolab_w5$BELONGINGNESS <- 0
data_num_plus_autolab_w5$CONFIDENCE <- 0
data_num_plus_autolab_w5$INTEREST <- 0
data_num_plus_autolab_w5$USEFULNESS <- 0
data_num_plus_autolab_w5$ENCOURAGEMENT <- 0
data_num_plus_autolab_w5$Q6_B <- 0 
data_num_plus_autolab_w5$Q3_B <- 0 
data_num_plus_autolab_w5$Q11_B <- 0 
data_num_plus_autolab_w5$Q57_B <- 0 
data_num_plus_autolab_w5$Q21_B <- 0 
data_num_plus_autolab_w5$Q26_B <- 0

data_num_plus_autolab_w7$BELONGINGNESS <- 0
data_num_plus_autolab_w7$CONFIDENCE <- 0
data_num_plus_autolab_w7$INTEREST <- 0
data_num_plus_autolab_w7$USEFULNESS <- 0
data_num_plus_autolab_w7$ENCOURAGEMENT <- 0
data_num_plus_autolab_w7$Q6_B <- 0 
data_num_plus_autolab_w7$Q3_B <- 0 
data_num_plus_autolab_w7$Q11_B <- 0 
data_num_plus_autolab_w7$Q57_B <- 0 
data_num_plus_autolab_w7$Q21_B <- 0 
data_num_plus_autolab_w7$Q26_B <- 0


# Belongingness

#names(data_not_num)

data_num$Q6_B[data_not_num$Q6 == "Strongly Agree"] <- 3
data_num$Q6_B[data_not_num$Q6 == "Agree"] <- 2
data_num$Q6_B[data_not_num$Q6 == "Disagree"] <- 1
data_num$Q6_B[data_not_num$Q6 == "Strongly Disagree"] <- 0
data_num$Q6_B[data_not_num$Q6 == ""] <- 1.5 # average between agree and disagree

data_num$Q11_B[data_not_num$Q11 == "Strongly Agree"] <- 3
data_num$Q11_B[data_not_num$Q11 == "Agree"] <- 2
data_num$Q11_B[data_not_num$Q11 == "Disagree"] <- 1
data_num$Q11_B[data_not_num$Q11 == "Strongly Disagree"] <- 0
data_num$Q11_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q21_B[data_not_num$Q21 == "Strongly Agree"] <- 3
data_num$Q21_B[data_not_num$Q21 == "Agree"] <- 2
data_num$Q21_B[data_not_num$Q21 == "Disagree"] <- 1
data_num$Q21_B[data_not_num$Q21 == "Strongly Disagree"] <- 0
data_num$Q21_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q26_B[data_not_num$Q26 == "Strongly Agree"] <- 3
data_num$Q26_B[data_not_num$Q26 == "Agree"] <- 2
data_num$Q26_B[data_not_num$Q26 == "Disagree"] <- 1
data_num$Q26_B[data_not_num$Q26 == "Strongly Disagree"] <- 0
data_num$Q26_B[data_not_num$Q26 == ""] <- 1.5

data_num$BELONGINGNESS <- data_num$Q6_B + data_num$Q11_B + data_num$Q21_B + data_num$Q26_B

# ALL FEATURES

data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Agree"] <- 2
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Disagree"] <- 1
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Agree"] <- 2
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Disagree"] <- 1
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == ""] <- 1.5

data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Agree"] <- 2
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Disagree"] <- 1
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == ""] <- 1.5

data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Agree"] <- 2
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Disagree"] <- 1
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == ""] <- 1.5

data_num_plus_autolab_all$BELONGINGNESS <- data_num_plus_autolab_all$Q6_B + data_num_plus_autolab_all$Q11_B + data_num_plus_autolab_all$Q21_B + data_num_plus_autolab_all$Q26_B

# W4 

data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Agree"] <- 2
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Agree"] <- 2
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == ""] <- 1.5

data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Agree"] <- 2
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == ""] <- 1.5

data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Agree"] <- 2
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == ""] <- 1.5

data_num_plus_autolab_w4$BELONGINGNESS <- data_num_plus_autolab_w4$Q6_B + data_num_plus_autolab_w4$Q11_B + data_num_plus_autolab_w4$Q21_B + data_num_plus_autolab_w4$Q26_B

# W5

data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Agree"] <- 2
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Agree"] <- 2
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == ""] <- 1.5

data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Agree"] <- 2
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == ""] <- 1.5

data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Agree"] <- 2
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == ""] <- 1.5

data_num_plus_autolab_w5$BELONGINGNESS <- data_num_plus_autolab_w5$Q6_B + data_num_plus_autolab_w5$Q11_B + data_num_plus_autolab_w5$Q21_B + data_num_plus_autolab_w5$Q26_B

# W7

data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Agree"] <- 2
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Agree"] <- 2
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == ""] <- 1.5

data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Agree"] <- 2
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == ""] <- 1.5

data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Agree"] <- 2
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == ""] <- 1.5

data_num_plus_autolab_w7$BELONGINGNESS <- data_num_plus_autolab_w7$Q6_B + data_num_plus_autolab_w7$Q11_B + data_num_plus_autolab_w7$Q21_B + data_num_plus_autolab_w7$Q26_B


# Confidence
# Q3, Q9, Q15, Q19, Q24

data_num$Q3_B[data_not_num$Q3 == "Strongly Agree"] <- 3
data_num$Q3_B[data_not_num$Q3 == "Agree"] <- 2
data_num$Q3_B[data_not_num$Q3 == "Disagree"] <- 1
data_num$Q3_B[data_not_num$Q3 == "Strongly Disagree"] <- 0
data_num$Q3_B[data_not_num$Q3 == ""] <- 1.5

data_num$Q9_B[data_not_num$Q9 == "Strongly Agree"] <- 3
data_num$Q9_B[data_not_num$Q9 == "Agree"] <- 2
data_num$Q9_B[data_not_num$Q9 == "Disagree"] <- 1
data_num$Q9_B[data_not_num$Q9 == "Strongly Disagree"] <- 0
data_num$Q9_B[data_not_num$Q9 == ""] <- 1.5

data_num$Q15_B[data_not_num$Q15 == "Strongly Agree"] <- 3
data_num$Q15_B[data_not_num$Q15 == "Agree"] <- 2
data_num$Q15_B[data_not_num$Q15 == "Disagree"] <- 1
data_num$Q15_B[data_not_num$Q15 == "Strongly Disagree"] <- 0
data_num$Q15_B[data_not_num$Q15 == ""] <- 1.5


data_num$Q19_B[data_not_num$Q19 == "Strongly Agree"] <- 3
data_num$Q19_B[data_not_num$Q19 == "Agree"] <- 2
data_num$Q19_B[data_not_num$Q19 == "Disagree"] <- 1
data_num$Q19_B[data_not_num$Q19 == "Strongly Disagree"] <- 0
data_num$Q19_B[data_not_num$Q19 == ""] <- 1.5


data_num$Q24_B[data_not_num$Q24 == "Strongly Agree"] <- 3
data_num$Q24_B[data_not_num$Q24 == "Agree"] <- 2
data_num$Q24_B[data_not_num$Q24 == "Disagree"] <- 1
data_num$Q24_B[data_not_num$Q24 == "Strongly Disagree"] <- 0
data_num$Q24_B[data_not_num$Q24 == ""] <- 1.5

data_num$CONFIDENCE <- data_num$Q3_B + data_num$Q9_B + data_num$Q15_B + data_num$Q19_B + data_num$Q24_B

# ALL

data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Agree"] <- 2
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Disagree"] <- 1
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == ""] <- 1.5

data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Agree"] <- 2
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Disagree"] <- 1
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == ""] <- 1.5

data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Agree"] <- 2
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Disagree"] <- 1
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == ""] <- 1.5


data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Agree"] <- 2
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Disagree"] <- 1
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == ""] <- 1.5


data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Agree"] <- 2
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Disagree"] <- 1
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == ""] <- 1.5

data_num_plus_autolab_all$CONFIDENCE <- data_num_plus_autolab_all$Q3_B + data_num_plus_autolab_all$Q9_B + data_num_plus_autolab_all$Q15_B + data_num_plus_autolab_all$Q19_B + data_num_plus_autolab_all$Q24_B



# W4

data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Agree"] <- 2
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == ""] <- 1.5

data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Agree"] <- 2
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == ""] <- 1.5

data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Agree"] <- 2
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == ""] <- 1.5


data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Agree"] <- 2
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == ""] <- 1.5


data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Agree"] <- 2
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == ""] <- 1.5

data_num_plus_autolab_w4$CONFIDENCE <- data_num_plus_autolab_w4$Q3_B + data_num_plus_autolab_w4$Q9_B + data_num_plus_autolab_w4$Q15_B + data_num_plus_autolab_w4$Q19_B + data_num_plus_autolab_w4$Q24_B

# W5

data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Agree"] <- 2
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == ""] <- 1.5

data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Agree"] <- 2
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == ""] <- 1.5

data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Agree"] <- 2
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == ""] <- 1.5


data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Agree"] <- 2
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == ""] <- 1.5


data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Agree"] <- 2
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == ""] <- 1.5

data_num_plus_autolab_w5$CONFIDENCE <- data_num_plus_autolab_w5$Q3_B + data_num_plus_autolab_w5$Q9_B + data_num_plus_autolab_w5$Q15_B + data_num_plus_autolab_w5$Q19_B + data_num_plus_autolab_w5$Q24_B

# W7

data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Agree"] <- 2
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == ""] <- 1.5

data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Agree"] <- 2
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == ""] <- 1.5

data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Agree"] <- 2
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == ""] <- 1.5


data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Agree"] <- 2
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == ""] <- 1.5


data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Agree"] <- 2
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == ""] <- 1.5

data_num_plus_autolab_w7$CONFIDENCE <- data_num_plus_autolab_w7$Q3_B + data_num_plus_autolab_w7$Q9_B + data_num_plus_autolab_w7$Q15_B + data_num_plus_autolab_w7$Q19_B + data_num_plus_autolab_w7$Q24_B



# Interest
#Q5, Q10, Q16, Q20, Q25

data_num$Q5_B[data_not_num$Q5 == "Strongly Agree"] <- 3
data_num$Q5_B[data_not_num$Q5 == "Agree"] <- 2
data_num$Q5_B[data_not_num$Q5 == "Disagree"] <- 1
data_num$Q5_B[data_not_num$Q5 == "Strongly Disagree"] <- 0
data_num$Q5_B[data_not_num$Q5 == ""] <- 1.5

data_num$Q10_B[data_not_num$Q10 == "Strongly Agree"] <- 3
data_num$Q10_B[data_not_num$Q10 == "Agree"] <- 2
data_num$Q10_B[data_not_num$Q10 == "Disagree"] <- 1
data_num$Q10_B[data_not_num$Q10 == "Strongly Disagree"] <- 0
data_num$Q10_B[data_not_num$Q10 == ""] <- 1.5

data_num$Q16_B[data_not_num$Q16 == "Strongly Agree"] <- 3
data_num$Q16_B[data_not_num$Q16 == "Agree"] <- 2
data_num$Q16_B[data_not_num$Q16 == "Disagree"] <- 1
data_num$Q16_B[data_not_num$Q16 == "Strongly Disagree"] <- 0
data_num$Q16_B[data_not_num$Q16 == ""] <- 1.5


data_num$Q20_B[data_not_num$Q20 == "Strongly Agree"] <- 3
data_num$Q20_B[data_not_num$Q20 == "Agree"] <- 2
data_num$Q20_B[data_not_num$Q20 == "Disagree"] <- 1
data_num$Q20_B[data_not_num$Q20 == "Strongly Disagree"] <- 0
data_num$Q20_B[data_not_num$Q20 == ""] <- 1.5


data_num$Q25_B[data_not_num$Q25 == "Strongly Agree"] <- 3
data_num$Q25_B[data_not_num$Q25 == "Agree"] <- 2
data_num$Q25_B[data_not_num$Q25 == "Disagree"] <- 1
data_num$Q25_B[data_not_num$Q25 == "Strongly Disagree"] <- 0
data_num$Q25_B[data_not_num$Q25 == ""] <- 1.5

data_num$INTEREST <- data_num$Q5_B + data_num$Q10_B + data_num$Q16_B + data_num$Q20_B + data_num$Q25_B

# ALL

data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Agree"] <- 2
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Disagree"] <- 1
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == ""] <- 1.5

data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Agree"] <- 2
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Disagree"] <- 1
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == ""] <- 1.5

data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Agree"] <- 2
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Disagree"] <- 1
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == ""] <- 1.5


data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Agree"] <- 2
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Disagree"] <- 1
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == ""] <- 1.5


data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Agree"] <- 2
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Disagree"] <- 1
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == ""] <- 1.5

data_num_plus_autolab_all$INTEREST <- data_num_plus_autolab_all$Q5_B + data_num_plus_autolab_all$Q10_B + data_num_plus_autolab_all$Q16_B + data_num_plus_autolab_all$Q20_B + data_num_plus_autolab_all$Q25_B



# W4

data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Agree"] <- 2
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == ""] <- 1.5

data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Agree"] <- 2
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == ""] <- 1.5

data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Agree"] <- 2
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == ""] <- 1.5


data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Agree"] <- 2
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == ""] <- 1.5


data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Agree"] <- 2
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == ""] <- 1.5

data_num_plus_autolab_w4$INTEREST <- data_num_plus_autolab_w4$Q5_B + data_num_plus_autolab_w4$Q10_B + data_num_plus_autolab_w4$Q16_B + data_num_plus_autolab_w4$Q20_B + data_num_plus_autolab_w4$Q25_B

# W5

data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Agree"] <- 2
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == ""] <- 1.5

data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Agree"] <- 2
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == ""] <- 1.5

data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Agree"] <- 2
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == ""] <- 1.5


data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Agree"] <- 2
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == ""] <- 1.5


data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Agree"] <- 2
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == ""] <- 1.5

data_num_plus_autolab_w5$INTEREST <- data_num_plus_autolab_w5$Q5_B + data_num_plus_autolab_w5$Q10_B + data_num_plus_autolab_w5$Q16_B + data_num_plus_autolab_w5$Q20_B + data_num_plus_autolab_w5$Q25_B

# W7

data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Agree"] <- 2
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == ""] <- 1.5

data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Agree"] <- 2
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == ""] <- 1.5

data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Agree"] <- 2
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == ""] <- 1.5


data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Agree"] <- 2
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == ""] <- 1.5


data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Agree"] <- 2
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == ""] <- 1.5

data_num_plus_autolab_w7$INTEREST <- data_num_plus_autolab_w7$Q5_B + data_num_plus_autolab_w7$Q10_B + data_num_plus_autolab_w7$Q16_B + data_num_plus_autolab_w7$Q20_B + data_num_plus_autolab_w7$Q25_B

# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_num$Q7_B[data_not_num$Q7 == "Strongly Agree"] <- 3
data_num$Q7_B[data_not_num$Q7 == "Agree"] <- 2
data_num$Q7_B[data_not_num$Q7 == "Disagree"] <- 1
data_num$Q7_B[data_not_num$Q7 == "Strongly Disagree"] <- 0
data_num$Q7_B[data_not_num$Q7 == ""] <- 1.5

data_num$Q12_B[data_not_num$Q12 == "Strongly Agree"] <- 3
data_num$Q12_B[data_not_num$Q12 == "Agree"] <- 2
data_num$Q12_B[data_not_num$Q12 == "Disagree"] <- 1
data_num$Q12_B[data_not_num$Q12 == "Strongly Disagree"] <- 0
data_num$Q12_B[data_not_num$Q12 == ""] <- 1.5

data_num$Q17_B[data_not_num$Q17 == "Strongly Agree"] <- 3
data_num$Q17_B[data_not_num$Q17 == "Agree"] <- 2
data_num$Q17_B[data_not_num$Q17 == "Disagree"] <- 1
data_num$Q17_B[data_not_num$Q17 == "Strongly Disagree"] <- 0
data_num$Q17_B[data_not_num$Q17 == ""] <- 1.5


data_num$Q22_B[data_not_num$Q22 == "Strongly Agree"] <- 3
data_num$Q22_B[data_not_num$Q22 == "Agree"] <- 2
data_num$Q22_B[data_not_num$Q22 == "Disagree"] <- 1
data_num$Q22_B[data_not_num$Q22 == "Strongly Disagree"] <- 0
data_num$Q22_B[data_not_num$Q22 == ""] <- 1.5


data_num$Q27_B[data_not_num$Q27 == "Strongly Agree"] <- 3
data_num$Q27_B[data_not_num$Q27 == "Agree"] <- 2
data_num$Q27_B[data_not_num$Q27 == "Disagree"] <- 1
data_num$Q27_B[data_not_num$Q27 == "Strongly Disagree"] <- 0
data_num$Q27_B[data_not_num$Q27 == ""] <- 1.5

data_num$USEFULNESS <- data_num$Q7_B + data_num$Q12_B + data_num$Q17_B + data_num$Q22_B + data_num$Q27_B

# ALL

data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Agree"] <- 2
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Disagree"] <- 1
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == ""] <- 1.5

data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Agree"] <- 2
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Disagree"] <- 1
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == ""] <- 1.5

data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Agree"] <- 2
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Disagree"] <- 1
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == ""] <- 1.5


data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Agree"] <- 2
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Disagree"] <- 1
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == ""] <- 1.5


data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Agree"] <- 2
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Disagree"] <- 1
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == ""] <- 1.5

data_num_plus_autolab_all$USEFULNESS <- data_num_plus_autolab_all$Q7_B + data_num_plus_autolab_all$Q12_B + data_num_plus_autolab_all$Q17_B + data_num_plus_autolab_all$Q22_B + data_num_plus_autolab_all$Q27_B


# W4

data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Agree"] <- 2
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == ""] <- 1.5

data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Agree"] <- 2
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == ""] <- 1.5

data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Agree"] <- 2
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == ""] <- 1.5


data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Agree"] <- 2
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == ""] <- 1.5


data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Agree"] <- 2
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == ""] <- 1.5

data_num_plus_autolab_w4$USEFULNESS <- data_num_plus_autolab_w4$Q7_B + data_num_plus_autolab_w4$Q12_B + data_num_plus_autolab_w4$Q17_B + data_num_plus_autolab_w4$Q22_B + data_num_plus_autolab_w4$Q27_B

# W5

data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Agree"] <- 2
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == ""] <- 1.5

data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Agree"] <- 2
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == ""] <- 1.5

data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Agree"] <- 2
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == ""] <- 1.5


data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Agree"] <- 2
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == ""] <- 1.5


data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Agree"] <- 2
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == ""] <- 1.5

data_num_plus_autolab_w5$USEFULNESS <- data_num_plus_autolab_w5$Q7_B + data_num_plus_autolab_w5$Q12_B + data_num_plus_autolab_w5$Q17_B + data_num_plus_autolab_w5$Q22_B + data_num_plus_autolab_w5$Q27_B

# W7

data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Agree"] <- 2
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == ""] <- 1.5

data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Agree"] <- 2
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == ""] <- 1.5

data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Agree"] <- 2
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == ""] <- 1.5


data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Agree"] <- 2
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == ""] <- 1.5


data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Agree"] <- 2
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == ""] <- 1.5

data_num_plus_autolab_w7$USEFULNESS <- data_num_plus_autolab_w7$Q7_B + data_num_plus_autolab_w7$Q12_B + data_num_plus_autolab_w7$Q17_B + data_num_plus_autolab_w7$Q22_B + data_num_plus_autolab_w7$Q27_B




# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_num$Q8_B[data_not_num$Q8 == "Strongly Agree"] <- 3
data_num$Q8_B[data_not_num$Q8 == "Agree"] <- 2
data_num$Q8_B[data_not_num$Q8 == "Disagree"] <- 1
data_num$Q8_B[data_not_num$Q8 == "Strongly Disagree"] <- 0
data_num$Q8_B[data_not_num$Q8 == ""] <- 1.5

data_num$Q14_B[data_not_num$Q14 == "Strongly Agree"] <- 3
data_num$Q14_B[data_not_num$Q14 == "Agree"] <- 2
data_num$Q14_B[data_not_num$Q14 == "Disagree"] <- 1
data_num$Q14_B[data_not_num$Q14 == "Strongly Disagree"] <- 0
data_num$Q14_B[data_not_num$Q14 == ""] <- 1.5

data_num$Q18_B[data_not_num$Q18 == "Strongly Agree"] <- 3
data_num$Q18_B[data_not_num$Q18 == "Agree"] <- 2
data_num$Q18_B[data_not_num$Q18 == "Disagree"] <- 1
data_num$Q18_B[data_not_num$Q18 == "Strongly Disagree"] <- 0
data_num$Q18_B[data_not_num$Q18 == ""] <- 1.5


data_num$Q23_B[data_not_num$Q23 == "Strongly Agree"] <- 3
data_num$Q23_B[data_not_num$Q23 == "Agree"] <- 2
data_num$Q23_B[data_not_num$Q23 == "Disagree"] <- 1
data_num$Q23_B[data_not_num$Q23 == "Strongly Disagree"] <- 0
data_num$Q23_B[data_not_num$Q23 == ""] <- 1.5


data_num$Q28_B[data_not_num$Q28 == "Strongly Agree"] <- 3
data_num$Q28_B[data_not_num$Q28 == "Agree"] <- 2
data_num$Q28_B[data_not_num$Q28 == "Disagree"] <- 1
data_num$Q28_B[data_not_num$Q28 == "Strongly Disagree"] <- 0
data_num$Q28_B[data_not_num$Q28 == ""] <- 1.5

data_num$ENCOURAGEMENT <- data_num$Q8_B + data_num$Q14_B + data_num$Q18_B + data_num$Q23_B + data_num$Q28_B

# ALL

data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Agree"] <- 2
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Disagree"] <- 1
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == ""] <- 1.5

data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Agree"] <- 2
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Disagree"] <- 1
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == ""] <- 1.5

data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Agree"] <- 2
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Disagree"] <- 1
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == ""] <- 1.5


data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Agree"] <- 2
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Disagree"] <- 1
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == ""] <- 1.5


data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Agree"] <- 2
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Disagree"] <- 1
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == ""] <- 1.5

data_num_plus_autolab_all$ENCOURAGEMENT <- data_num_plus_autolab_all$Q8_B + data_num_plus_autolab_all$Q14_B + data_num_plus_autolab_all$Q18_B + data_num_plus_autolab_all$Q23_B + data_num_plus_autolab_all$Q28_B



# W4

data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Agree"] <- 2
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == ""] <- 1.5

data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Agree"] <- 2
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == ""] <- 1.5

data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Agree"] <- 2
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == ""] <- 1.5


data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Agree"] <- 2
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == ""] <- 1.5


data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Agree"] <- 2
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == ""] <- 1.5

data_num_plus_autolab_w4$ENCOURAGEMENT <- data_num_plus_autolab_w4$Q8_B + data_num_plus_autolab_w4$Q14_B + data_num_plus_autolab_w4$Q18_B + data_num_plus_autolab_w4$Q23_B + data_num_plus_autolab_w4$Q28_B

# W5

data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Agree"] <- 2
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == ""] <- 1.5

data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Agree"] <- 2
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == ""] <- 1.5

data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Agree"] <- 2
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == ""] <- 1.5


data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Agree"] <- 2
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == ""] <- 1.5


data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Agree"] <- 2
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == ""] <- 1.5

data_num_plus_autolab_w5$ENCOURAGEMENT <- data_num_plus_autolab_w5$Q8_B + data_num_plus_autolab_w5$Q14_B + data_num_plus_autolab_w5$Q18_B + data_num_plus_autolab_w5$Q23_B + data_num_plus_autolab_w5$Q28_B


# W7

data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Agree"] <- 2
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == ""] <- 1.5

data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Agree"] <- 2
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == ""] <- 1.5

data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Agree"] <- 2
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == ""] <- 1.5


data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Agree"] <- 2
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == ""] <- 1.5


data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Agree"] <- 2
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == ""] <- 1.5

data_num_plus_autolab_w7$ENCOURAGEMENT <- data_num_plus_autolab_w7$Q8_B + data_num_plus_autolab_w7$Q14_B + data_num_plus_autolab_w7$Q18_B + data_num_plus_autolab_w7$Q23_B + data_num_plus_autolab_w7$Q28_B


names(data_num_plus_autolab)

# DONE WITH ATTITUDES

data_f20_num_untrimmed <- data_num
data_f20_num_untrimmed_plus_autolab_all <-  data_num_plus_autolab_all
data_f20_num_untrimmed_plus_autolab_w4 <-  data_num_plus_autolab_w4
data_f20_num_untrimmed_plus_autolab_w5 <-  data_num_plus_autolab_w5
data_f20_num_untrimmed_plus_autolab_w7 <-  data_num_plus_autolab_w7
  
data_f20_not_num_untrimmed <- data_not_num
data_f20_not_num_untrimmed_plus_autolab_all <-  data_not_num_plus_autolab_all
data_f20_not_num_untrimmed_plus_autolab_w4 <-  data_not_num_plus_autolab_w4
data_f20_not_num_untrimmed_plus_autolab_w5 <-  data_not_num_plus_autolab_w5
data_f20_not_num_untrimmed_plus_autolab_w7 <-  data_not_num_plus_autolab_w7
# Remove unneeded attributes

# DATA_NOT_NUM

names(data_not_num)
table(data_not_num$course_repeat_ind)
selected_variables <- c("NetID", "gender_cd", "ethnic_cd","course_repeat_ind" ,  "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","citizen_status_cd","SUCCESS", "Q1","Q2", "Q4", "Q35")

data_not_num_ss <- data_not_num # SAVE!

data_not_num_temp <- data_not_num[selected_variables]
data_not_num <- data_not_num_temp

# Same for Autolab data
names(data_num)
data_not_num_plus_autolab_all_ss <- data_not_num_plus_autolab_all # SAVE!
data_not_num_plus_autolab_w4_ss <- data_not_num_plus_autolab_w4 # SAVE!
data_not_num_plus_autolab_w5_ss <- data_not_num_plus_autolab_w5 # SAVE!
data_not_num_plus_autolab_w7_ss <- data_not_num_plus_autolab_w7 # SAVE!

data_not_num_plus_autolab_all_temp <- data_not_num_plus_autolab_all[selected_variables]
data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all_temp
data_not_num_plus_autolab_w4_temp <- data_not_num_plus_autolab_w4[selected_variables]
data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4_temp
data_not_num_plus_autolab_w5_temp <- data_not_num_plus_autolab_w5[selected_variables]
data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5_temp
data_not_num_plus_autolab_w7_temp <- data_not_num_plus_autolab_w7[selected_variables]
data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7_temp


# DATA_NUM

# Paste from Spring 2021
names(data_num)

selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam3","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14",   "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_ss <- data_num # SAVE!

data_num_temp <- data_num[selected_variables]
names(data_num_temp)
data_num <- data_num_temp

#names(data_not_num_plus_autolab)
#names(data_num_plus_autolab)

#names(data_num_plus_autolab)

names(data_num_plus_autolab_w4)
#data_num_plus_autolab$max_submissions
selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam3","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES","max_submissions", "max_time_f_l_subm", "max_time_consecutive_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission", "min_time_b4_deadline_first_submission",  "max_time_b4_deadline_last_submission", "min_time_b4_deadline_last_submission")

#selected_variables <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.", "X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.", "X8..Find.Duplicate..1067540.", "X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.", "X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.", "Recitation.10..1129728.", "Recitation.2..1129729.", "Recitation.3..1129730.", "Recitation.7..1129732.", "Recitation.4..1129733.","Recitation.12..1129734.", "Recitation.5..1129735.", "Recitation.8..1129736.", "Recitation.13..1129737.",  "Recitation.11..1129738.", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")
names(data_num_plus_autolab_all)
data_num_plus_autolab_all_temp <- data_num_plus_autolab_all[selected_variables]
data_num_plus_autolab_all <- data_num_plus_autolab_all_temp

data_num_plus_autolab_w4_temp <- data_num_plus_autolab_w4[selected_variables]
data_num_plus_autolab_w4 <- data_num_plus_autolab_w4_temp

data_num_plus_autolab_w5_temp <- data_num_plus_autolab_w5[selected_variables]
data_num_plus_autolab_w5 <- data_num_plus_autolab_w5_temp

data_num_plus_autolab_w7_temp <- data_num_plus_autolab_w7[selected_variables]
data_num_plus_autolab_w7 <- data_num_plus_autolab_w7_temp


names(data_not_num_plus_autolab)


# select meaningful variables from non-numeric features
str(data_not_num)

success_s <- data_not_num_temp$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all_temp$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4_temp$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5_temp$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7_temp$SUCCESS

length(success_s_a_all)
# SAVE THE NUM AND NOT NUM DATA FRAMES

data_num_s <- data_num
data_not_num_s <- data_not_num

data_num_a_s_all <- data_num_plus_autolab_all
data_not_num_a_s_all <-data_not_num_plus_autolab_all


data_num_a_s_w4 <- data_num_plus_autolab_w4
data_not_num_a_s_w4 <-data_not_num_plus_autolab_w4

data_num_a_s_w5 <- data_num_plus_autolab_w5
data_not_num_a_s_w5 <-data_not_num_plus_autolab_w5

data_num_a_s_w7 <- data_num_plus_autolab_w7
data_not_num_a_s_w7 <-data_not_num_plus_autolab_w7

# Done paste Spring 2021

#names(data_num)

#table(data_num$Exit.Survey..1127030.) # get rid of
##table(data_num$Recitations.Final.Points) # get rid of 
#table(data_num$Recitations.Current.Score) # get rid of 
#table(data_num$Recitations.Current.Score) # get rid of
# etc etc etc Recitations...
# same for Quizzes and Assignments! we won't have this info half way through the semester
# same for Final.Points, etc.

# DATA_NUM_WITH_AUTOLAB

#names(data_num)
#names(data_not_num)

## RECOVER NUM AND NOT NUM DATA FRAMES

names(data_not_num)
names(data_num)

drops_not_num <- c("NetID", "SUCCESS")

data_not_num <- data_not_num[ , !(names(data_not_num) %in% drops_not_num)]
#data_not_num$Duration..in.seconds. <- as.integer(data_not_num$Duration..in.seconds.)

data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all[ , !(names(data_not_num_plus_autolab_all) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4[ , !(names(data_not_num_plus_autolab_w4) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5[ , !(names(data_not_num_plus_autolab_w5) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7[ , !(names(data_not_num_plus_autolab_w7) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


str(data_not_num)

library(lattice)
library(caret)
# one-hot encoding


# get rid of constant(empty) fields, otherwise can't do one-hot encoding because of errors..
library(janitor)
data_not_num_saved <- data_not_num
data_not_num <- remove_constant(data_not_num_saved, na.rm= TRUE)

data_not_num_plus_autolab_saved_all <- data_not_num_plus_autolab_all
data_not_num_plus_autolab_all <- remove_constant(data_not_num_plus_autolab_saved_all, na.rm= TRUE)

data_not_num_plus_autolab_saved_w4 <- data_not_num_plus_autolab_w4
data_not_num_plus_autolab_w4 <- remove_constant(data_not_num_plus_autolab_saved_w4, na.rm= TRUE)

data_not_num_plus_autolab_saved_w5 <- data_not_num_plus_autolab_w5
data_not_num_plus_autolab_w5 <- remove_constant(data_not_num_plus_autolab_saved_w5, na.rm= TRUE)

data_not_num_plus_autolab_saved_w7 <- data_not_num_plus_autolab_w7
data_not_num_plus_autolab_w7 <- remove_constant(data_not_num_plus_autolab_saved_w7, na.rm= TRUE)


library(caret)

dummy <- dummyVars(" ~ .", data=data_not_num)
final_df <- data.frame(predict(dummy, newdata=data_not_num))

dummy_a_all <- dummyVars(" ~ .", data=data_not_num_plus_autolab_all)
final_df_a_all <- data.frame(predict(dummy_a_all, newdata=data_not_num_plus_autolab_all))

dummy_a_w4 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w4)
final_df_a_w4 <- data.frame(predict(dummy_a_w4, newdata=data_not_num_plus_autolab_w4))

dummy_a_w5 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w5)
final_df_a_w5 <- data.frame(predict(dummy_a_w5, newdata=data_not_num_plus_autolab_w5))

dummy_a_w7 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w7)
final_df_a_w7 <- data.frame(predict(dummy_a_w7, newdata=data_not_num_plus_autolab_w7))

success_s <- data_not_num_temp$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all_temp$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4_temp$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5_temp$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7_temp$SUCCESS

length(success_s)
length(success_s_a_all)
length(success_s_a_w4)
length(success_s_a_w5)
length(success_s_a_w7)


success_saved <- data_not_num_temp$SUCCESS
success_saved_a_all <- data_not_num_plus_autolab_all_temp$SUCCESS
success_saved_a_w4 <- data_not_num_plus_autolab_w4_temp$SUCCESS
success_saved_a_w5 <- data_not_num_plus_autolab_w5_temp$SUCCESS
success_saved_a_w7 <- data_not_num_plus_autolab_w7_temp$SUCCESS
# Need to check for zero-variance features.. save to do later ...

# Mix numeric and categorical variables
data_f20_preprocessed <- cbind(data_num, final_df)
data_f20_preprocessed$SUCCESS <- success_s
data_f20_no_na <- na.omit(data_f20_preprocessed)
success_saved <- data_f20_no_na$SUCCESS
data_f20_no_na <- data_f20_no_na[, !(names(data_f20_no_na) %in% c("SUCCESS"))]
length(success_saved)
nrow(data_f20_no_na)

#checking for constant columns...
data_f20_no_na_saved <- data_f20_no_na
data_f20_no_na <- remove_constant(data_f20_no_na_saved, na.rm= TRUE)

# plus autolab...
data_f20_preprocessed_a_all <- cbind(data_num_plus_autolab_all, final_df_a_all)
data_f20_preprocessed_a_all$SUCCESS <- success_s_a_all
data_f20_no_na_plus_autolab_all <- na.omit(data_f20_preprocessed_a_all)
success_saved_a_all <- data_f20_no_na_plus_autolab_all$SUCCESS
#temp_success <- data_f20_no_na_plus_autolab_all$SUCCESS
data_f20_no_na_plus_autolab_all <- data_f20_no_na_plus_autolab_all[, !(names(data_f20_no_na_plus_autolab_all) %in% c("SUCCESS"))]

success_a_all <- temp_success

# sanity check
length(success_saved_a_all)
nrow(data_f20_no_na_plus_autolab_all)


#checking for constant columns...
data_f20_no_na_plus_autolab_saved_all <- data_f20_no_na_plus_autolab_all
data_f20_no_na_plus_autolab_all <- remove_constant(data_f20_no_na_plus_autolab_saved_all, na.rm= TRUE)



# W4

data_f20_preprocessed_a_w4 <- cbind(data_num_plus_autolab_w4, final_df_a_w4)
data_f20_preprocessed_a_w4$SUCCESS <- success_s_a_w4
data_f20_no_na_plus_autolab_w4 <- na.omit(data_f20_preprocessed_a_w4)
success_saved_a_w4 <- data_f20_no_na_plus_autolab_w4$SUCCESS
data_f20_no_na_plus_autolab_w4 <- data_f20_no_na_plus_autolab_w4[, !(names(data_f20_no_na_plus_autolab_w4) %in% c("SUCCESS"))]
length(success_saved_a_w4)
nrow(data_f20_no_na_plus_autolab_w4)

#checking for constant columns...
data_f20_no_na_plus_autolab_saved_w4 <- data_f20_no_na_plus_autolab_w4
data_f20_no_na_plus_autolab_w4 <- remove_constant(data_f20_no_na_plus_autolab_saved_w4, na.rm= TRUE)

# W5

data_f20_preprocessed_a_w5 <- cbind(data_num_plus_autolab_w5, final_df_a_w5)
data_f20_preprocessed_a_w5$SUCCESS <- success_s_a_w5
data_f20_no_na_plus_autolab_w5 <- na.omit(data_f20_preprocessed_a_w5)
success_saved_a_w5 <- data_f20_no_na_plus_autolab_w5$SUCCESS
data_f20_no_na_plus_autolab_w5 <- data_f20_no_na_plus_autolab_w5[, !(names(data_f20_no_na_plus_autolab_w5) %in% c("SUCCESS"))]
length(success_saved_a_w5)
nrow(data_f20_no_na_plus_autolab_w5)


#checking for constant columns...
data_f20_no_na_plus_autolab_saved_w5 <- data_f20_no_na_plus_autolab_w5
data_f20_no_na_plus_autolab_w5 <- remove_constant(data_f20_no_na_plus_autolab_saved_w5, na.rm= TRUE)

# w7

data_f20_preprocessed_a_w7 <- cbind(data_num_plus_autolab_w7, final_df_a_w7)
data_f20_preprocessed_a_w7$SUCCESS <- success_s_a_w7
data_f20_no_na_plus_autolab_w7 <- na.omit(data_f20_preprocessed_a_w7)
success_saved_a_w7 <- data_f20_no_na_plus_autolab_w7$SUCCESS
data_f20_no_na_plus_autolab_w7 <- data_f20_no_na_plus_autolab_w7[, !(names(data_f20_no_na_plus_autolab_w7) %in% c("SUCCESS"))]
length(success_saved_a_w7)
nrow(data_f20_no_na_plus_autolab_w7)

#checking for constant columns...
data_f20_no_na_plus_autolab_saved_w7 <- data_f20_no_na_plus_autolab_w7
data_f20_no_na_plus_autolab_w7 <- remove_constant(data_f20_no_na_plus_autolab_saved_w7, na.rm= TRUE)



# Need to check for correlated features
cor_matrix <- cor(data_f20_no_na)
#write.csv(cor_matrix,file="cortmp.csv")

for (i in 1:nrow(cor_matrix)){
  correlations <-  which((abs(cor_matrix[i,]) > 0.70))
  if(length(correlations)> 0){
    print(colnames(data_f20_no_na)[i])
    print(correlations)
  }
}

# REMOVE CORRELATED VARS: COPY FROM SPRING 2021 data

indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.70)

remove_corrs <- data_f20_no_na[-c(indexes_to_drop)]

data_f20_no_na_no_corr <- remove_corrs
#nrow(data_f20_no_na_no_corr)
#length(success_s)
names(remove_corrs)

cor_matrix <- cor(data_f20_no_na_no_corr)
indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.70)

# indexes to drop is now empty, which means NO CORRELATIONS OVER 0.9!
names(data_f20_no_na_no_corr)

# DONE REMOVONG CORR VARS


# AUTOLAB DATA : remove correlated variables

# Need to check for correlated features

cor_matrix_a <- cor(data_f20_no_na_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
#names(data_f20_no_na_plus_autolab_all)
remove_corrs <- data_f20_no_na_plus_autolab_all[-c(indexes_to_drop)]
data_f20_no_na_no_corr_plus_autolab_all <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f20_no_na_no_corr_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

nrow(data_f20_no_na_no_corr_plus_autolab_all)
length(success_saved_a_all)


# W4

# Need to check for correlated features
cor_matrix_a <- cor(data_f20_no_na_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
#names(data_f20_no_na_plus_autolab_w4)
remove_corrs <- data_f20_no_na_plus_autolab_w4[-c(indexes_to_drop)]
data_f20_no_na_no_corr_plus_autolab_w4 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f20_no_na_no_corr_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# empty, no more variables with correlations over 0.9!

nrow(data_f20_no_na_plus_autolab_w4)
length(success_saved_a_w4)

# W5

# Need to check for correlated features
cor_matrix_a <- cor(data_f20_no_na_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
names(data_f20_no_na_plus_autolab_w5)
remove_corrs <- data_f20_no_na_plus_autolab_w5[-c(indexes_to_drop)]
data_f20_no_na_no_corr_plus_autolab_w5 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f20_no_na_no_corr_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# empty, no more variables with correlations over 0.9!

# W7

# Need to check for correlated features
cor_matrix_a <- cor(data_f20_no_na_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
names(data_f20_no_na_plus_autolab_w7)
remove_corrs <- data_f20_no_na_plus_autolab_w7[-c(indexes_to_drop)]
data_f20_no_na_no_corr_plus_autolab_w7 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f20_no_na_no_corr_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# empty, no more variables with correlations over 0.9!



# get rid of features with variance under 0.005
# copied from Spring 2021
# BETTER?? Apply variances on data without correlations

variances <- sapply(data_f20_no_na_no_corr, var)
variances_a_all <- sapply(data_f20_no_na_no_corr_plus_autolab_all, var)
variances_a_w4 <- sapply(data_f20_no_na_no_corr_plus_autolab_w4, var)
variances_a_w5 <- sapply(data_f20_no_na_no_corr_plus_autolab_w5, var)
variances_a_w7 <- sapply(data_f20_no_na_no_corr_plus_autolab_w7, var)

low_variance_features <- c()
colnames(data_f20_no_na_no_corr)[1]

for (i in 1:ncol(data_f20_no_na_no_corr)){
  
  if(variances[i] < 0.005)
  {
    low_variance_features <- c(low_variance_features, colnames(data_f20_no_na_no_corr)[i])
    print(i)
    print(colnames(data_f20_no_na_no_corr)[i])
    print(variances[i])
  }
}  

# Data with AUTOLAB ALL FT.
low_variance_features_a_all <- c()

#colnames(data_f20_no_na_plus_autolab[1]

for (i in 1:ncol(data_f20_no_na_no_corr_plus_autolab_all)){
  
  if(variances_a_all[i] < 0.005)
  {
    low_variance_features_a_all <- c(low_variance_features_a_all, colnames(data_f20_no_na_no_corr_plus_autolab_all)[i])
    print(i)
    print(colnames(data_f20_no_na_no_corr_plus_autolab_all)[i])
    print(variances_a_all[i])
  }
}  



# W4

low_variance_features_a_w4 <- c()

#colnames(data_f20_no_na_plus_autolab[1]

for (i in 1:ncol(data_f20_no_na_no_corr_plus_autolab_w4)){
  
  if(variances_a_w4[i] < 0.005)
  {
    low_variance_features_a_w4 <- c(low_variance_features_a_w4, colnames(data_f20_no_na_no_corr_plus_autolab_w4)[i])
    print(i)
    print(colnames(data_f20_no_na_no_corr_plus_autolab_w4)[i])
    print(variances_a_w4[i])
  }
}  

# w5

low_variance_features_a_w5 <- c()

#colnames(data_f20_no_na_plus_autolab[1]

for (i in 1:ncol(data_f20_no_na_no_corr_plus_autolab_w5)){
  
  if(variances_a_w5[i] < 0.005)
  {
    low_variance_features_a_w5 <- c(low_variance_features_a_w5, colnames(data_f20_no_na_no_corr_plus_autolab_w5)[i])
    print(i)
    print(colnames(data_f20_no_na_no_corr_plus_autolab_w5)[i])
    print(variances_a_w5[i])
  }
}  

# w7

low_variance_features_a_w7 <- c()

#colnames(data_f20_no_na_plus_autolab[1]

for (i in 1:ncol(data_f20_no_na_no_corr_plus_autolab_w7)){
  
  if(variances_a_w7[i] < 0.005)
  {
    low_variance_features_a_w7 <- c(low_variance_features_a_w7, colnames(data_f20_no_na_no_corr_plus_autolab_w7)[i])
    print(i)
    print(colnames(data_f20_no_na_no_corr_plus_autolab_w7)[i])
    print(variances_a_w7[i])
  }
}  


# done copied from Spring 2021

# Drop low variance features from Spring 2021 code

drops_n <- low_variance_features
drops_n_a_all <- low_variance_features_a_all
drops_n_a_w4 <- low_variance_features_a_w4
drops_n_a_w5 <- low_variance_features_a_w5
drops_n_a_w7 <- low_variance_features_a_w7

data_f20_final <- data_f20_no_na_no_corr[ , !(names(data_f20_no_na_no_corr) %in% drops_n)]
data_f20_no_na_no_corr_no_low_var <- data_f20_final

data_f20_final_a_all <- data_f20_no_na_no_corr_plus_autolab_all[ , !(names(data_f20_no_na_no_corr_plus_autolab_all) %in% drops_n_a_all)]
data_f20_no_na_no_corr_no_low_var_a_all <- data_f20_final_a_all


data_f20_final_a_w4 <- data_f20_no_na_no_corr_plus_autolab_w4[ , !(names(data_f20_no_na_no_corr_plus_autolab_w4) %in% drops_n_a_w4)]
data_f20_no_na_no_corr_no_low_var_a_w4 <- data_f20_final_a_w4

data_f20_final_a_w5 <- data_f20_no_na_no_corr_plus_autolab_w5[ , !(names(data_f20_no_na_no_corr_plus_autolab_w5) %in% drops_n_a_w5)]
data_f20_no_na_no_corr_no_low_var_a_w5 <- data_f20_final_a_w5

data_f20_final_a_w7 <- data_f20_no_na_no_corr_plus_autolab_w7[ , !(names(data_f20_no_na_no_corr_plus_autolab_w7) %in% drops_n_a_w7)]
data_f20_no_na_no_corr_no_low_var_a_w7 <- data_f20_final_a_w7


data_f20_final$SUCCESS <- success_saved
data_f20_final_a_all$SUCCESS <- success_saved_a_all
data_f20_final_a_w4$SUCCESS <- success_saved_a_w4
data_f20_final_a_w5$SUCCESS <- success_saved_a_w5
data_f20_final_a_w7$SUCCESS <- success_saved_a_w7

data_f20_no_na_no_corr_no_low_var$SUCCESS <- success_saved
data_f20_no_na_no_corr_no_low_var_a_all$SUCCESS <- success_saved_a_all
data_f20_no_na_no_corr_no_low_var_a_w4$SUCCESS <- success_saved_a_w4
data_f20_no_na_no_corr_no_low_var_a_w5$SUCCESS <- success_saved_a_w5
data_f20_no_na_no_corr_no_low_var_a_w7$SUCCESS <- success_saved_a_w7

str(data_f20_no_na_no_corr_no_low_var_a)
# DONE with Drop low variance features from Spring 2021 code


table(data_f20_no_na_a$SUCCESS)
# check again for zero variance
#final_df_no_na <- remove_constant(data_no_na, na.rm= TRUE)


# Feature importance

control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)

# for data with autolab up to week 7 ...
control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final_a, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)


# RECURSIVE FEATURE ELIMINATION... NOT DONE!

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=10)
# run the RFE algorithm
results <- rfe(PimaIndiansDiabetes[,1:8], PimaIndiansDiabetes[,9], sizes=c(1:8), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))


# Write the final result in a file
getwd()
write.csv(data_f20_final, "Data_F20_After_Processing.csv", row.names = FALSE)
write.csv(data_f20_final_a_all, "Data_F20_After_Processing_w_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_f20_final_a_w4, "Data_F20_After_Processing_w_Autolab_W4.csv", row.names = FALSE)
write.csv(data_f20_final_a_w5, "Data_F20_After_Processing_w_Autolab_W5.csv", row.names = FALSE)
write.csv(data_f20_final_a_w7, "Data_F20_After_Processing_w_Autolab_W7.csv", row.names = FALSE)

write.csv(data_f20_final, "Data_F20_After_Processing_600_700.csv", row.names = FALSE)
write.csv(data_f20_final_a_all, "Data_F20_After_Processing_w_Autolab_ALL_600_700.csv", row.names = FALSE)
write.csv(data_f20_final_a_w4, "Data_F20_After_Processing_w_Autolab_W4_600_700.csv", row.names = FALSE)
write.csv(data_f20_final_a_w5, "Data_F20_After_Processing_w_Autolab_W5_600_700.csv", row.names = FALSE)
write.csv(data_f20_final_a_w7, "Data_F20_After_Processing_w_Autolab_W7_600_700.csv", row.names = FALSE)

setwd("")

data_f20_final <- read.csv("Data_F20_After_Processing.csv", header = TRUE)
data_f20_final_a_all <- read.csv("Data_F20_After_Processing_w_Autolab_ALL.csv", header = TRUE)
data_f20_final_a_w4 <- read.csv("Data_F20_After_Processing_w_Autolab_W4.csv", header = TRUE)
data_f20_final_a_w5 <- read.csv( "Data_F20_After_Processing_w_Autolab_W5.csv", header = TRUE)
data_f20_final_a_w7 <- read.csv("Data_F20_After_Processing_w_Autolab_W7.csv", header = TRUE)



# DATA WITH ALL THE FEATURES: data_f20_no_na
# No correlated features and no features with 0 variance

names(data_f20_final)

#####################################################
#
#---------  Fall 2022 START HERE  !!  -------------
#
#####################################################

# intro survey has only students who have given consent for research
data_intro_f22_111_t <- data_intro_f22_111[data_intro_f22_111$Q38=="Yes, I understand.",]
data_intro_f22_111 <- data_intro_f22_111_t


# STEP 1: Merge Canvas+SAS with Intro survey
data_all1 <- merge(data_canvas_and_sas_f22_111, data_intro_f22_111, by = "NetID")
#names(data_all1)
data_all_plus_autolab_all <- merge(data_all1, data_autolab_f22)
data_all_plus_autolab_w4 <- merge(data_all1, data_autolab_f22_w4)
data_all_plus_autolab_w5 <- merge(data_all1, data_autolab_f22_w5)
data_all_plus_autolab_w7 <- merge(data_all1, data_autolab_f22_w7)
#names(data_all_plus_autolab_w7)
# Turn SUCCESS into a factor so we can do classification on it

data_all1$SUCCESS <- as.factor(data_all1$SUCCESS)
#table(data_all1$SUCCESS)
data_all_plus_autolab_all$SUCCESS <- as.factor(data_all_plus_autolab_all$SUCCESS)
data_all_plus_autolab_w4$SUCCESS <- as.factor(data_all_plus_autolab_w4$SUCCESS)
data_all_plus_autolab_w5$SUCCESS <- as.factor(data_all_plus_autolab_w5$SUCCESS)
data_all_plus_autolab_w7$SUCCESS <- as.factor(data_all_plus_autolab_w7$SUCCESS)

write.csv(data_all_plus_autolab_all, "F22_Beginnning_Of_Processing_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w4, "F22_Beginnning_Of_Processing_Autolab_W4.csv", row.names = FALSE)
write.csv(data_all1, "F22_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w5, "F22_Beginnning_Of_Processing_Autolab_W5.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w7, "F22_Beginnning_Of_Processing_Autolab_W7.csv", row.names = FALSE)

# ADD AUTOLAB FEATURES

# all

data_all_plus_autolab_all$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_first_submission)
data_all_plus_autolab_all$max_time_f_l_subm <- as.integer(data_all_plus_autolab_all$max_time_f_l_subm)
data_all_plus_autolab_all$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_all$max_time_consecutive_submissions)
data_all_plus_autolab_all$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_last_submission)
data_all_plus_autolab_all$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_first_submission)
data_all_plus_autolab_all$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_last_submission)


# w4

data_all_plus_autolab_w4$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w4$max_time_f_l_subm)
data_all_plus_autolab_w4$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w4$max_time_consecutive_submissions)
data_all_plus_autolab_w4$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7
data_f22_plus_autolab_week4 <- data_all_plus_autolab_w4
write.csv(data_f22_plus_autolab_week4, "F22_W4_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

# W5

data_all_plus_autolab_w5$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w5$max_time_f_l_subm)
data_all_plus_autolab_w5$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w5$max_time_consecutive_submissions)
data_all_plus_autolab_w5$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_f22 <- data_all1
data_f22_plus_autolab_week5 <- data_all_plus_autolab_w5

write.csv(data_f22_plus_autolab_week5, "F22_W5_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)


# W7

data_all_plus_autolab_w7$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w7$max_time_f_l_subm)
data_all_plus_autolab_w7$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w7$max_time_consecutive_submissions)
data_all_plus_autolab_w7$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_f22 <- data_all1
data_f22_plus_autolab_all <- data_all_plus_autolab_all
data_f22_plus_autolab_week4 <- data_all_plus_autolab_w4
data_f22_plus_autolab_week5 <- data_all_plus_autolab_w5
data_f22_plus_autolab_week7 <- data_all_plus_autolab_w7

write.csv(data_f22_plus_autolab_week7, "F22_W_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

names(data_all1)

data_f22$SUCCESS <- as.factor(data_f22$SUCCESS)
data_f22_plus_autolab_all$SUCCESS <- as.factor(data_f22_plus_autolab_all$SUCCESS)
data_f22_plus_autolab_week4$SUCCESS <- as.factor(data_f22_plus_autolab_week4$SUCCESS)
data_f22_plus_autolab_week5$SUCCESS <- as.factor(data_f22_plus_autolab_week5$SUCCESS)
data_f22_plus_autolab_week7$SUCCESS <- as.factor(data_f22_plus_autolab_week7$SUCCESS)

# double check ...
table(data_f22$SUCCESS)
library(dplyr)

# Turn all numeric features into numbers

data_f22$Duration..in.seconds. <- as.numeric(data_f22$Duration..in.seconds.)
data_f22_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_all$Duration..in.seconds.)
data_f22_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_week4$Duration..in.seconds.)
data_f22_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_week5$Duration..in.seconds.)
data_f22_plus_autolab_week7$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_week7$Duration..in.seconds.)

# Turn features that should be categories into factors

data_f22$sending_school_type_cd <- as.factor(data_f22$sending_school_type_cd)
data_f22$orig_admit_type_cd <- as.factor(data_f22$orig_admit_type_cd)
data_f22$citizen_status_cd <- as.factor(data_f22$citizen_status_cd)
data_f22$curr_admit_type_cd <- as.factor(data_f22$curr_admit_type_cd)

data_f22_plus_autolab_all$sending_school_type_cd <- as.factor(data_f22_plus_autolab_all$sending_school_type_cd)
data_f22_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_all$orig_admit_type_cd)
data_f22_plus_autolab_all$citizen_status_cd <- as.factor(data_f22_plus_autolab_all$citizen_status_cd)
data_f22_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_all$curr_admit_type_cd)


data_f22_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week4$sending_school_type_cd)
data_f22_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week4$orig_admit_type_cd)
data_f22_plus_autolab_week4$citizen_status_cd <- as.factor(data_f22_plus_autolab_week4$citizen_status_cd)
data_f22_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week4$curr_admit_type_cd)

data_f22_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week5$sending_school_type_cd)
data_f22_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week5$orig_admit_type_cd)
data_f22_plus_autolab_week5$citizen_status_cd <- as.factor(data_f22_plus_autolab_week5$citizen_status_cd)
data_f22_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week5$curr_admit_type_cd)


data_f22_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week7$sending_school_type_cd)
data_f22_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week7$orig_admit_type_cd)
data_f22_plus_autolab_week7$citizen_status_cd <- as.factor(data_f22_plus_autolab_week7$citizen_status_cd)
data_f22_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week7$curr_admit_type_cd)



# remove students whose progress is not 100%
table(data_f22$Progress)
table(data_f22_plus_autolab_week7$Progress)

data_f22_temp <- data_f22[data_f22$Progress == "100",]
data_f22 <- data_f22_temp

data_f22_plus_autolab_all_temp <- data_f22_plus_autolab_all[data_f22_plus_autolab_all$Progress == "100",]
data_f22_plus_autolab_all <- data_f22_plus_autolab_all_temp


data_f22_plus_autolab_week4_temp <- data_f22_plus_autolab_week4[data_f22_plus_autolab_week4$Progress == "100",]
data_f22_plus_autolab_week4 <- data_f22_plus_autolab_week4_temp

data_f22_plus_autolab_week5_temp <- data_f22_plus_autolab_week5[data_f22_plus_autolab_week5$Progress == "100",]
data_f22_plus_autolab_week5 <- data_f22_plus_autolab_week5_temp


data_f22_plus_autolab_week7_temp <- data_f22_plus_autolab_week7[data_f22_plus_autolab_week7$Progress == "100",]
data_f22_plus_autolab_week7 <- data_f22_plus_autolab_week7_temp

data_f22$Assignments.Current.Points <- as.numeric(data_f22$Assignments.Current.Points)
data_f22$Assignments.Final.Points <- as.numeric(data_f22$Assignments.Final.Points)
data_f22$Assignments.Current.Score <- as.numeric(data_f22$Assignments.Current.Score)
data_f22$Assignments.Unposted.Current.Score <- as.numeric(data_f22$Assignments.Unposted.Current.Score)
data_f22$Assignments.Final.Score <- as.numeric(data_f22$Assignments.Final.Score)
data_f22$Assignments.Unposted.Final.Score <- as.numeric(data_f22$Assignments.Unposted.Final.Score)

data_f22$Quizzes.Current.Points <- as.numeric(data_f22$Current.Points)
data_f22$Quizzes.Final.Points <- as.numeric(data_f22$Final.Points)
data_f22$Quizzes.Current.Score <- as.numeric(data_f22$Current.Score)
data_f22$Quizzes.Unposted.Current.Score  <- as.numeric(data_f22$Unposted.Current.Score )
data_f22$Quizzes.Final.Score <- as.numeric(data_f22$Final.Score)
data_f22$Quizzes.Unposted.Final.Score <- as.numeric(data_f22$Unposted.Final.Score)

#names(data_f22)

data_f22$Recitations.Current.Points <- as.numeric(data_f22$Recitations.Current.Points)
data_f22$Recitations.Final.Points <- as.numeric(data_f22$Recitations.Final.Points)
data_f22$Recitations.Current.Score <- as.numeric(data_f22$Recitations.Current.Score)
data_f22$Recitations.Unposted.Current.Score  <- as.numeric(data_f22$Recitations.Unposted.Current.Score )
data_f22$Recitations.Final.Score <- as.numeric(data_f22$Recitations.Final.Score)
data_f22$Recitations.Unposted.Final.Score <- as.numeric(data_f22$Recitations.Unposted.Final.Score)

data_f22$Current.Points <- as.numeric(data_f22$Current.Points)
data_f22$Final.Points <- as.numeric(data_f22$Final.Points)
data_f22$Current.Score <- as.numeric(data_f22$Current.Score)
data_f22$Unposted.Current.Score  <- as.numeric(data_f22$Unposted.Current.Score )
data_f22$Final.Score <- as.numeric(data_f22$Final.Score)
data_f22$Unposted.Final.Score <- as.numeric(data_f22$Unposted.Final.Score)

data_f22_plus_autolab_all$Current.Points <- as.numeric(data_f22_plus_autolab_all$Current.Points)
data_f22_plus_autolab_all$Final.Points <- as.numeric(data_f22_plus_autolab_all$Final.Points)
data_f22_plus_autolab_all$Current.Score <- as.numeric(data_f22_plus_autolab_all$Current.Score)
data_f22_plus_autolab_all$Unposted.Current.Score  <- as.numeric(data_f22_plus_autolab_all$Unposted.Current.Score )
data_f22_plus_autolab_all$Final.Score <- as.numeric(data_f22_plus_autolab_all$Final.Score)
data_f22_plus_autolab_all$Unposted.Final.Score <- as.numeric(data_f22_plus_autolab_all$Unposted.Final.Score)
data_f22_plus_autolab_all$Progress <- as.numeric(data_f22_plus_autolab_all$Progress)
data_f22_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_all$Duration..in.seconds.)


#str(data_f22_plus_autolab_all)

data_f22_plus_autolab_week4$Current.Points <- as.numeric(data_f22_plus_autolab_week4$Current.Points)
data_f22_plus_autolab_week4$Final.Points <- as.numeric(data_f22_plus_autolab_week4$Final.Points)
data_f22_plus_autolab_week4$Current.Score <- as.numeric(data_f22_plus_autolab_week4$Current.Score)
data_f22_plus_autolab_week4$Unposted.Current.Score  <- as.numeric(data_f22_plus_autolab_week4$Unposted.Current.Score )
data_f22_plus_autolab_week4$Final.Score <- as.numeric(data_f22_plus_autolab_week4$Final.Score)
data_f22_plus_autolab_week4$Unposted.Final.Score <- as.numeric(data_f22_plus_autolab_week4$Unposted.Final.Score)
data_f22_plus_autolab_week4$Progress <- as.numeric(data_f22_plus_autolab_week4$Progress)
data_f22_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_week4$Duration..in.seconds.)



data_f22_plus_autolab_week5$Current.Points <- as.numeric(data_f22_plus_autolab_week5$Current.Points)
data_f22_plus_autolab_week5$Final.Points <- as.numeric(data_f22_plus_autolab_week5$Final.Points)
data_f22_plus_autolab_week5$Current.Score <- as.numeric(data_f22_plus_autolab_week5$Current.Score)
data_f22_plus_autolab_week5$Unposted.Current.Score  <- as.numeric(data_f22_plus_autolab_week5$Unposted.Current.Score )
data_f22_plus_autolab_week5$Final.Score <- as.numeric(data_f22_plus_autolab_week5$Final.Score)
data_f22_plus_autolab_week5$Unposted.Final.Score <- as.numeric(data_f22_plus_autolab_week5$Unposted.Final.Score)
data_f22_plus_autolab_week5$Progress <- as.numeric(data_f22_plus_autolab_week5$Progress)
data_f22_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_f22_plus_autolab_week5$Duration..in.seconds.)


data_f22_plus_autolab_week7$Current.Points <- as.numeric(data_f22_plus_autolab_week7$Current.Points)
data_f22_plus_autolab_week7$Final.Points <- as.numeric(data_f22_plus_autolab_week7$Final.Points)
data_f22_plus_autolab_week7$Current.Score <- as.numeric(data_f22_plus_autolab_week7$Current.Score)
data_f22_plus_autolab_week7$Unposted.Current.Score  <- as.numeric(data_f22_plus_autolab_week7$Unposted.Current.Score )
data_f22_plus_autolab_week7$Final.Score <- as.numeric(data_f22_plus_autolab_week7$Final.Score)
data_f22_plus_autolab_week7$Unposted.Final.Score <- as.numeric(data_f22_plus_autolab_week7$Unposted.Final.Score)

# data_f20$unit_of_reg_cd <- as.factor(data_f20$unit_of_reg_cd)
# data_f20$subj_cd <- as.factor(data_f20$subj_cd)
# data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)
# data_f20$housing_status_cd <- as.factor(data_f20$housing_status_cd)
# data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
# data_f20$deg_earned_curric_cd1 <- as.factor(data_f20$deg_earned_curric_cd1)
# data_f20$deg_minor_curric_cd1 <- as.factor(data_f20$deg_minor_curric_cd1)

#data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_f22_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_all$curr_admit_type_cd)
data_f22_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week4$curr_admit_type_cd)
data_f22_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week5$curr_admit_type_cd)
data_f22_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f22_plus_autolab_week7$curr_admit_type_cd)

data_f22_plus_autolab_all$sending_school_type_cd <- as.factor(data_f22_plus_autolab_all$sending_school_type_cd)
data_f22_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week4$sending_school_type_cd)
data_f22_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week5$sending_school_type_cd)
data_f22_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f22_plus_autolab_week7$sending_school_type_cd)

data_f22_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_all$orig_admit_type_cd)
data_f22_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week4$orig_admit_type_cd)
data_f22_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week5$orig_admit_type_cd)
data_f22_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f22_plus_autolab_week7$orig_admit_type_cd)

data_f22_plus_autolab_all$citizen_status_cd <- as.factor(data_f22_plus_autolab_all$citizen_status_cd)
data_f22_plus_autolab_week4$citizen_status_cd <- as.factor(data_f22_plus_autolab_week4$citizen_status_cd)
data_f22_plus_autolab_week5$citizen_status_cd <- as.factor(data_f22_plus_autolab_week5$citizen_status_cd)
data_f22_plus_autolab_week7$citizen_status_cd <- as.factor(data_f22_plus_autolab_week7$citizen_status_cd)

#str(data_f22_plus_autolab_all)

# Split data into numeric and not numeric features

data_num <- select_if(data_f22, is.numeric)
data_not_num <- data_f22[ , !(names(data_f22) %in% names(data_num))]
str(data_f22_plus_autolab_week4$Final.Points)

data_num_plus_autolab_all <- select_if(data_f22_plus_autolab_all, is.numeric)
data_not_num_plus_autolab_all <- data_f22_plus_autolab_all[ , !(names(data_f22_plus_autolab_all) %in% names(data_num_plus_autolab_all))]

data_num_plus_autolab_w4 <- select_if(data_f22_plus_autolab_week4, is.numeric)
data_not_num_plus_autolab_w4 <- data_f22_plus_autolab_week4[ , !(names(data_f22_plus_autolab_week4) %in% names(data_num_plus_autolab_w4))]

data_num_plus_autolab_w5 <- select_if(data_f22_plus_autolab_week5, is.numeric)
data_not_num_plus_autolab_w5 <- data_f22_plus_autolab_week5[ , !(names(data_f22_plus_autolab_week5) %in% names(data_num_plus_autolab_w5))]

data_num_plus_autolab_w7 <- select_if(data_f22_plus_autolab_week7, is.numeric)
data_not_num_plus_autolab_w7 <- data_f22_plus_autolab_week7[ , !(names(data_f22_plus_autolab_week7) %in% names(data_num_plus_autolab_w7))]

names(data_num_plus_autolab)
names(data_not_num_plus_autolab)

data_not_num_plus_autolab$Q38_1
names(data_not_num)

table(data_not_num$Section) # out
table(data_not_num$Current.Grade) # out b/c it corr with predicted var
table(data_not_num$Unposted.Current.Grade) # out: same as the one before
table(data_not_num$Final.Grade) # ibid
table(data_not_num$Unposted.Final.Grade) # ibid

table(data_not_num$gender_cd) # can stay
table(data_not_num$ethnic_cd) # can stay
table(data_not_num$SUCCESS) # has to stay

table(data_not_num$EndDate) # can go, probably irrelevant
table(data_not_num$Progress) # can go after selecting students who completed it 100%
table(data_not_num$Finished) # same as before, can remove those for whom it's FALSE and then get rid of column
table(data_not_num$RecordedDate) # irrelevant
table(data_not_num$UserLanguage) # can go, everyone is ENG
table(data_not_num$Q38) # can go, everyone agrees to take part of research


table(data_not_num$Q1) # can stay, major

table(data_not_num$Q33) # second major, lots of NA, may not have enough variablilty.. 
table(data_not_num$Q32) # minor, 206 undecided.., may not be a great feature
table(data_not_num$Q30) # second minor, 406 none, may need to get rid of

table(data_not_num$Q2) # keep.. reason they are taking CS1

table(data_not_num$Q2_8_TEXT) # mostly empty, get rid of
table(data_not_num$Q2_6_TEXT) # mostly empty, get rid of
table(data_not_num$Q44) # empty, get rid of
table(data_not_num$Q44_8_TEXT) # empty, get rid of
table(data_not_num$Q44_6_TEXT) # empty, get rid of

table(data_not_num$Q4) # Keep, prior experience

table(data_not_num$Q4_6_TEXT) # mostly empty
table(data_not_num$Q34) # mostly empty

table(data_not_num$Q35) # Keep, how difficult do they think the class will be
table(data_not_num$Q37) # get rid of, how would they explain cs

# Q43 is empty: get rid of it!

table(data_not_num$Q43)

# 30 variables so far.

# attitudes are 24 questions/variables.

# attitude qs  Q3, Q5 - Q12, Q14 - 28  1 + 8 + 15 = 24 questions
table(data_not_num$Q3)
table(data_not_num$Q5)
table(data_not_num$Q6)
table(data_not_num$Q7)
table(data_not_num$Q8)


# etc.

# Q38: Which of the following have you done this year or do you plan to do? Check all that apply. 
# I have no interest in doing this 0 / I did this in the past year 3 / I plan to do this in the future 2 / I'm not sure 1

table(data_not_num$Q38_1) # Participate in social events sponsored by the CS Living Learning Community
table(data_not_num$Q38_2) # Take a 200-level computer science course
table(data_not_num$Q38_3) # Matriculate as a computer science major
table(data_not_num$Q38_4) # Become a learning assistant for a computer science course
table(data_not_num$Q38_5) # Become a learning assistant for a computer science course
table(data_not_num$Q38_6) # Become a peer mentor in computer science
table(data_not_num$Q38_7) # Participate in the Reboot program, supporting high schools with CS instruction
table(data_not_num$Q38_8) # Do an internship that involves computer science
table(data_not_num$Q38_9) # Do academic research in the computer science field
table(data_not_num$Q38_10) # Join a professional organization or attend a professional conference in computer science
table(data_not_num$Q38_11) # Pursue a career in computer science
table(data_not_num$Q38_12) # Pursue a career in a field related to computer science

names(data_num)

data_num$ENGAGEMENT <- 0

data_num$E1[data_not_num$Q38_1 == "I did this in the past year"] <- 3
data_num$E1[data_not_num$Q38_1 == "I plan to do this in the future"] <- 2
data_num$E1[data_not_num$Q38_1 == "I'm not sure"] <- 1
data_num$E1[data_not_num$Q38_1 == "I have no interest in doing this"] <- 0
data_num$E1[data_not_num$Q38_1 == ""] <- 1.5

#table(data_num$E1)

data_num$E2[data_not_num$Q38_2 == "I did this in the past year"] <- 3
data_num$E2[data_not_num$Q38_2 == "I plan to do this in the future"] <- 2
data_num$E2[data_not_num$Q38_2 == "I'm not sure"] <- 1
data_num$E2[data_not_num$Q38_2 == "I have no interest in doing this"] <- 0
data_num$E2[data_not_num$Q38_2 == ""] <- 1.5

data_num$E3[data_not_num$Q38_3 == "I did this in the past year"] <- 3
data_num$E3[data_not_num$Q38_3 == "I plan to do this in the future"] <- 2
data_num$E3[data_not_num$Q38_3 == "I'm not sure"] <- 1
data_num$E3[data_not_num$Q38_3 == "I have no interest in doing this"] <- 0
data_num$E3[data_not_num$Q38_3 == ""] <- 1.5

data_num$E4[data_not_num$Q38_4 == "I did this in the past year"] <- 3
data_num$E4[data_not_num$Q38_4 == "I plan to do this in the future"] <- 2
data_num$E4[data_not_num$Q38_4 == "I'm not sure"] <- 1
data_num$E4[data_not_num$Q38_4 == "I have no interest in doing this"] <- 0
data_num$E4[data_not_num$Q38_4 == ""] <- 1.5

data_num$E5[data_not_num$Q38_5 == "I did this in the past year"] <- 3
data_num$E5[data_not_num$Q38_5 == "I plan to do this in the future"] <- 2
data_num$E5[data_not_num$Q38_5 == "I'm not sure"] <- 1
data_num$E5[data_not_num$Q38_5 == "I have no interest in doing this"] <- 0
data_num$E5[data_not_num$Q38_5 == ""] <- 1.5

data_num$E6[data_not_num$Q38_6 == "I did this in the past year"] <- 3
data_num$E6[data_not_num$Q38_6 == "I plan to do this in the future"] <- 2
data_num$E6[data_not_num$Q38_6 == "I'm not sure"] <- 1
data_num$E6[data_not_num$Q38_6 == "I have no interest in doing this"] <- 0
data_num$E6[data_not_num$Q38_6 == ""] <- 1.5

data_num$E7[data_not_num$Q38_7 == "I did this in the past year"] <- 3
data_num$E7[data_not_num$Q38_7 == "I plan to do this in the future"] <- 2
data_num$E7[data_not_num$Q38_7 == "I'm not sure"] <- 1
data_num$E7[data_not_num$Q38_7 == "I have no interest in doing this"] <- 0
data_num$E7[data_not_num$Q38_7 == ""] <- 1.5

data_num$E8[data_not_num$Q38_8 == "I did this in the past year"] <- 3
data_num$E8[data_not_num$Q38_8 == "I plan to do this in the future"] <- 2
data_num$E8[data_not_num$Q38_8 == "I'm not sure"] <- 1
data_num$E8[data_not_num$Q38_8 == "I have no interest in doing this"] <- 0
data_num$E8[data_not_num$Q38_8 == ""] <- 1.5

data_num$E9[data_not_num$Q38_9 == "I did this in the past year"] <- 3
data_num$E9[data_not_num$Q38_9 == "I plan to do this in the future"] <- 2
data_num$E9[data_not_num$Q38_9 == "I'm not sure"] <- 1
data_num$E9[data_not_num$Q38_9 == "I have no interest in doing this"] <- 0
data_num$E9[data_not_num$Q38_9 == ""] <- 1.5

data_num$E10[data_not_num$Q38_10 == "I did this in the past year"] <- 3
data_num$E10[data_not_num$Q38_10 == "I plan to do this in the future"] <- 2
data_num$E10[data_not_num$Q38_10 == "I'm not sure"] <- 1
data_num$E10[data_not_num$Q38_10 == "I have no interest in doing this"] <- 0
data_num$E10[data_not_num$Q38_10 == ""] <- 1.5

data_num$E11[data_not_num$Q38_11 == "I did this in the past year"] <- 3
data_num$E11[data_not_num$Q38_11 == "I plan to do this in the future"] <- 2
data_num$E11[data_not_num$Q38_11 == "I'm not sure"] <- 1
data_num$E11[data_not_num$Q38_11 == "I have no interest in doing this"] <- 0
data_num$E11[data_not_num$Q38_11 == ""] <- 1.5

data_num$E12[data_not_num$Q38_12 == "I did this in the past year"] <- 3
data_num$E12[data_not_num$Q38_12 == "I plan to do this in the future"] <- 2
data_num$E12[data_not_num$Q38_12 == "I'm not sure"] <- 1
data_num$E12[data_not_num$Q38_12 == "I have no interest in doing this"] <- 0
data_num$E12[data_not_num$Q38_12 == ""] <- 1.5

data_num$ENGAGEMENT <- data_num$E1 + data_num$E2 + data_num$E3 + data_num$E4 + data_num$E5 + data_num$E6 + data_num$E7 + data_num$E8 + data_num$E9 + data_num$E10 + data_num$E11 + data_num$E12

#all

data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_all$E1)

data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == ""] <- 1.5

data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == ""] <- 1.5


data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == ""] <- 1.5

data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == ""] <- 1.5

data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == ""] <- 1.5

data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == ""] <- 1.5

data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == ""] <- 1.5

data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == ""] <- 1.5

data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == ""] <- 1.5

data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == ""] <- 1.5

data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == ""] <- 1.5

data_num_plus_autolab_all$ENGAGEMENT <- data_num_plus_autolab_all$E1 + data_num_plus_autolab_all$E2 + data_num_plus_autolab_all$E3 + data_num_plus_autolab_all$E4 + data_num_plus_autolab_all$E5 + data_num_plus_autolab_all$E6 + data_num_plus_autolab_all$E7 + data_num_plus_autolab_all$E8 + data_num_plus_autolab_all$E9 + data_num_plus_autolab_all$E10 + data_num_plus_autolab_all$E11 + data_num_plus_autolab_all$E12


#W4

data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w4$E1)

data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w4$ENGAGEMENT <- data_num_plus_autolab_w4$E1 + data_num_plus_autolab_w4$E2 + data_num_plus_autolab_w4$E3 + data_num_plus_autolab_w4$E4 + data_num_plus_autolab_w4$E5 + data_num_plus_autolab_w4$E6 + data_num_plus_autolab_w4$E7 + data_num_plus_autolab_w4$E8 + data_num_plus_autolab_w4$E9 + data_num_plus_autolab_w4$E10 + data_num_plus_autolab_w4$E11 + data_num_plus_autolab_w4$E12

#w5

data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w5$E1)

data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w5$ENGAGEMENT <- data_num_plus_autolab_w5$E1 + data_num_plus_autolab_w5$E2 + data_num_plus_autolab_w5$E3 + data_num_plus_autolab_w5$E4 + data_num_plus_autolab_w5$E5 + data_num_plus_autolab_w5$E6 + data_num_plus_autolab_w5$E7 + data_num_plus_autolab_w5$E8 + data_num_plus_autolab_w5$E9 + data_num_plus_autolab_w5$E10 + data_num_plus_autolab_w5$E11 + data_num_plus_autolab_w5$E12

#w7

data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w7$E1)

data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w7$ENGAGEMENT <- data_num_plus_autolab_w7$E1 + data_num_plus_autolab_w7$E2 + data_num_plus_autolab_w7$E3 + data_num_plus_autolab_w7$E4 + data_num_plus_autolab_w7$E5 + data_num_plus_autolab_w7$E6 + data_num_plus_autolab_w7$E7 + data_num_plus_autolab_w7$E8 + data_num_plus_autolab_w7$E9 + data_num_plus_autolab_w7$E10 + data_num_plus_autolab_w7$E11 + data_num_plus_autolab_w7$E12


table(data_num$ENGAGEMENT)

# Q39 : To what extent do you agree with the following statements? 
# Strongly agree / Somewhat agree / Not sure / Somewhat disagree / Strongly disagree

table(data_not_num$Q39_1) # With hard work, anyone can become an expert in computer science
table(data_not_num$Q39_2) # Women and men have the same level of natural ability and talent in computer science
table(data_not_num$Q39_3) # Women are less capable of success in computer science than men
table(data_not_num$Q39_4) # Men are more likely to excel in careers that involve computing than women are
table(data_not_num$Q39_5) # Men are more capable than women at solving computing problems


data_num$A1[data_not_num$Q39_1 == "Strongly agree"] <- 3
data_num$A1[data_not_num$Q39_1 == "Somewhat agree"] <- 2
data_num$A1[data_not_num$Q39_1 == "Not sure"] <- 1.5
data_num$A1[data_not_num$Q39_1 == "Somewhat disagree"] <- 1
data_num$A1[data_not_num$Q39_1 == "Strongly disagree"] <- 0
data_num$A1[data_not_num$Q39_1 == ""] <- 1.5

data_num$A2[data_not_num$Q39_2 == "Strongly agree"] <- 3
data_num$A2[data_not_num$Q39_2 == "Somewhat agree"] <- 2
data_num$A2[data_not_num$Q39_2 == "Not sure"] <- 1.5
data_num$A2[data_not_num$Q39_2 == "Somewhat disagree"] <- 1
data_num$A2[data_not_num$Q39_2 == "Strongly disagree"] <- 0
data_num$A2[data_not_num$Q39_2 == ""] <- 1.5

# inverted scale
data_num$A3[data_not_num$Q39_3 == "Strongly disagree"] <- 3
data_num$A3[data_not_num$Q39_3 == "Somewhat disagree"] <- 2
data_num$A3[data_not_num$Q39_3 == "Not sure"] <- 1.5
data_num$A3[data_not_num$Q39_3 == "Somewhat agree"] <- 1
data_num$A3[data_not_num$Q39_3 == "Strongly sagree"] <- 0
data_num$A3[data_not_num$Q39_3 == ""] <- 1.5

data_num$A4[data_not_num$Q39_4 == "Strongly disagree"] <- 3
data_num$A4[data_not_num$Q39_4 == "Somewhat disagree"] <- 2
data_num$A4[data_not_num$Q39_4 == "Not sure"] <- 1.5
data_num$A4[data_not_num$Q39_4 == "Somewhat agree"] <- 1
data_num$A4[data_not_num$Q39_4 == "Strongly agree"] <- 0
data_num$A4[data_not_num$Q39_4 == ""] <- 1.5

data_num$A5[data_not_num$Q39_5 == "Strongly disagree"] <- 3
data_num$A5[data_not_num$Q39_5 == "Somewhat disagree"] <- 2
data_num$A5[data_not_num$Q39_5 == "Not sure"] <- 1.5
data_num$A5[data_not_num$Q39_5 == "Somewhat agree"] <- 1
data_num$A5[data_not_num$Q39_5 == "Strongly agree"] <- 0
data_num$A5[data_not_num$Q39_5 == ""] <- 1.5

data_num$ATTITUDES <- data_num$A1 + data_num$A2 + data_num$A3 + data_num$A4  + data_num$A5

# all

data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == ""] <- 1.5

data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == ""] <- 1.5

data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == ""] <- 1.5

data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == ""] <- 1.5

data_num_plus_autolab_all$ATTITUDES <- data_num_plus_autolab_all$A1 + data_num_plus_autolab_all$A2 + data_num_plus_autolab_all$A3 + data_num_plus_autolab_all$A4 + data_num_plus_autolab_all$A5



# W4

data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w4$ATTITUDES <- data_num_plus_autolab_w4$A1 + data_num_plus_autolab_w4$A2 + data_num_plus_autolab_w4$A3 + data_num_plus_autolab_w4$A4 + data_num_plus_autolab_w4$A5

# w5

data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w5$A1[data_f22_plus_autolab_week5$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A2[data_f22_plus_autolab_week5$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A3[data_f22_plus_autolab_week5$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A4[data_f22_plus_autolab_week5$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A5[data_f22_plus_autolab_week5$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w5$ATTITUDES <- data_num_plus_autolab_w5$A1 + data_num_plus_autolab_w5$A2 + data_num_plus_autolab_w5$A3 + data_num_plus_autolab_w5$A4 + data_num_plus_autolab_w5$A5

# w7

data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w7$ATTITUDES <- data_num_plus_autolab_w7$A1 + data_num_plus_autolab_w7$A2 + data_num_plus_autolab_w7$A3 + data_num_plus_autolab_w7$A4 + data_num_plus_autolab_w7$A5


# Divide the value for ATTITUDES by 15, which is the max possible value

#data_num$ATTITUDES <- data_num$ATTITUDES/15
#data_num_plus_autolab$ATTITUDES <- data_num_plus_autolab$ATTITUDES/15


names(data_not_num)


str(data_num_plus_autolab)
str(data_not_num_plus_autolab)
names(data_f20_plus_autolab_week7)

# REPLACE ATTITUDES WITH NUMBERS

data_num$BELONGINGNESS <- 0
data_num$CONFIDENCE <- 0
data_num$INTEREST <- 0
data_num$USEFULNESS <- 0
data_num$ENCOURAGEMENT <- 0

data_num_plus_autolab_all$BELONGINGNESS <- 0
data_num_plus_autolab_all$CONFIDENCE <- 0
data_num_plus_autolab_all$INTEREST <- 0
data_num_plus_autolab_all$USEFULNESS <- 0
data_num_plus_autolab_all$ENCOURAGEMENT <- 0
data_num_plus_autolab_all$Q6_B <- 0 
data_num_plus_autolab_all$Q3_B <- 0 
data_num_plus_autolab_all$Q11_B <- 0 
data_num_plus_autolab_all$Q57_B <- 0 
data_num_plus_autolab_all$Q21_B <- 0 
data_num_plus_autolab_all$Q26_B <- 0


data_num_plus_autolab_w4$BELONGINGNESS <- 0
data_num_plus_autolab_w4$CONFIDENCE <- 0
data_num_plus_autolab_w4$INTEREST <- 0
data_num_plus_autolab_w4$USEFULNESS <- 0
data_num_plus_autolab_w4$ENCOURAGEMENT <- 0
data_num_plus_autolab_w4$Q6_B <- 0 
data_num_plus_autolab_w4$Q3_B <- 0 
data_num_plus_autolab_w4$Q11_B <- 0 
data_num_plus_autolab_w4$Q57_B <- 0 
data_num_plus_autolab_w4$Q21_B <- 0 
data_num_plus_autolab_w4$Q26_B <- 0

data_num_plus_autolab_w5$BELONGINGNESS <- 0
data_num_plus_autolab_w5$CONFIDENCE <- 0
data_num_plus_autolab_w5$INTEREST <- 0
data_num_plus_autolab_w5$USEFULNESS <- 0
data_num_plus_autolab_w5$ENCOURAGEMENT <- 0
data_num_plus_autolab_w5$Q6_B <- 0 
data_num_plus_autolab_w5$Q3_B <- 0 
data_num_plus_autolab_w5$Q11_B <- 0 
data_num_plus_autolab_w5$Q57_B <- 0 
data_num_plus_autolab_w5$Q21_B <- 0 
data_num_plus_autolab_w5$Q26_B <- 0

data_num_plus_autolab_w7$BELONGINGNESS <- 0
data_num_plus_autolab_w7$CONFIDENCE <- 0
data_num_plus_autolab_w7$INTEREST <- 0
data_num_plus_autolab_w7$USEFULNESS <- 0
data_num_plus_autolab_w7$ENCOURAGEMENT <- 0
data_num_plus_autolab_w7$Q6_B <- 0 
data_num_plus_autolab_w7$Q3_B <- 0 
data_num_plus_autolab_w7$Q11_B <- 0 
data_num_plus_autolab_w7$Q57_B <- 0 
data_num_plus_autolab_w7$Q21_B <- 0 
data_num_plus_autolab_w7$Q26_B <- 0


# Belongingness

names(data_not_num)

data_num$Q6_B[data_not_num$Q6 == "Strongly Agree"] <- 3
data_num$Q6_B[data_not_num$Q6 == "Agree"] <- 2
data_num$Q6_B[data_not_num$Q6 == "Disagree"] <- 1
data_num$Q6_B[data_not_num$Q6 == "Strongly Disagree"] <- 0
data_num$Q6_B[data_not_num$Q6 == ""] <- 1.5 # average between agree and disagree

data_num$Q11_B[data_not_num$Q11 == "Strongly Agree"] <- 3
data_num$Q11_B[data_not_num$Q11 == "Agree"] <- 2
data_num$Q11_B[data_not_num$Q11 == "Disagree"] <- 1
data_num$Q11_B[data_not_num$Q11 == "Strongly Disagree"] <- 0
data_num$Q11_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q21_B[data_not_num$Q21 == "Strongly Agree"] <- 3
data_num$Q21_B[data_not_num$Q21 == "Agree"] <- 2
data_num$Q21_B[data_not_num$Q21 == "Disagree"] <- 1
data_num$Q21_B[data_not_num$Q21 == "Strongly Disagree"] <- 0
data_num$Q21_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q26_B[data_not_num$Q26 == "Strongly Agree"] <- 3
data_num$Q26_B[data_not_num$Q26 == "Agree"] <- 2
data_num$Q26_B[data_not_num$Q26 == "Disagree"] <- 1
data_num$Q26_B[data_not_num$Q26 == "Strongly Disagree"] <- 0
data_num$Q26_B[data_not_num$Q26 == ""] <- 1.5

data_num$BELONGINGNESS <- data_num$Q6_B + data_num$Q11_B + data_num$Q21_B + data_num$Q26_B

# all

data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Agree"] <- 2
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Disagree"] <- 1
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Agree"] <- 2
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Disagree"] <- 1
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == ""] <- 1.5

data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Agree"] <- 2
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Disagree"] <- 1
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == ""] <- 1.5

data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Agree"] <- 2
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Disagree"] <- 1
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == ""] <- 1.5

data_num_plus_autolab_all$BELONGINGNESS <- data_num_plus_autolab_all$Q6_B + data_num_plus_autolab_all$Q11_B + data_num_plus_autolab_all$Q21_B + data_num_plus_autolab_all$Q26_B


# W4

data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Agree"] <- 2
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Agree"] <- 2
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == ""] <- 1.5

data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Agree"] <- 2
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == ""] <- 1.5

data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Agree"] <- 2
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == ""] <- 1.5

data_num_plus_autolab_w4$BELONGINGNESS <- data_num_plus_autolab_w4$Q6_B + data_num_plus_autolab_w4$Q11_B + data_num_plus_autolab_w4$Q21_B + data_num_plus_autolab_w4$Q26_B

# w5

data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Agree"] <- 2
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Agree"] <- 2
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == ""] <- 1.5

data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Agree"] <- 2
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == ""] <- 1.5

data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Agree"] <- 2
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == ""] <- 1.5

data_num_plus_autolab_w5$BELONGINGNESS <- data_num_plus_autolab_w5$Q6_B + data_num_plus_autolab_w5$Q11_B + data_num_plus_autolab_w5$Q21_B + data_num_plus_autolab_w5$Q26_B

# w7

data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Agree"] <- 2
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Agree"] <- 2
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == ""] <- 1.5

data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Agree"] <- 2
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == ""] <- 1.5

data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Agree"] <- 2
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == ""] <- 1.5

data_num_plus_autolab_w7$BELONGINGNESS <- data_num_plus_autolab_w7$Q6_B + data_num_plus_autolab_w7$Q11_B + data_num_plus_autolab_w7$Q21_B + data_num_plus_autolab_w7$Q26_B



# Confidence
# Q3, Q9, Q15, Q19, Q24

data_num$Q3_B[data_not_num$Q3 == "Strongly Agree"] <- 3
data_num$Q3_B[data_not_num$Q3 == "Agree"] <- 2
data_num$Q3_B[data_not_num$Q3 == "Disagree"] <- 1
data_num$Q3_B[data_not_num$Q3 == "Strongly Disagree"] <- 0
data_num$Q3_B[data_not_num$Q3 == ""] <- 1.5

data_num$Q9_B[data_not_num$Q9 == "Strongly Agree"] <- 3
data_num$Q9_B[data_not_num$Q9 == "Agree"] <- 2
data_num$Q9_B[data_not_num$Q9 == "Disagree"] <- 1
data_num$Q9_B[data_not_num$Q9 == "Strongly Disagree"] <- 0
data_num$Q9_B[data_not_num$Q9 == ""] <- 1.5

data_num$Q15_B[data_not_num$Q15 == "Strongly Agree"] <- 3
data_num$Q15_B[data_not_num$Q15 == "Agree"] <- 2
data_num$Q15_B[data_not_num$Q15 == "Disagree"] <- 1
data_num$Q15_B[data_not_num$Q15 == "Strongly Disagree"] <- 0
data_num$Q15_B[data_not_num$Q15 == ""] <- 1.5


data_num$Q19_B[data_not_num$Q19 == "Strongly Agree"] <- 3
data_num$Q19_B[data_not_num$Q19 == "Agree"] <- 2
data_num$Q19_B[data_not_num$Q19 == "Disagree"] <- 1
data_num$Q19_B[data_not_num$Q19 == "Strongly Disagree"] <- 0
data_num$Q19_B[data_not_num$Q19 == ""] <- 1.5


data_num$Q24_B[data_not_num$Q24 == "Strongly Agree"] <- 3
data_num$Q24_B[data_not_num$Q24 == "Agree"] <- 2
data_num$Q24_B[data_not_num$Q24 == "Disagree"] <- 1
data_num$Q24_B[data_not_num$Q24 == "Strongly Disagree"] <- 0
data_num$Q24_B[data_not_num$Q24 == ""] <- 1.5

data_num$CONFIDENCE <- data_num$Q3_B + data_num$Q9_B + data_num$Q15_B + data_num$Q19_B + data_num$Q24_B

# all

data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Agree"] <- 2
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Disagree"] <- 1
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == ""] <- 1.5

data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Agree"] <- 2
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Disagree"] <- 1
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == ""] <- 1.5

data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Agree"] <- 2
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Disagree"] <- 1
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == ""] <- 1.5


data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Agree"] <- 2
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Disagree"] <- 1
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == ""] <- 1.5


data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Agree"] <- 2
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Disagree"] <- 1
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == ""] <- 1.5

data_num_plus_autolab_all$CONFIDENCE <- data_num_plus_autolab_all$Q3_B + data_num_plus_autolab_all$Q9_B + data_num_plus_autolab_all$Q15_B + data_num_plus_autolab_all$Q19_B + data_num_plus_autolab_all$Q24_B


# W4

data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Agree"] <- 2
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == ""] <- 1.5

data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Agree"] <- 2
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == ""] <- 1.5

data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Agree"] <- 2
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == ""] <- 1.5


data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Agree"] <- 2
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == ""] <- 1.5


data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Agree"] <- 2
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == ""] <- 1.5

data_num_plus_autolab_w4$CONFIDENCE <- data_num_plus_autolab_w4$Q3_B + data_num_plus_autolab_w4$Q9_B + data_num_plus_autolab_w4$Q15_B + data_num_plus_autolab_w4$Q19_B + data_num_plus_autolab_w4$Q24_B

# w5

data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Agree"] <- 2
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == ""] <- 1.5

data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Agree"] <- 2
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == ""] <- 1.5

data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Agree"] <- 2
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == ""] <- 1.5


data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Agree"] <- 2
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == ""] <- 1.5


data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Agree"] <- 2
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == ""] <- 1.5

data_num_plus_autolab_w5$CONFIDENCE <- data_num_plus_autolab_w5$Q3_B + data_num_plus_autolab_w5$Q9_B + data_num_plus_autolab_w5$Q15_B + data_num_plus_autolab_w5$Q19_B + data_num_plus_autolab_w5$Q24_B

# w7

data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Agree"] <- 2
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == ""] <- 1.5

data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Agree"] <- 2
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == ""] <- 1.5

data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Agree"] <- 2
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == ""] <- 1.5


data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Agree"] <- 2
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == ""] <- 1.5


data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Agree"] <- 2
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == ""] <- 1.5

data_num_plus_autolab_w7$CONFIDENCE <- data_num_plus_autolab_w7$Q3_B + data_num_plus_autolab_w7$Q9_B + data_num_plus_autolab_w7$Q15_B + data_num_plus_autolab_w7$Q19_B + data_num_plus_autolab_w7$Q24_B


# Interest
#Q5, Q10, Q16, Q20, Q25

data_num$Q5_B[data_not_num$Q5 == "Strongly Agree"] <- 3
data_num$Q5_B[data_not_num$Q5 == "Agree"] <- 2
data_num$Q5_B[data_not_num$Q5 == "Disagree"] <- 1
data_num$Q5_B[data_not_num$Q5 == "Strongly Disagree"] <- 0
data_num$Q5_B[data_not_num$Q5 == ""] <- 1.5

data_num$Q10_B[data_not_num$Q10 == "Strongly Agree"] <- 3
data_num$Q10_B[data_not_num$Q10 == "Agree"] <- 2
data_num$Q10_B[data_not_num$Q10 == "Disagree"] <- 1
data_num$Q10_B[data_not_num$Q10 == "Strongly Disagree"] <- 0
data_num$Q10_B[data_not_num$Q10 == ""] <- 1.5

data_num$Q16_B[data_not_num$Q16 == "Strongly Agree"] <- 3
data_num$Q16_B[data_not_num$Q16 == "Agree"] <- 2
data_num$Q16_B[data_not_num$Q16 == "Disagree"] <- 1
data_num$Q16_B[data_not_num$Q16 == "Strongly Disagree"] <- 0
data_num$Q16_B[data_not_num$Q16 == ""] <- 1.5


data_num$Q20_B[data_not_num$Q20 == "Strongly Agree"] <- 3
data_num$Q20_B[data_not_num$Q20 == "Agree"] <- 2
data_num$Q20_B[data_not_num$Q20 == "Disagree"] <- 1
data_num$Q20_B[data_not_num$Q20 == "Strongly Disagree"] <- 0
data_num$Q20_B[data_not_num$Q20 == ""] <- 1.5


data_num$Q25_B[data_not_num$Q25 == "Strongly Agree"] <- 3
data_num$Q25_B[data_not_num$Q25 == "Agree"] <- 2
data_num$Q25_B[data_not_num$Q25 == "Disagree"] <- 1
data_num$Q25_B[data_not_num$Q25 == "Strongly Disagree"] <- 0
data_num$Q25_B[data_not_num$Q25 == ""] <- 1.5

data_num$INTEREST <- data_num$Q5_B + data_num$Q10_B + data_num$Q16_B + data_num$Q20_B + data_num$Q25_B

#all

data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Agree"] <- 2
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Disagree"] <- 1
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == ""] <- 1.5

data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Agree"] <- 2
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Disagree"] <- 1
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == ""] <- 1.5

data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Agree"] <- 2
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Disagree"] <- 1
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == ""] <- 1.5


data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Agree"] <- 2
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Disagree"] <- 1
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == ""] <- 1.5


data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Agree"] <- 2
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Disagree"] <- 1
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == ""] <- 1.5

data_num_plus_autolab_all$INTEREST <- data_num_plus_autolab_all$Q5_B + data_num_plus_autolab_all$Q10_B + data_num_plus_autolab_all$Q16_B + data_num_plus_autolab_all$Q20_B + data_num_plus_autolab_all$Q25_B


#W4

data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Agree"] <- 2
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == ""] <- 1.5

data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Agree"] <- 2
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == ""] <- 1.5

data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Agree"] <- 2
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == ""] <- 1.5


data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Agree"] <- 2
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == ""] <- 1.5


data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Agree"] <- 2
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == ""] <- 1.5

data_num_plus_autolab_w4$INTEREST <- data_num_plus_autolab_w4$Q5_B + data_num_plus_autolab_w4$Q10_B + data_num_plus_autolab_w4$Q16_B + data_num_plus_autolab_w4$Q20_B + data_num_plus_autolab_w4$Q25_B

#W5

data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Agree"] <- 2
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == ""] <- 1.5

data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Agree"] <- 2
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == ""] <- 1.5

data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Agree"] <- 2
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == ""] <- 1.5


data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Agree"] <- 2
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == ""] <- 1.5


data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Agree"] <- 2
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == ""] <- 1.5

data_num_plus_autolab_w5$INTEREST <- data_num_plus_autolab_w5$Q5_B + data_num_plus_autolab_w5$Q10_B + data_num_plus_autolab_w5$Q16_B + data_num_plus_autolab_w5$Q20_B + data_num_plus_autolab_w5$Q25_B

#w7

data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Agree"] <- 2
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == ""] <- 1.5

data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Agree"] <- 2
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == ""] <- 1.5

data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Agree"] <- 2
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == ""] <- 1.5


data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Agree"] <- 2
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == ""] <- 1.5


data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Agree"] <- 2
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == ""] <- 1.5

data_num_plus_autolab_w7$INTEREST <- data_num_plus_autolab_w7$Q5_B + data_num_plus_autolab_w7$Q10_B + data_num_plus_autolab_w7$Q16_B + data_num_plus_autolab_w7$Q20_B + data_num_plus_autolab_w7$Q25_B


# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_num$Q7_B[data_not_num$Q7 == "Strongly Agree"] <- 3
data_num$Q7_B[data_not_num$Q7 == "Agree"] <- 2
data_num$Q7_B[data_not_num$Q7 == "Disagree"] <- 1
data_num$Q7_B[data_not_num$Q7 == "Strongly Disagree"] <- 0
data_num$Q7_B[data_not_num$Q7 == ""] <- 1.5

data_num$Q12_B[data_not_num$Q12 == "Strongly Agree"] <- 3
data_num$Q12_B[data_not_num$Q12 == "Agree"] <- 2
data_num$Q12_B[data_not_num$Q12 == "Disagree"] <- 1
data_num$Q12_B[data_not_num$Q12 == "Strongly Disagree"] <- 0
data_num$Q12_B[data_not_num$Q12 == ""] <- 1.5

data_num$Q17_B[data_not_num$Q17 == "Strongly Agree"] <- 3
data_num$Q17_B[data_not_num$Q17 == "Agree"] <- 2
data_num$Q17_B[data_not_num$Q17 == "Disagree"] <- 1
data_num$Q17_B[data_not_num$Q17 == "Strongly Disagree"] <- 0
data_num$Q17_B[data_not_num$Q17 == ""] <- 1.5


data_num$Q22_B[data_not_num$Q22 == "Strongly Agree"] <- 3
data_num$Q22_B[data_not_num$Q22 == "Agree"] <- 2
data_num$Q22_B[data_not_num$Q22 == "Disagree"] <- 1
data_num$Q22_B[data_not_num$Q22 == "Strongly Disagree"] <- 0
data_num$Q22_B[data_not_num$Q22 == ""] <- 1.5


data_num$Q27_B[data_not_num$Q27 == "Strongly Agree"] <- 3
data_num$Q27_B[data_not_num$Q27 == "Agree"] <- 2
data_num$Q27_B[data_not_num$Q27 == "Disagree"] <- 1
data_num$Q27_B[data_not_num$Q27 == "Strongly Disagree"] <- 0
data_num$Q27_B[data_not_num$Q27 == ""] <- 1.5

data_num$USEFULNESS <- data_num$Q7_B + data_num$Q12_B + data_num$Q17_B + data_num$Q22_B + data_num$Q27_B

#all

data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Agree"] <- 2
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Disagree"] <- 1
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == ""] <- 1.5

data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Agree"] <- 2
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Disagree"] <- 1
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == ""] <- 1.5

data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Agree"] <- 2
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Disagree"] <- 1
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == ""] <- 1.5


data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Agree"] <- 2
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Disagree"] <- 1
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == ""] <- 1.5


data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Agree"] <- 2
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Disagree"] <- 1
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == ""] <- 1.5

data_num_plus_autolab_all$USEFULNESS <- data_num_plus_autolab_all$Q7_B + data_num_plus_autolab_all$Q12_B + data_num_plus_autolab_all$Q17_B + data_num_plus_autolab_all$Q22_B + data_num_plus_autolab_all$Q27_B


#W4

data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Agree"] <- 2
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == ""] <- 1.5

data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Agree"] <- 2
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == ""] <- 1.5

data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Agree"] <- 2
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == ""] <- 1.5


data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Agree"] <- 2
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == ""] <- 1.5


data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Agree"] <- 2
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == ""] <- 1.5

data_num_plus_autolab_w4$USEFULNESS <- data_num_plus_autolab_w4$Q7_B + data_num_plus_autolab_w4$Q12_B + data_num_plus_autolab_w4$Q17_B + data_num_plus_autolab_w4$Q22_B + data_num_plus_autolab_w4$Q27_B

# W5

data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Agree"] <- 2
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == ""] <- 1.5

data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Agree"] <- 2
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == ""] <- 1.5

data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Agree"] <- 2
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == ""] <- 1.5


data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Agree"] <- 2
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == ""] <- 1.5


data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Agree"] <- 2
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == ""] <- 1.5

data_num_plus_autolab_w5$USEFULNESS <- data_num_plus_autolab_w5$Q7_B + data_num_plus_autolab_w5$Q12_B + data_num_plus_autolab_w5$Q17_B + data_num_plus_autolab_w5$Q22_B + data_num_plus_autolab_w5$Q27_B

#w7

data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Agree"] <- 2
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == ""] <- 1.5

data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Agree"] <- 2
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == ""] <- 1.5

data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Agree"] <- 2
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == ""] <- 1.5


data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Agree"] <- 2
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == ""] <- 1.5


data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Agree"] <- 2
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == ""] <- 1.5

data_num_plus_autolab_w7$USEFULNESS <- data_num_plus_autolab_w7$Q7_B + data_num_plus_autolab_w7$Q12_B + data_num_plus_autolab_w7$Q17_B + data_num_plus_autolab_w7$Q22_B + data_num_plus_autolab_w7$Q27_B



# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_num$Q8_B[data_not_num$Q8 == "Strongly Agree"] <- 3
data_num$Q8_B[data_not_num$Q8 == "Agree"] <- 2
data_num$Q8_B[data_not_num$Q8 == "Disagree"] <- 1
data_num$Q8_B[data_not_num$Q8 == "Strongly Disagree"] <- 0
data_num$Q8_B[data_not_num$Q8 == ""] <- 1.5

data_num$Q14_B[data_not_num$Q14 == "Strongly Agree"] <- 3
data_num$Q14_B[data_not_num$Q14 == "Agree"] <- 2
data_num$Q14_B[data_not_num$Q14 == "Disagree"] <- 1
data_num$Q14_B[data_not_num$Q14 == "Strongly Disagree"] <- 0
data_num$Q14_B[data_not_num$Q14 == ""] <- 1.5

data_num$Q18_B[data_not_num$Q18 == "Strongly Agree"] <- 3
data_num$Q18_B[data_not_num$Q18 == "Agree"] <- 2
data_num$Q18_B[data_not_num$Q18 == "Disagree"] <- 1
data_num$Q18_B[data_not_num$Q18 == "Strongly Disagree"] <- 0
data_num$Q18_B[data_not_num$Q18 == ""] <- 1.5


data_num$Q23_B[data_not_num$Q23 == "Strongly Agree"] <- 3
data_num$Q23_B[data_not_num$Q23 == "Agree"] <- 2
data_num$Q23_B[data_not_num$Q23 == "Disagree"] <- 1
data_num$Q23_B[data_not_num$Q23 == "Strongly Disagree"] <- 0
data_num$Q23_B[data_not_num$Q23 == ""] <- 1.5


data_num$Q28_B[data_not_num$Q28 == "Strongly Agree"] <- 3
data_num$Q28_B[data_not_num$Q28 == "Agree"] <- 2
data_num$Q28_B[data_not_num$Q28 == "Disagree"] <- 1
data_num$Q28_B[data_not_num$Q28 == "Strongly Disagree"] <- 0
data_num$Q28_B[data_not_num$Q28 == ""] <- 1.5

data_num$ENCOURAGEMENT <- data_num$Q8_B + data_num$Q14_B + data_num$Q18_B + data_num$Q23_B + data_num$Q28_B

# all

data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Agree"] <- 2
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Disagree"] <- 1
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == ""] <- 1.5

data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Agree"] <- 2
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Disagree"] <- 1
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == ""] <- 1.5

data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Agree"] <- 2
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Disagree"] <- 1
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == ""] <- 1.5


data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Agree"] <- 2
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Disagree"] <- 1
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == ""] <- 1.5


data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Agree"] <- 2
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Disagree"] <- 1
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == ""] <- 1.5

data_num_plus_autolab_all$ENCOURAGEMENT <- data_num_plus_autolab_all$Q8_B + data_num_plus_autolab_all$Q14_B + data_num_plus_autolab_all$Q18_B + data_num_plus_autolab_all$Q23_B + data_num_plus_autolab_all$Q28_B


# W4

data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Agree"] <- 2
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == ""] <- 1.5

data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Agree"] <- 2
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == ""] <- 1.5

data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Agree"] <- 2
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == ""] <- 1.5


data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Agree"] <- 2
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == ""] <- 1.5


data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Agree"] <- 2
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == ""] <- 1.5

data_num_plus_autolab_w4$ENCOURAGEMENT <- data_num_plus_autolab_w4$Q8_B + data_num_plus_autolab_w4$Q14_B + data_num_plus_autolab_w4$Q18_B + data_num_plus_autolab_w4$Q23_B + data_num_plus_autolab_w4$Q28_B

# w5

data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Agree"] <- 2
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == ""] <- 1.5

data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Agree"] <- 2
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == ""] <- 1.5

data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Agree"] <- 2
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == ""] <- 1.5


data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Agree"] <- 2
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == ""] <- 1.5


data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Agree"] <- 2
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == ""] <- 1.5

data_num_plus_autolab_w5$ENCOURAGEMENT <- data_num_plus_autolab_w5$Q8_B + data_num_plus_autolab_w5$Q14_B + data_num_plus_autolab_w5$Q18_B + data_num_plus_autolab_w5$Q23_B + data_num_plus_autolab_w5$Q28_B

# w7

data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Agree"] <- 2
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == ""] <- 1.5

data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Agree"] <- 2
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == ""] <- 1.5

data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Agree"] <- 2
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == ""] <- 1.5


data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Agree"] <- 2
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == ""] <- 1.5


data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Agree"] <- 2
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == ""] <- 1.5

data_num_plus_autolab_w7$ENCOURAGEMENT <- data_num_plus_autolab_w7$Q8_B + data_num_plus_autolab_w7$Q14_B + data_num_plus_autolab_w7$Q18_B + data_num_plus_autolab_w7$Q23_B + data_num_plus_autolab_w7$Q28_B



names(data_num_plus_autolab)

# DONE WITH ATTITUDES

data_f22_num_untrimmed <- data_num
data_f22_num_untrimmed_plus_autolab_all <-  data_num_plus_autolab_all
data_f22_num_untrimmed_plus_autolab_w4 <-  data_num_plus_autolab_w4
data_f22_num_untrimmed_plus_autolab_w5 <-  data_num_plus_autolab_w5
data_f22_num_untrimmed_plus_autolab_w7 <-  data_num_plus_autolab_w7

data_f22_not_num_untrimmed <- data_not_num
data_f22_not_num_untrimmed_plus_autolab_all <-  data_not_num_plus_autolab_all
data_f22_not_num_untrimmed_plus_autolab_w4 <-  data_not_num_plus_autolab_w4
data_f22_not_num_untrimmed_plus_autolab_w5 <-  data_not_num_plus_autolab_w5
data_f22_not_num_untrimmed_plus_autolab_w7 <-  data_not_num_plus_autolab_w7

# Remove unneeded attributes

# DATA_NOT_NUM

names(data_not_num)
selected_variables <- c("NetID", "gender_cd", "ethnic_cd", "course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","citizen_status_cd","SUCCESS", "Q1","Q2", "Q4", "Q35")

data_not_num_ss <- data_not_num # SAVE!

data_not_num_temp <- data_not_num[selected_variables]
data_not_num <- data_not_num_temp

# Same for Autolab data
names(data_not_num_plus_autolab_w4)

data_not_num_plus_autolab_ss_all <- data_not_num_plus_autolab_all # SAVE!
data_not_num_plus_autolab_temp_all <- data_not_num_plus_autolab_all[selected_variables]
data_not_num_plus_autolab_all <- data_not_num_plus_autolab_temp_all


data_not_num_plus_autolab_ss_w4 <- data_not_num_plus_autolab_w4 # SAVE!
data_not_num_plus_autolab_temp_w4 <- data_not_num_plus_autolab_w4[selected_variables]
data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_temp_w4

data_not_num_plus_autolab_ss_w5 <- data_not_num_plus_autolab_w5 # SAVE!
data_not_num_plus_autolab_temp_w5 <- data_not_num_plus_autolab_w5[selected_variables]
data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_temp_w5

data_not_num_plus_autolab_ss_w7 <- data_not_num_plus_autolab_w7 # SAVE!
data_not_num_plus_autolab_temp_w7 <- data_not_num_plus_autolab_w7[selected_variables]
data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_temp_w7


# DATA_NUM

# Paste from Spring 2021

names(data_num)
names(data_num_plus_autolab)

selected_variables <- c("Final.Points","Exam1", "Exam2","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14","RecWeek15", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_ss <- data_num # SAVE!

data_num_temp <- data_num[selected_variables]
names(data_num_temp)
data_num <- data_num_temp

# DATA_NUM_WITH_AUTOLAB

names(data_num_plus_autolab_w4)

data_num_plus_autolab_w4$max_submissions
selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES","max_submissions", "max_time_f_l_subm", "max_time_consecutive_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission", "min_time_b4_deadline_first_submission",  "max_time_b4_deadline_last_submission", "min_time_b4_deadline_last_submission")

#selected_variables <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.", "X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.", "X8..Find.Duplicate..1067540.", "X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.", "X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.", "Recitation.10..1129728.", "Recitation.2..1129729.", "Recitation.3..1129730.", "Recitation.7..1129732.", "Recitation.4..1129733.","Recitation.12..1129734.", "Recitation.5..1129735.", "Recitation.8..1129736.", "Recitation.13..1129737.",  "Recitation.11..1129738.", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_plus_autolab_ss_all <- data_num_plus_autolab_all # SAVE!
data_num_plus_autolab_temp_all <- data_num_plus_autolab_all[selected_variables]
data_num_plus_autolab_all <- data_num_plus_autolab_temp_all

data_num_plus_autolab_ss_w4 <- data_num_plus_autolab_w4 # SAVE!
data_num_plus_autolab_temp_w4 <- data_num_plus_autolab_w4[selected_variables]
data_num_plus_autolab_w4 <- data_num_plus_autolab_temp_w4

data_num_plus_autolab_ss_w5 <- data_num_plus_autolab_w5 # SAVE!
data_num_plus_autolab_temp_w5 <- data_num_plus_autolab_w5[selected_variables]
data_num_plus_autolab_w5 <- data_num_plus_autolab_temp_w5

data_num_plus_autolab_ss_w7 <- data_num_plus_autolab_w7 # SAVE!
data_num_plus_autolab_temp_w7 <- data_num_plus_autolab_w7[selected_variables]
data_num_plus_autolab_w7 <- data_num_plus_autolab_temp_w7

names(data_num_plus_autolab_w7)


# select meaningful variables from non-numeric features
str(data_not_num)

success_s <- data_not_num$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7$SUCCESS


# SAVE THE NUM AND NOT NUM DATA FRAMES

data_num_s <- data_num
data_not_num_s <- data_not_num

data_num_a_s_all <- data_num_plus_autolab_all
data_not_num_a_s_all <-data_not_num_plus_autolab_all

data_num_a_s_w4 <- data_num_plus_autolab_w4
data_not_num_a_s_w4 <-data_not_num_plus_autolab_w4

data_num_a_s_w5 <- data_num_plus_autolab_w5
data_not_num_a_s_w5 <-data_not_num_plus_autolab_w5

data_num_a_s_w7 <- data_num_plus_autolab_w7
data_not_num_a_s_w7 <-data_not_num_plus_autolab_w7



# Done paste Spring 2021

names(data_num)

table(data_num$Exit.Survey..1127030.) # get rid of
table(data_num$Recitations.Final.Points) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of
# etc etc etc Recitations...
# same for Quizzes and Assignments! we won't have this info half way through the semester
# same for Final.Points, etc.

# DATA_NUM_WITH_AUTOLAB

names(data_num)

names(data_not_num)

## RECOVER NUM AND NOT NUM DATA FRAMES

names(data_not_num)
names(data_num)

drops_not_num <- c("NetID", "SUCCESS")

data_not_num <- data_not_num[ , !(names(data_not_num) %in% drops_not_num)]
#data_not_num$Duration..in.seconds. <- as.integer(data_not_num$Duration..in.seconds.)

data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all[ , !(names(data_not_num_plus_autolab_all) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4[ , !(names(data_not_num_plus_autolab_w4) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5[ , !(names(data_not_num_plus_autolab_w5) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7[ , !(names(data_not_num_plus_autolab_w7) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


str(data_not_num)

library(lattice)
library(caret)
# one-hot encoding


# get rid of constant(empty) fields, otherwise can't do one-hot encoding because of errors..
library(janitor)
data_not_num_saved <- data_not_num
data_not_num <- remove_constant(data_not_num_saved, na.rm= TRUE)

data_not_num_plus_autolab_saved_all <- data_not_num_plus_autolab_all
data_not_num_plus_autolab_all <- remove_constant(data_not_num_plus_autolab_saved_all, na.rm= TRUE)


data_not_num_plus_autolab_saved_w4 <- data_not_num_plus_autolab_w4
data_not_num_plus_autolab_w4 <- remove_constant(data_not_num_plus_autolab_saved_w4, na.rm= TRUE)

data_not_num_plus_autolab_saved_w5 <- data_not_num_plus_autolab_w5
data_not_num_plus_autolab_w5 <- remove_constant(data_not_num_plus_autolab_saved_w5, na.rm= TRUE)

data_not_num_plus_autolab_saved_w7 <- data_not_num_plus_autolab_w7
data_not_num_plus_autolab_w7 <- remove_constant(data_not_num_plus_autolab_saved_w7, na.rm= TRUE)



library(caret)

dummy <- dummyVars(" ~ .", data=data_not_num)
final_df <- data.frame(predict(dummy, newdata=data_not_num))

dummy_a_all <- dummyVars(" ~ .", data=data_not_num_plus_autolab_all)
final_df_a_all <- data.frame(predict(dummy_a_all, newdata=data_not_num_plus_autolab_all))


dummy_a_w4 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w4)
final_df_a_w4 <- data.frame(predict(dummy_a_w4, newdata=data_not_num_plus_autolab_w4))

dummy_a_w5 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w5)
final_df_a_w5 <- data.frame(predict(dummy_a_w5, newdata=data_not_num_plus_autolab_w5))

dummy_a_w7 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w7)
final_df_a_w7 <- data.frame(predict(dummy_a_w7, newdata=data_not_num_plus_autolab_w7))


# Need to check for zero-variance features.. save to do later ...

# Mix numeric and categorical variables
data_f22_preprocessed <- cbind(data_num, final_df)
data_f22_preprocessed$SUCCESS <- success_s
data_f22_no_na <- na.omit(data_f22_preprocessed)
success_s <- data_f22_no_na$SUCCESS
data_f22_no_na <- data_f22_no_na[, !(names(data_f22_no_na) %in% c("SUCCESS"))]
length(success_s)
nrow(data_f22_no_na)
#table(data_num$RecWeek2)
#var(data_num$RecWeek3)
#names(data_f22_no_na)

#checking for constant columns...
data_f22_no_na_saved <- data_f22_no_na
data_f22_no_na <- remove_constant(data_f22_no_na_saved, na.rm= TRUE)

# plus autolab...

#all

data_f22_preprocessed_a_all <- cbind(data_num_plus_autolab_all, final_df_a_all)
data_f22_preprocessed_a_all$SUCCESS <- success_s_a_all
data_f22_no_na_plus_autolab_all <- na.omit(data_f22_preprocessed_a_all)
success_a_all <- data_f22_no_na_plus_autolab_all$SUCCESS
data_f22_no_na_plus_autolab_all <- data_f22_no_na_plus_autolab_all[, !(names(data_f22_no_na_plus_autolab_all) %in% c("SUCCESS"))]
length(success_a_all)
nrow(data_f22_no_na_plus_autolab_all)


#checking for constant columns...
data_f22_no_na_plus_autolab_saved_all <- data_f22_no_na_plus_autolab_all
data_f22_no_na_plus_autolab_all <- remove_constant(data_f22_no_na_plus_autolab_saved_all, na.rm= TRUE)


#W4

data_f22_preprocessed_a_w4 <- cbind(data_num_plus_autolab_w4, final_df_a_w4)
data_f22_preprocessed_a_w4$SUCCESS <- success_s_a_w4
data_f22_no_na_plus_autolab_w4 <- na.omit(data_f22_preprocessed_a_w4)
success_a_w4 <- data_f22_no_na_plus_autolab_w4$SUCCESS
data_f22_no_na_plus_autolab_w4 <- data_f22_no_na_plus_autolab_w4[, !(names(data_f22_no_na_plus_autolab_w4) %in% c("SUCCESS"))]
length(success_a_w4)
nrow(data_f22_no_na_plus_autolab_w4)


#checking for constant columns...
data_f22_no_na_plus_autolab_saved_w4 <- data_f22_no_na_plus_autolab_w4
data_f22_no_na_plus_autolab_w4 <- remove_constant(data_f22_no_na_plus_autolab_saved_w4, na.rm= TRUE)

#W5

data_f22_preprocessed_a_w5 <- cbind(data_num_plus_autolab_w5, final_df_a_w5)
data_f22_preprocessed_a_w5$SUCCESS <- success_s_a_w5
data_f22_no_na_plus_autolab_w5 <- na.omit(data_f22_preprocessed_a_w5)
success_a_w5 <- data_f22_no_na_plus_autolab_w5$SUCCESS
data_f22_no_na_plus_autolab_w5 <- data_f22_no_na_plus_autolab_w5[, !(names(data_f22_no_na_plus_autolab_w5) %in% c("SUCCESS"))]
length(success_a_w5)
nrow(data_f22_no_na_plus_autolab_w5)


#checking for constant columns...
data_f22_no_na_plus_autolab_saved_w5 <- data_f22_no_na_plus_autolab_w5
data_f22_no_na_plus_autolab_w5 <- remove_constant(data_f22_no_na_plus_autolab_saved_w5, na.rm= TRUE)

#w7

data_f22_preprocessed_a_w7 <- cbind(data_num_plus_autolab_w7, final_df_a_w7)
data_f22_preprocessed_a_w7$SUCCESS <- success_s_a_w7
data_f22_no_na_plus_autolab_w7 <- na.omit(data_f22_preprocessed_a_w7)
success_a_w7 <- data_f22_no_na_plus_autolab_w7$SUCCESS
data_f22_no_na_plus_autolab_w7 <- data_f22_no_na_plus_autolab_w7[, !(names(data_f22_no_na_plus_autolab_w7) %in% c("SUCCESS"))]
length(success_a_w7)
nrow(data_f22_no_na_plus_autolab_w7)

#checking for constant columns...
data_f22_no_na_plus_autolab_saved_w7 <- data_f22_no_na_plus_autolab_w7
data_f22_no_na_plus_autolab_w7 <- remove_constant(data_f22_no_na_plus_autolab_saved_w7, na.rm= TRUE)


# Need to check for correlated features
cor_matrix <- cor(data_f22_no_na)
#write.csv(cor_matrix,file="cortmp.csv")

for (i in 1:nrow(cor_matrix)){
  correlations <-  which((abs(cor_matrix[i,]) > 0.90))
  if(length(correlations)> 0){
    print(colnames(data_f22_no_na)[i])
    print(correlations)
  }
}

# REMOVE CORRELATED VARS: COPY FROM SPRING 2021 data

indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

remove_corrs <- data_f22_no_na[-c(indexes_to_drop)]

data_f22_no_na_no_corr <- remove_corrs

names(remove_corrs)

cor_matrix <- cor(data_f22_no_na_no_corr)
indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

# indexes to drop is now empty, which means NO CORRELATIONS OVER 0.9!
names(data_f22_no_na_no_corr)

# DONE REMOVONG CORR VARS


# AUTOLAB DATA : remove correlated variables

# all

# Need to check for correlated features
cor_matrix_a <- cor(data_f22_no_na_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f22_no_na_plus_autolab_all[-c(indexes_to_drop)]
data_f22_no_na_no_corr_plus_autolab_all <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f22_no_na_no_corr_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)# should be empty


# W4

# Need to check for correlated features
cor_matrix_a <- cor(data_f22_no_na_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f22_no_na_plus_autolab_w4[-c(indexes_to_drop)]
data_f22_no_na_no_corr_plus_autolab_w4 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f22_no_na_no_corr_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# w5

# Need to check for correlated features
cor_matrix_a <- cor(data_f22_no_na_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f22_no_na_plus_autolab_w5[-c(indexes_to_drop)]
data_f22_no_na_no_corr_plus_autolab_w5 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f22_no_na_no_corr_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# w7

# Need to check for correlated features
cor_matrix_a <- cor(data_f22_no_na_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f22_no_na_plus_autolab_w7[-c(indexes_to_drop)]
data_f22_no_na_no_corr_plus_autolab_w7 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f22_no_na_no_corr_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)


# empty, no more variables with correlations over 0.9!

# get rid of features with variance under 0.005
# copied from Spring 2021
# BETTER?? Apply variances on data without correlations

variances <- sapply(data_f22_no_na_no_corr, var)
variances_a_all <- sapply(data_f22_no_na_no_corr_plus_autolab_all, var)
variances_a_w4 <- sapply(data_f22_no_na_no_corr_plus_autolab_w4, var)
variances_a_w5 <- sapply(data_f22_no_na_no_corr_plus_autolab_w5, var)
variances_a_w7 <- sapply(data_f22_no_na_no_corr_plus_autolab_w7, var)


low_variance_features <- c()

colnames(data_f22_no_na_no_corr)[1]

for (i in 1:ncol(data_f22_no_na_no_corr)){
  
  if(variances[i] < 0.005)
  {
    low_variance_features <- c(low_variance_features, colnames(data_f22_no_na_no_corr)[i])
    print(i)
    print(colnames(data_f22_no_na_no_corr)[i])
    print(variances[i])
  }
}  

# Data Autolab 

# ALL

low_variance_features_a_all <- c()

for (i in 1:ncol(data_f22_no_na_no_corr_plus_autolab_all)){
  
  if(variances_a_all[i] < 0.005)
  {
    low_variance_features_a_all <- c(low_variance_features_a_all, colnames(data_f22_no_na_no_corr_plus_autolab_all)[i])
    print(i)
    print(colnames(data_f22_no_na_no_corr_plus_autolab_all)[i])
    print(variances_a_all[i])
  }
}  

#W4

low_variance_features_a_w4 <- c()

for (i in 1:ncol(data_f22_no_na_no_corr_plus_autolab_w4)){
  
  if(variances_a_w4[i] < 0.005)
  {
    low_variance_features_a_w4 <- c(low_variance_features_a_w4, colnames(data_f22_no_na_no_corr_plus_autolab_w4)[i])
    print(i)
    print(colnames(data_f22_no_na_no_corr_plus_autolab_w4)[i])
    print(variances_a_w4[i])
  }
}  

#w5

low_variance_features_a_w5 <- c()

for (i in 1:ncol(data_f22_no_na_no_corr_plus_autolab_w5)){
  
  if(variances_a_w5[i] < 0.005)
  {
    low_variance_features_a_w5 <- c(low_variance_features_a_w5, colnames(data_f22_no_na_no_corr_plus_autolab_w5)[i])
    print(i)
    print(colnames(data_f22_no_na_no_corr_plus_autolab_w5)[i])
    print(variances_a_w5[i])
  }
}  

#W7

low_variance_features_a_w7 <- c()

for (i in 1:ncol(data_f22_no_na_no_corr_plus_autolab_w7)){
  
  if(variances_a_w7[i] < 0.005)
  {
    low_variance_features_a_w7 <- c(low_variance_features_a_w7, colnames(data_f22_no_na_no_corr_plus_autolab_w7)[i])
    print(i)
    print(colnames(data_f22_no_na_no_corr_plus_autolab_w7)[i])
    print(variances_a_w7[i])
  }
}  



# done copied from Spring 2021

# Drop low variance features from Spring 2021 code

drops_n <- low_variance_features
drops_n_a_all <- low_variance_features_a_all
drops_n_a_w4 <- low_variance_features_a_w4
drops_n_a_w5 <- low_variance_features_a_w5
drops_n_a_w7 <- low_variance_features_a_w7


data_f22_final <- data_f22_no_na_no_corr[ , !(names(data_f22_no_na_no_corr) %in% drops_n)]
data_f22_no_na_no_corr_no_low_var <- data_f22_final

data_f22_final_a_all <- data_f22_no_na_no_corr_plus_autolab_all[ , !(names(data_f22_no_na_no_corr_plus_autolab_all) %in% drops_n_a_all)]
data_f22_no_na_no_corr_no_low_var_a_all <- data_f22_final_a_all


data_f22_final_a_w4 <- data_f22_no_na_no_corr_plus_autolab_w4[ , !(names(data_f22_no_na_no_corr_plus_autolab_w4) %in% drops_n_a_w4)]
data_f22_no_na_no_corr_no_low_var_a_w4 <- data_f22_final_a_w4

data_f22_final_a_w5 <- data_f22_no_na_no_corr_plus_autolab_w5[ , !(names(data_f22_no_na_no_corr_plus_autolab_w5) %in% drops_n_a_w5)]
data_f22_no_na_no_corr_no_low_var_a_w5 <- data_f22_final_a_w5

data_f22_final_a_w7 <- data_f22_no_na_no_corr_plus_autolab_w7[ , !(names(data_f22_no_na_no_corr_plus_autolab_w7) %in% drops_n_a_w7)]
data_f22_no_na_no_corr_no_low_var_a_w7 <- data_f22_final_a_w7


data_f22_final$SUCCESS <- success_s
data_f22_final_a_all$SUCCESS <- success_a_all
data_f22_final_a_w4$SUCCESS <- success_a_w4
data_f22_final_a_w5$SUCCESS <- success_a_w5
data_f22_final_a_w7$SUCCESS <- success_a_w7

data_f22_no_na_no_corr_no_low_var$SUCCESS <- success_s
data_f22_no_na_no_corr_no_low_var_a_all$SUCCESS <- success_a_all
data_f22_no_na_no_corr_no_low_var_a_w4$SUCCESS <- success_a_w4
data_f22_no_na_no_corr_no_low_var_a_w5$SUCCESS <- success_a_w5
data_f22_no_na_no_corr_no_low_var_a_w7$SUCCESS <- success_a_w7


names(data_f22_no_na_no_corr_no_low_var_a_w4)
# DONE with Drop low variance features from Spring 2021 code


table(data_f20_no_na_a$SUCCESS)
# check again for zero variance
#final_df_no_na <- remove_constant(data_no_na, na.rm= TRUE)


# Feature importance

control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)

# for data with autolab up to week 7 ...
control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final_a, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)


# RECURSIVE FEATURE ELIMINATION... NOT DONE!

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=10)
# run the RFE algorithm
results <- rfe(PimaIndiansDiabetes[,1:8], PimaIndiansDiabetes[,9], sizes=c(1:8), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))


# Write the final result in a file
getwd()
write.csv(data_f22_final, "Data_F22_After_Processing.csv", row.names = FALSE)
write.csv(data_f22_final_a_all, "Data_F22_After_Processing_w_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_f22_final_a_w4, "Data_F22_After_Processing_w_Autolab_W4.csv", row.names = FALSE)
write.csv(data_f22_final_a_w5, "Data_F22_After_Processing_w_Autolab_W5.csv", row.names = FALSE)
write.csv(data_f22_final_a_w7, "Data_F22_After_Processing_w_Autolab_W7.csv", row.names = FALSE)

write.csv(data_f22_final, "Data_F22_After_Processing_600_750.csv", row.names = FALSE)
write.csv(data_f22_final_a_all, "Data_F22_After_Processing_w_Autolab_ALL_600_750.csv", row.names = FALSE)
write.csv(data_f22_final_a_w4, "Data_F22_After_Processing_w_Autolab_W4_600_750.csv", row.names = FALSE)
write.csv(data_f22_final_a_w5, "Data_F22_After_Processing_w_Autolab_W5_600_750.csv", row.names = FALSE)
write.csv(data_f22_final_a_w7, "Data_F22_After_Processing_w_Autolab_W7_600_750.csv", row.names = FALSE)

data_f22_final <- read.csv("Data_F22_After_Processing.csv", header = TRUE)
data_f22_final_a_all <- read.csv("Data_F22_After_Processing_w_Autolab_ALL.csv", header = TRUE)
data_f22_final_a_w4 <- read.csv("Data_F22_After_Processing_w_Autolab_W4.csv", header = TRUE)
data_f22_final_a_w5 <- read.csv("Data_F22_After_Processing_w_Autolab_W5.csv", header = TRUE)
data_f22_final_a_w7 <- read.csv("Data_F22_After_Processing_w_Autolab_W7.csv", header = TRUE)


# DATA WITH ALL THE FEATURES: data_f20_no_na
# No correlated features and no features with 0 variance

names(data_f22_final)

#data_f22_final <- read.csv("Data_F22_After_Processing.csv", header = TRUE)
#data_f22_final_a_all <- read.csv("Data_F22_After_Processing_w_Autolab_ALL.csv", header = TRUE)
#data_f22_final_a_w4 <- read.csv("Data_F22_After_Processing_w_Autolab_W4.csv", header = TRUE)
#data_f22_final_a_w5 <- read.csv("Data_F22_After_Processing_w_Autolab_W5.csv", header = TRUE)
#data_f22_final_a_w7 <- read.csv("Data_F22_After_Processing_w_Autolab_W7.csv", header = TRUE)


#####################################################
#
#---------  Fall 2023 START HERE  !!  -------------
#
#####################################################

#####################################################
#
#---------  Fall 2022 START HERE  !!  -------------
#
#####################################################

# intro survey has only students who have given consent for research
data_intro_f23_111_t <- data_intro_f23_111[data_intro_f23_111$Q38=="Yes, I understand.",]
data_intro_f23_111 <- data_intro_f23_111_t


# STEP 1: Merge Canvas+SAS with Intro survey
data_all1 <- merge(data_canvas_and_sas_f23_111, data_intro_f23_111, by = "NetID")
names(data_all1)
data_all_plus_autolab_all <- merge(data_all1, data_autolab_f23)
data_all_plus_autolab_w4 <- merge(data_all1, data_autolab_f23_w4)
data_all_plus_autolab_w5 <- merge(data_all1, data_autolab_f23_w5)
data_all_plus_autolab_w7 <- merge(data_all1, data_autolab_f23_w7)
names(data_all_plus_autolab_w7)
# Turn SUCCESS into a factor so we can do classification on it

data_all1$SUCCESS <- as.factor(data_all1$SUCCESS)
table(data_all1$SUCCESS)
data_all_plus_autolab_all$SUCCESS <- as.factor(data_all_plus_autolab_all$SUCCESS)
data_all_plus_autolab_w4$SUCCESS <- as.factor(data_all_plus_autolab_w4$SUCCESS)
data_all_plus_autolab_w5$SUCCESS <- as.factor(data_all_plus_autolab_w5$SUCCESS)
data_all_plus_autolab_w7$SUCCESS <- as.factor(data_all_plus_autolab_w7$SUCCESS)

write.csv(data_all_plus_autolab_all, "f23_Beginnning_Of_Processing_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w4, "f23_Beginnning_Of_Processing_Autolab_W4.csv", row.names = FALSE)
write.csv(data_all1, "f23_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w5, "f23_Beginnning_Of_Processing_Autolab_W5.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w7, "f23_Beginnning_Of_Processing_Autolab_W7.csv", row.names = FALSE)

# ADD AUTOLAB FEATURES

# all

data_all_plus_autolab_all$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_first_submission)
data_all_plus_autolab_all$max_time_f_l_subm <- as.integer(data_all_plus_autolab_all$max_time_f_l_subm)
data_all_plus_autolab_all$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_all$max_time_consecutive_submissions)
data_all_plus_autolab_all$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_last_submission)
data_all_plus_autolab_all$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_first_submission)
data_all_plus_autolab_all$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_last_submission)


# w4

data_all_plus_autolab_w4$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w4$max_time_f_l_subm)
data_all_plus_autolab_w4$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w4$max_time_consecutive_submissions)
data_all_plus_autolab_w4$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7
data_f23_plus_autolab_week4 <- data_all_plus_autolab_w4
write.csv(data_f23_plus_autolab_week4, "f23_W4_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

# W5

data_all_plus_autolab_w5$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w5$max_time_f_l_subm)
data_all_plus_autolab_w5$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w5$max_time_consecutive_submissions)
data_all_plus_autolab_w5$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_f23 <- data_all1
data_f23_plus_autolab_week5 <- data_all_plus_autolab_w5

write.csv(data_f23_plus_autolab_week5, "f23_W5_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)


# W7

data_all_plus_autolab_w7$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w7$max_time_f_l_subm)
data_all_plus_autolab_w7$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w7$max_time_consecutive_submissions)
data_all_plus_autolab_w7$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_f23 <- data_all1
data_f23_plus_autolab_all <- data_all_plus_autolab_all
data_f23_plus_autolab_week4 <- data_all_plus_autolab_w4
data_f23_plus_autolab_week5 <- data_all_plus_autolab_w5
data_f23_plus_autolab_week7 <- data_all_plus_autolab_w7

write.csv(data_f23_plus_autolab_week7, "f23_W_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

names(data_all1)

data_f23$SUCCESS <- as.factor(data_f23$SUCCESS)
data_f23_plus_autolab_all$SUCCESS <- as.factor(data_f23_plus_autolab_all$SUCCESS)
data_f23_plus_autolab_week4$SUCCESS <- as.factor(data_f23_plus_autolab_week4$SUCCESS)
data_f23_plus_autolab_week5$SUCCESS <- as.factor(data_f23_plus_autolab_week5$SUCCESS)
data_f23_plus_autolab_week7$SUCCESS <- as.factor(data_f23_plus_autolab_week7$SUCCESS)

# double check ...
table(data_f23$SUCCESS)
library(dplyr)

# Turn all numeric features into numbers

data_f23$Duration..in.seconds. <- as.numeric(data_f23$Duration..in.seconds.)
data_f23_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_all$Duration..in.seconds.)
data_f23_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_week4$Duration..in.seconds.)
data_f23_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_week5$Duration..in.seconds.)
data_f23_plus_autolab_week7$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_week7$Duration..in.seconds.)

# Turn features that should be categories into factors

data_f23$sending_school_type_cd <- as.factor(data_f23$sending_school_type_cd)
data_f23$orig_admit_type_cd <- as.factor(data_f23$orig_admit_type_cd)
data_f23$citizen_status_cd <- as.factor(data_f23$citizen_status_cd)
data_f23$curr_admit_type_cd <- as.factor(data_f23$curr_admit_type_cd)

data_f23_plus_autolab_all$sending_school_type_cd <- as.factor(data_f23_plus_autolab_all$sending_school_type_cd)
data_f23_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_all$orig_admit_type_cd)
data_f23_plus_autolab_all$citizen_status_cd <- as.factor(data_f23_plus_autolab_all$citizen_status_cd)
data_f23_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_all$curr_admit_type_cd)


data_f23_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week4$sending_school_type_cd)
data_f23_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week4$orig_admit_type_cd)
data_f23_plus_autolab_week4$citizen_status_cd <- as.factor(data_f23_plus_autolab_week4$citizen_status_cd)
data_f23_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week4$curr_admit_type_cd)

data_f23_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week5$sending_school_type_cd)
data_f23_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week5$orig_admit_type_cd)
data_f23_plus_autolab_week5$citizen_status_cd <- as.factor(data_f23_plus_autolab_week5$citizen_status_cd)
data_f23_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week5$curr_admit_type_cd)


data_f23_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week7$sending_school_type_cd)
data_f23_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week7$orig_admit_type_cd)
data_f23_plus_autolab_week7$citizen_status_cd <- as.factor(data_f23_plus_autolab_week7$citizen_status_cd)
data_f23_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week7$curr_admit_type_cd)



# remove students whose progress is not 100%
table(data_f23$Progress)
table(data_f23_plus_autolab_week7$Progress)

data_f23_temp <- data_f23[data_f23$Progress == "100",]
data_f23 <- data_f23_temp

data_f23_plus_autolab_all_temp <- data_f23_plus_autolab_all[data_f23_plus_autolab_all$Progress == "100",]
data_f23_plus_autolab_all <- data_f23_plus_autolab_all_temp


data_f23_plus_autolab_week4_temp <- data_f23_plus_autolab_week4[data_f23_plus_autolab_week4$Progress == "100",]
data_f23_plus_autolab_week4 <- data_f23_plus_autolab_week4_temp

data_f23_plus_autolab_week5_temp <- data_f23_plus_autolab_week5[data_f23_plus_autolab_week5$Progress == "100",]
data_f23_plus_autolab_week5 <- data_f23_plus_autolab_week5_temp


data_f23_plus_autolab_week7_temp <- data_f23_plus_autolab_week7[data_f23_plus_autolab_week7$Progress == "100",]
data_f23_plus_autolab_week7 <- data_f23_plus_autolab_week7_temp

data_f23$Assignments.Current.Points <- as.numeric(data_f23$Assignments.Current.Points)
data_f23$Assignments.Final.Points <- as.numeric(data_f23$Assignments.Final.Points)
data_f23$Assignments.Current.Score <- as.numeric(data_f23$Assignments.Current.Score)
data_f23$Assignments.Unposted.Current.Score <- as.numeric(data_f23$Assignments.Unposted.Current.Score)
data_f23$Assignments.Final.Score <- as.numeric(data_f23$Assignments.Final.Score)
data_f23$Assignments.Unposted.Final.Score <- as.numeric(data_f23$Assignments.Unposted.Final.Score)

data_f23$Quizzes.Current.Points <- as.numeric(data_f23$Current.Points)
data_f23$Quizzes.Final.Points <- as.numeric(data_f23$Final.Points)
data_f23$Quizzes.Current.Score <- as.numeric(data_f23$Current.Score)
data_f23$Quizzes.Unposted.Current.Score  <- as.numeric(data_f23$Unposted.Current.Score )
data_f23$Quizzes.Final.Score <- as.numeric(data_f23$Final.Score)
data_f23$Quizzes.Unposted.Final.Score <- as.numeric(data_f23$Unposted.Final.Score)

names(data_f23)

data_f23$Recitations.Current.Points <- as.numeric(data_f23$Recitations.Current.Points)
data_f23$Recitations.Final.Points <- as.numeric(data_f23$Recitations.Final.Points)
data_f23$Recitations.Current.Score <- as.numeric(data_f23$Recitations.Current.Score)
data_f23$Recitations.Unposted.Current.Score  <- as.numeric(data_f23$Recitations.Unposted.Current.Score )
data_f23$Recitations.Final.Score <- as.numeric(data_f23$Recitations.Final.Score)
data_f23$Recitations.Unposted.Final.Score <- as.numeric(data_f23$Recitations.Unposted.Final.Score)

data_f23$Current.Points <- as.numeric(data_f23$Current.Points)
data_f23$Final.Points <- as.numeric(data_f23$Final.Points)
data_f23$Current.Score <- as.numeric(data_f23$Current.Score)
data_f23$Unposted.Current.Score  <- as.numeric(data_f23$Unposted.Current.Score )
data_f23$Final.Score <- as.numeric(data_f23$Final.Score)
data_f23$Unposted.Final.Score <- as.numeric(data_f23$Unposted.Final.Score)

data_f23_plus_autolab_all$Current.Points <- as.numeric(data_f23_plus_autolab_all$Current.Points)
data_f23_plus_autolab_all$Final.Points <- as.numeric(data_f23_plus_autolab_all$Final.Points)
data_f23_plus_autolab_all$Current.Score <- as.numeric(data_f23_plus_autolab_all$Current.Score)
data_f23_plus_autolab_all$Unposted.Current.Score  <- as.numeric(data_f23_plus_autolab_all$Unposted.Current.Score )
data_f23_plus_autolab_all$Final.Score <- as.numeric(data_f23_plus_autolab_all$Final.Score)
data_f23_plus_autolab_all$Unposted.Final.Score <- as.numeric(data_f23_plus_autolab_all$Unposted.Final.Score)
data_f23_plus_autolab_all$Progress <- as.numeric(data_f23_plus_autolab_all$Progress)
data_f23_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_all$Duration..in.seconds.)


str(data_f23_plus_autolab_all)

data_f23_plus_autolab_week4$Current.Points <- as.numeric(data_f23_plus_autolab_week4$Current.Points)
data_f23_plus_autolab_week4$Final.Points <- as.numeric(data_f23_plus_autolab_week4$Final.Points)
data_f23_plus_autolab_week4$Current.Score <- as.numeric(data_f23_plus_autolab_week4$Current.Score)
data_f23_plus_autolab_week4$Unposted.Current.Score  <- as.numeric(data_f23_plus_autolab_week4$Unposted.Current.Score )
data_f23_plus_autolab_week4$Final.Score <- as.numeric(data_f23_plus_autolab_week4$Final.Score)
data_f23_plus_autolab_week4$Unposted.Final.Score <- as.numeric(data_f23_plus_autolab_week4$Unposted.Final.Score)
data_f23_plus_autolab_week4$Progress <- as.numeric(data_f23_plus_autolab_week4$Progress)
data_f23_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_week4$Duration..in.seconds.)



data_f23_plus_autolab_week5$Current.Points <- as.numeric(data_f23_plus_autolab_week5$Current.Points)
data_f23_plus_autolab_week5$Final.Points <- as.numeric(data_f23_plus_autolab_week5$Final.Points)
data_f23_plus_autolab_week5$Current.Score <- as.numeric(data_f23_plus_autolab_week5$Current.Score)
data_f23_plus_autolab_week5$Unposted.Current.Score  <- as.numeric(data_f23_plus_autolab_week5$Unposted.Current.Score )
data_f23_plus_autolab_week5$Final.Score <- as.numeric(data_f23_plus_autolab_week5$Final.Score)
data_f23_plus_autolab_week5$Unposted.Final.Score <- as.numeric(data_f23_plus_autolab_week5$Unposted.Final.Score)
data_f23_plus_autolab_week5$Progress <- as.numeric(data_f23_plus_autolab_week5$Progress)
data_f23_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_f23_plus_autolab_week5$Duration..in.seconds.)


data_f23_plus_autolab_week7$Current.Points <- as.numeric(data_f23_plus_autolab_week7$Current.Points)
data_f23_plus_autolab_week7$Final.Points <- as.numeric(data_f23_plus_autolab_week7$Final.Points)
data_f23_plus_autolab_week7$Current.Score <- as.numeric(data_f23_plus_autolab_week7$Current.Score)
data_f23_plus_autolab_week7$Unposted.Current.Score  <- as.numeric(data_f23_plus_autolab_week7$Unposted.Current.Score )
data_f23_plus_autolab_week7$Final.Score <- as.numeric(data_f23_plus_autolab_week7$Final.Score)
data_f23_plus_autolab_week7$Unposted.Final.Score <- as.numeric(data_f23_plus_autolab_week7$Unposted.Final.Score)

# data_f20$unit_of_reg_cd <- as.factor(data_f20$unit_of_reg_cd)
# data_f20$subj_cd <- as.factor(data_f20$subj_cd)
# data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)
# data_f20$housing_status_cd <- as.factor(data_f20$housing_status_cd)
# data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
# data_f20$deg_earned_curric_cd1 <- as.factor(data_f20$deg_earned_curric_cd1)
# data_f20$deg_minor_curric_cd1 <- as.factor(data_f20$deg_minor_curric_cd1)

#data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_f23_plus_autolab_all$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_all$curr_admit_type_cd)
data_f23_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week4$curr_admit_type_cd)
data_f23_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week5$curr_admit_type_cd)
data_f23_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_f23_plus_autolab_week7$curr_admit_type_cd)

data_f23_plus_autolab_all$sending_school_type_cd <- as.factor(data_f23_plus_autolab_all$sending_school_type_cd)
data_f23_plus_autolab_week4$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week4$sending_school_type_cd)
data_f23_plus_autolab_week5$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week5$sending_school_type_cd)
data_f23_plus_autolab_week7$sending_school_type_cd <- as.factor(data_f23_plus_autolab_week7$sending_school_type_cd)

data_f23_plus_autolab_all$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_all$orig_admit_type_cd)
data_f23_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week4$orig_admit_type_cd)
data_f23_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week5$orig_admit_type_cd)
data_f23_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_f23_plus_autolab_week7$orig_admit_type_cd)

data_f23_plus_autolab_all$citizen_status_cd <- as.factor(data_f23_plus_autolab_all$citizen_status_cd)
data_f23_plus_autolab_week4$citizen_status_cd <- as.factor(data_f23_plus_autolab_week4$citizen_status_cd)
data_f23_plus_autolab_week5$citizen_status_cd <- as.factor(data_f23_plus_autolab_week5$citizen_status_cd)
data_f23_plus_autolab_week7$citizen_status_cd <- as.factor(data_f23_plus_autolab_week7$citizen_status_cd)

str(data_f23_plus_autolab_all)

# Split data into numeric and not numeric features

data_num <- select_if(data_f23, is.numeric)
data_not_num <- data_f23[ , !(names(data_f23) %in% names(data_num))]
str(data_f23_plus_autolab_week4$Final.Points)

data_num_plus_autolab_all <- select_if(data_f23_plus_autolab_all, is.numeric)
data_not_num_plus_autolab_all <- data_f23_plus_autolab_all[ , !(names(data_f23_plus_autolab_all) %in% names(data_num_plus_autolab_all))]

data_num_plus_autolab_w4 <- select_if(data_f23_plus_autolab_week4, is.numeric)
data_not_num_plus_autolab_w4 <- data_f23_plus_autolab_week4[ , !(names(data_f23_plus_autolab_week4) %in% names(data_num_plus_autolab_w4))]

data_num_plus_autolab_w5 <- select_if(data_f23_plus_autolab_week5, is.numeric)
data_not_num_plus_autolab_w5 <- data_f23_plus_autolab_week5[ , !(names(data_f23_plus_autolab_week5) %in% names(data_num_plus_autolab_w5))]

data_num_plus_autolab_w7 <- select_if(data_f23_plus_autolab_week7, is.numeric)
data_not_num_plus_autolab_w7 <- data_f23_plus_autolab_week7[ , !(names(data_f23_plus_autolab_week7) %in% names(data_num_plus_autolab_w7))]

names(data_num_plus_autolab)
names(data_not_num_plus_autolab)

data_not_num_plus_autolab$Q38_1
names(data_not_num)

table(data_not_num$Section) # out
table(data_not_num$Current.Grade) # out b/c it corr with predicted var
table(data_not_num$Unposted.Current.Grade) # out: same as the one before
table(data_not_num$Final.Grade) # ibid
table(data_not_num$Unposted.Final.Grade) # ibid

table(data_not_num$gender_cd) # can stay
table(data_not_num$ethnic_cd) # can stay
table(data_not_num$SUCCESS) # has to stay

table(data_not_num$EndDate) # can go, probably irrelevant
table(data_not_num$Progress) # can go after selecting students who completed it 100%
table(data_not_num$Finished) # same as before, can remove those for whom it's FALSE and then get rid of column
table(data_not_num$RecordedDate) # irrelevant
table(data_not_num$UserLanguage) # can go, everyone is ENG
table(data_not_num$Q38) # can go, everyone agrees to take part of research


table(data_not_num$Q1) # can stay, major

table(data_not_num$Q33) # second major, lots of NA, may not have enough variablilty.. 
table(data_not_num$Q32) # minor, 206 undecided.., may not be a great feature
table(data_not_num$Q30) # second minor, 406 none, may need to get rid of

table(data_not_num$Q2) # keep.. reason they are taking CS1

table(data_not_num$Q2_8_TEXT) # mostly empty, get rid of
table(data_not_num$Q2_6_TEXT) # mostly empty, get rid of
table(data_not_num$Q44) # empty, get rid of
table(data_not_num$Q44_8_TEXT) # empty, get rid of
table(data_not_num$Q44_6_TEXT) # empty, get rid of

table(data_not_num$Q4) # Keep, prior experience

table(data_not_num$Q4_6_TEXT) # mostly empty
table(data_not_num$Q34) # mostly empty

table(data_not_num$Q35) # Keep, how difficult do they think the class will be
table(data_not_num$Q37) # get rid of, how would they explain cs

# Q43 is empty: get rid of it!

table(data_not_num$Q43)

# 30 variables so far.

# attitudes are 24 questions/variables.

# attitude qs  Q3, Q5 - Q12, Q14 - 28  1 + 8 + 15 = 24 questions
table(data_not_num$Q3)
table(data_not_num$Q5)
table(data_not_num$Q6)
table(data_not_num$Q7)
table(data_not_num$Q8)


# etc.

# Q38: Which of the following have you done this year or do you plan to do? Check all that apply. 
# I have no interest in doing this 0 / I did this in the past year 3 / I plan to do this in the future 2 / I'm not sure 1

table(data_not_num$Q38_1) # Participate in social events sponsored by the CS Living Learning Community
table(data_not_num$Q38_2) # Take a 200-level computer science course
table(data_not_num$Q38_3) # Matriculate as a computer science major
table(data_not_num$Q38_4) # Become a learning assistant for a computer science course
table(data_not_num$Q38_5) # Become a learning assistant for a computer science course
table(data_not_num$Q38_6) # Become a peer mentor in computer science
table(data_not_num$Q38_7) # Participate in the Reboot program, supporting high schools with CS instruction
table(data_not_num$Q38_8) # Do an internship that involves computer science
table(data_not_num$Q38_9) # Do academic research in the computer science field
table(data_not_num$Q38_10) # Join a professional organization or attend a professional conference in computer science
table(data_not_num$Q38_11) # Pursue a career in computer science
table(data_not_num$Q38_12) # Pursue a career in a field related to computer science

names(data_num)

data_num$ENGAGEMENT <- 0

data_num$E1[data_not_num$Q38_1 == "I did this in the past year"] <- 3
data_num$E1[data_not_num$Q38_1 == "I plan to do this in the future"] <- 2
data_num$E1[data_not_num$Q38_1 == "I'm not sure"] <- 1
data_num$E1[data_not_num$Q38_1 == "I have no interest in doing this"] <- 0
data_num$E1[data_not_num$Q38_1 == ""] <- 1.5

#table(data_num$E1)

data_num$E2[data_not_num$Q38_2 == "I did this in the past year"] <- 3
data_num$E2[data_not_num$Q38_2 == "I plan to do this in the future"] <- 2
data_num$E2[data_not_num$Q38_2 == "I'm not sure"] <- 1
data_num$E2[data_not_num$Q38_2 == "I have no interest in doing this"] <- 0
data_num$E2[data_not_num$Q38_2 == ""] <- 1.5

data_num$E3[data_not_num$Q38_3 == "I did this in the past year"] <- 3
data_num$E3[data_not_num$Q38_3 == "I plan to do this in the future"] <- 2
data_num$E3[data_not_num$Q38_3 == "I'm not sure"] <- 1
data_num$E3[data_not_num$Q38_3 == "I have no interest in doing this"] <- 0
data_num$E3[data_not_num$Q38_3 == ""] <- 1.5

data_num$E4[data_not_num$Q38_4 == "I did this in the past year"] <- 3
data_num$E4[data_not_num$Q38_4 == "I plan to do this in the future"] <- 2
data_num$E4[data_not_num$Q38_4 == "I'm not sure"] <- 1
data_num$E4[data_not_num$Q38_4 == "I have no interest in doing this"] <- 0
data_num$E4[data_not_num$Q38_4 == ""] <- 1.5

data_num$E5[data_not_num$Q38_5 == "I did this in the past year"] <- 3
data_num$E5[data_not_num$Q38_5 == "I plan to do this in the future"] <- 2
data_num$E5[data_not_num$Q38_5 == "I'm not sure"] <- 1
data_num$E5[data_not_num$Q38_5 == "I have no interest in doing this"] <- 0
data_num$E5[data_not_num$Q38_5 == ""] <- 1.5

data_num$E6[data_not_num$Q38_6 == "I did this in the past year"] <- 3
data_num$E6[data_not_num$Q38_6 == "I plan to do this in the future"] <- 2
data_num$E6[data_not_num$Q38_6 == "I'm not sure"] <- 1
data_num$E6[data_not_num$Q38_6 == "I have no interest in doing this"] <- 0
data_num$E6[data_not_num$Q38_6 == ""] <- 1.5

data_num$E7[data_not_num$Q38_7 == "I did this in the past year"] <- 3
data_num$E7[data_not_num$Q38_7 == "I plan to do this in the future"] <- 2
data_num$E7[data_not_num$Q38_7 == "I'm not sure"] <- 1
data_num$E7[data_not_num$Q38_7 == "I have no interest in doing this"] <- 0
data_num$E7[data_not_num$Q38_7 == ""] <- 1.5

data_num$E8[data_not_num$Q38_8 == "I did this in the past year"] <- 3
data_num$E8[data_not_num$Q38_8 == "I plan to do this in the future"] <- 2
data_num$E8[data_not_num$Q38_8 == "I'm not sure"] <- 1
data_num$E8[data_not_num$Q38_8 == "I have no interest in doing this"] <- 0
data_num$E8[data_not_num$Q38_8 == ""] <- 1.5

data_num$E9[data_not_num$Q38_9 == "I did this in the past year"] <- 3
data_num$E9[data_not_num$Q38_9 == "I plan to do this in the future"] <- 2
data_num$E9[data_not_num$Q38_9 == "I'm not sure"] <- 1
data_num$E9[data_not_num$Q38_9 == "I have no interest in doing this"] <- 0
data_num$E9[data_not_num$Q38_9 == ""] <- 1.5

data_num$E10[data_not_num$Q38_10 == "I did this in the past year"] <- 3
data_num$E10[data_not_num$Q38_10 == "I plan to do this in the future"] <- 2
data_num$E10[data_not_num$Q38_10 == "I'm not sure"] <- 1
data_num$E10[data_not_num$Q38_10 == "I have no interest in doing this"] <- 0
data_num$E10[data_not_num$Q38_10 == ""] <- 1.5

data_num$E11[data_not_num$Q38_11 == "I did this in the past year"] <- 3
data_num$E11[data_not_num$Q38_11 == "I plan to do this in the future"] <- 2
data_num$E11[data_not_num$Q38_11 == "I'm not sure"] <- 1
data_num$E11[data_not_num$Q38_11 == "I have no interest in doing this"] <- 0
data_num$E11[data_not_num$Q38_11 == ""] <- 1.5

data_num$E12[data_not_num$Q38_12 == "I did this in the past year"] <- 3
data_num$E12[data_not_num$Q38_12 == "I plan to do this in the future"] <- 2
data_num$E12[data_not_num$Q38_12 == "I'm not sure"] <- 1
data_num$E12[data_not_num$Q38_12 == "I have no interest in doing this"] <- 0
data_num$E12[data_not_num$Q38_12 == ""] <- 1.5

data_num$ENGAGEMENT <- data_num$E1 + data_num$E2 + data_num$E3 + data_num$E4 + data_num$E5 + data_num$E6 + data_num$E7 + data_num$E8 + data_num$E9 + data_num$E10 + data_num$E11 + data_num$E12

#all

data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_all$E1)

data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == ""] <- 1.5

data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == ""] <- 1.5


data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == ""] <- 1.5

data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == ""] <- 1.5

data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == ""] <- 1.5

data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == ""] <- 1.5

data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == ""] <- 1.5

data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == ""] <- 1.5

data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == ""] <- 1.5

data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == ""] <- 1.5

data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == ""] <- 1.5

data_num_plus_autolab_all$ENGAGEMENT <- data_num_plus_autolab_all$E1 + data_num_plus_autolab_all$E2 + data_num_plus_autolab_all$E3 + data_num_plus_autolab_all$E4 + data_num_plus_autolab_all$E5 + data_num_plus_autolab_all$E6 + data_num_plus_autolab_all$E7 + data_num_plus_autolab_all$E8 + data_num_plus_autolab_all$E9 + data_num_plus_autolab_all$E10 + data_num_plus_autolab_all$E11 + data_num_plus_autolab_all$E12


#W4

data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w4$E1)

data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w4$ENGAGEMENT <- data_num_plus_autolab_w4$E1 + data_num_plus_autolab_w4$E2 + data_num_plus_autolab_w4$E3 + data_num_plus_autolab_w4$E4 + data_num_plus_autolab_w4$E5 + data_num_plus_autolab_w4$E6 + data_num_plus_autolab_w4$E7 + data_num_plus_autolab_w4$E8 + data_num_plus_autolab_w4$E9 + data_num_plus_autolab_w4$E10 + data_num_plus_autolab_w4$E11 + data_num_plus_autolab_w4$E12

#w5

data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w5$E1)

data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w5$ENGAGEMENT <- data_num_plus_autolab_w5$E1 + data_num_plus_autolab_w5$E2 + data_num_plus_autolab_w5$E3 + data_num_plus_autolab_w5$E4 + data_num_plus_autolab_w5$E5 + data_num_plus_autolab_w5$E6 + data_num_plus_autolab_w5$E7 + data_num_plus_autolab_w5$E8 + data_num_plus_autolab_w5$E9 + data_num_plus_autolab_w5$E10 + data_num_plus_autolab_w5$E11 + data_num_plus_autolab_w5$E12

#w7

data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w7$E1)

data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w7$ENGAGEMENT <- data_num_plus_autolab_w7$E1 + data_num_plus_autolab_w7$E2 + data_num_plus_autolab_w7$E3 + data_num_plus_autolab_w7$E4 + data_num_plus_autolab_w7$E5 + data_num_plus_autolab_w7$E6 + data_num_plus_autolab_w7$E7 + data_num_plus_autolab_w7$E8 + data_num_plus_autolab_w7$E9 + data_num_plus_autolab_w7$E10 + data_num_plus_autolab_w7$E11 + data_num_plus_autolab_w7$E12


table(data_num$ENGAGEMENT)

# Q39 : To what extent do you agree with the following statements? 
# Strongly agree / Somewhat agree / Not sure / Somewhat disagree / Strongly disagree

table(data_not_num$Q39_1) # With hard work, anyone can become an expert in computer science
table(data_not_num$Q39_2) # Women and men have the same level of natural ability and talent in computer science
table(data_not_num$Q39_3) # Women are less capable of success in computer science than men
table(data_not_num$Q39_4) # Men are more likely to excel in careers that involve computing than women are
table(data_not_num$Q39_5) # Men are more capable than women at solving computing problems


data_num$A1[data_not_num$Q39_1 == "Strongly agree"] <- 3
data_num$A1[data_not_num$Q39_1 == "Somewhat agree"] <- 2
data_num$A1[data_not_num$Q39_1 == "Not sure"] <- 1.5
data_num$A1[data_not_num$Q39_1 == "Somewhat disagree"] <- 1
data_num$A1[data_not_num$Q39_1 == "Strongly disagree"] <- 0
data_num$A1[data_not_num$Q39_1 == ""] <- 1.5

data_num$A2[data_not_num$Q39_2 == "Strongly agree"] <- 3
data_num$A2[data_not_num$Q39_2 == "Somewhat agree"] <- 2
data_num$A2[data_not_num$Q39_2 == "Not sure"] <- 1.5
data_num$A2[data_not_num$Q39_2 == "Somewhat disagree"] <- 1
data_num$A2[data_not_num$Q39_2 == "Strongly disagree"] <- 0
data_num$A2[data_not_num$Q39_2 == ""] <- 1.5

# inverted scale
data_num$A3[data_not_num$Q39_3 == "Strongly disagree"] <- 3
data_num$A3[data_not_num$Q39_3 == "Somewhat disagree"] <- 2
data_num$A3[data_not_num$Q39_3 == "Not sure"] <- 1.5
data_num$A3[data_not_num$Q39_3 == "Somewhat agree"] <- 1
data_num$A3[data_not_num$Q39_3 == "Strongly sagree"] <- 0
data_num$A3[data_not_num$Q39_3 == ""] <- 1.5

data_num$A4[data_not_num$Q39_4 == "Strongly disagree"] <- 3
data_num$A4[data_not_num$Q39_4 == "Somewhat disagree"] <- 2
data_num$A4[data_not_num$Q39_4 == "Not sure"] <- 1.5
data_num$A4[data_not_num$Q39_4 == "Somewhat agree"] <- 1
data_num$A4[data_not_num$Q39_4 == "Strongly agree"] <- 0
data_num$A4[data_not_num$Q39_4 == ""] <- 1.5

data_num$A5[data_not_num$Q39_5 == "Strongly disagree"] <- 3
data_num$A5[data_not_num$Q39_5 == "Somewhat disagree"] <- 2
data_num$A5[data_not_num$Q39_5 == "Not sure"] <- 1.5
data_num$A5[data_not_num$Q39_5 == "Somewhat agree"] <- 1
data_num$A5[data_not_num$Q39_5 == "Strongly agree"] <- 0
data_num$A5[data_not_num$Q39_5 == ""] <- 1.5

data_num$ATTITUDES <- data_num$A1 + data_num$A2 + data_num$A3 + data_num$A4  + data_num$A5

# all

data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == ""] <- 1.5

data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == ""] <- 1.5

data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == ""] <- 1.5

data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == ""] <- 1.5

data_num_plus_autolab_all$ATTITUDES <- data_num_plus_autolab_all$A1 + data_num_plus_autolab_all$A2 + data_num_plus_autolab_all$A3 + data_num_plus_autolab_all$A4 + data_num_plus_autolab_all$A5



# W4

data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w4$ATTITUDES <- data_num_plus_autolab_w4$A1 + data_num_plus_autolab_w4$A2 + data_num_plus_autolab_w4$A3 + data_num_plus_autolab_w4$A4 + data_num_plus_autolab_w4$A5

# w5

data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w5$A1[data_f23_plus_autolab_week5$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A2[data_f23_plus_autolab_week5$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A3[data_f23_plus_autolab_week5$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A4[data_f23_plus_autolab_week5$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A5[data_f23_plus_autolab_week5$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w5$ATTITUDES <- data_num_plus_autolab_w5$A1 + data_num_plus_autolab_w5$A2 + data_num_plus_autolab_w5$A3 + data_num_plus_autolab_w5$A4 + data_num_plus_autolab_w5$A5

# w7

data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w7$ATTITUDES <- data_num_plus_autolab_w7$A1 + data_num_plus_autolab_w7$A2 + data_num_plus_autolab_w7$A3 + data_num_plus_autolab_w7$A4 + data_num_plus_autolab_w7$A5


# Divide the value for ATTITUDES by 15, which is the max possible value

#data_num$ATTITUDES <- data_num$ATTITUDES/15
#data_num_plus_autolab$ATTITUDES <- data_num_plus_autolab$ATTITUDES/15


names(data_not_num)


str(data_num_plus_autolab)
str(data_not_num_plus_autolab)
names(data_f20_plus_autolab_week7)

# REPLACE ATTITUDES WITH NUMBERS

data_num$BELONGINGNESS <- 0
data_num$CONFIDENCE <- 0
data_num$INTEREST <- 0
data_num$USEFULNESS <- 0
data_num$ENCOURAGEMENT <- 0

data_num_plus_autolab_all$BELONGINGNESS <- 0
data_num_plus_autolab_all$CONFIDENCE <- 0
data_num_plus_autolab_all$INTEREST <- 0
data_num_plus_autolab_all$USEFULNESS <- 0
data_num_plus_autolab_all$ENCOURAGEMENT <- 0
data_num_plus_autolab_all$Q6_B <- 0 
data_num_plus_autolab_all$Q3_B <- 0 
data_num_plus_autolab_all$Q11_B <- 0 
data_num_plus_autolab_all$Q57_B <- 0 
data_num_plus_autolab_all$Q21_B <- 0 
data_num_plus_autolab_all$Q26_B <- 0


data_num_plus_autolab_w4$BELONGINGNESS <- 0
data_num_plus_autolab_w4$CONFIDENCE <- 0
data_num_plus_autolab_w4$INTEREST <- 0
data_num_plus_autolab_w4$USEFULNESS <- 0
data_num_plus_autolab_w4$ENCOURAGEMENT <- 0
data_num_plus_autolab_w4$Q6_B <- 0 
data_num_plus_autolab_w4$Q3_B <- 0 
data_num_plus_autolab_w4$Q11_B <- 0 
data_num_plus_autolab_w4$Q57_B <- 0 
data_num_plus_autolab_w4$Q21_B <- 0 
data_num_plus_autolab_w4$Q26_B <- 0

data_num_plus_autolab_w5$BELONGINGNESS <- 0
data_num_plus_autolab_w5$CONFIDENCE <- 0
data_num_plus_autolab_w5$INTEREST <- 0
data_num_plus_autolab_w5$USEFULNESS <- 0
data_num_plus_autolab_w5$ENCOURAGEMENT <- 0
data_num_plus_autolab_w5$Q6_B <- 0 
data_num_plus_autolab_w5$Q3_B <- 0 
data_num_plus_autolab_w5$Q11_B <- 0 
data_num_plus_autolab_w5$Q57_B <- 0 
data_num_plus_autolab_w5$Q21_B <- 0 
data_num_plus_autolab_w5$Q26_B <- 0

data_num_plus_autolab_w7$BELONGINGNESS <- 0
data_num_plus_autolab_w7$CONFIDENCE <- 0
data_num_plus_autolab_w7$INTEREST <- 0
data_num_plus_autolab_w7$USEFULNESS <- 0
data_num_plus_autolab_w7$ENCOURAGEMENT <- 0
data_num_plus_autolab_w7$Q6_B <- 0 
data_num_plus_autolab_w7$Q3_B <- 0 
data_num_plus_autolab_w7$Q11_B <- 0 
data_num_plus_autolab_w7$Q57_B <- 0 
data_num_plus_autolab_w7$Q21_B <- 0 
data_num_plus_autolab_w7$Q26_B <- 0


# Belongingness

names(data_not_num)

data_num$Q6_B[data_not_num$Q6 == "Strongly Agree"] <- 3
data_num$Q6_B[data_not_num$Q6 == "Agree"] <- 2
data_num$Q6_B[data_not_num$Q6 == "Disagree"] <- 1
data_num$Q6_B[data_not_num$Q6 == "Strongly Disagree"] <- 0
data_num$Q6_B[data_not_num$Q6 == ""] <- 1.5 # average between agree and disagree

data_num$Q11_B[data_not_num$Q11 == "Strongly Agree"] <- 3
data_num$Q11_B[data_not_num$Q11 == "Agree"] <- 2
data_num$Q11_B[data_not_num$Q11 == "Disagree"] <- 1
data_num$Q11_B[data_not_num$Q11 == "Strongly Disagree"] <- 0
data_num$Q11_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q21_B[data_not_num$Q21 == "Strongly Agree"] <- 3
data_num$Q21_B[data_not_num$Q21 == "Agree"] <- 2
data_num$Q21_B[data_not_num$Q21 == "Disagree"] <- 1
data_num$Q21_B[data_not_num$Q21 == "Strongly Disagree"] <- 0
data_num$Q21_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q26_B[data_not_num$Q26 == "Strongly Agree"] <- 3
data_num$Q26_B[data_not_num$Q26 == "Agree"] <- 2
data_num$Q26_B[data_not_num$Q26 == "Disagree"] <- 1
data_num$Q26_B[data_not_num$Q26 == "Strongly Disagree"] <- 0
data_num$Q26_B[data_not_num$Q26 == ""] <- 1.5

data_num$BELONGINGNESS <- data_num$Q6_B + data_num$Q11_B + data_num$Q21_B + data_num$Q26_B

# all

data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Agree"] <- 2
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Disagree"] <- 1
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Agree"] <- 2
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Disagree"] <- 1
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == ""] <- 1.5

data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Agree"] <- 2
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Disagree"] <- 1
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == ""] <- 1.5

data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Agree"] <- 2
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Disagree"] <- 1
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == ""] <- 1.5

data_num_plus_autolab_all$BELONGINGNESS <- data_num_plus_autolab_all$Q6_B + data_num_plus_autolab_all$Q11_B + data_num_plus_autolab_all$Q21_B + data_num_plus_autolab_all$Q26_B


# W4

data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Agree"] <- 2
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Agree"] <- 2
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == ""] <- 1.5

data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Agree"] <- 2
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == ""] <- 1.5

data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Agree"] <- 2
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == ""] <- 1.5

data_num_plus_autolab_w4$BELONGINGNESS <- data_num_plus_autolab_w4$Q6_B + data_num_plus_autolab_w4$Q11_B + data_num_plus_autolab_w4$Q21_B + data_num_plus_autolab_w4$Q26_B

# w5

data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Agree"] <- 2
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Agree"] <- 2
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == ""] <- 1.5

data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Agree"] <- 2
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == ""] <- 1.5

data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Agree"] <- 2
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == ""] <- 1.5

data_num_plus_autolab_w5$BELONGINGNESS <- data_num_plus_autolab_w5$Q6_B + data_num_plus_autolab_w5$Q11_B + data_num_plus_autolab_w5$Q21_B + data_num_plus_autolab_w5$Q26_B

# w7

data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Agree"] <- 2
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Agree"] <- 2
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == ""] <- 1.5

data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Agree"] <- 2
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == ""] <- 1.5

data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Agree"] <- 2
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == ""] <- 1.5

data_num_plus_autolab_w7$BELONGINGNESS <- data_num_plus_autolab_w7$Q6_B + data_num_plus_autolab_w7$Q11_B + data_num_plus_autolab_w7$Q21_B + data_num_plus_autolab_w7$Q26_B



# Confidence
# Q3, Q9, Q15, Q19, Q24

data_num$Q3_B[data_not_num$Q3 == "Strongly Agree"] <- 3
data_num$Q3_B[data_not_num$Q3 == "Agree"] <- 2
data_num$Q3_B[data_not_num$Q3 == "Disagree"] <- 1
data_num$Q3_B[data_not_num$Q3 == "Strongly Disagree"] <- 0
data_num$Q3_B[data_not_num$Q3 == ""] <- 1.5

data_num$Q9_B[data_not_num$Q9 == "Strongly Agree"] <- 3
data_num$Q9_B[data_not_num$Q9 == "Agree"] <- 2
data_num$Q9_B[data_not_num$Q9 == "Disagree"] <- 1
data_num$Q9_B[data_not_num$Q9 == "Strongly Disagree"] <- 0
data_num$Q9_B[data_not_num$Q9 == ""] <- 1.5

data_num$Q15_B[data_not_num$Q15 == "Strongly Agree"] <- 3
data_num$Q15_B[data_not_num$Q15 == "Agree"] <- 2
data_num$Q15_B[data_not_num$Q15 == "Disagree"] <- 1
data_num$Q15_B[data_not_num$Q15 == "Strongly Disagree"] <- 0
data_num$Q15_B[data_not_num$Q15 == ""] <- 1.5


data_num$Q19_B[data_not_num$Q19 == "Strongly Agree"] <- 3
data_num$Q19_B[data_not_num$Q19 == "Agree"] <- 2
data_num$Q19_B[data_not_num$Q19 == "Disagree"] <- 1
data_num$Q19_B[data_not_num$Q19 == "Strongly Disagree"] <- 0
data_num$Q19_B[data_not_num$Q19 == ""] <- 1.5


data_num$Q24_B[data_not_num$Q24 == "Strongly Agree"] <- 3
data_num$Q24_B[data_not_num$Q24 == "Agree"] <- 2
data_num$Q24_B[data_not_num$Q24 == "Disagree"] <- 1
data_num$Q24_B[data_not_num$Q24 == "Strongly Disagree"] <- 0
data_num$Q24_B[data_not_num$Q24 == ""] <- 1.5

data_num$CONFIDENCE <- data_num$Q3_B + data_num$Q9_B + data_num$Q15_B + data_num$Q19_B + data_num$Q24_B

# all

data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Agree"] <- 2
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Disagree"] <- 1
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == ""] <- 1.5

data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Agree"] <- 2
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Disagree"] <- 1
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == ""] <- 1.5

data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Agree"] <- 2
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Disagree"] <- 1
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == ""] <- 1.5


data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Agree"] <- 2
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Disagree"] <- 1
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == ""] <- 1.5


data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Agree"] <- 2
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Disagree"] <- 1
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == ""] <- 1.5

data_num_plus_autolab_all$CONFIDENCE <- data_num_plus_autolab_all$Q3_B + data_num_plus_autolab_all$Q9_B + data_num_plus_autolab_all$Q15_B + data_num_plus_autolab_all$Q19_B + data_num_plus_autolab_all$Q24_B


# W4

data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Agree"] <- 2
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == ""] <- 1.5

data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Agree"] <- 2
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == ""] <- 1.5

data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Agree"] <- 2
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == ""] <- 1.5


data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Agree"] <- 2
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == ""] <- 1.5


data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Agree"] <- 2
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == ""] <- 1.5

data_num_plus_autolab_w4$CONFIDENCE <- data_num_plus_autolab_w4$Q3_B + data_num_plus_autolab_w4$Q9_B + data_num_plus_autolab_w4$Q15_B + data_num_plus_autolab_w4$Q19_B + data_num_plus_autolab_w4$Q24_B

# w5

data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Agree"] <- 2
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == ""] <- 1.5

data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Agree"] <- 2
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == ""] <- 1.5

data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Agree"] <- 2
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == ""] <- 1.5


data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Agree"] <- 2
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == ""] <- 1.5


data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Agree"] <- 2
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == ""] <- 1.5

data_num_plus_autolab_w5$CONFIDENCE <- data_num_plus_autolab_w5$Q3_B + data_num_plus_autolab_w5$Q9_B + data_num_plus_autolab_w5$Q15_B + data_num_plus_autolab_w5$Q19_B + data_num_plus_autolab_w5$Q24_B

# w7

data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Agree"] <- 2
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == ""] <- 1.5

data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Agree"] <- 2
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == ""] <- 1.5

data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Agree"] <- 2
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == ""] <- 1.5


data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Agree"] <- 2
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == ""] <- 1.5


data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Agree"] <- 2
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == ""] <- 1.5

data_num_plus_autolab_w7$CONFIDENCE <- data_num_plus_autolab_w7$Q3_B + data_num_plus_autolab_w7$Q9_B + data_num_plus_autolab_w7$Q15_B + data_num_plus_autolab_w7$Q19_B + data_num_plus_autolab_w7$Q24_B


# Interest
#Q5, Q10, Q16, Q20, Q25

data_num$Q5_B[data_not_num$Q5 == "Strongly Agree"] <- 3
data_num$Q5_B[data_not_num$Q5 == "Agree"] <- 2
data_num$Q5_B[data_not_num$Q5 == "Disagree"] <- 1
data_num$Q5_B[data_not_num$Q5 == "Strongly Disagree"] <- 0
data_num$Q5_B[data_not_num$Q5 == ""] <- 1.5

data_num$Q10_B[data_not_num$Q10 == "Strongly Agree"] <- 3
data_num$Q10_B[data_not_num$Q10 == "Agree"] <- 2
data_num$Q10_B[data_not_num$Q10 == "Disagree"] <- 1
data_num$Q10_B[data_not_num$Q10 == "Strongly Disagree"] <- 0
data_num$Q10_B[data_not_num$Q10 == ""] <- 1.5

data_num$Q16_B[data_not_num$Q16 == "Strongly Agree"] <- 3
data_num$Q16_B[data_not_num$Q16 == "Agree"] <- 2
data_num$Q16_B[data_not_num$Q16 == "Disagree"] <- 1
data_num$Q16_B[data_not_num$Q16 == "Strongly Disagree"] <- 0
data_num$Q16_B[data_not_num$Q16 == ""] <- 1.5


data_num$Q20_B[data_not_num$Q20 == "Strongly Agree"] <- 3
data_num$Q20_B[data_not_num$Q20 == "Agree"] <- 2
data_num$Q20_B[data_not_num$Q20 == "Disagree"] <- 1
data_num$Q20_B[data_not_num$Q20 == "Strongly Disagree"] <- 0
data_num$Q20_B[data_not_num$Q20 == ""] <- 1.5


data_num$Q25_B[data_not_num$Q25 == "Strongly Agree"] <- 3
data_num$Q25_B[data_not_num$Q25 == "Agree"] <- 2
data_num$Q25_B[data_not_num$Q25 == "Disagree"] <- 1
data_num$Q25_B[data_not_num$Q25 == "Strongly Disagree"] <- 0
data_num$Q25_B[data_not_num$Q25 == ""] <- 1.5

data_num$INTEREST <- data_num$Q5_B + data_num$Q10_B + data_num$Q16_B + data_num$Q20_B + data_num$Q25_B

#all

data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Agree"] <- 2
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Disagree"] <- 1
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == ""] <- 1.5

data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Agree"] <- 2
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Disagree"] <- 1
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == ""] <- 1.5

data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Agree"] <- 2
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Disagree"] <- 1
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == ""] <- 1.5


data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Agree"] <- 2
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Disagree"] <- 1
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == ""] <- 1.5


data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Agree"] <- 2
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Disagree"] <- 1
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == ""] <- 1.5

data_num_plus_autolab_all$INTEREST <- data_num_plus_autolab_all$Q5_B + data_num_plus_autolab_all$Q10_B + data_num_plus_autolab_all$Q16_B + data_num_plus_autolab_all$Q20_B + data_num_plus_autolab_all$Q25_B


#W4

data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Agree"] <- 2
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == ""] <- 1.5

data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Agree"] <- 2
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == ""] <- 1.5

data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Agree"] <- 2
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == ""] <- 1.5


data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Agree"] <- 2
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == ""] <- 1.5


data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Agree"] <- 2
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == ""] <- 1.5

data_num_plus_autolab_w4$INTEREST <- data_num_plus_autolab_w4$Q5_B + data_num_plus_autolab_w4$Q10_B + data_num_plus_autolab_w4$Q16_B + data_num_plus_autolab_w4$Q20_B + data_num_plus_autolab_w4$Q25_B

#W5

data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Agree"] <- 2
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == ""] <- 1.5

data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Agree"] <- 2
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == ""] <- 1.5

data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Agree"] <- 2
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == ""] <- 1.5


data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Agree"] <- 2
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == ""] <- 1.5


data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Agree"] <- 2
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == ""] <- 1.5

data_num_plus_autolab_w5$INTEREST <- data_num_plus_autolab_w5$Q5_B + data_num_plus_autolab_w5$Q10_B + data_num_plus_autolab_w5$Q16_B + data_num_plus_autolab_w5$Q20_B + data_num_plus_autolab_w5$Q25_B

#w7

data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Agree"] <- 2
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == ""] <- 1.5

data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Agree"] <- 2
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == ""] <- 1.5

data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Agree"] <- 2
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == ""] <- 1.5


data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Agree"] <- 2
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == ""] <- 1.5


data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Agree"] <- 2
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == ""] <- 1.5

data_num_plus_autolab_w7$INTEREST <- data_num_plus_autolab_w7$Q5_B + data_num_plus_autolab_w7$Q10_B + data_num_plus_autolab_w7$Q16_B + data_num_plus_autolab_w7$Q20_B + data_num_plus_autolab_w7$Q25_B


# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_num$Q7_B[data_not_num$Q7 == "Strongly Agree"] <- 3
data_num$Q7_B[data_not_num$Q7 == "Agree"] <- 2
data_num$Q7_B[data_not_num$Q7 == "Disagree"] <- 1
data_num$Q7_B[data_not_num$Q7 == "Strongly Disagree"] <- 0
data_num$Q7_B[data_not_num$Q7 == ""] <- 1.5

data_num$Q12_B[data_not_num$Q12 == "Strongly Agree"] <- 3
data_num$Q12_B[data_not_num$Q12 == "Agree"] <- 2
data_num$Q12_B[data_not_num$Q12 == "Disagree"] <- 1
data_num$Q12_B[data_not_num$Q12 == "Strongly Disagree"] <- 0
data_num$Q12_B[data_not_num$Q12 == ""] <- 1.5

data_num$Q17_B[data_not_num$Q17 == "Strongly Agree"] <- 3
data_num$Q17_B[data_not_num$Q17 == "Agree"] <- 2
data_num$Q17_B[data_not_num$Q17 == "Disagree"] <- 1
data_num$Q17_B[data_not_num$Q17 == "Strongly Disagree"] <- 0
data_num$Q17_B[data_not_num$Q17 == ""] <- 1.5


data_num$Q22_B[data_not_num$Q22 == "Strongly Agree"] <- 3
data_num$Q22_B[data_not_num$Q22 == "Agree"] <- 2
data_num$Q22_B[data_not_num$Q22 == "Disagree"] <- 1
data_num$Q22_B[data_not_num$Q22 == "Strongly Disagree"] <- 0
data_num$Q22_B[data_not_num$Q22 == ""] <- 1.5


data_num$Q27_B[data_not_num$Q27 == "Strongly Agree"] <- 3
data_num$Q27_B[data_not_num$Q27 == "Agree"] <- 2
data_num$Q27_B[data_not_num$Q27 == "Disagree"] <- 1
data_num$Q27_B[data_not_num$Q27 == "Strongly Disagree"] <- 0
data_num$Q27_B[data_not_num$Q27 == ""] <- 1.5

data_num$USEFULNESS <- data_num$Q7_B + data_num$Q12_B + data_num$Q17_B + data_num$Q22_B + data_num$Q27_B

#all

data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Agree"] <- 2
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Disagree"] <- 1
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == ""] <- 1.5

data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Agree"] <- 2
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Disagree"] <- 1
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == ""] <- 1.5

data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Agree"] <- 2
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Disagree"] <- 1
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == ""] <- 1.5


data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Agree"] <- 2
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Disagree"] <- 1
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == ""] <- 1.5


data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Agree"] <- 2
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Disagree"] <- 1
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == ""] <- 1.5

data_num_plus_autolab_all$USEFULNESS <- data_num_plus_autolab_all$Q7_B + data_num_plus_autolab_all$Q12_B + data_num_plus_autolab_all$Q17_B + data_num_plus_autolab_all$Q22_B + data_num_plus_autolab_all$Q27_B


#W4

data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Agree"] <- 2
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == ""] <- 1.5

data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Agree"] <- 2
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == ""] <- 1.5

data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Agree"] <- 2
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == ""] <- 1.5


data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Agree"] <- 2
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == ""] <- 1.5


data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Agree"] <- 2
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == ""] <- 1.5

data_num_plus_autolab_w4$USEFULNESS <- data_num_plus_autolab_w4$Q7_B + data_num_plus_autolab_w4$Q12_B + data_num_plus_autolab_w4$Q17_B + data_num_plus_autolab_w4$Q22_B + data_num_plus_autolab_w4$Q27_B

# W5

data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Agree"] <- 2
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == ""] <- 1.5

data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Agree"] <- 2
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == ""] <- 1.5

data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Agree"] <- 2
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == ""] <- 1.5


data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Agree"] <- 2
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == ""] <- 1.5


data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Agree"] <- 2
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == ""] <- 1.5

data_num_plus_autolab_w5$USEFULNESS <- data_num_plus_autolab_w5$Q7_B + data_num_plus_autolab_w5$Q12_B + data_num_plus_autolab_w5$Q17_B + data_num_plus_autolab_w5$Q22_B + data_num_plus_autolab_w5$Q27_B

#w7

data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Agree"] <- 2
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == ""] <- 1.5

data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Agree"] <- 2
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == ""] <- 1.5

data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Agree"] <- 2
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == ""] <- 1.5


data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Agree"] <- 2
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == ""] <- 1.5


data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Agree"] <- 2
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == ""] <- 1.5

data_num_plus_autolab_w7$USEFULNESS <- data_num_plus_autolab_w7$Q7_B + data_num_plus_autolab_w7$Q12_B + data_num_plus_autolab_w7$Q17_B + data_num_plus_autolab_w7$Q22_B + data_num_plus_autolab_w7$Q27_B



# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_num$Q8_B[data_not_num$Q8 == "Strongly Agree"] <- 3
data_num$Q8_B[data_not_num$Q8 == "Agree"] <- 2
data_num$Q8_B[data_not_num$Q8 == "Disagree"] <- 1
data_num$Q8_B[data_not_num$Q8 == "Strongly Disagree"] <- 0
data_num$Q8_B[data_not_num$Q8 == ""] <- 1.5

data_num$Q14_B[data_not_num$Q14 == "Strongly Agree"] <- 3
data_num$Q14_B[data_not_num$Q14 == "Agree"] <- 2
data_num$Q14_B[data_not_num$Q14 == "Disagree"] <- 1
data_num$Q14_B[data_not_num$Q14 == "Strongly Disagree"] <- 0
data_num$Q14_B[data_not_num$Q14 == ""] <- 1.5

data_num$Q18_B[data_not_num$Q18 == "Strongly Agree"] <- 3
data_num$Q18_B[data_not_num$Q18 == "Agree"] <- 2
data_num$Q18_B[data_not_num$Q18 == "Disagree"] <- 1
data_num$Q18_B[data_not_num$Q18 == "Strongly Disagree"] <- 0
data_num$Q18_B[data_not_num$Q18 == ""] <- 1.5


data_num$Q23_B[data_not_num$Q23 == "Strongly Agree"] <- 3
data_num$Q23_B[data_not_num$Q23 == "Agree"] <- 2
data_num$Q23_B[data_not_num$Q23 == "Disagree"] <- 1
data_num$Q23_B[data_not_num$Q23 == "Strongly Disagree"] <- 0
data_num$Q23_B[data_not_num$Q23 == ""] <- 1.5


data_num$Q28_B[data_not_num$Q28 == "Strongly Agree"] <- 3
data_num$Q28_B[data_not_num$Q28 == "Agree"] <- 2
data_num$Q28_B[data_not_num$Q28 == "Disagree"] <- 1
data_num$Q28_B[data_not_num$Q28 == "Strongly Disagree"] <- 0
data_num$Q28_B[data_not_num$Q28 == ""] <- 1.5

data_num$ENCOURAGEMENT <- data_num$Q8_B + data_num$Q14_B + data_num$Q18_B + data_num$Q23_B + data_num$Q28_B

# all

data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Agree"] <- 2
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Disagree"] <- 1
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == ""] <- 1.5

data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Agree"] <- 2
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Disagree"] <- 1
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == ""] <- 1.5

data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Agree"] <- 2
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Disagree"] <- 1
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == ""] <- 1.5


data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Agree"] <- 2
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Disagree"] <- 1
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == ""] <- 1.5


data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Agree"] <- 2
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Disagree"] <- 1
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == ""] <- 1.5

data_num_plus_autolab_all$ENCOURAGEMENT <- data_num_plus_autolab_all$Q8_B + data_num_plus_autolab_all$Q14_B + data_num_plus_autolab_all$Q18_B + data_num_plus_autolab_all$Q23_B + data_num_plus_autolab_all$Q28_B


# W4

data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Agree"] <- 2
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == ""] <- 1.5

data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Agree"] <- 2
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == ""] <- 1.5

data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Agree"] <- 2
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == ""] <- 1.5


data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Agree"] <- 2
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == ""] <- 1.5


data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Agree"] <- 2
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == ""] <- 1.5

data_num_plus_autolab_w4$ENCOURAGEMENT <- data_num_plus_autolab_w4$Q8_B + data_num_plus_autolab_w4$Q14_B + data_num_plus_autolab_w4$Q18_B + data_num_plus_autolab_w4$Q23_B + data_num_plus_autolab_w4$Q28_B

# w5

data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Agree"] <- 2
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == ""] <- 1.5

data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Agree"] <- 2
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == ""] <- 1.5

data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Agree"] <- 2
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == ""] <- 1.5


data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Agree"] <- 2
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == ""] <- 1.5


data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Agree"] <- 2
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == ""] <- 1.5

data_num_plus_autolab_w5$ENCOURAGEMENT <- data_num_plus_autolab_w5$Q8_B + data_num_plus_autolab_w5$Q14_B + data_num_plus_autolab_w5$Q18_B + data_num_plus_autolab_w5$Q23_B + data_num_plus_autolab_w5$Q28_B

# w7

data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Agree"] <- 2
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == ""] <- 1.5

data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Agree"] <- 2
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == ""] <- 1.5

data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Agree"] <- 2
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == ""] <- 1.5


data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Agree"] <- 2
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == ""] <- 1.5


data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Agree"] <- 2
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == ""] <- 1.5

data_num_plus_autolab_w7$ENCOURAGEMENT <- data_num_plus_autolab_w7$Q8_B + data_num_plus_autolab_w7$Q14_B + data_num_plus_autolab_w7$Q18_B + data_num_plus_autolab_w7$Q23_B + data_num_plus_autolab_w7$Q28_B



names(data_num_plus_autolab)

# DONE WITH ATTITUDES

data_f23_num_untrimmed <- data_num
data_f23_num_untrimmed_plus_autolab_all <-  data_num_plus_autolab_all
data_f23_num_untrimmed_plus_autolab_w4 <-  data_num_plus_autolab_w4
data_f23_num_untrimmed_plus_autolab_w5 <-  data_num_plus_autolab_w5
data_f23_num_untrimmed_plus_autolab_w7 <-  data_num_plus_autolab_w7

data_f23_not_num_untrimmed <- data_not_num
data_f23_not_num_untrimmed_plus_autolab_all <-  data_not_num_plus_autolab_all
data_f23_not_num_untrimmed_plus_autolab_w4 <-  data_not_num_plus_autolab_w4
data_f23_not_num_untrimmed_plus_autolab_w5 <-  data_not_num_plus_autolab_w5
data_f23_not_num_untrimmed_plus_autolab_w7 <-  data_not_num_plus_autolab_w7

# Remove unneeded attributes

# DATA_NOT_NUM

names(data_not_num)
selected_variables <- c("NetID", "gender_cd", "ethnic_cd", "course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","citizen_status_cd","SUCCESS", "Q1","Q2", "Q4", "Q35")

data_not_num_ss <- data_not_num # SAVE!

data_not_num_temp <- data_not_num[selected_variables]
data_not_num <- data_not_num_temp

# Same for Autolab data
names(data_not_num_plus_autolab_w4)

data_not_num_plus_autolab_ss_all <- data_not_num_plus_autolab_all # SAVE!
data_not_num_plus_autolab_temp_all <- data_not_num_plus_autolab_all[selected_variables]
data_not_num_plus_autolab_all <- data_not_num_plus_autolab_temp_all


data_not_num_plus_autolab_ss_w4 <- data_not_num_plus_autolab_w4 # SAVE!
data_not_num_plus_autolab_temp_w4 <- data_not_num_plus_autolab_w4[selected_variables]
data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_temp_w4

data_not_num_plus_autolab_ss_w5 <- data_not_num_plus_autolab_w5 # SAVE!
data_not_num_plus_autolab_temp_w5 <- data_not_num_plus_autolab_w5[selected_variables]
data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_temp_w5

data_not_num_plus_autolab_ss_w7 <- data_not_num_plus_autolab_w7 # SAVE!
data_not_num_plus_autolab_temp_w7 <- data_not_num_plus_autolab_w7[selected_variables]
data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_temp_w7


# DATA_NUM

# Paste from Spring 2021

names(data_num)
names(data_num_plus_autolab)

selected_variables <- c("Final.Points","Exam1", "Exam2","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14","RecWeek15", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_ss <- data_num # SAVE!

data_num_temp <- data_num[selected_variables]
names(data_num_temp)
data_num <- data_num_temp

# DATA_NUM_WITH_AUTOLAB

names(data_num_plus_autolab_w4)

data_num_plus_autolab_w4$max_submissions
selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES","max_submissions", "max_time_f_l_subm", "max_time_consecutive_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission", "min_time_b4_deadline_first_submission",  "max_time_b4_deadline_last_submission", "min_time_b4_deadline_last_submission")

#selected_variables <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.", "X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.", "X8..Find.Duplicate..1067540.", "X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.", "X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.", "Recitation.10..1129728.", "Recitation.2..1129729.", "Recitation.3..1129730.", "Recitation.7..1129732.", "Recitation.4..1129733.","Recitation.12..1129734.", "Recitation.5..1129735.", "Recitation.8..1129736.", "Recitation.13..1129737.",  "Recitation.11..1129738.", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_plus_autolab_ss_all <- data_num_plus_autolab_all # SAVE!
data_num_plus_autolab_temp_all <- data_num_plus_autolab_all[selected_variables]
data_num_plus_autolab_all <- data_num_plus_autolab_temp_all

data_num_plus_autolab_ss_w4 <- data_num_plus_autolab_w4 # SAVE!
data_num_plus_autolab_temp_w4 <- data_num_plus_autolab_w4[selected_variables]
data_num_plus_autolab_w4 <- data_num_plus_autolab_temp_w4

data_num_plus_autolab_ss_w5 <- data_num_plus_autolab_w5 # SAVE!
data_num_plus_autolab_temp_w5 <- data_num_plus_autolab_w5[selected_variables]
data_num_plus_autolab_w5 <- data_num_plus_autolab_temp_w5

data_num_plus_autolab_ss_w7 <- data_num_plus_autolab_w7 # SAVE!
data_num_plus_autolab_temp_w7 <- data_num_plus_autolab_w7[selected_variables]
data_num_plus_autolab_w7 <- data_num_plus_autolab_temp_w7

names(data_num_plus_autolab_w7)


# select meaningful variables from non-numeric features
str(data_not_num)

success_s <- data_not_num$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7$SUCCESS


# SAVE THE NUM AND NOT NUM DATA FRAMES

data_num_s <- data_num
data_not_num_s <- data_not_num

data_num_a_s_all <- data_num_plus_autolab_all
data_not_num_a_s_all <-data_not_num_plus_autolab_all

data_num_a_s_w4 <- data_num_plus_autolab_w4
data_not_num_a_s_w4 <-data_not_num_plus_autolab_w4

data_num_a_s_w5 <- data_num_plus_autolab_w5
data_not_num_a_s_w5 <-data_not_num_plus_autolab_w5

data_num_a_s_w7 <- data_num_plus_autolab_w7
data_not_num_a_s_w7 <-data_not_num_plus_autolab_w7



# Done paste Spring 2021

names(data_num)

table(data_num$Exit.Survey..1127030.) # get rid of
table(data_num$Recitations.Final.Points) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of
# etc etc etc Recitations...
# same for Quizzes and Assignments! we won't have this info half way through the semester
# same for Final.Points, etc.

# DATA_NUM_WITH_AUTOLAB

names(data_num)

names(data_not_num)

## RECOVER NUM AND NOT NUM DATA FRAMES

names(data_not_num)
names(data_num)

drops_not_num <- c("NetID", "SUCCESS")

data_not_num <- data_not_num[ , !(names(data_not_num) %in% drops_not_num)]
#data_not_num$Duration..in.seconds. <- as.integer(data_not_num$Duration..in.seconds.)

data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all[ , !(names(data_not_num_plus_autolab_all) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4[ , !(names(data_not_num_plus_autolab_w4) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5[ , !(names(data_not_num_plus_autolab_w5) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7[ , !(names(data_not_num_plus_autolab_w7) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


str(data_not_num)

library(lattice)
library(caret)
# one-hot encoding


# get rid of constant(empty) fields, otherwise can't do one-hot encoding because of errors..
library(janitor)
data_not_num_saved <- data_not_num
data_not_num <- remove_constant(data_not_num_saved, na.rm= TRUE)

data_not_num_plus_autolab_saved_all <- data_not_num_plus_autolab_all
data_not_num_plus_autolab_all <- remove_constant(data_not_num_plus_autolab_saved_all, na.rm= TRUE)


data_not_num_plus_autolab_saved_w4 <- data_not_num_plus_autolab_w4
data_not_num_plus_autolab_w4 <- remove_constant(data_not_num_plus_autolab_saved_w4, na.rm= TRUE)

data_not_num_plus_autolab_saved_w5 <- data_not_num_plus_autolab_w5
data_not_num_plus_autolab_w5 <- remove_constant(data_not_num_plus_autolab_saved_w5, na.rm= TRUE)

data_not_num_plus_autolab_saved_w7 <- data_not_num_plus_autolab_w7
data_not_num_plus_autolab_w7 <- remove_constant(data_not_num_plus_autolab_saved_w7, na.rm= TRUE)



library(caret)

dummy <- dummyVars(" ~ .", data=data_not_num)
final_df <- data.frame(predict(dummy, newdata=data_not_num))

dummy_a_all <- dummyVars(" ~ .", data=data_not_num_plus_autolab_all)
final_df_a_all <- data.frame(predict(dummy_a_all, newdata=data_not_num_plus_autolab_all))


dummy_a_w4 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w4)
final_df_a_w4 <- data.frame(predict(dummy_a_w4, newdata=data_not_num_plus_autolab_w4))

dummy_a_w5 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w5)
final_df_a_w5 <- data.frame(predict(dummy_a_w5, newdata=data_not_num_plus_autolab_w5))

dummy_a_w7 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w7)
final_df_a_w7 <- data.frame(predict(dummy_a_w7, newdata=data_not_num_plus_autolab_w7))


# Need to check for zero-variance features.. save to do later ...

# Mix numeric and categorical variables
data_f23_preprocessed <- cbind(data_num, final_df)
data_f23_preprocessed$SUCCESS <- success_s
data_f23_no_na <- na.omit(data_f23_preprocessed)
success_s <- data_f23_no_na$SUCCESS
data_f23_no_na <- data_f23_no_na[, !(names(data_f23_no_na) %in% c("SUCCESS"))]
#length(success_a_w4)
#table(data_num$RecWeek2)
#var(data_num$RecWeek3)
#names(data_f23_no_na)

#checking for constant columns...
data_f23_no_na_saved <- data_f23_no_na
data_f23_no_na <- remove_constant(data_f23_no_na_saved, na.rm= TRUE)

# plus autolab...

#all

data_f23_preprocessed_a_all <- cbind(data_num_plus_autolab_all, final_df_a_all)
data_f23_preprocessed_a_all$SUCCESS <- success_s_a_all
data_f23_no_na_plus_autolab_all <- na.omit(data_f23_preprocessed_a_all)
success_a_all <- data_f23_no_na_plus_autolab_all$SUCCESS
data_f23_no_na_plus_autolab_all <- data_f23_no_na_plus_autolab_all[, !(names(data_f23_no_na_plus_autolab_all) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_f23_no_na_plus_autolab_saved_all <- data_f23_no_na_plus_autolab_all
data_f23_no_na_plus_autolab_all <- remove_constant(data_f23_no_na_plus_autolab_saved_all, na.rm= TRUE)


#W4

data_f23_preprocessed_a_w4 <- cbind(data_num_plus_autolab_w4, final_df_a_w4)
data_f23_preprocessed_a_w4$SUCCESS <- success_s_a_w4
data_f23_no_na_plus_autolab_w4 <- na.omit(data_f23_preprocessed_a_w4)
success_a_w4 <- data_f23_no_na_plus_autolab_w4$SUCCESS
data_f23_no_na_plus_autolab_w4 <- data_f23_no_na_plus_autolab_w4[, !(names(data_f23_no_na_plus_autolab_w4) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_f23_no_na_plus_autolab_saved_w4 <- data_f23_no_na_plus_autolab_w4
data_f23_no_na_plus_autolab_w4 <- remove_constant(data_f23_no_na_plus_autolab_saved_w4, na.rm= TRUE)

#W5

data_f23_preprocessed_a_w5 <- cbind(data_num_plus_autolab_w5, final_df_a_w5)
data_f23_preprocessed_a_w5$SUCCESS <- success_s_a_w5
data_f23_no_na_plus_autolab_w5 <- na.omit(data_f23_preprocessed_a_w5)
success_a_w5 <- data_f23_no_na_plus_autolab_w5$SUCCESS
data_f23_no_na_plus_autolab_w5 <- data_f23_no_na_plus_autolab_w5[, !(names(data_f23_no_na_plus_autolab_w5) %in% c("SUCCESS"))]

#checking for constant columns...
data_f23_no_na_plus_autolab_saved_w5 <- data_f23_no_na_plus_autolab_w5
data_f23_no_na_plus_autolab_w5 <- remove_constant(data_f23_no_na_plus_autolab_saved_w5, na.rm= TRUE)

#w7

data_f23_preprocessed_a_w7 <- cbind(data_num_plus_autolab_w7, final_df_a_w7)
data_f23_preprocessed_a_w7$SUCCESS <- success_s_a_w7
data_f23_no_na_plus_autolab_w7 <- na.omit(data_f23_preprocessed_a_w7)
success_a_w7 <- data_f23_no_na_plus_autolab_w7$SUCCESS
data_f23_no_na_plus_autolab_w7 <- data_f23_no_na_plus_autolab_w7[, !(names(data_f23_no_na_plus_autolab_w7) %in% c("SUCCESS"))]



#checking for constant columns...
data_f23_no_na_plus_autolab_saved_w7 <- data_f23_no_na_plus_autolab_w7
data_f23_no_na_plus_autolab_w7 <- remove_constant(data_f23_no_na_plus_autolab_saved_w7, na.rm= TRUE)


# Need to check for correlated features
cor_matrix <- cor(data_f23_no_na)
#write.csv(cor_matrix,file="cortmp.csv")

for (i in 1:nrow(cor_matrix)){
  correlations <-  which((abs(cor_matrix[i,]) > 0.70))
  if(length(correlations)> 0){
    print(colnames(data_f23_no_na)[i])
    print(correlations)
  }
}

# REMOVE CORRELATED VARS: COPY FROM SPRING 2021 data

indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.70)

remove_corrs <- data_f23_no_na[-c(indexes_to_drop)]

data_f23_no_na_no_corr <- remove_corrs

names(remove_corrs)

cor_matrix <- cor(data_f23_no_na_no_corr)
indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.70)

# indexes to drop is now empty, which means NO CORRELATIONS OVER 0.9!
names(data_f23_no_na_no_corr)

# DONE REMOVONG CORR VARS


# AUTOLAB DATA : remove correlated variables

# all

# Need to check for correlated features
cor_matrix_a <- cor(data_f23_no_na_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f23_no_na_plus_autolab_all[-c(indexes_to_drop)]
data_f23_no_na_no_corr_plus_autolab_all <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f23_no_na_no_corr_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)# should be empty


# W4

# Need to check for correlated features
cor_matrix_a <- cor(data_f23_no_na_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f23_no_na_plus_autolab_w4[-c(indexes_to_drop)]
data_f23_no_na_no_corr_plus_autolab_w4 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f23_no_na_no_corr_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# w5

# Need to check for correlated features
cor_matrix_a <- cor(data_f23_no_na_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f23_no_na_plus_autolab_w5[-c(indexes_to_drop)]
data_f23_no_na_no_corr_plus_autolab_w5 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f23_no_na_no_corr_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

# w7

# Need to check for correlated features
cor_matrix_a <- cor(data_f23_no_na_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)

remove_corrs <- data_f23_no_na_plus_autolab_w7[-c(indexes_to_drop)]
data_f23_no_na_no_corr_plus_autolab_w7 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_f23_no_na_no_corr_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)


# empty, no more variables with correlations over 0.9!

# get rid of features with variance under 0.005
# copied from Spring 2021
# BETTER?? Apply variances on data without correlations

variances <- sapply(data_f23_no_na_no_corr, var)
variances_a_all <- sapply(data_f23_no_na_no_corr_plus_autolab_all, var)
variances_a_w4 <- sapply(data_f23_no_na_no_corr_plus_autolab_w4, var)
variances_a_w5 <- sapply(data_f23_no_na_no_corr_plus_autolab_w5, var)
variances_a_w7 <- sapply(data_f23_no_na_no_corr_plus_autolab_w7, var)


low_variance_features <- c()

colnames(data_f23_no_na_no_corr)[1]

for (i in 1:ncol(data_f23_no_na_no_corr)){
  
  if(variances[i] < 0.005)
  {
    low_variance_features <- c(low_variance_features, colnames(data_f23_no_na_no_corr)[i])
    print(i)
    print(colnames(data_f23_no_na_no_corr)[i])
    print(variances[i])
  }
}  

# Data Autolab 

# ALL

low_variance_features_a_all <- c()

for (i in 1:ncol(data_f23_no_na_no_corr_plus_autolab_all)){
  
  if(variances_a_all[i] < 0.005)
  {
    low_variance_features_a_all <- c(low_variance_features_a_all, colnames(data_f23_no_na_no_corr_plus_autolab_all)[i])
    print(i)
    print(colnames(data_f23_no_na_no_corr_plus_autolab_all)[i])
    print(variances_a_all[i])
  }
}  


#W4

low_variance_features_a_w4 <- c()

for (i in 1:ncol(data_f23_no_na_no_corr_plus_autolab_w4)){
  
  if(variances_a_w4[i] < 0.005)
  {
    low_variance_features_a_w4 <- c(low_variance_features_a_w4, colnames(data_f23_no_na_no_corr_plus_autolab_w4)[i])
    print(i)
    print(colnames(data_f23_no_na_no_corr_plus_autolab_w4)[i])
    print(variances_a_w4[i])
  }
}  

#w5

low_variance_features_a_w5 <- c()

for (i in 1:ncol(data_f23_no_na_no_corr_plus_autolab_w5)){
  
  if(variances_a_w5[i] < 0.005)
  {
    low_variance_features_a_w5 <- c(low_variance_features_a_w5, colnames(data_f23_no_na_no_corr_plus_autolab_w5)[i])
    print(i)
    print(colnames(data_f23_no_na_no_corr_plus_autolab_w5)[i])
    print(variances_a_w5[i])
  }
}  

#W7

low_variance_features_a_w7 <- c()

for (i in 1:ncol(data_f23_no_na_no_corr_plus_autolab_w7)){
  
  if(variances_a_w7[i] < 0.005)
  {
    low_variance_features_a_w7 <- c(low_variance_features_a_w7, colnames(data_f23_no_na_no_corr_plus_autolab_w7)[i])
    print(i)
    print(colnames(data_f23_no_na_no_corr_plus_autolab_w7)[i])
    print(variances_a_w7[i])
  }
}  



# done copied from Spring 2021

# Drop low variance features from Spring 2021 code

drops_n <- low_variance_features
drops_n_a_all <- low_variance_features_a_all
drops_n_a_w4 <- low_variance_features_a_w4
drops_n_a_w5 <- low_variance_features_a_w5
drops_n_a_w7 <- low_variance_features_a_w7


data_f23_final <- data_f23_no_na_no_corr[ , !(names(data_f23_no_na_no_corr) %in% drops_n)]
data_f23_no_na_no_corr_no_low_var <- data_f23_final

data_f23_final_a_all <- data_f23_no_na_no_corr_plus_autolab_all[ , !(names(data_f23_no_na_no_corr_plus_autolab_all) %in% drops_n_a_all)]
data_f23_no_na_no_corr_no_low_var_a_all <- data_f23_final_a_all


data_f23_final_a_w4 <- data_f23_no_na_no_corr_plus_autolab_w4[ , !(names(data_f23_no_na_no_corr_plus_autolab_w4) %in% drops_n_a_w4)]
data_f23_no_na_no_corr_no_low_var_a_w4 <- data_f23_final_a_w4

data_f23_final_a_w5 <- data_f23_no_na_no_corr_plus_autolab_w5[ , !(names(data_f23_no_na_no_corr_plus_autolab_w5) %in% drops_n_a_w5)]
data_f23_no_na_no_corr_no_low_var_a_w5 <- data_f23_final_a_w5

data_f23_final_a_w7 <- data_f23_no_na_no_corr_plus_autolab_w7[ , !(names(data_f23_no_na_no_corr_plus_autolab_w7) %in% drops_n_a_w7)]
data_f23_no_na_no_corr_no_low_var_a_w7 <- data_f23_final_a_w7


data_f23_final$SUCCESS <- success_s
data_f23_final_a_all$SUCCESS <- success_a_all
data_f23_final_a_w4$SUCCESS <- success_a_w4
data_f23_final_a_w5$SUCCESS <- success_a_w5
data_f23_final_a_w7$SUCCESS <- success_a_w7

data_f23_no_na_no_corr_no_low_var$SUCCESS <- success_s
data_f23_no_na_no_corr_no_low_var_a_all$SUCCESS <- success_a_all
data_f23_no_na_no_corr_no_low_var_a_w4$SUCCESS <- success_a_w4
data_f23_no_na_no_corr_no_low_var_a_w5$SUCCESS <- success_a_w5
data_f23_no_na_no_corr_no_low_var_a_w7$SUCCESS <- success_a_w7


names(data_f23_no_na_no_corr_no_low_var_a_w4)
# DONE with Drop low variance features from Spring 2021 code


table(data_f20_no_na_a$SUCCESS)
# check again for zero variance
#final_df_no_na <- remove_constant(data_no_na, na.rm= TRUE)


# Feature importance

control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)

# for data with autolab up to week 7 ...
control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final_a, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)


# RECURSIVE FEATURE ELIMINATION... NOT DONE!

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=10)
# run the RFE algorithm
results <- rfe(PimaIndiansDiabetes[,1:8], PimaIndiansDiabetes[,9], sizes=c(1:8), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))


# Write the final result in a file
getwd()
write.csv(data_f23_final, "Data_f23_After_Processing.csv", row.names = FALSE)
write.csv(data_f23_final_a_all, "Data_f23_After_Processing_w_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_f23_final_a_w4, "Data_f23_After_Processing_w_Autolab_W4.csv", row.names = FALSE)
write.csv(data_f23_final_a_w5, "Data_f23_After_Processing_w_Autolab_W5.csv", row.names = FALSE)
write.csv(data_f23_final_a_w7, "Data_f23_After_Processing_w_Autolab_W7.csv", row.names = FALSE)

# DATA WITH ALL THE FEATURES: data_f20_no_na
# No correlated features and no features with 0 variance

names(data_f23_final)

#data_f23_final <- read.csv("Data_f23_After_Processing.csv", row.names = FALSE)
#data_f23_final_a_all <- read.csv("Data_f23_After_Processing_w_Autolab_ALL.csv", header = TRUE)
#data_f23_final_a_w4 <- read.csv("Data_f23_After_Processing_w_Autolab_W4.csv", header = TRUE)
#data_f23_final_a_w5 <- read.csv("Data_f23_After_Processing_w_Autolab_W5.csv", header = TRUE)
#data_f23_final_a_w7 <- read.csv("Data_f23_After_Processing_w_Autolab_W7.csv", header = TRUE)


########################################################
#                                                      #
#     SAME PREPROCESSING For DATA FOR SPRING 2021      #
#                                                      #
########################################################

# intro survey has only students who have given consent for research
data_intro_s21_111_t <- data_intro_s21_111[data_intro_s21_111$Q38=="Yes, I understand.",]
data_intro_s21_111 <- data_intro_s21_111_t


# STEP 1: Merge Canvas+SAS with Intro survey
data_all1 <- merge(data_canvas_and_sas_s21_111, data_intro_s21_111, by = "NetID")
names(data_all1)
data_all_plus_autolab_all <- merge(data_all1, data_autolab_s21)
data_all_plus_autolab_w4 <- merge(data_all1, data_autolab_s21_w4)
data_all_plus_autolab_w5 <- merge(data_all1, data_autolab_s21_w5)
data_all_plus_autolab_w7 <- merge(data_all1, data_autolab_s21_w7)
names(data_all_plus_autolab_w7)
# Turn SUCCESS into a factor so we can do classification on it

data_all1$SUCCESS <- as.factor(data_all1$SUCCESS)
table(data_all1$SUCCESS)
data_all_plus_autolab_all$SUCCESS <- as.factor(data_all_plus_autolab_all$SUCCESS)
data_all_plus_autolab_w4$SUCCESS <- as.factor(data_all_plus_autolab_w4$SUCCESS)
data_all_plus_autolab_w5$SUCCESS <- as.factor(data_all_plus_autolab_w5$SUCCESS)
data_all_plus_autolab_w7$SUCCESS <- as.factor(data_all_plus_autolab_w7$SUCCESS)

write.csv(data_all_plus_autolab_all, "s21_Beginnning_Of_Processing_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w4, "s21_Beginnning_Of_Processing_Autolab_W4.csv", row.names = FALSE)
write.csv(data_all1, "s21_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w5, "s21_Beginnning_Of_Processing_Autolab_W5.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w7, "s21_Beginnning_Of_Processing_Autolab_W7.csv", row.names = FALSE)

# ADD AUTOLAB FEATURES

# all

data_all_plus_autolab_all$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_first_submission)
data_all_plus_autolab_all$max_time_f_l_subm <- as.integer(data_all_plus_autolab_all$max_time_f_l_subm)
data_all_plus_autolab_all$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_all$max_time_consecutive_submissions)
data_all_plus_autolab_all$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_last_submission)
data_all_plus_autolab_all$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_first_submission)
data_all_plus_autolab_all$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_last_submission)


# w4

data_all_plus_autolab_w4$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w4$max_time_f_l_subm)
data_all_plus_autolab_w4$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w4$max_time_consecutive_submissions)
data_all_plus_autolab_w4$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7
data_s21_plus_autolab_week4 <- data_all_plus_autolab_w4
write.csv(data_s21_plus_autolab_week4, "s21_W4_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

# W5

data_all_plus_autolab_w5$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w5$max_time_f_l_subm)
data_all_plus_autolab_w5$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w5$max_time_consecutive_submissions)
data_all_plus_autolab_w5$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_s21 <- data_all1
data_s21_plus_autolab_week5 <- data_all_plus_autolab_w5

write.csv(data_s21_plus_autolab_week5, "s21_W5_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)


# W7

data_all_plus_autolab_w7$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w7$max_time_f_l_subm)
data_all_plus_autolab_w7$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w7$max_time_consecutive_submissions)
data_all_plus_autolab_w7$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_s21 <- data_all1
data_s21_plus_autolab_all <- data_all_plus_autolab_all
data_s21_plus_autolab_week4 <- data_all_plus_autolab_w4
data_s21_plus_autolab_week5 <- data_all_plus_autolab_w5
data_s21_plus_autolab_week7 <- data_all_plus_autolab_w7

write.csv(data_s21_plus_autolab_week7, "s21_W_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

names(data_all1)

data_s21$SUCCESS <- as.factor(data_s21$SUCCESS)
data_s21_plus_autolab_all$SUCCESS <- as.factor(data_s21_plus_autolab_all$SUCCESS)
data_s21_plus_autolab_week4$SUCCESS <- as.factor(data_s21_plus_autolab_week4$SUCCESS)
data_s21_plus_autolab_week5$SUCCESS <- as.factor(data_s21_plus_autolab_week5$SUCCESS)
data_s21_plus_autolab_week7$SUCCESS <- as.factor(data_s21_plus_autolab_week7$SUCCESS)

# double check ...
table(data_s21$SUCCESS)
library(dplyr)

# Turn all numeric features into numbers

data_s21$Duration..in.seconds. <- as.numeric(data_s21$Duration..in.seconds.)
data_s21_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_all$Duration..in.seconds.)
data_s21_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_week4$Duration..in.seconds.)
data_s21_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_week5$Duration..in.seconds.)
data_s21_plus_autolab_week7$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_week7$Duration..in.seconds.)

# Turn features that should be categories into factors

data_s21$sending_school_type_cd <- as.factor(data_s21$sending_school_type_cd)
data_s21$orig_admit_type_cd <- as.factor(data_s21$orig_admit_type_cd)
data_s21$citizen_status_cd <- as.factor(data_s21$citizen_status_cd)
data_s21$curr_admit_type_cd <- as.factor(data_s21$curr_admit_type_cd)

data_s21_plus_autolab_all$sending_school_type_cd <- as.factor(data_s21_plus_autolab_all$sending_school_type_cd)
data_s21_plus_autolab_all$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_all$orig_admit_type_cd)
data_s21_plus_autolab_all$citizen_status_cd <- as.factor(data_s21_plus_autolab_all$citizen_status_cd)
data_s21_plus_autolab_all$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_all$curr_admit_type_cd)


data_s21_plus_autolab_week4$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week4$sending_school_type_cd)
data_s21_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week4$orig_admit_type_cd)
data_s21_plus_autolab_week4$citizen_status_cd <- as.factor(data_s21_plus_autolab_week4$citizen_status_cd)
data_s21_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week4$curr_admit_type_cd)

data_s21_plus_autolab_week5$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week5$sending_school_type_cd)
data_s21_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week5$orig_admit_type_cd)
data_s21_plus_autolab_week5$citizen_status_cd <- as.factor(data_s21_plus_autolab_week5$citizen_status_cd)
data_s21_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week5$curr_admit_type_cd)


data_s21_plus_autolab_week7$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week7$sending_school_type_cd)
data_s21_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week7$orig_admit_type_cd)
data_s21_plus_autolab_week7$citizen_status_cd <- as.factor(data_s21_plus_autolab_week7$citizen_status_cd)
data_s21_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week7$curr_admit_type_cd)



# remove students whose progress is not 100%
table(data_s21$Progress)
table(data_s21_plus_autolab_week7$Progress)

data_s21_temp <- data_s21[data_s21$Progress == "100",]
data_s21 <- data_s21_temp

data_s21_plus_autolab_all_temp <- data_s21_plus_autolab_all[data_s21_plus_autolab_all$Progress == "100",]
data_s21_plus_autolab_all <- data_s21_plus_autolab_all_temp


data_s21_plus_autolab_week4_temp <- data_s21_plus_autolab_week4[data_s21_plus_autolab_week4$Progress == "100",]
data_s21_plus_autolab_week4 <- data_s21_plus_autolab_week4_temp

data_s21_plus_autolab_week5_temp <- data_s21_plus_autolab_week5[data_s21_plus_autolab_week5$Progress == "100",]
data_s21_plus_autolab_week5 <- data_s21_plus_autolab_week5_temp


data_s21_plus_autolab_week7_temp <- data_s21_plus_autolab_week7[data_s21_plus_autolab_week7$Progress == "100",]
data_s21_plus_autolab_week7 <- data_s21_plus_autolab_week7_temp

data_s21$Assignments.Current.Points <- as.numeric(data_s21$Assignments.Current.Points)
data_s21$Assignments.Final.Points <- as.numeric(data_s21$Assignments.Final.Points)
data_s21$Assignments.Current.Score <- as.numeric(data_s21$Assignments.Current.Score)
data_s21$Assignments.Unposted.Current.Score <- as.numeric(data_s21$Assignments.Unposted.Current.Score)
data_s21$Assignments.Final.Score <- as.numeric(data_s21$Assignments.Final.Score)
data_s21$Assignments.Unposted.Final.Score <- as.numeric(data_s21$Assignments.Unposted.Final.Score)

data_s21$Quizzes.Current.Points <- as.numeric(data_s21$Current.Points)
data_s21$Quizzes.Final.Points <- as.numeric(data_s21$Final.Points)
data_s21$Quizzes.Current.Score <- as.numeric(data_s21$Current.Score)
data_s21$Quizzes.Unposted.Current.Score  <- as.numeric(data_s21$Unposted.Current.Score )
data_s21$Quizzes.Final.Score <- as.numeric(data_s21$Final.Score)
data_s21$Quizzes.Unposted.Final.Score <- as.numeric(data_s21$Unposted.Final.Score)

names(data_s21)

data_s21$Recitations.Current.Points <- as.numeric(data_s21$Recitations.Current.Points)
data_s21$Recitations.Final.Points <- as.numeric(data_s21$Recitations.Final.Points)
data_s21$Recitations.Current.Score <- as.numeric(data_s21$Recitations.Current.Score)
data_s21$Recitations.Unposted.Current.Score  <- as.numeric(data_s21$Recitations.Unposted.Current.Score )
data_s21$Recitations.Final.Score <- as.numeric(data_s21$Recitations.Final.Score)
data_s21$Recitations.Unposted.Final.Score <- as.numeric(data_s21$Recitations.Unposted.Final.Score)

data_s21$Current.Points <- as.numeric(data_s21$Current.Points)
data_s21$Final.Points <- as.numeric(data_s21$Final.Points)
data_s21$Current.Score <- as.numeric(data_s21$Current.Score)
data_s21$Unposted.Current.Score  <- as.numeric(data_s21$Unposted.Current.Score )
data_s21$Final.Score <- as.numeric(data_s21$Final.Score)
data_s21$Unposted.Final.Score <- as.numeric(data_s21$Unposted.Final.Score)

data_s21_plus_autolab_all$Current.Points <- as.numeric(data_s21_plus_autolab_all$Current.Points)
data_s21_plus_autolab_all$Final.Points <- as.numeric(data_s21_plus_autolab_all$Final.Points)
data_s21_plus_autolab_all$Current.Score <- as.numeric(data_s21_plus_autolab_all$Current.Score)
data_s21_plus_autolab_all$Unposted.Current.Score  <- as.numeric(data_s21_plus_autolab_all$Unposted.Current.Score )
data_s21_plus_autolab_all$Final.Score <- as.numeric(data_s21_plus_autolab_all$Final.Score)
data_s21_plus_autolab_all$Unposted.Final.Score <- as.numeric(data_s21_plus_autolab_all$Unposted.Final.Score)
data_s21_plus_autolab_all$Progress <- as.numeric(data_s21_plus_autolab_all$Progress)
data_s21_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_all$Duration..in.seconds.)


str(data_s21_plus_autolab_all)

data_s21_plus_autolab_week4$Current.Points <- as.numeric(data_s21_plus_autolab_week4$Current.Points)
data_s21_plus_autolab_week4$Final.Points <- as.numeric(data_s21_plus_autolab_week4$Final.Points)
data_s21_plus_autolab_week4$Current.Score <- as.numeric(data_s21_plus_autolab_week4$Current.Score)
data_s21_plus_autolab_week4$Unposted.Current.Score  <- as.numeric(data_s21_plus_autolab_week4$Unposted.Current.Score )
data_s21_plus_autolab_week4$Final.Score <- as.numeric(data_s21_plus_autolab_week4$Final.Score)
data_s21_plus_autolab_week4$Unposted.Final.Score <- as.numeric(data_s21_plus_autolab_week4$Unposted.Final.Score)
data_s21_plus_autolab_week4$Progress <- as.numeric(data_s21_plus_autolab_week4$Progress)
data_s21_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_week4$Duration..in.seconds.)



data_s21_plus_autolab_week5$Current.Points <- as.numeric(data_s21_plus_autolab_week5$Current.Points)
data_s21_plus_autolab_week5$Final.Points <- as.numeric(data_s21_plus_autolab_week5$Final.Points)
data_s21_plus_autolab_week5$Current.Score <- as.numeric(data_s21_plus_autolab_week5$Current.Score)
data_s21_plus_autolab_week5$Unposted.Current.Score  <- as.numeric(data_s21_plus_autolab_week5$Unposted.Current.Score )
data_s21_plus_autolab_week5$Final.Score <- as.numeric(data_s21_plus_autolab_week5$Final.Score)
data_s21_plus_autolab_week5$Unposted.Final.Score <- as.numeric(data_s21_plus_autolab_week5$Unposted.Final.Score)
data_s21_plus_autolab_week5$Progress <- as.numeric(data_s21_plus_autolab_week5$Progress)
data_s21_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_s21_plus_autolab_week5$Duration..in.seconds.)


data_s21_plus_autolab_week7$Current.Points <- as.numeric(data_s21_plus_autolab_week7$Current.Points)
data_s21_plus_autolab_week7$Final.Points <- as.numeric(data_s21_plus_autolab_week7$Final.Points)
data_s21_plus_autolab_week7$Current.Score <- as.numeric(data_s21_plus_autolab_week7$Current.Score)
data_s21_plus_autolab_week7$Unposted.Current.Score  <- as.numeric(data_s21_plus_autolab_week7$Unposted.Current.Score )
data_s21_plus_autolab_week7$Final.Score <- as.numeric(data_s21_plus_autolab_week7$Final.Score)
data_s21_plus_autolab_week7$Unposted.Final.Score <- as.numeric(data_s21_plus_autolab_week7$Unposted.Final.Score)

# data_f20$unit_of_reg_cd <- as.factor(data_f20$unit_of_reg_cd)
# data_f20$subj_cd <- as.factor(data_f20$subj_cd)
# data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)
# data_f20$housing_status_cd <- as.factor(data_f20$housing_status_cd)
# data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
# data_f20$deg_earned_curric_cd1 <- as.factor(data_f20$deg_earned_curric_cd1)
# data_f20$deg_minor_curric_cd1 <- as.factor(data_f20$deg_minor_curric_cd1)

#data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_s21_plus_autolab_all$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_all$curr_admit_type_cd)
data_s21_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week4$curr_admit_type_cd)
data_s21_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week5$curr_admit_type_cd)
data_s21_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_s21_plus_autolab_week7$curr_admit_type_cd)

data_s21_plus_autolab_all$sending_school_type_cd <- as.factor(data_s21_plus_autolab_all$sending_school_type_cd)
data_s21_plus_autolab_week4$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week4$sending_school_type_cd)
data_s21_plus_autolab_week5$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week5$sending_school_type_cd)
data_s21_plus_autolab_week7$sending_school_type_cd <- as.factor(data_s21_plus_autolab_week7$sending_school_type_cd)

data_s21_plus_autolab_all$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_all$orig_admit_type_cd)
data_s21_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week4$orig_admit_type_cd)
data_s21_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week5$orig_admit_type_cd)
data_s21_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_s21_plus_autolab_week7$orig_admit_type_cd)

data_s21_plus_autolab_all$citizen_status_cd <- as.factor(data_s21_plus_autolab_all$citizen_status_cd)
data_s21_plus_autolab_week4$citizen_status_cd <- as.factor(data_s21_plus_autolab_week4$citizen_status_cd)
data_s21_plus_autolab_week5$citizen_status_cd <- as.factor(data_s21_plus_autolab_week5$citizen_status_cd)
data_s21_plus_autolab_week7$citizen_status_cd <- as.factor(data_s21_plus_autolab_week7$citizen_status_cd)

str(data_s21_plus_autolab_all)

# Split data into numeric and not numeric features

data_num <- select_if(data_s21, is.numeric)
data_not_num <- data_s21[ , !(names(data_s21) %in% names(data_num))]
str(data_s21_plus_autolab_week4$Final.Points)

data_num_plus_autolab_all <- select_if(data_s21_plus_autolab_all, is.numeric)
data_not_num_plus_autolab_all <- data_s21_plus_autolab_all[ , !(names(data_s21_plus_autolab_all) %in% names(data_num_plus_autolab_all))]

data_num_plus_autolab_w4 <- select_if(data_s21_plus_autolab_week4, is.numeric)
data_not_num_plus_autolab_w4 <- data_s21_plus_autolab_week4[ , !(names(data_s21_plus_autolab_week4) %in% names(data_num_plus_autolab_w4))]

data_num_plus_autolab_w5 <- select_if(data_s21_plus_autolab_week5, is.numeric)
data_not_num_plus_autolab_w5 <- data_s21_plus_autolab_week5[ , !(names(data_s21_plus_autolab_week5) %in% names(data_num_plus_autolab_w5))]

data_num_plus_autolab_w7 <- select_if(data_s21_plus_autolab_week7, is.numeric)
data_not_num_plus_autolab_w7 <- data_s21_plus_autolab_week7[ , !(names(data_s21_plus_autolab_week7) %in% names(data_num_plus_autolab_w7))]

names(data_num_plus_autolab)
names(data_not_num_plus_autolab)

data_not_num_plus_autolab$Q38_1
names(data_not_num)

table(data_not_num$Section) # out
table(data_not_num$Current.Grade) # out b/c it corr with predicted var
table(data_not_num$Unposted.Current.Grade) # out: same as the one before
table(data_not_num$Final.Grade) # ibid
table(data_not_num$Unposted.Final.Grade) # ibid

table(data_not_num$gender_cd) # can stay
table(data_not_num$ethnic_cd) # can stay
table(data_not_num$SUCCESS) # has to stay

table(data_not_num$EndDate) # can go, probably irrelevant
table(data_not_num$Progress) # can go after selecting students who completed it 100%
table(data_not_num$Finished) # same as before, can remove those for whom it's FALSE and then get rid of column
table(data_not_num$RecordedDate) # irrelevant
table(data_not_num$UserLanguage) # can go, everyone is ENG
table(data_not_num$Q38) # can go, everyone agrees to take part of research


table(data_not_num$Q1) # can stay, major

table(data_not_num$Q33) # second major, lots of NA, may not have enough variablilty.. 
table(data_not_num$Q32) # minor, 206 undecided.., may not be a great feature
table(data_not_num$Q30) # second minor, 406 none, may need to get rid of

table(data_not_num$Q2) # keep.. reason they are taking CS1

table(data_not_num$Q2_8_TEXT) # mostly empty, get rid of
table(data_not_num$Q2_6_TEXT) # mostly empty, get rid of
table(data_not_num$Q44) # empty, get rid of
table(data_not_num$Q44_8_TEXT) # empty, get rid of
table(data_not_num$Q44_6_TEXT) # empty, get rid of

table(data_not_num$Q4) # Keep, prior experience

table(data_not_num$Q4_6_TEXT) # mostly empty
table(data_not_num$Q34) # mostly empty

table(data_not_num$Q35) # Keep, how difficult do they think the class will be
table(data_not_num$Q37) # get rid of, how would they explain cs

# Q43 is empty: get rid of it!

table(data_not_num$Q43)

# 30 variables so far.

# attitudes are 24 questions/variables.

# attitude qs  Q3, Q5 - Q12, Q14 - 28  1 + 8 + 15 = 24 questions
table(data_not_num$Q3)
table(data_not_num$Q5)
table(data_not_num$Q6)
table(data_not_num$Q7)
table(data_not_num$Q8)


# etc.

# Q38: Which of the following have you done this year or do you plan to do? Check all that apply. 
# I have no interest in doing this 0 / I did this in the past year 3 / I plan to do this in the future 2 / I'm not sure 1

table(data_not_num$Q38_1) # Participate in social events sponsored by the CS Living Learning Community
table(data_not_num$Q38_2) # Take a 200-level computer science course
table(data_not_num$Q38_3) # Matriculate as a computer science major
table(data_not_num$Q38_4) # Become a learning assistant for a computer science course
table(data_not_num$Q38_5) # Become a learning assistant for a computer science course
table(data_not_num$Q38_6) # Become a peer mentor in computer science
table(data_not_num$Q38_7) # Participate in the Reboot program, supporting high schools with CS instruction
table(data_not_num$Q38_8) # Do an internship that involves computer science
table(data_not_num$Q38_9) # Do academic research in the computer science field
table(data_not_num$Q38_10) # Join a professional organization or attend a professional conference in computer science
table(data_not_num$Q38_11) # Pursue a career in computer science
table(data_not_num$Q38_12) # Pursue a career in a field related to computer science

names(data_num)

data_num$ENGAGEMENT <- 0

data_num$E1[data_not_num$Q38_1 == "I did this in the past year"] <- 3
data_num$E1[data_not_num$Q38_1 == "I plan to do this in the future"] <- 2
data_num$E1[data_not_num$Q38_1 == "I'm not sure"] <- 1
data_num$E1[data_not_num$Q38_1 == "I have no interest in doing this"] <- 0
data_num$E1[data_not_num$Q38_1 == ""] <- 1.5

#table(data_num$E1)

data_num$E2[data_not_num$Q38_2 == "I did this in the past year"] <- 3
data_num$E2[data_not_num$Q38_2 == "I plan to do this in the future"] <- 2
data_num$E2[data_not_num$Q38_2 == "I'm not sure"] <- 1
data_num$E2[data_not_num$Q38_2 == "I have no interest in doing this"] <- 0
data_num$E2[data_not_num$Q38_2 == ""] <- 1.5

data_num$E3[data_not_num$Q38_3 == "I did this in the past year"] <- 3
data_num$E3[data_not_num$Q38_3 == "I plan to do this in the future"] <- 2
data_num$E3[data_not_num$Q38_3 == "I'm not sure"] <- 1
data_num$E3[data_not_num$Q38_3 == "I have no interest in doing this"] <- 0
data_num$E3[data_not_num$Q38_3 == ""] <- 1.5

data_num$E4[data_not_num$Q38_4 == "I did this in the past year"] <- 3
data_num$E4[data_not_num$Q38_4 == "I plan to do this in the future"] <- 2
data_num$E4[data_not_num$Q38_4 == "I'm not sure"] <- 1
data_num$E4[data_not_num$Q38_4 == "I have no interest in doing this"] <- 0
data_num$E4[data_not_num$Q38_4 == ""] <- 1.5

data_num$E5[data_not_num$Q38_5 == "I did this in the past year"] <- 3
data_num$E5[data_not_num$Q38_5 == "I plan to do this in the future"] <- 2
data_num$E5[data_not_num$Q38_5 == "I'm not sure"] <- 1
data_num$E5[data_not_num$Q38_5 == "I have no interest in doing this"] <- 0
data_num$E5[data_not_num$Q38_5 == ""] <- 1.5

data_num$E6[data_not_num$Q38_6 == "I did this in the past year"] <- 3
data_num$E6[data_not_num$Q38_6 == "I plan to do this in the future"] <- 2
data_num$E6[data_not_num$Q38_6 == "I'm not sure"] <- 1
data_num$E6[data_not_num$Q38_6 == "I have no interest in doing this"] <- 0
data_num$E6[data_not_num$Q38_6 == ""] <- 1.5

data_num$E7[data_not_num$Q38_7 == "I did this in the past year"] <- 3
data_num$E7[data_not_num$Q38_7 == "I plan to do this in the future"] <- 2
data_num$E7[data_not_num$Q38_7 == "I'm not sure"] <- 1
data_num$E7[data_not_num$Q38_7 == "I have no interest in doing this"] <- 0
data_num$E7[data_not_num$Q38_7 == ""] <- 1.5

data_num$E8[data_not_num$Q38_8 == "I did this in the past year"] <- 3
data_num$E8[data_not_num$Q38_8 == "I plan to do this in the future"] <- 2
data_num$E8[data_not_num$Q38_8 == "I'm not sure"] <- 1
data_num$E8[data_not_num$Q38_8 == "I have no interest in doing this"] <- 0
data_num$E8[data_not_num$Q38_8 == ""] <- 1.5

data_num$E9[data_not_num$Q38_9 == "I did this in the past year"] <- 3
data_num$E9[data_not_num$Q38_9 == "I plan to do this in the future"] <- 2
data_num$E9[data_not_num$Q38_9 == "I'm not sure"] <- 1
data_num$E9[data_not_num$Q38_9 == "I have no interest in doing this"] <- 0
data_num$E9[data_not_num$Q38_9 == ""] <- 1.5

data_num$E10[data_not_num$Q38_10 == "I did this in the past year"] <- 3
data_num$E10[data_not_num$Q38_10 == "I plan to do this in the future"] <- 2
data_num$E10[data_not_num$Q38_10 == "I'm not sure"] <- 1
data_num$E10[data_not_num$Q38_10 == "I have no interest in doing this"] <- 0
data_num$E10[data_not_num$Q38_10 == ""] <- 1.5

data_num$E11[data_not_num$Q38_11 == "I did this in the past year"] <- 3
data_num$E11[data_not_num$Q38_11 == "I plan to do this in the future"] <- 2
data_num$E11[data_not_num$Q38_11 == "I'm not sure"] <- 1
data_num$E11[data_not_num$Q38_11 == "I have no interest in doing this"] <- 0
data_num$E11[data_not_num$Q38_11 == ""] <- 1.5

data_num$E12[data_not_num$Q38_12 == "I did this in the past year"] <- 3
data_num$E12[data_not_num$Q38_12 == "I plan to do this in the future"] <- 2
data_num$E12[data_not_num$Q38_12 == "I'm not sure"] <- 1
data_num$E12[data_not_num$Q38_12 == "I have no interest in doing this"] <- 0
data_num$E12[data_not_num$Q38_12 == ""] <- 1.5

data_num$ENGAGEMENT <- data_num$E1 + data_num$E2 + data_num$E3 + data_num$E4 + data_num$E5 + data_num$E6 + data_num$E7 + data_num$E8 + data_num$E9 + data_num$E10 + data_num$E11 + data_num$E12

#all

data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_all$E1)

data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == ""] <- 1.5

data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == ""] <- 1.5


data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == ""] <- 1.5

data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == ""] <- 1.5

data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == ""] <- 1.5

data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == ""] <- 1.5

data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == ""] <- 1.5

data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == ""] <- 1.5

data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == ""] <- 1.5

data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == ""] <- 1.5

data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == ""] <- 1.5

data_num_plus_autolab_all$ENGAGEMENT <- data_num_plus_autolab_all$E1 + data_num_plus_autolab_all$E2 + data_num_plus_autolab_all$E3 + data_num_plus_autolab_all$E4 + data_num_plus_autolab_all$E5 + data_num_plus_autolab_all$E6 + data_num_plus_autolab_all$E7 + data_num_plus_autolab_all$E8 + data_num_plus_autolab_all$E9 + data_num_plus_autolab_all$E10 + data_num_plus_autolab_all$E11 + data_num_plus_autolab_all$E12


#W4

data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w4$E1)

data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w4$ENGAGEMENT <- data_num_plus_autolab_w4$E1 + data_num_plus_autolab_w4$E2 + data_num_plus_autolab_w4$E3 + data_num_plus_autolab_w4$E4 + data_num_plus_autolab_w4$E5 + data_num_plus_autolab_w4$E6 + data_num_plus_autolab_w4$E7 + data_num_plus_autolab_w4$E8 + data_num_plus_autolab_w4$E9 + data_num_plus_autolab_w4$E10 + data_num_plus_autolab_w4$E11 + data_num_plus_autolab_w4$E12

#w5

data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w5$E1)

data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w5$ENGAGEMENT <- data_num_plus_autolab_w5$E1 + data_num_plus_autolab_w5$E2 + data_num_plus_autolab_w5$E3 + data_num_plus_autolab_w5$E4 + data_num_plus_autolab_w5$E5 + data_num_plus_autolab_w5$E6 + data_num_plus_autolab_w5$E7 + data_num_plus_autolab_w5$E8 + data_num_plus_autolab_w5$E9 + data_num_plus_autolab_w5$E10 + data_num_plus_autolab_w5$E11 + data_num_plus_autolab_w5$E12

#w7

data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w7$E1)

data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w7$ENGAGEMENT <- data_num_plus_autolab_w7$E1 + data_num_plus_autolab_w7$E2 + data_num_plus_autolab_w7$E3 + data_num_plus_autolab_w7$E4 + data_num_plus_autolab_w7$E5 + data_num_plus_autolab_w7$E6 + data_num_plus_autolab_w7$E7 + data_num_plus_autolab_w7$E8 + data_num_plus_autolab_w7$E9 + data_num_plus_autolab_w7$E10 + data_num_plus_autolab_w7$E11 + data_num_plus_autolab_w7$E12


table(data_num$ENGAGEMENT)

# Q39 : To what extent do you agree with the following statements? 
# Strongly agree / Somewhat agree / Not sure / Somewhat disagree / Strongly disagree

table(data_not_num$Q39_1) # With hard work, anyone can become an expert in computer science
table(data_not_num$Q39_2) # Women and men have the same level of natural ability and talent in computer science
table(data_not_num$Q39_3) # Women are less capable of success in computer science than men
table(data_not_num$Q39_4) # Men are more likely to excel in careers that involve computing than women are
table(data_not_num$Q39_5) # Men are more capable than women at solving computing problems


data_num$A1[data_not_num$Q39_1 == "Strongly agree"] <- 3
data_num$A1[data_not_num$Q39_1 == "Somewhat agree"] <- 2
data_num$A1[data_not_num$Q39_1 == "Not sure"] <- 1.5
data_num$A1[data_not_num$Q39_1 == "Somewhat disagree"] <- 1
data_num$A1[data_not_num$Q39_1 == "Strongly disagree"] <- 0
data_num$A1[data_not_num$Q39_1 == ""] <- 1.5

data_num$A2[data_not_num$Q39_2 == "Strongly agree"] <- 3
data_num$A2[data_not_num$Q39_2 == "Somewhat agree"] <- 2
data_num$A2[data_not_num$Q39_2 == "Not sure"] <- 1.5
data_num$A2[data_not_num$Q39_2 == "Somewhat disagree"] <- 1
data_num$A2[data_not_num$Q39_2 == "Strongly disagree"] <- 0
data_num$A2[data_not_num$Q39_2 == ""] <- 1.5

# inverted scale
data_num$A3[data_not_num$Q39_3 == "Strongly disagree"] <- 3
data_num$A3[data_not_num$Q39_3 == "Somewhat disagree"] <- 2
data_num$A3[data_not_num$Q39_3 == "Not sure"] <- 1.5
data_num$A3[data_not_num$Q39_3 == "Somewhat agree"] <- 1
data_num$A3[data_not_num$Q39_3 == "Strongly sagree"] <- 0
data_num$A3[data_not_num$Q39_3 == ""] <- 1.5

data_num$A4[data_not_num$Q39_4 == "Strongly disagree"] <- 3
data_num$A4[data_not_num$Q39_4 == "Somewhat disagree"] <- 2
data_num$A4[data_not_num$Q39_4 == "Not sure"] <- 1.5
data_num$A4[data_not_num$Q39_4 == "Somewhat agree"] <- 1
data_num$A4[data_not_num$Q39_4 == "Strongly agree"] <- 0
data_num$A4[data_not_num$Q39_4 == ""] <- 1.5

data_num$A5[data_not_num$Q39_5 == "Strongly disagree"] <- 3
data_num$A5[data_not_num$Q39_5 == "Somewhat disagree"] <- 2
data_num$A5[data_not_num$Q39_5 == "Not sure"] <- 1.5
data_num$A5[data_not_num$Q39_5 == "Somewhat agree"] <- 1
data_num$A5[data_not_num$Q39_5 == "Strongly agree"] <- 0
data_num$A5[data_not_num$Q39_5 == ""] <- 1.5

data_num$ATTITUDES <- data_num$A1 + data_num$A2 + data_num$A3 + data_num$A4  + data_num$A5

# all

data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == ""] <- 1.5

data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == ""] <- 1.5

data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == ""] <- 1.5

data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == ""] <- 1.5

data_num_plus_autolab_all$ATTITUDES <- data_num_plus_autolab_all$A1 + data_num_plus_autolab_all$A2 + data_num_plus_autolab_all$A3 + data_num_plus_autolab_all$A4 + data_num_plus_autolab_all$A5



# W4

data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w4$ATTITUDES <- data_num_plus_autolab_w4$A1 + data_num_plus_autolab_w4$A2 + data_num_plus_autolab_w4$A3 + data_num_plus_autolab_w4$A4 + data_num_plus_autolab_w4$A5

# w5

data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w5$A1[data_s21_plus_autolab_week5$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A2[data_s21_plus_autolab_week5$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A3[data_s21_plus_autolab_week5$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A4[data_s21_plus_autolab_week5$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A5[data_s21_plus_autolab_week5$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w5$ATTITUDES <- data_num_plus_autolab_w5$A1 + data_num_plus_autolab_w5$A2 + data_num_plus_autolab_w5$A3 + data_num_plus_autolab_w5$A4 + data_num_plus_autolab_w5$A5

# w7

data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w7$ATTITUDES <- data_num_plus_autolab_w7$A1 + data_num_plus_autolab_w7$A2 + data_num_plus_autolab_w7$A3 + data_num_plus_autolab_w7$A4 + data_num_plus_autolab_w7$A5


# Divide the value for ATTITUDES by 15, which is the max possible value

#data_num$ATTITUDES <- data_num$ATTITUDES/15
#data_num_plus_autolab$ATTITUDES <- data_num_plus_autolab$ATTITUDES/15


names(data_not_num)


str(data_num_plus_autolab)
str(data_not_num_plus_autolab)
names(data_f20_plus_autolab_week7)

# REPLACE ATTITUDES WITH NUMBERS

data_num$BELONGINGNESS <- 0
data_num$CONFIDENCE <- 0
data_num$INTEREST <- 0
data_num$USEFULNESS <- 0
data_num$ENCOURAGEMENT <- 0

data_num_plus_autolab_all$BELONGINGNESS <- 0
data_num_plus_autolab_all$CONFIDENCE <- 0
data_num_plus_autolab_all$INTEREST <- 0
data_num_plus_autolab_all$USEFULNESS <- 0
data_num_plus_autolab_all$ENCOURAGEMENT <- 0
data_num_plus_autolab_all$Q6_B <- 0 
data_num_plus_autolab_all$Q3_B <- 0 
data_num_plus_autolab_all$Q11_B <- 0 
data_num_plus_autolab_all$Q57_B <- 0 
data_num_plus_autolab_all$Q21_B <- 0 
data_num_plus_autolab_all$Q26_B <- 0


data_num_plus_autolab_w4$BELONGINGNESS <- 0
data_num_plus_autolab_w4$CONFIDENCE <- 0
data_num_plus_autolab_w4$INTEREST <- 0
data_num_plus_autolab_w4$USEFULNESS <- 0
data_num_plus_autolab_w4$ENCOURAGEMENT <- 0
data_num_plus_autolab_w4$Q6_B <- 0 
data_num_plus_autolab_w4$Q3_B <- 0 
data_num_plus_autolab_w4$Q11_B <- 0 
data_num_plus_autolab_w4$Q57_B <- 0 
data_num_plus_autolab_w4$Q21_B <- 0 
data_num_plus_autolab_w4$Q26_B <- 0

data_num_plus_autolab_w5$BELONGINGNESS <- 0
data_num_plus_autolab_w5$CONFIDENCE <- 0
data_num_plus_autolab_w5$INTEREST <- 0
data_num_plus_autolab_w5$USEFULNESS <- 0
data_num_plus_autolab_w5$ENCOURAGEMENT <- 0
data_num_plus_autolab_w5$Q6_B <- 0 
data_num_plus_autolab_w5$Q3_B <- 0 
data_num_plus_autolab_w5$Q11_B <- 0 
data_num_plus_autolab_w5$Q57_B <- 0 
data_num_plus_autolab_w5$Q21_B <- 0 
data_num_plus_autolab_w5$Q26_B <- 0

data_num_plus_autolab_w7$BELONGINGNESS <- 0
data_num_plus_autolab_w7$CONFIDENCE <- 0
data_num_plus_autolab_w7$INTEREST <- 0
data_num_plus_autolab_w7$USEFULNESS <- 0
data_num_plus_autolab_w7$ENCOURAGEMENT <- 0
data_num_plus_autolab_w7$Q6_B <- 0 
data_num_plus_autolab_w7$Q3_B <- 0 
data_num_plus_autolab_w7$Q11_B <- 0 
data_num_plus_autolab_w7$Q57_B <- 0 
data_num_plus_autolab_w7$Q21_B <- 0 
data_num_plus_autolab_w7$Q26_B <- 0


# Belongingness

names(data_not_num)

data_num$Q6_B[data_not_num$Q6 == "Strongly Agree"] <- 3
data_num$Q6_B[data_not_num$Q6 == "Agree"] <- 2
data_num$Q6_B[data_not_num$Q6 == "Disagree"] <- 1
data_num$Q6_B[data_not_num$Q6 == "Strongly Disagree"] <- 0
data_num$Q6_B[data_not_num$Q6 == ""] <- 1.5 # average between agree and disagree

data_num$Q11_B[data_not_num$Q11 == "Strongly Agree"] <- 3
data_num$Q11_B[data_not_num$Q11 == "Agree"] <- 2
data_num$Q11_B[data_not_num$Q11 == "Disagree"] <- 1
data_num$Q11_B[data_not_num$Q11 == "Strongly Disagree"] <- 0
data_num$Q11_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q21_B[data_not_num$Q21 == "Strongly Agree"] <- 3
data_num$Q21_B[data_not_num$Q21 == "Agree"] <- 2
data_num$Q21_B[data_not_num$Q21 == "Disagree"] <- 1
data_num$Q21_B[data_not_num$Q21 == "Strongly Disagree"] <- 0
data_num$Q21_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q26_B[data_not_num$Q26 == "Strongly Agree"] <- 3
data_num$Q26_B[data_not_num$Q26 == "Agree"] <- 2
data_num$Q26_B[data_not_num$Q26 == "Disagree"] <- 1
data_num$Q26_B[data_not_num$Q26 == "Strongly Disagree"] <- 0
data_num$Q26_B[data_not_num$Q26 == ""] <- 1.5

data_num$BELONGINGNESS <- data_num$Q6_B + data_num$Q11_B + data_num$Q21_B + data_num$Q26_B

# all

data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Agree"] <- 2
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Disagree"] <- 1
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Agree"] <- 2
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Disagree"] <- 1
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == ""] <- 1.5

data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Agree"] <- 2
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Disagree"] <- 1
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == ""] <- 1.5

data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Agree"] <- 2
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Disagree"] <- 1
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == ""] <- 1.5

data_num_plus_autolab_all$BELONGINGNESS <- data_num_plus_autolab_all$Q6_B + data_num_plus_autolab_all$Q11_B + data_num_plus_autolab_all$Q21_B + data_num_plus_autolab_all$Q26_B


# W4

data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Agree"] <- 2
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Agree"] <- 2
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == ""] <- 1.5

data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Agree"] <- 2
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == ""] <- 1.5

data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Agree"] <- 2
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == ""] <- 1.5

data_num_plus_autolab_w4$BELONGINGNESS <- data_num_plus_autolab_w4$Q6_B + data_num_plus_autolab_w4$Q11_B + data_num_plus_autolab_w4$Q21_B + data_num_plus_autolab_w4$Q26_B

# w5

data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Agree"] <- 2
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Agree"] <- 2
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == ""] <- 1.5

data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Agree"] <- 2
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == ""] <- 1.5

data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Agree"] <- 2
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == ""] <- 1.5

data_num_plus_autolab_w5$BELONGINGNESS <- data_num_plus_autolab_w5$Q6_B + data_num_plus_autolab_w5$Q11_B + data_num_plus_autolab_w5$Q21_B + data_num_plus_autolab_w5$Q26_B

# w7

data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Agree"] <- 2
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Agree"] <- 2
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == ""] <- 1.5

data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Agree"] <- 2
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == ""] <- 1.5

data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Agree"] <- 2
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == ""] <- 1.5

data_num_plus_autolab_w7$BELONGINGNESS <- data_num_plus_autolab_w7$Q6_B + data_num_plus_autolab_w7$Q11_B + data_num_plus_autolab_w7$Q21_B + data_num_plus_autolab_w7$Q26_B



# Confidence
# Q3, Q9, Q15, Q19, Q24

data_num$Q3_B[data_not_num$Q3 == "Strongly Agree"] <- 3
data_num$Q3_B[data_not_num$Q3 == "Agree"] <- 2
data_num$Q3_B[data_not_num$Q3 == "Disagree"] <- 1
data_num$Q3_B[data_not_num$Q3 == "Strongly Disagree"] <- 0
data_num$Q3_B[data_not_num$Q3 == ""] <- 1.5

data_num$Q9_B[data_not_num$Q9 == "Strongly Agree"] <- 3
data_num$Q9_B[data_not_num$Q9 == "Agree"] <- 2
data_num$Q9_B[data_not_num$Q9 == "Disagree"] <- 1
data_num$Q9_B[data_not_num$Q9 == "Strongly Disagree"] <- 0
data_num$Q9_B[data_not_num$Q9 == ""] <- 1.5

data_num$Q15_B[data_not_num$Q15 == "Strongly Agree"] <- 3
data_num$Q15_B[data_not_num$Q15 == "Agree"] <- 2
data_num$Q15_B[data_not_num$Q15 == "Disagree"] <- 1
data_num$Q15_B[data_not_num$Q15 == "Strongly Disagree"] <- 0
data_num$Q15_B[data_not_num$Q15 == ""] <- 1.5


data_num$Q19_B[data_not_num$Q19 == "Strongly Agree"] <- 3
data_num$Q19_B[data_not_num$Q19 == "Agree"] <- 2
data_num$Q19_B[data_not_num$Q19 == "Disagree"] <- 1
data_num$Q19_B[data_not_num$Q19 == "Strongly Disagree"] <- 0
data_num$Q19_B[data_not_num$Q19 == ""] <- 1.5


data_num$Q24_B[data_not_num$Q24 == "Strongly Agree"] <- 3
data_num$Q24_B[data_not_num$Q24 == "Agree"] <- 2
data_num$Q24_B[data_not_num$Q24 == "Disagree"] <- 1
data_num$Q24_B[data_not_num$Q24 == "Strongly Disagree"] <- 0
data_num$Q24_B[data_not_num$Q24 == ""] <- 1.5

data_num$CONFIDENCE <- data_num$Q3_B + data_num$Q9_B + data_num$Q15_B + data_num$Q19_B + data_num$Q24_B

# all

data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Agree"] <- 2
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Disagree"] <- 1
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == ""] <- 1.5

data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Agree"] <- 2
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Disagree"] <- 1
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == ""] <- 1.5

data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Agree"] <- 2
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Disagree"] <- 1
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == ""] <- 1.5


data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Agree"] <- 2
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Disagree"] <- 1
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == ""] <- 1.5


data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Agree"] <- 2
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Disagree"] <- 1
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == ""] <- 1.5

data_num_plus_autolab_all$CONFIDENCE <- data_num_plus_autolab_all$Q3_B + data_num_plus_autolab_all$Q9_B + data_num_plus_autolab_all$Q15_B + data_num_plus_autolab_all$Q19_B + data_num_plus_autolab_all$Q24_B


# W4

data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Agree"] <- 2
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == ""] <- 1.5

data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Agree"] <- 2
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == ""] <- 1.5

data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Agree"] <- 2
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == ""] <- 1.5


data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Agree"] <- 2
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == ""] <- 1.5


data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Agree"] <- 2
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == ""] <- 1.5

data_num_plus_autolab_w4$CONFIDENCE <- data_num_plus_autolab_w4$Q3_B + data_num_plus_autolab_w4$Q9_B + data_num_plus_autolab_w4$Q15_B + data_num_plus_autolab_w4$Q19_B + data_num_plus_autolab_w4$Q24_B

# w5

data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Agree"] <- 2
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == ""] <- 1.5

data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Agree"] <- 2
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == ""] <- 1.5

data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Agree"] <- 2
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == ""] <- 1.5


data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Agree"] <- 2
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == ""] <- 1.5


data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Agree"] <- 2
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == ""] <- 1.5

data_num_plus_autolab_w5$CONFIDENCE <- data_num_plus_autolab_w5$Q3_B + data_num_plus_autolab_w5$Q9_B + data_num_plus_autolab_w5$Q15_B + data_num_plus_autolab_w5$Q19_B + data_num_plus_autolab_w5$Q24_B

# w7

data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Agree"] <- 2
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == ""] <- 1.5

data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Agree"] <- 2
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == ""] <- 1.5

data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Agree"] <- 2
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == ""] <- 1.5


data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Agree"] <- 2
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == ""] <- 1.5


data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Agree"] <- 2
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == ""] <- 1.5

data_num_plus_autolab_w7$CONFIDENCE <- data_num_plus_autolab_w7$Q3_B + data_num_plus_autolab_w7$Q9_B + data_num_plus_autolab_w7$Q15_B + data_num_plus_autolab_w7$Q19_B + data_num_plus_autolab_w7$Q24_B


# Interest
#Q5, Q10, Q16, Q20, Q25

data_num$Q5_B[data_not_num$Q5 == "Strongly Agree"] <- 3
data_num$Q5_B[data_not_num$Q5 == "Agree"] <- 2
data_num$Q5_B[data_not_num$Q5 == "Disagree"] <- 1
data_num$Q5_B[data_not_num$Q5 == "Strongly Disagree"] <- 0
data_num$Q5_B[data_not_num$Q5 == ""] <- 1.5

data_num$Q10_B[data_not_num$Q10 == "Strongly Agree"] <- 3
data_num$Q10_B[data_not_num$Q10 == "Agree"] <- 2
data_num$Q10_B[data_not_num$Q10 == "Disagree"] <- 1
data_num$Q10_B[data_not_num$Q10 == "Strongly Disagree"] <- 0
data_num$Q10_B[data_not_num$Q10 == ""] <- 1.5

data_num$Q16_B[data_not_num$Q16 == "Strongly Agree"] <- 3
data_num$Q16_B[data_not_num$Q16 == "Agree"] <- 2
data_num$Q16_B[data_not_num$Q16 == "Disagree"] <- 1
data_num$Q16_B[data_not_num$Q16 == "Strongly Disagree"] <- 0
data_num$Q16_B[data_not_num$Q16 == ""] <- 1.5


data_num$Q20_B[data_not_num$Q20 == "Strongly Agree"] <- 3
data_num$Q20_B[data_not_num$Q20 == "Agree"] <- 2
data_num$Q20_B[data_not_num$Q20 == "Disagree"] <- 1
data_num$Q20_B[data_not_num$Q20 == "Strongly Disagree"] <- 0
data_num$Q20_B[data_not_num$Q20 == ""] <- 1.5


data_num$Q25_B[data_not_num$Q25 == "Strongly Agree"] <- 3
data_num$Q25_B[data_not_num$Q25 == "Agree"] <- 2
data_num$Q25_B[data_not_num$Q25 == "Disagree"] <- 1
data_num$Q25_B[data_not_num$Q25 == "Strongly Disagree"] <- 0
data_num$Q25_B[data_not_num$Q25 == ""] <- 1.5

data_num$INTEREST <- data_num$Q5_B + data_num$Q10_B + data_num$Q16_B + data_num$Q20_B + data_num$Q25_B

#all

data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Agree"] <- 2
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Disagree"] <- 1
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == ""] <- 1.5

data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Agree"] <- 2
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Disagree"] <- 1
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == ""] <- 1.5

data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Agree"] <- 2
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Disagree"] <- 1
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == ""] <- 1.5


data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Agree"] <- 2
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Disagree"] <- 1
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == ""] <- 1.5


data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Agree"] <- 2
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Disagree"] <- 1
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == ""] <- 1.5

data_num_plus_autolab_all$INTEREST <- data_num_plus_autolab_all$Q5_B + data_num_plus_autolab_all$Q10_B + data_num_plus_autolab_all$Q16_B + data_num_plus_autolab_all$Q20_B + data_num_plus_autolab_all$Q25_B


#W4

data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Agree"] <- 2
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == ""] <- 1.5

data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Agree"] <- 2
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == ""] <- 1.5

data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Agree"] <- 2
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == ""] <- 1.5


data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Agree"] <- 2
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == ""] <- 1.5


data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Agree"] <- 2
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == ""] <- 1.5

data_num_plus_autolab_w4$INTEREST <- data_num_plus_autolab_w4$Q5_B + data_num_plus_autolab_w4$Q10_B + data_num_plus_autolab_w4$Q16_B + data_num_plus_autolab_w4$Q20_B + data_num_plus_autolab_w4$Q25_B

#W5

data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Agree"] <- 2
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == ""] <- 1.5

data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Agree"] <- 2
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == ""] <- 1.5

data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Agree"] <- 2
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == ""] <- 1.5


data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Agree"] <- 2
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == ""] <- 1.5


data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Agree"] <- 2
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == ""] <- 1.5

data_num_plus_autolab_w5$INTEREST <- data_num_plus_autolab_w5$Q5_B + data_num_plus_autolab_w5$Q10_B + data_num_plus_autolab_w5$Q16_B + data_num_plus_autolab_w5$Q20_B + data_num_plus_autolab_w5$Q25_B

#w7

data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Agree"] <- 2
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == ""] <- 1.5

data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Agree"] <- 2
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == ""] <- 1.5

data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Agree"] <- 2
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == ""] <- 1.5


data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Agree"] <- 2
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == ""] <- 1.5


data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Agree"] <- 2
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == ""] <- 1.5

data_num_plus_autolab_w7$INTEREST <- data_num_plus_autolab_w7$Q5_B + data_num_plus_autolab_w7$Q10_B + data_num_plus_autolab_w7$Q16_B + data_num_plus_autolab_w7$Q20_B + data_num_plus_autolab_w7$Q25_B


# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_num$Q7_B[data_not_num$Q7 == "Strongly Agree"] <- 3
data_num$Q7_B[data_not_num$Q7 == "Agree"] <- 2
data_num$Q7_B[data_not_num$Q7 == "Disagree"] <- 1
data_num$Q7_B[data_not_num$Q7 == "Strongly Disagree"] <- 0
data_num$Q7_B[data_not_num$Q7 == ""] <- 1.5

data_num$Q12_B[data_not_num$Q12 == "Strongly Agree"] <- 3
data_num$Q12_B[data_not_num$Q12 == "Agree"] <- 2
data_num$Q12_B[data_not_num$Q12 == "Disagree"] <- 1
data_num$Q12_B[data_not_num$Q12 == "Strongly Disagree"] <- 0
data_num$Q12_B[data_not_num$Q12 == ""] <- 1.5

data_num$Q17_B[data_not_num$Q17 == "Strongly Agree"] <- 3
data_num$Q17_B[data_not_num$Q17 == "Agree"] <- 2
data_num$Q17_B[data_not_num$Q17 == "Disagree"] <- 1
data_num$Q17_B[data_not_num$Q17 == "Strongly Disagree"] <- 0
data_num$Q17_B[data_not_num$Q17 == ""] <- 1.5


data_num$Q22_B[data_not_num$Q22 == "Strongly Agree"] <- 3
data_num$Q22_B[data_not_num$Q22 == "Agree"] <- 2
data_num$Q22_B[data_not_num$Q22 == "Disagree"] <- 1
data_num$Q22_B[data_not_num$Q22 == "Strongly Disagree"] <- 0
data_num$Q22_B[data_not_num$Q22 == ""] <- 1.5


data_num$Q27_B[data_not_num$Q27 == "Strongly Agree"] <- 3
data_num$Q27_B[data_not_num$Q27 == "Agree"] <- 2
data_num$Q27_B[data_not_num$Q27 == "Disagree"] <- 1
data_num$Q27_B[data_not_num$Q27 == "Strongly Disagree"] <- 0
data_num$Q27_B[data_not_num$Q27 == ""] <- 1.5

data_num$USEFULNESS <- data_num$Q7_B + data_num$Q12_B + data_num$Q17_B + data_num$Q22_B + data_num$Q27_B

#all

data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Agree"] <- 2
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Disagree"] <- 1
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == ""] <- 1.5

data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Agree"] <- 2
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Disagree"] <- 1
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == ""] <- 1.5

data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Agree"] <- 2
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Disagree"] <- 1
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == ""] <- 1.5


data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Agree"] <- 2
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Disagree"] <- 1
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == ""] <- 1.5


data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Agree"] <- 2
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Disagree"] <- 1
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == ""] <- 1.5

data_num_plus_autolab_all$USEFULNESS <- data_num_plus_autolab_all$Q7_B + data_num_plus_autolab_all$Q12_B + data_num_plus_autolab_all$Q17_B + data_num_plus_autolab_all$Q22_B + data_num_plus_autolab_all$Q27_B


#W4

data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Agree"] <- 2
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == ""] <- 1.5

data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Agree"] <- 2
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == ""] <- 1.5

data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Agree"] <- 2
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == ""] <- 1.5


data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Agree"] <- 2
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == ""] <- 1.5


data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Agree"] <- 2
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == ""] <- 1.5

data_num_plus_autolab_w4$USEFULNESS <- data_num_plus_autolab_w4$Q7_B + data_num_plus_autolab_w4$Q12_B + data_num_plus_autolab_w4$Q17_B + data_num_plus_autolab_w4$Q22_B + data_num_plus_autolab_w4$Q27_B

# W5

data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Agree"] <- 2
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == ""] <- 1.5

data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Agree"] <- 2
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == ""] <- 1.5

data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Agree"] <- 2
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == ""] <- 1.5


data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Agree"] <- 2
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == ""] <- 1.5


data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Agree"] <- 2
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == ""] <- 1.5

data_num_plus_autolab_w5$USEFULNESS <- data_num_plus_autolab_w5$Q7_B + data_num_plus_autolab_w5$Q12_B + data_num_plus_autolab_w5$Q17_B + data_num_plus_autolab_w5$Q22_B + data_num_plus_autolab_w5$Q27_B

#w7

data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Agree"] <- 2
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == ""] <- 1.5

data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Agree"] <- 2
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == ""] <- 1.5

data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Agree"] <- 2
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == ""] <- 1.5


data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Agree"] <- 2
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == ""] <- 1.5


data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Agree"] <- 2
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == ""] <- 1.5

data_num_plus_autolab_w7$USEFULNESS <- data_num_plus_autolab_w7$Q7_B + data_num_plus_autolab_w7$Q12_B + data_num_plus_autolab_w7$Q17_B + data_num_plus_autolab_w7$Q22_B + data_num_plus_autolab_w7$Q27_B



# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_num$Q8_B[data_not_num$Q8 == "Strongly Agree"] <- 3
data_num$Q8_B[data_not_num$Q8 == "Agree"] <- 2
data_num$Q8_B[data_not_num$Q8 == "Disagree"] <- 1
data_num$Q8_B[data_not_num$Q8 == "Strongly Disagree"] <- 0
data_num$Q8_B[data_not_num$Q8 == ""] <- 1.5

data_num$Q14_B[data_not_num$Q14 == "Strongly Agree"] <- 3
data_num$Q14_B[data_not_num$Q14 == "Agree"] <- 2
data_num$Q14_B[data_not_num$Q14 == "Disagree"] <- 1
data_num$Q14_B[data_not_num$Q14 == "Strongly Disagree"] <- 0
data_num$Q14_B[data_not_num$Q14 == ""] <- 1.5

data_num$Q18_B[data_not_num$Q18 == "Strongly Agree"] <- 3
data_num$Q18_B[data_not_num$Q18 == "Agree"] <- 2
data_num$Q18_B[data_not_num$Q18 == "Disagree"] <- 1
data_num$Q18_B[data_not_num$Q18 == "Strongly Disagree"] <- 0
data_num$Q18_B[data_not_num$Q18 == ""] <- 1.5


data_num$Q23_B[data_not_num$Q23 == "Strongly Agree"] <- 3
data_num$Q23_B[data_not_num$Q23 == "Agree"] <- 2
data_num$Q23_B[data_not_num$Q23 == "Disagree"] <- 1
data_num$Q23_B[data_not_num$Q23 == "Strongly Disagree"] <- 0
data_num$Q23_B[data_not_num$Q23 == ""] <- 1.5


data_num$Q28_B[data_not_num$Q28 == "Strongly Agree"] <- 3
data_num$Q28_B[data_not_num$Q28 == "Agree"] <- 2
data_num$Q28_B[data_not_num$Q28 == "Disagree"] <- 1
data_num$Q28_B[data_not_num$Q28 == "Strongly Disagree"] <- 0
data_num$Q28_B[data_not_num$Q28 == ""] <- 1.5

data_num$ENCOURAGEMENT <- data_num$Q8_B + data_num$Q14_B + data_num$Q18_B + data_num$Q23_B + data_num$Q28_B

# all

data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Agree"] <- 2
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Disagree"] <- 1
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == ""] <- 1.5

data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Agree"] <- 2
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Disagree"] <- 1
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == ""] <- 1.5

data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Agree"] <- 2
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Disagree"] <- 1
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == ""] <- 1.5


data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Agree"] <- 2
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Disagree"] <- 1
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == ""] <- 1.5


data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Agree"] <- 2
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Disagree"] <- 1
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == ""] <- 1.5

data_num_plus_autolab_all$ENCOURAGEMENT <- data_num_plus_autolab_all$Q8_B + data_num_plus_autolab_all$Q14_B + data_num_plus_autolab_all$Q18_B + data_num_plus_autolab_all$Q23_B + data_num_plus_autolab_all$Q28_B


# W4

data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Agree"] <- 2
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == ""] <- 1.5

data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Agree"] <- 2
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == ""] <- 1.5

data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Agree"] <- 2
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == ""] <- 1.5


data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Agree"] <- 2
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == ""] <- 1.5


data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Agree"] <- 2
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == ""] <- 1.5

data_num_plus_autolab_w4$ENCOURAGEMENT <- data_num_plus_autolab_w4$Q8_B + data_num_plus_autolab_w4$Q14_B + data_num_plus_autolab_w4$Q18_B + data_num_plus_autolab_w4$Q23_B + data_num_plus_autolab_w4$Q28_B

# w5

data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Agree"] <- 2
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == ""] <- 1.5

data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Agree"] <- 2
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == ""] <- 1.5

data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Agree"] <- 2
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == ""] <- 1.5


data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Agree"] <- 2
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == ""] <- 1.5


data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Agree"] <- 2
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == ""] <- 1.5

data_num_plus_autolab_w5$ENCOURAGEMENT <- data_num_plus_autolab_w5$Q8_B + data_num_plus_autolab_w5$Q14_B + data_num_plus_autolab_w5$Q18_B + data_num_plus_autolab_w5$Q23_B + data_num_plus_autolab_w5$Q28_B

# w7

data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Agree"] <- 2
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == ""] <- 1.5

data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Agree"] <- 2
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == ""] <- 1.5

data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Agree"] <- 2
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == ""] <- 1.5


data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Agree"] <- 2
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == ""] <- 1.5


data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Agree"] <- 2
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == ""] <- 1.5

data_num_plus_autolab_w7$ENCOURAGEMENT <- data_num_plus_autolab_w7$Q8_B + data_num_plus_autolab_w7$Q14_B + data_num_plus_autolab_w7$Q18_B + data_num_plus_autolab_w7$Q23_B + data_num_plus_autolab_w7$Q28_B



names(data_num_plus_autolab)

# DONE WITH ATTITUDES

data_s21_num_untrimmed <- data_num
data_s21_num_untrimmed_plus_autolab_all <-  data_num_plus_autolab_all
data_s21_num_untrimmed_plus_autolab_w4 <-  data_num_plus_autolab_w4
data_s21_num_untrimmed_plus_autolab_w5 <-  data_num_plus_autolab_w5
data_s21_num_untrimmed_plus_autolab_w7 <-  data_num_plus_autolab_w7

data_s21_not_num_untrimmed <- data_not_num
data_s21_not_num_untrimmed_plus_autolab_all <-  data_not_num_plus_autolab_all
data_s21_not_num_untrimmed_plus_autolab_w4 <-  data_not_num_plus_autolab_w4
data_s21_not_num_untrimmed_plus_autolab_w5 <-  data_not_num_plus_autolab_w5
data_s21_not_num_untrimmed_plus_autolab_w7 <-  data_not_num_plus_autolab_w7

# Remove unneeded attributes

# DATA_NOT_NUM

names(data_not_num)
selected_variables <- c("NetID", "gender_cd", "ethnic_cd", "course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","citizen_status_cd","SUCCESS", "Q1","Q2", "Q4", "Q35")

data_not_num_ss <- data_not_num # SAVE!

data_not_num_temp <- data_not_num[selected_variables]
data_not_num <- data_not_num_temp

# Same for Autolab data
names(data_not_num_plus_autolab_w4)

data_not_num_plus_autolab_ss_all <- data_not_num_plus_autolab_all # SAVE!
data_not_num_plus_autolab_temp_all <- data_not_num_plus_autolab_all[selected_variables]
data_not_num_plus_autolab_all <- data_not_num_plus_autolab_temp_all


data_not_num_plus_autolab_ss_w4 <- data_not_num_plus_autolab_w4 # SAVE!
data_not_num_plus_autolab_temp_w4 <- data_not_num_plus_autolab_w4[selected_variables]
data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_temp_w4

data_not_num_plus_autolab_ss_w5 <- data_not_num_plus_autolab_w5 # SAVE!
data_not_num_plus_autolab_temp_w5 <- data_not_num_plus_autolab_w5[selected_variables]
data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_temp_w5

data_not_num_plus_autolab_ss_w7 <- data_not_num_plus_autolab_w7 # SAVE!
data_not_num_plus_autolab_temp_w7 <- data_not_num_plus_autolab_w7[selected_variables]
data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_temp_w7


# DATA_NUM

# Paste from Spring 2021

names(data_num)
names(data_num_plus_autolab)

selected_variables <- c("Final.Points","Exam1", "Exam2","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14","RecWeek15", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_ss <- data_num # SAVE!

data_num_temp <- data_num[selected_variables]
names(data_num_temp)
data_num <- data_num_temp

# DATA_NUM_WITH_AUTOLAB

names(data_num_plus_autolab_w4)

data_num_plus_autolab_w4$max_submissions
selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES","max_submissions", "max_time_f_l_subm", "max_time_consecutive_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission", "min_time_b4_deadline_first_submission",  "max_time_b4_deadline_last_submission", "min_time_b4_deadline_last_submission")

#selected_variables <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.", "X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.", "X8..Find.Duplicate..1067540.", "X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.", "X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.", "Recitation.10..1129728.", "Recitation.2..1129729.", "Recitation.3..1129730.", "Recitation.7..1129732.", "Recitation.4..1129733.","Recitation.12..1129734.", "Recitation.5..1129735.", "Recitation.8..1129736.", "Recitation.13..1129737.",  "Recitation.11..1129738.", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_plus_autolab_ss_all <- data_num_plus_autolab_all # SAVE!
data_num_plus_autolab_temp_all <- data_num_plus_autolab_all[selected_variables]
data_num_plus_autolab_all <- data_num_plus_autolab_temp_all

data_num_plus_autolab_ss_w4 <- data_num_plus_autolab_w4 # SAVE!
data_num_plus_autolab_temp_w4 <- data_num_plus_autolab_w4[selected_variables]
data_num_plus_autolab_w4 <- data_num_plus_autolab_temp_w4

data_num_plus_autolab_ss_w5 <- data_num_plus_autolab_w5 # SAVE!
data_num_plus_autolab_temp_w5 <- data_num_plus_autolab_w5[selected_variables]
data_num_plus_autolab_w5 <- data_num_plus_autolab_temp_w5

data_num_plus_autolab_ss_w7 <- data_num_plus_autolab_w7 # SAVE!
data_num_plus_autolab_temp_w7 <- data_num_plus_autolab_w7[selected_variables]
data_num_plus_autolab_w7 <- data_num_plus_autolab_temp_w7

names(data_num_plus_autolab_w7)


# select meaningful variables from non-numeric features
str(data_not_num)

success_s <- data_not_num$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7$SUCCESS


# SAVE THE NUM AND NOT NUM DATA FRAMES

data_num_s <- data_num
data_not_num_s <- data_not_num

data_num_a_s_all <- data_num_plus_autolab_all
data_not_num_a_s_all <-data_not_num_plus_autolab_all

data_num_a_s_w4 <- data_num_plus_autolab_w4
data_not_num_a_s_w4 <-data_not_num_plus_autolab_w4

data_num_a_s_w5 <- data_num_plus_autolab_w5
data_not_num_a_s_w5 <-data_not_num_plus_autolab_w5

data_num_a_s_w7 <- data_num_plus_autolab_w7
data_not_num_a_s_w7 <-data_not_num_plus_autolab_w7



# Done paste Spring 2021

names(data_num)

table(data_num$Exit.Survey..1127030.) # get rid of
table(data_num$Recitations.Final.Points) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of
# etc etc etc Recitations...
# same for Quizzes and Assignments! we won't have this info half way through the semester
# same for Final.Points, etc.

# DATA_NUM_WITH_AUTOLAB

names(data_num)

names(data_not_num)

## RECOVER NUM AND NOT NUM DATA FRAMES

names(data_not_num)
names(data_num)

drops_not_num <- c("NetID", "SUCCESS")

data_not_num <- data_not_num[ , !(names(data_not_num) %in% drops_not_num)]
#data_not_num$Duration..in.seconds. <- as.integer(data_not_num$Duration..in.seconds.)

data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all[ , !(names(data_not_num_plus_autolab_all) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4[ , !(names(data_not_num_plus_autolab_w4) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5[ , !(names(data_not_num_plus_autolab_w5) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7[ , !(names(data_not_num_plus_autolab_w7) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


str(data_not_num)

library(lattice)
library(caret)
# one-hot encoding


# get rid of constant(empty) fields, otherwise can't do one-hot encoding because of errors..
library(janitor)
data_not_num_saved <- data_not_num
data_not_num <- remove_constant(data_not_num_saved, na.rm= TRUE)

data_not_num_plus_autolab_saved_all <- data_not_num_plus_autolab_all
data_not_num_plus_autolab_all <- remove_constant(data_not_num_plus_autolab_saved_all, na.rm= TRUE)


data_not_num_plus_autolab_saved_w4 <- data_not_num_plus_autolab_w4
data_not_num_plus_autolab_w4 <- remove_constant(data_not_num_plus_autolab_saved_w4, na.rm= TRUE)

data_not_num_plus_autolab_saved_w5 <- data_not_num_plus_autolab_w5
data_not_num_plus_autolab_w5 <- remove_constant(data_not_num_plus_autolab_saved_w5, na.rm= TRUE)

data_not_num_plus_autolab_saved_w7 <- data_not_num_plus_autolab_w7
data_not_num_plus_autolab_w7 <- remove_constant(data_not_num_plus_autolab_saved_w7, na.rm= TRUE)



library(caret)

dummy <- dummyVars(" ~ .", data=data_not_num)
final_df <- data.frame(predict(dummy, newdata=data_not_num))

dummy_a_all <- dummyVars(" ~ .", data=data_not_num_plus_autolab_all)
final_df_a_all <- data.frame(predict(dummy_a_all, newdata=data_not_num_plus_autolab_all))


dummy_a_w4 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w4)
final_df_a_w4 <- data.frame(predict(dummy_a_w4, newdata=data_not_num_plus_autolab_w4))

dummy_a_w5 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w5)
final_df_a_w5 <- data.frame(predict(dummy_a_w5, newdata=data_not_num_plus_autolab_w5))

dummy_a_w7 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w7)
final_df_a_w7 <- data.frame(predict(dummy_a_w7, newdata=data_not_num_plus_autolab_w7))


# Need to check for zero-variance features.. save to do later ...

# Mix numeric and categorical variables
data_s21_preprocessed <- cbind(data_num, final_df)
data_s21_preprocessed$SUCCESS <- success_s
data_s21_no_na <- na.omit(data_s21_preprocessed)
success_s <- data_s21_no_na$SUCCESS
data_s21_no_na <- data_s21_no_na[, !(names(data_s21_no_na) %in% c("SUCCESS"))]
#length(success_a_w4)
#table(data_num$RecWeek2)
#var(data_num$RecWeek3)
#names(data_s21_no_na)

#checking for constant columns...
data_s21_no_na_saved <- data_s21_no_na
data_s21_no_na <- remove_constant(data_s21_no_na_saved, na.rm= TRUE)

# plus autolab...

#all

data_s21_preprocessed_a_all <- cbind(data_num_plus_autolab_all, final_df_a_all)
data_s21_preprocessed_a_all$SUCCESS <- success_s_a_all
data_s21_no_na_plus_autolab_all <- na.omit(data_s21_preprocessed_a_all)
success_a_all <- data_s21_no_na_plus_autolab_all$SUCCESS
data_s21_no_na_plus_autolab_all <- data_s21_no_na_plus_autolab_all[, !(names(data_s21_no_na_plus_autolab_all) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_s21_no_na_plus_autolab_saved_all <- data_s21_no_na_plus_autolab_all
data_s21_no_na_plus_autolab_all <- remove_constant(data_s21_no_na_plus_autolab_saved_all, na.rm= TRUE)


#W4

data_s21_preprocessed_a_w4 <- cbind(data_num_plus_autolab_w4, final_df_a_w4)
data_s21_preprocessed_a_w4$SUCCESS <- success_s_a_w4
data_s21_no_na_plus_autolab_w4 <- na.omit(data_s21_preprocessed_a_w4)
success_a_w4 <- data_s21_no_na_plus_autolab_w4$SUCCESS
data_s21_no_na_plus_autolab_w4 <- data_s21_no_na_plus_autolab_w4[, !(names(data_s21_no_na_plus_autolab_w4) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_s21_no_na_plus_autolab_saved_w4 <- data_s21_no_na_plus_autolab_w4
data_s21_no_na_plus_autolab_w4 <- remove_constant(data_s21_no_na_plus_autolab_saved_w4, na.rm= TRUE)

#W5

data_s21_preprocessed_a_w5 <- cbind(data_num_plus_autolab_w5, final_df_a_w5)
data_s21_preprocessed_a_w5$SUCCESS <- success_s_a_w5
data_s21_no_na_plus_autolab_w5 <- na.omit(data_s21_preprocessed_a_w5)
success_a_w5 <- data_s21_no_na_plus_autolab_w5$SUCCESS
data_s21_no_na_plus_autolab_w5 <- data_s21_no_na_plus_autolab_w5[, !(names(data_s21_no_na_plus_autolab_w5) %in% c("SUCCESS"))]

#checking for constant columns...
data_s21_no_na_plus_autolab_saved_w5 <- data_s21_no_na_plus_autolab_w5
data_s21_no_na_plus_autolab_w5 <- remove_constant(data_s21_no_na_plus_autolab_saved_w5, na.rm= TRUE)

#w7

data_s21_preprocessed_a_w7 <- cbind(data_num_plus_autolab_w7, final_df_a_w7)
data_s21_preprocessed_a_w7$SUCCESS <- success_s_a_w7
data_s21_no_na_plus_autolab_w7 <- na.omit(data_s21_preprocessed_a_w7)
success_a_w7 <- data_s21_no_na_plus_autolab_w7$SUCCESS
data_s21_no_na_plus_autolab_w7 <- data_s21_no_na_plus_autolab_w7[, !(names(data_s21_no_na_plus_autolab_w7) %in% c("SUCCESS"))]



#checking for constant columns...
data_s21_no_na_plus_autolab_saved_w7 <- data_s21_no_na_plus_autolab_w7
data_s21_no_na_plus_autolab_w7 <- remove_constant(data_s21_no_na_plus_autolab_saved_w7, na.rm= TRUE)


# Need to check for correlated features
cor_matrix <- cor(data_s21_no_na)
#write.csv(cor_matrix,file="cortmp.csv")

for (i in 1:nrow(cor_matrix)){
  correlations <-  which((abs(cor_matrix[i,]) > 0.90))
  if(length(correlations)> 0){
    print(colnames(data_s21_no_na)[i])
    print(correlations)
  }
}

# REMOVE CORRELATED VARS: COPY FROM SPRING 2021 data

indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

remove_corrs <- data_s21_no_na[-c(indexes_to_drop)]

data_s21_no_na_no_corr <- remove_corrs

names(remove_corrs)

cor_matrix <- cor(data_s21_no_na_no_corr)
indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

# indexes to drop is now empty, which means NO CORRELATIONS OVER 0.9!
names(data_s21_no_na_no_corr)

# DONE REMOVONG CORR VARS


# AUTOLAB DATA : remove correlated variables

# all

# Need to check for correlated features
cor_matrix_a <- cor(data_s21_no_na_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s21_no_na_plus_autolab_all[-c(indexes_to_drop)]
data_s21_no_na_no_corr_plus_autolab_all <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s21_no_na_no_corr_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)# should be empty


# W4

# Need to check for correlated features
cor_matrix_a <- cor(data_s21_no_na_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s21_no_na_plus_autolab_w4[-c(indexes_to_drop)]
data_s21_no_na_no_corr_plus_autolab_w4 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s21_no_na_no_corr_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

# w5

# Need to check for correlated features
cor_matrix_a <- cor(data_s21_no_na_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s21_no_na_plus_autolab_w5[-c(indexes_to_drop)]
data_s21_no_na_no_corr_plus_autolab_w5 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s21_no_na_no_corr_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

# w7

# Need to check for correlated features
cor_matrix_a <- cor(data_s21_no_na_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s21_no_na_plus_autolab_w7[-c(indexes_to_drop)]
data_s21_no_na_no_corr_plus_autolab_w7 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s21_no_na_no_corr_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)


# empty, no more variables with correlations over 0.9!

# get rid of features with variance under 0.005
# copied from Spring 2021
# BETTER?? Apply variances on data without correlations

variances <- sapply(data_s21_no_na_no_corr, var)
variances_a_all <- sapply(data_s21_no_na_no_corr_plus_autolab_all, var)
variances_a_w4 <- sapply(data_s21_no_na_no_corr_plus_autolab_w4, var)
variances_a_w5 <- sapply(data_s21_no_na_no_corr_plus_autolab_w5, var)
variances_a_w7 <- sapply(data_s21_no_na_no_corr_plus_autolab_w7, var)


low_variance_features <- c()

colnames(data_s21_no_na_no_corr)[1]

for (i in 1:ncol(data_s21_no_na_no_corr)){
  
  if(variances[i] < 0.005)
  {
    low_variance_features <- c(low_variance_features, colnames(data_s21_no_na_no_corr)[i])
    print(i)
    print(colnames(data_s21_no_na_no_corr)[i])
    print(variances[i])
  }
}  

# Data Autolab 

# ALL

low_variance_features_a_all <- c()

for (i in 1:ncol(data_s21_no_na_no_corr_plus_autolab_all)){
  
  if(variances_a_all[i] < 0.005)
  {
    low_variance_features_a_all <- c(low_variance_features_a_all, colnames(data_s21_no_na_no_corr_plus_autolab_all)[i])
    print(i)
    print(colnames(data_s21_no_na_no_corr_plus_autolab_all)[i])
    print(variances_a_all[i])
  }
}  


#W4

low_variance_features_a_w4 <- c()

for (i in 1:ncol(data_s21_no_na_no_corr_plus_autolab_w4)){
  
  if(variances_a_w4[i] < 0.005)
  {
    low_variance_features_a_w4 <- c(low_variance_features_a_w4, colnames(data_s21_no_na_no_corr_plus_autolab_w4)[i])
    print(i)
    print(colnames(data_s21_no_na_no_corr_plus_autolab_w4)[i])
    print(variances_a_w4[i])
  }
}  

#w5

low_variance_features_a_w5 <- c()

for (i in 1:ncol(data_s21_no_na_no_corr_plus_autolab_w5)){
  
  if(variances_a_w5[i] < 0.005)
  {
    low_variance_features_a_w5 <- c(low_variance_features_a_w5, colnames(data_s21_no_na_no_corr_plus_autolab_w5)[i])
    print(i)
    print(colnames(data_s21_no_na_no_corr_plus_autolab_w5)[i])
    print(variances_a_w5[i])
  }
}  

#W7

low_variance_features_a_w7 <- c()

for (i in 1:ncol(data_s21_no_na_no_corr_plus_autolab_w7)){
  
  if(variances_a_w7[i] < 0.005)
  {
    low_variance_features_a_w7 <- c(low_variance_features_a_w7, colnames(data_s21_no_na_no_corr_plus_autolab_w7)[i])
    print(i)
    print(colnames(data_s21_no_na_no_corr_plus_autolab_w7)[i])
    print(variances_a_w7[i])
  }
}  



# done copied from Spring 2021

# Drop low variance features from Spring 2021 code

drops_n <- low_variance_features
drops_n_a_all <- low_variance_features_a_all
drops_n_a_w4 <- low_variance_features_a_w4
drops_n_a_w5 <- low_variance_features_a_w5
drops_n_a_w7 <- low_variance_features_a_w7


data_s21_final <- data_s21_no_na_no_corr[ , !(names(data_s21_no_na_no_corr) %in% drops_n)]
data_s21_no_na_no_corr_no_low_var <- data_s21_final

data_s21_final_a_all <- data_s21_no_na_no_corr_plus_autolab_all[ , !(names(data_s21_no_na_no_corr_plus_autolab_all) %in% drops_n_a_all)]
data_s21_no_na_no_corr_no_low_var_a_all <- data_s21_final_a_all


data_s21_final_a_w4 <- data_s21_no_na_no_corr_plus_autolab_w4[ , !(names(data_s21_no_na_no_corr_plus_autolab_w4) %in% drops_n_a_w4)]
data_s21_no_na_no_corr_no_low_var_a_w4 <- data_s21_final_a_w4

data_s21_final_a_w5 <- data_s21_no_na_no_corr_plus_autolab_w5[ , !(names(data_s21_no_na_no_corr_plus_autolab_w5) %in% drops_n_a_w5)]
data_s21_no_na_no_corr_no_low_var_a_w5 <- data_s21_final_a_w5

data_s21_final_a_w7 <- data_s21_no_na_no_corr_plus_autolab_w7[ , !(names(data_s21_no_na_no_corr_plus_autolab_w7) %in% drops_n_a_w7)]
data_s21_no_na_no_corr_no_low_var_a_w7 <- data_s21_final_a_w7


data_s21_final$SUCCESS <- success_s
data_s21_final_a_all$SUCCESS <- success_a_all
data_s21_final_a_w4$SUCCESS <- success_a_w4
data_s21_final_a_w5$SUCCESS <- success_a_w5
data_s21_final_a_w7$SUCCESS <- success_a_w7

data_s21_no_na_no_corr_no_low_var$SUCCESS <- success_s
data_s21_no_na_no_corr_no_low_var_a_all$SUCCESS <- success_a_all
data_s21_no_na_no_corr_no_low_var_a_w4$SUCCESS <- success_a_w4
data_s21_no_na_no_corr_no_low_var_a_w5$SUCCESS <- success_a_w5
data_s21_no_na_no_corr_no_low_var_a_w7$SUCCESS <- success_a_w7


names(data_s21_no_na_no_corr_no_low_var_a_w4)
# DONE with Drop low variance features from Spring 2021 code


table(data_f20_no_na_a$SUCCESS)
# check again for zero variance
#final_df_no_na <- remove_constant(data_no_na, na.rm= TRUE)


# Feature importance

control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)

# for data with autolab up to week 7 ...
control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final_a, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)


# RECURSIVE FEATURE ELIMINATION... NOT DONE!

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=10)
# run the RFE algorithm
results <- rfe(PimaIndiansDiabetes[,1:8], PimaIndiansDiabetes[,9], sizes=c(1:8), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))


# Write the final result in a file
getwd()
write.csv(data_s21_final, "Data_s21_After_Processing.csv", row.names = FALSE)
write.csv(data_s21_final_a_all, "Data_s21_After_Processing_w_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_s21_final_a_w4, "Data_s21_After_Processing_w_Autolab_W4.csv", row.names = FALSE)
write.csv(data_s21_final_a_w5, "Data_s21_After_Processing_w_Autolab_W5.csv", row.names = FALSE)
write.csv(data_s21_final_a_w7, "Data_s21_After_Processing_w_Autolab_W7.csv", row.names = FALSE)

# DATA WITH ALL THE FEATURES: data_f20_no_na
# No correlated features and no features with 0 variance

names(data_s21_final)


#####################################################
#
#---------  Spring 2023 START HERE  !!  -------------
#
#####################################################

# intro survey has only students who have given consent for research
data_intro_s23_111_t <- data_intro_s23_111[data_intro_s23_111$Q38=="Yes, I understand.",]
data_intro_s23_111 <- data_intro_s23_111_t


# STEP 1: Merge Canvas+SAS with Intro survey
data_all1 <- merge(data_canvas_and_sas_s23_111, data_intro_s23_111, by = "NetID")
names(data_all1)
data_all_plus_autolab_all <- merge(data_all1, data_autolab_s23)
data_all_plus_autolab_w4 <- merge(data_all1, data_autolab_s23_w4)
data_all_plus_autolab_w5 <- merge(data_all1, data_autolab_s23_w5)
data_all_plus_autolab_w7 <- merge(data_all1, data_autolab_s23_w7)
names(data_all_plus_autolab_w7)
# Turn SUCCESS into a factor so we can do classification on it

data_all1$SUCCESS <- as.factor(data_all1$SUCCESS)
table(data_all1$SUCCESS)
data_all_plus_autolab_all$SUCCESS <- as.factor(data_all_plus_autolab_all$SUCCESS)
data_all_plus_autolab_w4$SUCCESS <- as.factor(data_all_plus_autolab_w4$SUCCESS)
data_all_plus_autolab_w5$SUCCESS <- as.factor(data_all_plus_autolab_w5$SUCCESS)
data_all_plus_autolab_w7$SUCCESS <- as.factor(data_all_plus_autolab_w7$SUCCESS)

write.csv(data_all_plus_autolab_all, "s23_Beginnning_Of_Processing_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w4, "s23_Beginnning_Of_Processing_Autolab_W4.csv", row.names = FALSE)
write.csv(data_all1, "s23_Beginnning_Of_Processing.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w5, "s23_Beginnning_Of_Processing_Autolab_W5.csv", row.names = FALSE)
write.csv(data_all_plus_autolab_w7, "s23_Beginnning_Of_Processing_Autolab_W7.csv", row.names = FALSE)

# ADD AUTOLAB FEATURES

# all

data_all_plus_autolab_all$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_first_submission)
data_all_plus_autolab_all$max_time_f_l_subm <- as.integer(data_all_plus_autolab_all$max_time_f_l_subm)
data_all_plus_autolab_all$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_all$max_time_consecutive_submissions)
data_all_plus_autolab_all$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$max_time_b4_deadline_last_submission)
data_all_plus_autolab_all$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_first_submission)
data_all_plus_autolab_all$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_all$min_time_b4_deadline_last_submission)


# w4

data_all_plus_autolab_w4$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w4$max_time_f_l_subm)
data_all_plus_autolab_w4$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w4$max_time_consecutive_submissions)
data_all_plus_autolab_w4$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w4$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w4$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w4$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7
data_s23_plus_autolab_week4 <- data_all_plus_autolab_w4
write.csv(data_s23_plus_autolab_week4, "s23_W4_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

# W5

data_all_plus_autolab_w5$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w5$max_time_f_l_subm)
data_all_plus_autolab_w5$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w5$max_time_consecutive_submissions)
data_all_plus_autolab_w5$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w5$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w5$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w5$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_s23 <- data_all1
data_s23_plus_autolab_week5 <- data_all_plus_autolab_w5

write.csv(data_s23_plus_autolab_week5, "s23_W5_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)


# W7

data_all_plus_autolab_w7$max_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$max_time_f_l_subm <- as.integer(data_all_plus_autolab_w7$max_time_f_l_subm)
data_all_plus_autolab_w7$max_time_consecutive_submissions <- as.integer(data_all_plus_autolab_w7$max_time_consecutive_submissions)
data_all_plus_autolab_w7$max_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$max_time_b4_deadline_last_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_first_submission)
data_all_plus_autolab_w7$min_time_b4_deadline_last_submission <- as.integer(data_all_plus_autolab_w7$min_time_b4_deadline_last_submission)

# Turn features that should be numbers into numbers

#data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission <- as.integer(data_all_plus_autolab_w7$avg_time_b4_deadline_first_submission)

# Save data into data_f20 and data_f20_plus_autolab_week7

data_s23 <- data_all1
data_s23_plus_autolab_all <- data_all_plus_autolab_all
data_s23_plus_autolab_week4 <- data_all_plus_autolab_w4
data_s23_plus_autolab_week5 <- data_all_plus_autolab_w5
data_s23_plus_autolab_week7 <- data_all_plus_autolab_w7

write.csv(data_s23_plus_autolab_week7, "s23_W_Autolab_Beginnning_Of_Processing.csv", row.names = FALSE)

names(data_all1)

data_s23$SUCCESS <- as.factor(data_s23$SUCCESS)
data_s23_plus_autolab_all$SUCCESS <- as.factor(data_s23_plus_autolab_all$SUCCESS)
data_s23_plus_autolab_week4$SUCCESS <- as.factor(data_s23_plus_autolab_week4$SUCCESS)
data_s23_plus_autolab_week5$SUCCESS <- as.factor(data_s23_plus_autolab_week5$SUCCESS)
data_s23_plus_autolab_week7$SUCCESS <- as.factor(data_s23_plus_autolab_week7$SUCCESS)

# double check ...
table(data_s23$SUCCESS)
library(dplyr)

# Turn all numeric features into numbers

data_s23$Duration..in.seconds. <- as.numeric(data_s23$Duration..in.seconds.)
data_s23_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_all$Duration..in.seconds.)
data_s23_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_week4$Duration..in.seconds.)
data_s23_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_week5$Duration..in.seconds.)
data_s23_plus_autolab_week7$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_week7$Duration..in.seconds.)

# Turn features that should be categories into factors

data_s23$sending_school_type_cd <- as.factor(data_s23$sending_school_type_cd)
data_s23$orig_admit_type_cd <- as.factor(data_s23$orig_admit_type_cd)
data_s23$citizen_status_cd <- as.factor(data_s23$citizen_status_cd)
data_s23$curr_admit_type_cd <- as.factor(data_s23$curr_admit_type_cd)

data_s23_plus_autolab_all$sending_school_type_cd <- as.factor(data_s23_plus_autolab_all$sending_school_type_cd)
data_s23_plus_autolab_all$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_all$orig_admit_type_cd)
data_s23_plus_autolab_all$citizen_status_cd <- as.factor(data_s23_plus_autolab_all$citizen_status_cd)
data_s23_plus_autolab_all$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_all$curr_admit_type_cd)


data_s23_plus_autolab_week4$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week4$sending_school_type_cd)
data_s23_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week4$orig_admit_type_cd)
data_s23_plus_autolab_week4$citizen_status_cd <- as.factor(data_s23_plus_autolab_week4$citizen_status_cd)
data_s23_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week4$curr_admit_type_cd)

data_s23_plus_autolab_week5$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week5$sending_school_type_cd)
data_s23_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week5$orig_admit_type_cd)
data_s23_plus_autolab_week5$citizen_status_cd <- as.factor(data_s23_plus_autolab_week5$citizen_status_cd)
data_s23_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week5$curr_admit_type_cd)


data_s23_plus_autolab_week7$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week7$sending_school_type_cd)
data_s23_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week7$orig_admit_type_cd)
data_s23_plus_autolab_week7$citizen_status_cd <- as.factor(data_s23_plus_autolab_week7$citizen_status_cd)
data_s23_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week7$curr_admit_type_cd)



# remove students whose progress is not 100%
table(data_s23$Progress)
table(data_s23_plus_autolab_week7$Progress)

data_s23_temp <- data_s23[data_s23$Progress == "100",]
data_s23 <- data_s23_temp

data_s23_plus_autolab_all_temp <- data_s23_plus_autolab_all[data_s23_plus_autolab_all$Progress == "100",]
data_s23_plus_autolab_all <- data_s23_plus_autolab_all_temp


data_s23_plus_autolab_week4_temp <- data_s23_plus_autolab_week4[data_s23_plus_autolab_week4$Progress == "100",]
data_s23_plus_autolab_week4 <- data_s23_plus_autolab_week4_temp

data_s23_plus_autolab_week5_temp <- data_s23_plus_autolab_week5[data_s23_plus_autolab_week5$Progress == "100",]
data_s23_plus_autolab_week5 <- data_s23_plus_autolab_week5_temp


data_s23_plus_autolab_week7_temp <- data_s23_plus_autolab_week7[data_s23_plus_autolab_week7$Progress == "100",]
data_s23_plus_autolab_week7 <- data_s23_plus_autolab_week7_temp

data_s23$Assignments.Current.Points <- as.numeric(data_s23$Assignments.Current.Points)
data_s23$Assignments.Final.Points <- as.numeric(data_s23$Assignments.Final.Points)
data_s23$Assignments.Current.Score <- as.numeric(data_s23$Assignments.Current.Score)
data_s23$Assignments.Unposted.Current.Score <- as.numeric(data_s23$Assignments.Unposted.Current.Score)
data_s23$Assignments.Final.Score <- as.numeric(data_s23$Assignments.Final.Score)
data_s23$Assignments.Unposted.Final.Score <- as.numeric(data_s23$Assignments.Unposted.Final.Score)

data_s23$Quizzes.Current.Points <- as.numeric(data_s23$Current.Points)
data_s23$Quizzes.Final.Points <- as.numeric(data_s23$Final.Points)
data_s23$Quizzes.Current.Score <- as.numeric(data_s23$Current.Score)
data_s23$Quizzes.Unposted.Current.Score  <- as.numeric(data_s23$Unposted.Current.Score )
data_s23$Quizzes.Final.Score <- as.numeric(data_s23$Final.Score)
data_s23$Quizzes.Unposted.Final.Score <- as.numeric(data_s23$Unposted.Final.Score)

names(data_s23)

data_s23$Recitations.Current.Points <- as.numeric(data_s23$Recitations.Current.Points)
data_s23$Recitations.Final.Points <- as.numeric(data_s23$Recitations.Final.Points)
data_s23$Recitations.Current.Score <- as.numeric(data_s23$Recitations.Current.Score)
data_s23$Recitations.Unposted.Current.Score  <- as.numeric(data_s23$Recitations.Unposted.Current.Score )
data_s23$Recitations.Final.Score <- as.numeric(data_s23$Recitations.Final.Score)
data_s23$Recitations.Unposted.Final.Score <- as.numeric(data_s23$Recitations.Unposted.Final.Score)

data_s23$Current.Points <- as.numeric(data_s23$Current.Points)
data_s23$Final.Points <- as.numeric(data_s23$Final.Points)
data_s23$Current.Score <- as.numeric(data_s23$Current.Score)
data_s23$Unposted.Current.Score  <- as.numeric(data_s23$Unposted.Current.Score )
data_s23$Final.Score <- as.numeric(data_s23$Final.Score)
data_s23$Unposted.Final.Score <- as.numeric(data_s23$Unposted.Final.Score)

data_s23_plus_autolab_all$Current.Points <- as.numeric(data_s23_plus_autolab_all$Current.Points)
data_s23_plus_autolab_all$Final.Points <- as.numeric(data_s23_plus_autolab_all$Final.Points)
data_s23_plus_autolab_all$Current.Score <- as.numeric(data_s23_plus_autolab_all$Current.Score)
data_s23_plus_autolab_all$Unposted.Current.Score  <- as.numeric(data_s23_plus_autolab_all$Unposted.Current.Score )
data_s23_plus_autolab_all$Final.Score <- as.numeric(data_s23_plus_autolab_all$Final.Score)
data_s23_plus_autolab_all$Unposted.Final.Score <- as.numeric(data_s23_plus_autolab_all$Unposted.Final.Score)
data_s23_plus_autolab_all$Progress <- as.numeric(data_s23_plus_autolab_all$Progress)
data_s23_plus_autolab_all$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_all$Duration..in.seconds.)


str(data_s23_plus_autolab_all)

data_s23_plus_autolab_week4$Current.Points <- as.numeric(data_s23_plus_autolab_week4$Current.Points)
data_s23_plus_autolab_week4$Final.Points <- as.numeric(data_s23_plus_autolab_week4$Final.Points)
data_s23_plus_autolab_week4$Current.Score <- as.numeric(data_s23_plus_autolab_week4$Current.Score)
data_s23_plus_autolab_week4$Unposted.Current.Score  <- as.numeric(data_s23_plus_autolab_week4$Unposted.Current.Score )
data_s23_plus_autolab_week4$Final.Score <- as.numeric(data_s23_plus_autolab_week4$Final.Score)
data_s23_plus_autolab_week4$Unposted.Final.Score <- as.numeric(data_s23_plus_autolab_week4$Unposted.Final.Score)
data_s23_plus_autolab_week4$Progress <- as.numeric(data_s23_plus_autolab_week4$Progress)
data_s23_plus_autolab_week4$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_week4$Duration..in.seconds.)



data_s23_plus_autolab_week5$Current.Points <- as.numeric(data_s23_plus_autolab_week5$Current.Points)
data_s23_plus_autolab_week5$Final.Points <- as.numeric(data_s23_plus_autolab_week5$Final.Points)
data_s23_plus_autolab_week5$Current.Score <- as.numeric(data_s23_plus_autolab_week5$Current.Score)
data_s23_plus_autolab_week5$Unposted.Current.Score  <- as.numeric(data_s23_plus_autolab_week5$Unposted.Current.Score )
data_s23_plus_autolab_week5$Final.Score <- as.numeric(data_s23_plus_autolab_week5$Final.Score)
data_s23_plus_autolab_week5$Unposted.Final.Score <- as.numeric(data_s23_plus_autolab_week5$Unposted.Final.Score)
data_s23_plus_autolab_week5$Progress <- as.numeric(data_s23_plus_autolab_week5$Progress)
data_s23_plus_autolab_week5$Duration..in.seconds. <- as.numeric(data_s23_plus_autolab_week5$Duration..in.seconds.)


data_s23_plus_autolab_week7$Current.Points <- as.numeric(data_s23_plus_autolab_week7$Current.Points)
data_s23_plus_autolab_week7$Final.Points <- as.numeric(data_s23_plus_autolab_week7$Final.Points)
data_s23_plus_autolab_week7$Current.Score <- as.numeric(data_s23_plus_autolab_week7$Current.Score)
data_s23_plus_autolab_week7$Unposted.Current.Score  <- as.numeric(data_s23_plus_autolab_week7$Unposted.Current.Score )
data_s23_plus_autolab_week7$Final.Score <- as.numeric(data_s23_plus_autolab_week7$Final.Score)
data_s23_plus_autolab_week7$Unposted.Final.Score <- as.numeric(data_s23_plus_autolab_week7$Unposted.Final.Score)

# data_f20$unit_of_reg_cd <- as.factor(data_f20$unit_of_reg_cd)
# data_f20$subj_cd <- as.factor(data_f20$subj_cd)
# data_f20$curr_admit_type_cd <- as.factor(data_f20$curr_admit_type_cd)
# data_f20$housing_status_cd <- as.factor(data_f20$housing_status_cd)
# data_f20$citizen_status_cd <- as.factor(data_f20$citizen_status_cd)
# data_f20$deg_earned_curric_cd1 <- as.factor(data_f20$deg_earned_curric_cd1)
# data_f20$deg_minor_curric_cd1 <- as.factor(data_f20$deg_minor_curric_cd1)

#data_f20_plus_autolab_week7$citizen_status_cd <- as.factor(data_f20_plus_autolab_week7$citizen_status_cd)
data_s23_plus_autolab_all$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_all$curr_admit_type_cd)
data_s23_plus_autolab_week4$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week4$curr_admit_type_cd)
data_s23_plus_autolab_week5$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week5$curr_admit_type_cd)
data_s23_plus_autolab_week7$curr_admit_type_cd <- as.factor(data_s23_plus_autolab_week7$curr_admit_type_cd)

data_s23_plus_autolab_all$sending_school_type_cd <- as.factor(data_s23_plus_autolab_all$sending_school_type_cd)
data_s23_plus_autolab_week4$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week4$sending_school_type_cd)
data_s23_plus_autolab_week5$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week5$sending_school_type_cd)
data_s23_plus_autolab_week7$sending_school_type_cd <- as.factor(data_s23_plus_autolab_week7$sending_school_type_cd)

data_s23_plus_autolab_all$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_all$orig_admit_type_cd)
data_s23_plus_autolab_week4$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week4$orig_admit_type_cd)
data_s23_plus_autolab_week5$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week5$orig_admit_type_cd)
data_s23_plus_autolab_week7$orig_admit_type_cd <- as.factor(data_s23_plus_autolab_week7$orig_admit_type_cd)

data_s23_plus_autolab_all$citizen_status_cd <- as.factor(data_s23_plus_autolab_all$citizen_status_cd)
data_s23_plus_autolab_week4$citizen_status_cd <- as.factor(data_s23_plus_autolab_week4$citizen_status_cd)
data_s23_plus_autolab_week5$citizen_status_cd <- as.factor(data_s23_plus_autolab_week5$citizen_status_cd)
data_s23_plus_autolab_week7$citizen_status_cd <- as.factor(data_s23_plus_autolab_week7$citizen_status_cd)

str(data_s23_plus_autolab_all)

# Split data into numeric and not numeric features

data_num <- select_if(data_s23, is.numeric)
data_not_num <- data_s23[ , !(names(data_s23) %in% names(data_num))]
str(data_s23_plus_autolab_week4$Final.Points)

data_num_plus_autolab_all <- select_if(data_s23_plus_autolab_all, is.numeric)
data_not_num_plus_autolab_all <- data_s23_plus_autolab_all[ , !(names(data_s23_plus_autolab_all) %in% names(data_num_plus_autolab_all))]

data_num_plus_autolab_w4 <- select_if(data_s23_plus_autolab_week4, is.numeric)
data_not_num_plus_autolab_w4 <- data_s23_plus_autolab_week4[ , !(names(data_s23_plus_autolab_week4) %in% names(data_num_plus_autolab_w4))]

data_num_plus_autolab_w5 <- select_if(data_s23_plus_autolab_week5, is.numeric)
data_not_num_plus_autolab_w5 <- data_s23_plus_autolab_week5[ , !(names(data_s23_plus_autolab_week5) %in% names(data_num_plus_autolab_w5))]

data_num_plus_autolab_w7 <- select_if(data_s23_plus_autolab_week7, is.numeric)
data_not_num_plus_autolab_w7 <- data_s23_plus_autolab_week7[ , !(names(data_s23_plus_autolab_week7) %in% names(data_num_plus_autolab_w7))]

names(data_num_plus_autolab)
names(data_not_num_plus_autolab)

data_not_num_plus_autolab$Q38_1
names(data_not_num)

table(data_not_num$Section) # out
table(data_not_num$Current.Grade) # out b/c it corr with predicted var
table(data_not_num$Unposted.Current.Grade) # out: same as the one before
table(data_not_num$Final.Grade) # ibid
table(data_not_num$Unposted.Final.Grade) # ibid

table(data_not_num$gender_cd) # can stay
table(data_not_num$ethnic_cd) # can stay
table(data_not_num$SUCCESS) # has to stay

table(data_not_num$EndDate) # can go, probably irrelevant
table(data_not_num$Progress) # can go after selecting students who completed it 100%
table(data_not_num$Finished) # same as before, can remove those for whom it's FALSE and then get rid of column
table(data_not_num$RecordedDate) # irrelevant
table(data_not_num$UserLanguage) # can go, everyone is ENG
table(data_not_num$Q38) # can go, everyone agrees to take part of research


table(data_not_num$Q1) # can stay, major

table(data_not_num$Q33) # second major, lots of NA, may not have enough variablilty.. 
table(data_not_num$Q32) # minor, 206 undecided.., may not be a great feature
table(data_not_num$Q30) # second minor, 406 none, may need to get rid of

table(data_not_num$Q2) # keep.. reason they are taking CS1

table(data_not_num$Q2_8_TEXT) # mostly empty, get rid of
table(data_not_num$Q2_6_TEXT) # mostly empty, get rid of
table(data_not_num$Q44) # empty, get rid of
table(data_not_num$Q44_8_TEXT) # empty, get rid of
table(data_not_num$Q44_6_TEXT) # empty, get rid of

table(data_not_num$Q4) # Keep, prior experience

table(data_not_num$Q4_6_TEXT) # mostly empty
table(data_not_num$Q34) # mostly empty

table(data_not_num$Q35) # Keep, how difficult do they think the class will be
table(data_not_num$Q37) # get rid of, how would they explain cs

# Q43 is empty: get rid of it!

table(data_not_num$Q43)

# 30 variables so far.

# attitudes are 24 questions/variables.

# attitude qs  Q3, Q5 - Q12, Q14 - 28  1 + 8 + 15 = 24 questions
table(data_not_num$Q3)
table(data_not_num$Q5)
table(data_not_num$Q6)
table(data_not_num$Q7)
table(data_not_num$Q8)


# etc.

# Q38: Which of the following have you done this year or do you plan to do? Check all that apply. 
# I have no interest in doing this 0 / I did this in the past year 3 / I plan to do this in the future 2 / I'm not sure 1

table(data_not_num$Q38_1) # Participate in social events sponsored by the CS Living Learning Community
table(data_not_num$Q38_2) # Take a 200-level computer science course
table(data_not_num$Q38_3) # Matriculate as a computer science major
table(data_not_num$Q38_4) # Become a learning assistant for a computer science course
table(data_not_num$Q38_5) # Become a learning assistant for a computer science course
table(data_not_num$Q38_6) # Become a peer mentor in computer science
table(data_not_num$Q38_7) # Participate in the Reboot program, supporting high schools with CS instruction
table(data_not_num$Q38_8) # Do an internship that involves computer science
table(data_not_num$Q38_9) # Do academic research in the computer science field
table(data_not_num$Q38_10) # Join a professional organization or attend a professional conference in computer science
table(data_not_num$Q38_11) # Pursue a career in computer science
table(data_not_num$Q38_12) # Pursue a career in a field related to computer science

names(data_num)

data_num$ENGAGEMENT <- 0

data_num$E1[data_not_num$Q38_1 == "I did this in the past year"] <- 3
data_num$E1[data_not_num$Q38_1 == "I plan to do this in the future"] <- 2
data_num$E1[data_not_num$Q38_1 == "I'm not sure"] <- 1
data_num$E1[data_not_num$Q38_1 == "I have no interest in doing this"] <- 0
data_num$E1[data_not_num$Q38_1 == ""] <- 1.5

#table(data_num$E1)

data_num$E2[data_not_num$Q38_2 == "I did this in the past year"] <- 3
data_num$E2[data_not_num$Q38_2 == "I plan to do this in the future"] <- 2
data_num$E2[data_not_num$Q38_2 == "I'm not sure"] <- 1
data_num$E2[data_not_num$Q38_2 == "I have no interest in doing this"] <- 0
data_num$E2[data_not_num$Q38_2 == ""] <- 1.5

data_num$E3[data_not_num$Q38_3 == "I did this in the past year"] <- 3
data_num$E3[data_not_num$Q38_3 == "I plan to do this in the future"] <- 2
data_num$E3[data_not_num$Q38_3 == "I'm not sure"] <- 1
data_num$E3[data_not_num$Q38_3 == "I have no interest in doing this"] <- 0
data_num$E3[data_not_num$Q38_3 == ""] <- 1.5

data_num$E4[data_not_num$Q38_4 == "I did this in the past year"] <- 3
data_num$E4[data_not_num$Q38_4 == "I plan to do this in the future"] <- 2
data_num$E4[data_not_num$Q38_4 == "I'm not sure"] <- 1
data_num$E4[data_not_num$Q38_4 == "I have no interest in doing this"] <- 0
data_num$E4[data_not_num$Q38_4 == ""] <- 1.5

data_num$E5[data_not_num$Q38_5 == "I did this in the past year"] <- 3
data_num$E5[data_not_num$Q38_5 == "I plan to do this in the future"] <- 2
data_num$E5[data_not_num$Q38_5 == "I'm not sure"] <- 1
data_num$E5[data_not_num$Q38_5 == "I have no interest in doing this"] <- 0
data_num$E5[data_not_num$Q38_5 == ""] <- 1.5

data_num$E6[data_not_num$Q38_6 == "I did this in the past year"] <- 3
data_num$E6[data_not_num$Q38_6 == "I plan to do this in the future"] <- 2
data_num$E6[data_not_num$Q38_6 == "I'm not sure"] <- 1
data_num$E6[data_not_num$Q38_6 == "I have no interest in doing this"] <- 0
data_num$E6[data_not_num$Q38_6 == ""] <- 1.5

data_num$E7[data_not_num$Q38_7 == "I did this in the past year"] <- 3
data_num$E7[data_not_num$Q38_7 == "I plan to do this in the future"] <- 2
data_num$E7[data_not_num$Q38_7 == "I'm not sure"] <- 1
data_num$E7[data_not_num$Q38_7 == "I have no interest in doing this"] <- 0
data_num$E7[data_not_num$Q38_7 == ""] <- 1.5

data_num$E8[data_not_num$Q38_8 == "I did this in the past year"] <- 3
data_num$E8[data_not_num$Q38_8 == "I plan to do this in the future"] <- 2
data_num$E8[data_not_num$Q38_8 == "I'm not sure"] <- 1
data_num$E8[data_not_num$Q38_8 == "I have no interest in doing this"] <- 0
data_num$E8[data_not_num$Q38_8 == ""] <- 1.5

data_num$E9[data_not_num$Q38_9 == "I did this in the past year"] <- 3
data_num$E9[data_not_num$Q38_9 == "I plan to do this in the future"] <- 2
data_num$E9[data_not_num$Q38_9 == "I'm not sure"] <- 1
data_num$E9[data_not_num$Q38_9 == "I have no interest in doing this"] <- 0
data_num$E9[data_not_num$Q38_9 == ""] <- 1.5

data_num$E10[data_not_num$Q38_10 == "I did this in the past year"] <- 3
data_num$E10[data_not_num$Q38_10 == "I plan to do this in the future"] <- 2
data_num$E10[data_not_num$Q38_10 == "I'm not sure"] <- 1
data_num$E10[data_not_num$Q38_10 == "I have no interest in doing this"] <- 0
data_num$E10[data_not_num$Q38_10 == ""] <- 1.5

data_num$E11[data_not_num$Q38_11 == "I did this in the past year"] <- 3
data_num$E11[data_not_num$Q38_11 == "I plan to do this in the future"] <- 2
data_num$E11[data_not_num$Q38_11 == "I'm not sure"] <- 1
data_num$E11[data_not_num$Q38_11 == "I have no interest in doing this"] <- 0
data_num$E11[data_not_num$Q38_11 == ""] <- 1.5

data_num$E12[data_not_num$Q38_12 == "I did this in the past year"] <- 3
data_num$E12[data_not_num$Q38_12 == "I plan to do this in the future"] <- 2
data_num$E12[data_not_num$Q38_12 == "I'm not sure"] <- 1
data_num$E12[data_not_num$Q38_12 == "I have no interest in doing this"] <- 0
data_num$E12[data_not_num$Q38_12 == ""] <- 1.5

data_num$ENGAGEMENT <- data_num$E1 + data_num$E2 + data_num$E3 + data_num$E4 + data_num$E5 + data_num$E6 + data_num$E7 + data_num$E8 + data_num$E9 + data_num$E10 + data_num$E11 + data_num$E12

#all

data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E1[data_not_num_plus_autolab_all$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_all$E1)

data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E2[data_not_num_plus_autolab_all$Q38_2 == ""] <- 1.5

data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E3[data_not_num_plus_autolab_all$Q38_3 == ""] <- 1.5


data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E4[data_not_num_plus_autolab_all$Q38_4 == ""] <- 1.5

data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E5[data_not_num_plus_autolab_all$Q38_5 == ""] <- 1.5

data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E6[data_not_num_plus_autolab_all$Q38_6 == ""] <- 1.5

data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E7[data_not_num_plus_autolab_all$Q38_7 == ""] <- 1.5

data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E8[data_not_num_plus_autolab_all$Q38_8 == ""] <- 1.5

data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E9[data_not_num_plus_autolab_all$Q38_9 == ""] <- 1.5

data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E10[data_not_num_plus_autolab_all$Q38_10 == ""] <- 1.5

data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E11[data_not_num_plus_autolab_all$Q38_11 == ""] <- 1.5

data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_all$E12[data_not_num_plus_autolab_all$Q38_12 == ""] <- 1.5

data_num_plus_autolab_all$ENGAGEMENT <- data_num_plus_autolab_all$E1 + data_num_plus_autolab_all$E2 + data_num_plus_autolab_all$E3 + data_num_plus_autolab_all$E4 + data_num_plus_autolab_all$E5 + data_num_plus_autolab_all$E6 + data_num_plus_autolab_all$E7 + data_num_plus_autolab_all$E8 + data_num_plus_autolab_all$E9 + data_num_plus_autolab_all$E10 + data_num_plus_autolab_all$E11 + data_num_plus_autolab_all$E12


#W4

data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E1[data_not_num_plus_autolab_w4$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w4$E1)

data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E2[data_not_num_plus_autolab_w4$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E3[data_not_num_plus_autolab_w4$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E4[data_not_num_plus_autolab_w4$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E5[data_not_num_plus_autolab_w4$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E6[data_not_num_plus_autolab_w4$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E7[data_not_num_plus_autolab_w4$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E8[data_not_num_plus_autolab_w4$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E9[data_not_num_plus_autolab_w4$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E10[data_not_num_plus_autolab_w4$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E11[data_not_num_plus_autolab_w4$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w4$E12[data_not_num_plus_autolab_w4$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w4$ENGAGEMENT <- data_num_plus_autolab_w4$E1 + data_num_plus_autolab_w4$E2 + data_num_plus_autolab_w4$E3 + data_num_plus_autolab_w4$E4 + data_num_plus_autolab_w4$E5 + data_num_plus_autolab_w4$E6 + data_num_plus_autolab_w4$E7 + data_num_plus_autolab_w4$E8 + data_num_plus_autolab_w4$E9 + data_num_plus_autolab_w4$E10 + data_num_plus_autolab_w4$E11 + data_num_plus_autolab_w4$E12

#w5

data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E1[data_not_num_plus_autolab_w5$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w5$E1)

data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E2[data_not_num_plus_autolab_w5$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E3[data_not_num_plus_autolab_w5$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E4[data_not_num_plus_autolab_w5$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E5[data_not_num_plus_autolab_w5$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E6[data_not_num_plus_autolab_w5$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E7[data_not_num_plus_autolab_w5$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E8[data_not_num_plus_autolab_w5$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E9[data_not_num_plus_autolab_w5$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E10[data_not_num_plus_autolab_w5$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E11[data_not_num_plus_autolab_w5$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w5$E12[data_not_num_plus_autolab_w5$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w5$ENGAGEMENT <- data_num_plus_autolab_w5$E1 + data_num_plus_autolab_w5$E2 + data_num_plus_autolab_w5$E3 + data_num_plus_autolab_w5$E4 + data_num_plus_autolab_w5$E5 + data_num_plus_autolab_w5$E6 + data_num_plus_autolab_w5$E7 + data_num_plus_autolab_w5$E8 + data_num_plus_autolab_w5$E9 + data_num_plus_autolab_w5$E10 + data_num_plus_autolab_w5$E11 + data_num_plus_autolab_w5$E12

#w7

data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E1[data_not_num_plus_autolab_w7$Q38_1 == ""] <- 1.5

#table(data_num_plus_autolab_w7$E1)

data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E2[data_not_num_plus_autolab_w7$Q38_2 == ""] <- 1.5

data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E3[data_not_num_plus_autolab_w7$Q38_3 == ""] <- 1.5


data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E4[data_not_num_plus_autolab_w7$Q38_4 == ""] <- 1.5

data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E5[data_not_num_plus_autolab_w7$Q38_5 == ""] <- 1.5

data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E6[data_not_num_plus_autolab_w7$Q38_6 == ""] <- 1.5

data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E7[data_not_num_plus_autolab_w7$Q38_7 == ""] <- 1.5

data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E8[data_not_num_plus_autolab_w7$Q38_8 == ""] <- 1.5

data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E9[data_not_num_plus_autolab_w7$Q38_9 == ""] <- 1.5

data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E10[data_not_num_plus_autolab_w7$Q38_10 == ""] <- 1.5

data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E11[data_not_num_plus_autolab_w7$Q38_11 == ""] <- 1.5

data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I did this in the past year"] <- 3
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I plan to do this in the future"] <- 2
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I'm not sure"] <- 1
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == "I have no interest in doing this"] <- 0
data_num_plus_autolab_w7$E12[data_not_num_plus_autolab_w7$Q38_12 == ""] <- 1.5

data_num_plus_autolab_w7$ENGAGEMENT <- data_num_plus_autolab_w7$E1 + data_num_plus_autolab_w7$E2 + data_num_plus_autolab_w7$E3 + data_num_plus_autolab_w7$E4 + data_num_plus_autolab_w7$E5 + data_num_plus_autolab_w7$E6 + data_num_plus_autolab_w7$E7 + data_num_plus_autolab_w7$E8 + data_num_plus_autolab_w7$E9 + data_num_plus_autolab_w7$E10 + data_num_plus_autolab_w7$E11 + data_num_plus_autolab_w7$E12


table(data_num$ENGAGEMENT)

# Q39 : To what extent do you agree with the following statements? 
# Strongly agree / Somewhat agree / Not sure / Somewhat disagree / Strongly disagree

table(data_not_num$Q39_1) # With hard work, anyone can become an expert in computer science
table(data_not_num$Q39_2) # Women and men have the same level of natural ability and talent in computer science
table(data_not_num$Q39_3) # Women are less capable of success in computer science than men
table(data_not_num$Q39_4) # Men are more likely to excel in careers that involve computing than women are
table(data_not_num$Q39_5) # Men are more capable than women at solving computing problems


data_num$A1[data_not_num$Q39_1 == "Strongly agree"] <- 3
data_num$A1[data_not_num$Q39_1 == "Somewhat agree"] <- 2
data_num$A1[data_not_num$Q39_1 == "Not sure"] <- 1.5
data_num$A1[data_not_num$Q39_1 == "Somewhat disagree"] <- 1
data_num$A1[data_not_num$Q39_1 == "Strongly disagree"] <- 0
data_num$A1[data_not_num$Q39_1 == ""] <- 1.5

data_num$A2[data_not_num$Q39_2 == "Strongly agree"] <- 3
data_num$A2[data_not_num$Q39_2 == "Somewhat agree"] <- 2
data_num$A2[data_not_num$Q39_2 == "Not sure"] <- 1.5
data_num$A2[data_not_num$Q39_2 == "Somewhat disagree"] <- 1
data_num$A2[data_not_num$Q39_2 == "Strongly disagree"] <- 0
data_num$A2[data_not_num$Q39_2 == ""] <- 1.5

# inverted scale
data_num$A3[data_not_num$Q39_3 == "Strongly disagree"] <- 3
data_num$A3[data_not_num$Q39_3 == "Somewhat disagree"] <- 2
data_num$A3[data_not_num$Q39_3 == "Not sure"] <- 1.5
data_num$A3[data_not_num$Q39_3 == "Somewhat agree"] <- 1
data_num$A3[data_not_num$Q39_3 == "Strongly sagree"] <- 0
data_num$A3[data_not_num$Q39_3 == ""] <- 1.5

data_num$A4[data_not_num$Q39_4 == "Strongly disagree"] <- 3
data_num$A4[data_not_num$Q39_4 == "Somewhat disagree"] <- 2
data_num$A4[data_not_num$Q39_4 == "Not sure"] <- 1.5
data_num$A4[data_not_num$Q39_4 == "Somewhat agree"] <- 1
data_num$A4[data_not_num$Q39_4 == "Strongly agree"] <- 0
data_num$A4[data_not_num$Q39_4 == ""] <- 1.5

data_num$A5[data_not_num$Q39_5 == "Strongly disagree"] <- 3
data_num$A5[data_not_num$Q39_5 == "Somewhat disagree"] <- 2
data_num$A5[data_not_num$Q39_5 == "Not sure"] <- 1.5
data_num$A5[data_not_num$Q39_5 == "Somewhat agree"] <- 1
data_num$A5[data_not_num$Q39_5 == "Strongly agree"] <- 0
data_num$A5[data_not_num$Q39_5 == ""] <- 1.5

data_num$ATTITUDES <- data_num$A1 + data_num$A2 + data_num$A3 + data_num$A4  + data_num$A5

# all

data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_all$A1[data_not_num_plus_autolab_all$Q39_1 == ""] <- 1.5

data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A2[data_not_num_plus_autolab_all$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A3[data_not_num_plus_autolab_all$Q39_3 == ""] <- 1.5

data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A4[data_not_num_plus_autolab_all$Q39_4 == ""] <- 1.5

data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_all$A5[data_not_num_plus_autolab_all$Q39_5 == ""] <- 1.5

data_num_plus_autolab_all$ATTITUDES <- data_num_plus_autolab_all$A1 + data_num_plus_autolab_all$A2 + data_num_plus_autolab_all$A3 + data_num_plus_autolab_all$A4 + data_num_plus_autolab_all$A5



# W4

data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w4$A1[data_not_num_plus_autolab_w4$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A2[data_not_num_plus_autolab_w4$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A3[data_not_num_plus_autolab_w4$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A4[data_not_num_plus_autolab_w4$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w4$A5[data_not_num_plus_autolab_w4$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w4$ATTITUDES <- data_num_plus_autolab_w4$A1 + data_num_plus_autolab_w4$A2 + data_num_plus_autolab_w4$A3 + data_num_plus_autolab_w4$A4 + data_num_plus_autolab_w4$A5

# w5

data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w5$A1[data_s23_plus_autolab_week5$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A2[data_s23_plus_autolab_week5$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A3[data_s23_plus_autolab_week5$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A4[data_s23_plus_autolab_week5$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w5$A5[data_s23_plus_autolab_week5$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w5$ATTITUDES <- data_num_plus_autolab_w5$A1 + data_num_plus_autolab_w5$A2 + data_num_plus_autolab_w5$A3 + data_num_plus_autolab_w5$A4 + data_num_plus_autolab_w5$A5

# w7

data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly agree"] <- 3
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat agree"] <- 2
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Somewhat disagree"] <- 1
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == "Strongly disagree"] <- 0
data_num_plus_autolab_w7$A1[data_not_num_plus_autolab_w7$Q39_1 == ""] <- 1.5

data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A2[data_not_num_plus_autolab_w7$Q39_2 == ""] <- 1.5

# inverted scale
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A3[data_not_num_plus_autolab_w7$Q39_3 == ""] <- 1.5

data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A4[data_not_num_plus_autolab_w7$Q39_4 == ""] <- 1.5

data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly disagree"] <- 3
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat disagree"] <- 2
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Not sure"] <- 1.5
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Somewhat agree"] <- 1
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == "Strongly agree"] <- 0
data_num_plus_autolab_w7$A5[data_not_num_plus_autolab_w7$Q39_5 == ""] <- 1.5

data_num_plus_autolab_w7$ATTITUDES <- data_num_plus_autolab_w7$A1 + data_num_plus_autolab_w7$A2 + data_num_plus_autolab_w7$A3 + data_num_plus_autolab_w7$A4 + data_num_plus_autolab_w7$A5


# Divide the value for ATTITUDES by 15, which is the max possible value

#data_num$ATTITUDES <- data_num$ATTITUDES/15
#data_num_plus_autolab$ATTITUDES <- data_num_plus_autolab$ATTITUDES/15


names(data_not_num)


str(data_num_plus_autolab)
str(data_not_num_plus_autolab)
names(data_f20_plus_autolab_week7)

# REPLACE ATTITUDES WITH NUMBERS

data_num$BELONGINGNESS <- 0
data_num$CONFIDENCE <- 0
data_num$INTEREST <- 0
data_num$USEFULNESS <- 0
data_num$ENCOURAGEMENT <- 0

data_num_plus_autolab_all$BELONGINGNESS <- 0
data_num_plus_autolab_all$CONFIDENCE <- 0
data_num_plus_autolab_all$INTEREST <- 0
data_num_plus_autolab_all$USEFULNESS <- 0
data_num_plus_autolab_all$ENCOURAGEMENT <- 0
data_num_plus_autolab_all$Q6_B <- 0 
data_num_plus_autolab_all$Q3_B <- 0 
data_num_plus_autolab_all$Q11_B <- 0 
data_num_plus_autolab_all$Q57_B <- 0 
data_num_plus_autolab_all$Q21_B <- 0 
data_num_plus_autolab_all$Q26_B <- 0


data_num_plus_autolab_w4$BELONGINGNESS <- 0
data_num_plus_autolab_w4$CONFIDENCE <- 0
data_num_plus_autolab_w4$INTEREST <- 0
data_num_plus_autolab_w4$USEFULNESS <- 0
data_num_plus_autolab_w4$ENCOURAGEMENT <- 0
data_num_plus_autolab_w4$Q6_B <- 0 
data_num_plus_autolab_w4$Q3_B <- 0 
data_num_plus_autolab_w4$Q11_B <- 0 
data_num_plus_autolab_w4$Q57_B <- 0 
data_num_plus_autolab_w4$Q21_B <- 0 
data_num_plus_autolab_w4$Q26_B <- 0

data_num_plus_autolab_w5$BELONGINGNESS <- 0
data_num_plus_autolab_w5$CONFIDENCE <- 0
data_num_plus_autolab_w5$INTEREST <- 0
data_num_plus_autolab_w5$USEFULNESS <- 0
data_num_plus_autolab_w5$ENCOURAGEMENT <- 0
data_num_plus_autolab_w5$Q6_B <- 0 
data_num_plus_autolab_w5$Q3_B <- 0 
data_num_plus_autolab_w5$Q11_B <- 0 
data_num_plus_autolab_w5$Q57_B <- 0 
data_num_plus_autolab_w5$Q21_B <- 0 
data_num_plus_autolab_w5$Q26_B <- 0

data_num_plus_autolab_w7$BELONGINGNESS <- 0
data_num_plus_autolab_w7$CONFIDENCE <- 0
data_num_plus_autolab_w7$INTEREST <- 0
data_num_plus_autolab_w7$USEFULNESS <- 0
data_num_plus_autolab_w7$ENCOURAGEMENT <- 0
data_num_plus_autolab_w7$Q6_B <- 0 
data_num_plus_autolab_w7$Q3_B <- 0 
data_num_plus_autolab_w7$Q11_B <- 0 
data_num_plus_autolab_w7$Q57_B <- 0 
data_num_plus_autolab_w7$Q21_B <- 0 
data_num_plus_autolab_w7$Q26_B <- 0


# Belongingness

names(data_not_num)

data_num$Q6_B[data_not_num$Q6 == "Strongly Agree"] <- 3
data_num$Q6_B[data_not_num$Q6 == "Agree"] <- 2
data_num$Q6_B[data_not_num$Q6 == "Disagree"] <- 1
data_num$Q6_B[data_not_num$Q6 == "Strongly Disagree"] <- 0
data_num$Q6_B[data_not_num$Q6 == ""] <- 1.5 # average between agree and disagree

data_num$Q11_B[data_not_num$Q11 == "Strongly Agree"] <- 3
data_num$Q11_B[data_not_num$Q11 == "Agree"] <- 2
data_num$Q11_B[data_not_num$Q11 == "Disagree"] <- 1
data_num$Q11_B[data_not_num$Q11 == "Strongly Disagree"] <- 0
data_num$Q11_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q21_B[data_not_num$Q21 == "Strongly Agree"] <- 3
data_num$Q21_B[data_not_num$Q21 == "Agree"] <- 2
data_num$Q21_B[data_not_num$Q21 == "Disagree"] <- 1
data_num$Q21_B[data_not_num$Q21 == "Strongly Disagree"] <- 0
data_num$Q21_B[data_not_num$Q11 == ""] <- 1.5

data_num$Q26_B[data_not_num$Q26 == "Strongly Agree"] <- 3
data_num$Q26_B[data_not_num$Q26 == "Agree"] <- 2
data_num$Q26_B[data_not_num$Q26 == "Disagree"] <- 1
data_num$Q26_B[data_not_num$Q26 == "Strongly Disagree"] <- 0
data_num$Q26_B[data_not_num$Q26 == ""] <- 1.5

data_num$BELONGINGNESS <- data_num$Q6_B + data_num$Q11_B + data_num$Q21_B + data_num$Q26_B

# all

data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Agree"] <- 2
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Disagree"] <- 1
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q6_B[data_not_num_plus_autolab_all$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Agree"] <- 2
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Disagree"] <- 1
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q11_B[data_not_num_plus_autolab_all$Q11 == ""] <- 1.5

data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Agree"] <- 2
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Disagree"] <- 1
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q21_B[data_not_num_plus_autolab_all$Q21 == ""] <- 1.5

data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Agree"] <- 2
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Disagree"] <- 1
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q26_B[data_not_num_plus_autolab_all$Q26 == ""] <- 1.5

data_num_plus_autolab_all$BELONGINGNESS <- data_num_plus_autolab_all$Q6_B + data_num_plus_autolab_all$Q11_B + data_num_plus_autolab_all$Q21_B + data_num_plus_autolab_all$Q26_B


# W4

data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Agree"] <- 2
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q6_B[data_not_num_plus_autolab_w4$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Agree"] <- 2
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q11_B[data_not_num_plus_autolab_w4$Q11 == ""] <- 1.5

data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Agree"] <- 2
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q21_B[data_not_num_plus_autolab_w4$Q21 == ""] <- 1.5

data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Agree"] <- 2
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q26_B[data_not_num_plus_autolab_w4$Q26 == ""] <- 1.5

data_num_plus_autolab_w4$BELONGINGNESS <- data_num_plus_autolab_w4$Q6_B + data_num_plus_autolab_w4$Q11_B + data_num_plus_autolab_w4$Q21_B + data_num_plus_autolab_w4$Q26_B

# w5

data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Agree"] <- 2
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q6_B[data_not_num_plus_autolab_w5$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Agree"] <- 2
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q11_B[data_not_num_plus_autolab_w5$Q11 == ""] <- 1.5

data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Agree"] <- 2
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q21_B[data_not_num_plus_autolab_w5$Q21 == ""] <- 1.5

data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Agree"] <- 2
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q26_B[data_not_num_plus_autolab_w5$Q26 == ""] <- 1.5

data_num_plus_autolab_w5$BELONGINGNESS <- data_num_plus_autolab_w5$Q6_B + data_num_plus_autolab_w5$Q11_B + data_num_plus_autolab_w5$Q21_B + data_num_plus_autolab_w5$Q26_B

# w7

data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Agree"] <- 2
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q6_B[data_not_num_plus_autolab_w7$Q6 == ""] <- 1.5 # average between agree and disagree

data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Agree"] <- 2
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q11_B[data_not_num_plus_autolab_w7$Q11 == ""] <- 1.5

data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Agree"] <- 2
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q21_B[data_not_num_plus_autolab_w7$Q21 == ""] <- 1.5

data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Agree"] <- 2
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q26_B[data_not_num_plus_autolab_w7$Q26 == ""] <- 1.5

data_num_plus_autolab_w7$BELONGINGNESS <- data_num_plus_autolab_w7$Q6_B + data_num_plus_autolab_w7$Q11_B + data_num_plus_autolab_w7$Q21_B + data_num_plus_autolab_w7$Q26_B



# Confidence
# Q3, Q9, Q15, Q19, Q24

data_num$Q3_B[data_not_num$Q3 == "Strongly Agree"] <- 3
data_num$Q3_B[data_not_num$Q3 == "Agree"] <- 2
data_num$Q3_B[data_not_num$Q3 == "Disagree"] <- 1
data_num$Q3_B[data_not_num$Q3 == "Strongly Disagree"] <- 0
data_num$Q3_B[data_not_num$Q3 == ""] <- 1.5

data_num$Q9_B[data_not_num$Q9 == "Strongly Agree"] <- 3
data_num$Q9_B[data_not_num$Q9 == "Agree"] <- 2
data_num$Q9_B[data_not_num$Q9 == "Disagree"] <- 1
data_num$Q9_B[data_not_num$Q9 == "Strongly Disagree"] <- 0
data_num$Q9_B[data_not_num$Q9 == ""] <- 1.5

data_num$Q15_B[data_not_num$Q15 == "Strongly Agree"] <- 3
data_num$Q15_B[data_not_num$Q15 == "Agree"] <- 2
data_num$Q15_B[data_not_num$Q15 == "Disagree"] <- 1
data_num$Q15_B[data_not_num$Q15 == "Strongly Disagree"] <- 0
data_num$Q15_B[data_not_num$Q15 == ""] <- 1.5


data_num$Q19_B[data_not_num$Q19 == "Strongly Agree"] <- 3
data_num$Q19_B[data_not_num$Q19 == "Agree"] <- 2
data_num$Q19_B[data_not_num$Q19 == "Disagree"] <- 1
data_num$Q19_B[data_not_num$Q19 == "Strongly Disagree"] <- 0
data_num$Q19_B[data_not_num$Q19 == ""] <- 1.5


data_num$Q24_B[data_not_num$Q24 == "Strongly Agree"] <- 3
data_num$Q24_B[data_not_num$Q24 == "Agree"] <- 2
data_num$Q24_B[data_not_num$Q24 == "Disagree"] <- 1
data_num$Q24_B[data_not_num$Q24 == "Strongly Disagree"] <- 0
data_num$Q24_B[data_not_num$Q24 == ""] <- 1.5

data_num$CONFIDENCE <- data_num$Q3_B + data_num$Q9_B + data_num$Q15_B + data_num$Q19_B + data_num$Q24_B

# all

data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Agree"] <- 2
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Disagree"] <- 1
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q3_B[data_not_num_plus_autolab_all$Q3 == ""] <- 1.5

data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Agree"] <- 2
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Disagree"] <- 1
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q9_B[data_not_num_plus_autolab_all$Q9 == ""] <- 1.5

data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Agree"] <- 2
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Disagree"] <- 1
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q15_B[data_not_num_plus_autolab_all$Q15 == ""] <- 1.5


data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Agree"] <- 2
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Disagree"] <- 1
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q19_B[data_not_num_plus_autolab_all$Q19 == ""] <- 1.5


data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Agree"] <- 2
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Disagree"] <- 1
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q24_B[data_not_num_plus_autolab_all$Q24 == ""] <- 1.5

data_num_plus_autolab_all$CONFIDENCE <- data_num_plus_autolab_all$Q3_B + data_num_plus_autolab_all$Q9_B + data_num_plus_autolab_all$Q15_B + data_num_plus_autolab_all$Q19_B + data_num_plus_autolab_all$Q24_B


# W4

data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Agree"] <- 2
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q3_B[data_not_num_plus_autolab_w4$Q3 == ""] <- 1.5

data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Agree"] <- 2
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q9_B[data_not_num_plus_autolab_w4$Q9 == ""] <- 1.5

data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Agree"] <- 2
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q15_B[data_not_num_plus_autolab_w4$Q15 == ""] <- 1.5


data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Agree"] <- 2
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q19_B[data_not_num_plus_autolab_w4$Q19 == ""] <- 1.5


data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Agree"] <- 2
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q24_B[data_not_num_plus_autolab_w4$Q24 == ""] <- 1.5

data_num_plus_autolab_w4$CONFIDENCE <- data_num_plus_autolab_w4$Q3_B + data_num_plus_autolab_w4$Q9_B + data_num_plus_autolab_w4$Q15_B + data_num_plus_autolab_w4$Q19_B + data_num_plus_autolab_w4$Q24_B

# w5

data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Agree"] <- 2
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q3_B[data_not_num_plus_autolab_w5$Q3 == ""] <- 1.5

data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Agree"] <- 2
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q9_B[data_not_num_plus_autolab_w5$Q9 == ""] <- 1.5

data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Agree"] <- 2
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q15_B[data_not_num_plus_autolab_w5$Q15 == ""] <- 1.5


data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Agree"] <- 2
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q19_B[data_not_num_plus_autolab_w5$Q19 == ""] <- 1.5


data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Agree"] <- 2
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q24_B[data_not_num_plus_autolab_w5$Q24 == ""] <- 1.5

data_num_plus_autolab_w5$CONFIDENCE <- data_num_plus_autolab_w5$Q3_B + data_num_plus_autolab_w5$Q9_B + data_num_plus_autolab_w5$Q15_B + data_num_plus_autolab_w5$Q19_B + data_num_plus_autolab_w5$Q24_B

# w7

data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Agree"] <- 2
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q3_B[data_not_num_plus_autolab_w7$Q3 == ""] <- 1.5

data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Agree"] <- 2
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q9_B[data_not_num_plus_autolab_w7$Q9 == ""] <- 1.5

data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Agree"] <- 2
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q15_B[data_not_num_plus_autolab_w7$Q15 == ""] <- 1.5


data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Agree"] <- 2
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q19_B[data_not_num_plus_autolab_w7$Q19 == ""] <- 1.5


data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Agree"] <- 2
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q24_B[data_not_num_plus_autolab_w7$Q24 == ""] <- 1.5

data_num_plus_autolab_w7$CONFIDENCE <- data_num_plus_autolab_w7$Q3_B + data_num_plus_autolab_w7$Q9_B + data_num_plus_autolab_w7$Q15_B + data_num_plus_autolab_w7$Q19_B + data_num_plus_autolab_w7$Q24_B


# Interest
#Q5, Q10, Q16, Q20, Q25

data_num$Q5_B[data_not_num$Q5 == "Strongly Agree"] <- 3
data_num$Q5_B[data_not_num$Q5 == "Agree"] <- 2
data_num$Q5_B[data_not_num$Q5 == "Disagree"] <- 1
data_num$Q5_B[data_not_num$Q5 == "Strongly Disagree"] <- 0
data_num$Q5_B[data_not_num$Q5 == ""] <- 1.5

data_num$Q10_B[data_not_num$Q10 == "Strongly Agree"] <- 3
data_num$Q10_B[data_not_num$Q10 == "Agree"] <- 2
data_num$Q10_B[data_not_num$Q10 == "Disagree"] <- 1
data_num$Q10_B[data_not_num$Q10 == "Strongly Disagree"] <- 0
data_num$Q10_B[data_not_num$Q10 == ""] <- 1.5

data_num$Q16_B[data_not_num$Q16 == "Strongly Agree"] <- 3
data_num$Q16_B[data_not_num$Q16 == "Agree"] <- 2
data_num$Q16_B[data_not_num$Q16 == "Disagree"] <- 1
data_num$Q16_B[data_not_num$Q16 == "Strongly Disagree"] <- 0
data_num$Q16_B[data_not_num$Q16 == ""] <- 1.5


data_num$Q20_B[data_not_num$Q20 == "Strongly Agree"] <- 3
data_num$Q20_B[data_not_num$Q20 == "Agree"] <- 2
data_num$Q20_B[data_not_num$Q20 == "Disagree"] <- 1
data_num$Q20_B[data_not_num$Q20 == "Strongly Disagree"] <- 0
data_num$Q20_B[data_not_num$Q20 == ""] <- 1.5


data_num$Q25_B[data_not_num$Q25 == "Strongly Agree"] <- 3
data_num$Q25_B[data_not_num$Q25 == "Agree"] <- 2
data_num$Q25_B[data_not_num$Q25 == "Disagree"] <- 1
data_num$Q25_B[data_not_num$Q25 == "Strongly Disagree"] <- 0
data_num$Q25_B[data_not_num$Q25 == ""] <- 1.5

data_num$INTEREST <- data_num$Q5_B + data_num$Q10_B + data_num$Q16_B + data_num$Q20_B + data_num$Q25_B

#all

data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Agree"] <- 2
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Disagree"] <- 1
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q5_B[data_not_num_plus_autolab_all$Q5 == ""] <- 1.5

data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Agree"] <- 2
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Disagree"] <- 1
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q10_B[data_not_num_plus_autolab_all$Q10 == ""] <- 1.5

data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Agree"] <- 2
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Disagree"] <- 1
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q16_B[data_not_num_plus_autolab_all$Q16 == ""] <- 1.5


data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Agree"] <- 2
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Disagree"] <- 1
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q20_B[data_not_num_plus_autolab_all$Q20 == ""] <- 1.5


data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Agree"] <- 2
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Disagree"] <- 1
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q25_B[data_not_num_plus_autolab_all$Q25 == ""] <- 1.5

data_num_plus_autolab_all$INTEREST <- data_num_plus_autolab_all$Q5_B + data_num_plus_autolab_all$Q10_B + data_num_plus_autolab_all$Q16_B + data_num_plus_autolab_all$Q20_B + data_num_plus_autolab_all$Q25_B


#W4

data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Agree"] <- 2
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q5_B[data_not_num_plus_autolab_w4$Q5 == ""] <- 1.5

data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Agree"] <- 2
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q10_B[data_not_num_plus_autolab_w4$Q10 == ""] <- 1.5

data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Agree"] <- 2
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q16_B[data_not_num_plus_autolab_w4$Q16 == ""] <- 1.5


data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Agree"] <- 2
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q20_B[data_not_num_plus_autolab_w4$Q20 == ""] <- 1.5


data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Agree"] <- 2
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q25_B[data_not_num_plus_autolab_w4$Q25 == ""] <- 1.5

data_num_plus_autolab_w4$INTEREST <- data_num_plus_autolab_w4$Q5_B + data_num_plus_autolab_w4$Q10_B + data_num_plus_autolab_w4$Q16_B + data_num_plus_autolab_w4$Q20_B + data_num_plus_autolab_w4$Q25_B

#W5

data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Agree"] <- 2
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q5_B[data_not_num_plus_autolab_w5$Q5 == ""] <- 1.5

data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Agree"] <- 2
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q10_B[data_not_num_plus_autolab_w5$Q10 == ""] <- 1.5

data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Agree"] <- 2
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q16_B[data_not_num_plus_autolab_w5$Q16 == ""] <- 1.5


data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Agree"] <- 2
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q20_B[data_not_num_plus_autolab_w5$Q20 == ""] <- 1.5


data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Agree"] <- 2
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q25_B[data_not_num_plus_autolab_w5$Q25 == ""] <- 1.5

data_num_plus_autolab_w5$INTEREST <- data_num_plus_autolab_w5$Q5_B + data_num_plus_autolab_w5$Q10_B + data_num_plus_autolab_w5$Q16_B + data_num_plus_autolab_w5$Q20_B + data_num_plus_autolab_w5$Q25_B

#w7

data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Agree"] <- 2
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q5_B[data_not_num_plus_autolab_w7$Q5 == ""] <- 1.5

data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Agree"] <- 2
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q10_B[data_not_num_plus_autolab_w7$Q10 == ""] <- 1.5

data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Agree"] <- 2
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q16_B[data_not_num_plus_autolab_w7$Q16 == ""] <- 1.5


data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Agree"] <- 2
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q20_B[data_not_num_plus_autolab_w7$Q20 == ""] <- 1.5


data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Agree"] <- 2
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q25_B[data_not_num_plus_autolab_w7$Q25 == ""] <- 1.5

data_num_plus_autolab_w7$INTEREST <- data_num_plus_autolab_w7$Q5_B + data_num_plus_autolab_w7$Q10_B + data_num_plus_autolab_w7$Q16_B + data_num_plus_autolab_w7$Q20_B + data_num_plus_autolab_w7$Q25_B


# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_num$Q7_B[data_not_num$Q7 == "Strongly Agree"] <- 3
data_num$Q7_B[data_not_num$Q7 == "Agree"] <- 2
data_num$Q7_B[data_not_num$Q7 == "Disagree"] <- 1
data_num$Q7_B[data_not_num$Q7 == "Strongly Disagree"] <- 0
data_num$Q7_B[data_not_num$Q7 == ""] <- 1.5

data_num$Q12_B[data_not_num$Q12 == "Strongly Agree"] <- 3
data_num$Q12_B[data_not_num$Q12 == "Agree"] <- 2
data_num$Q12_B[data_not_num$Q12 == "Disagree"] <- 1
data_num$Q12_B[data_not_num$Q12 == "Strongly Disagree"] <- 0
data_num$Q12_B[data_not_num$Q12 == ""] <- 1.5

data_num$Q17_B[data_not_num$Q17 == "Strongly Agree"] <- 3
data_num$Q17_B[data_not_num$Q17 == "Agree"] <- 2
data_num$Q17_B[data_not_num$Q17 == "Disagree"] <- 1
data_num$Q17_B[data_not_num$Q17 == "Strongly Disagree"] <- 0
data_num$Q17_B[data_not_num$Q17 == ""] <- 1.5


data_num$Q22_B[data_not_num$Q22 == "Strongly Agree"] <- 3
data_num$Q22_B[data_not_num$Q22 == "Agree"] <- 2
data_num$Q22_B[data_not_num$Q22 == "Disagree"] <- 1
data_num$Q22_B[data_not_num$Q22 == "Strongly Disagree"] <- 0
data_num$Q22_B[data_not_num$Q22 == ""] <- 1.5


data_num$Q27_B[data_not_num$Q27 == "Strongly Agree"] <- 3
data_num$Q27_B[data_not_num$Q27 == "Agree"] <- 2
data_num$Q27_B[data_not_num$Q27 == "Disagree"] <- 1
data_num$Q27_B[data_not_num$Q27 == "Strongly Disagree"] <- 0
data_num$Q27_B[data_not_num$Q27 == ""] <- 1.5

data_num$USEFULNESS <- data_num$Q7_B + data_num$Q12_B + data_num$Q17_B + data_num$Q22_B + data_num$Q27_B

#all

data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Agree"] <- 2
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Disagree"] <- 1
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q7_B[data_not_num_plus_autolab_all$Q7 == ""] <- 1.5

data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Agree"] <- 2
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Disagree"] <- 1
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q12_B[data_not_num_plus_autolab_all$Q12 == ""] <- 1.5

data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Agree"] <- 2
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Disagree"] <- 1
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q17_B[data_not_num_plus_autolab_all$Q17 == ""] <- 1.5


data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Agree"] <- 2
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Disagree"] <- 1
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q22_B[data_not_num_plus_autolab_all$Q22 == ""] <- 1.5


data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Agree"] <- 2
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Disagree"] <- 1
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q27_B[data_not_num_plus_autolab_all$Q27 == ""] <- 1.5

data_num_plus_autolab_all$USEFULNESS <- data_num_plus_autolab_all$Q7_B + data_num_plus_autolab_all$Q12_B + data_num_plus_autolab_all$Q17_B + data_num_plus_autolab_all$Q22_B + data_num_plus_autolab_all$Q27_B


#W4

data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Agree"] <- 2
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q7_B[data_not_num_plus_autolab_w4$Q7 == ""] <- 1.5

data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Agree"] <- 2
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q12_B[data_not_num_plus_autolab_w4$Q12 == ""] <- 1.5

data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Agree"] <- 2
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q17_B[data_not_num_plus_autolab_w4$Q17 == ""] <- 1.5


data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Agree"] <- 2
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q22_B[data_not_num_plus_autolab_w4$Q22 == ""] <- 1.5


data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Agree"] <- 2
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q27_B[data_not_num_plus_autolab_w4$Q27 == ""] <- 1.5

data_num_plus_autolab_w4$USEFULNESS <- data_num_plus_autolab_w4$Q7_B + data_num_plus_autolab_w4$Q12_B + data_num_plus_autolab_w4$Q17_B + data_num_plus_autolab_w4$Q22_B + data_num_plus_autolab_w4$Q27_B

# W5

data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Agree"] <- 2
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q7_B[data_not_num_plus_autolab_w5$Q7 == ""] <- 1.5

data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Agree"] <- 2
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q12_B[data_not_num_plus_autolab_w5$Q12 == ""] <- 1.5

data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Agree"] <- 2
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q17_B[data_not_num_plus_autolab_w5$Q17 == ""] <- 1.5


data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Agree"] <- 2
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q22_B[data_not_num_plus_autolab_w5$Q22 == ""] <- 1.5


data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Agree"] <- 2
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q27_B[data_not_num_plus_autolab_w5$Q27 == ""] <- 1.5

data_num_plus_autolab_w5$USEFULNESS <- data_num_plus_autolab_w5$Q7_B + data_num_plus_autolab_w5$Q12_B + data_num_plus_autolab_w5$Q17_B + data_num_plus_autolab_w5$Q22_B + data_num_plus_autolab_w5$Q27_B

#w7

data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Agree"] <- 2
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q7_B[data_not_num_plus_autolab_w7$Q7 == ""] <- 1.5

data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Agree"] <- 2
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q12_B[data_not_num_plus_autolab_w7$Q12 == ""] <- 1.5

data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Agree"] <- 2
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q17_B[data_not_num_plus_autolab_w7$Q17 == ""] <- 1.5


data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Agree"] <- 2
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q22_B[data_not_num_plus_autolab_w7$Q22 == ""] <- 1.5


data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Agree"] <- 2
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q27_B[data_not_num_plus_autolab_w7$Q27 == ""] <- 1.5

data_num_plus_autolab_w7$USEFULNESS <- data_num_plus_autolab_w7$Q7_B + data_num_plus_autolab_w7$Q12_B + data_num_plus_autolab_w7$Q17_B + data_num_plus_autolab_w7$Q22_B + data_num_plus_autolab_w7$Q27_B



# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_num$Q8_B[data_not_num$Q8 == "Strongly Agree"] <- 3
data_num$Q8_B[data_not_num$Q8 == "Agree"] <- 2
data_num$Q8_B[data_not_num$Q8 == "Disagree"] <- 1
data_num$Q8_B[data_not_num$Q8 == "Strongly Disagree"] <- 0
data_num$Q8_B[data_not_num$Q8 == ""] <- 1.5

data_num$Q14_B[data_not_num$Q14 == "Strongly Agree"] <- 3
data_num$Q14_B[data_not_num$Q14 == "Agree"] <- 2
data_num$Q14_B[data_not_num$Q14 == "Disagree"] <- 1
data_num$Q14_B[data_not_num$Q14 == "Strongly Disagree"] <- 0
data_num$Q14_B[data_not_num$Q14 == ""] <- 1.5

data_num$Q18_B[data_not_num$Q18 == "Strongly Agree"] <- 3
data_num$Q18_B[data_not_num$Q18 == "Agree"] <- 2
data_num$Q18_B[data_not_num$Q18 == "Disagree"] <- 1
data_num$Q18_B[data_not_num$Q18 == "Strongly Disagree"] <- 0
data_num$Q18_B[data_not_num$Q18 == ""] <- 1.5


data_num$Q23_B[data_not_num$Q23 == "Strongly Agree"] <- 3
data_num$Q23_B[data_not_num$Q23 == "Agree"] <- 2
data_num$Q23_B[data_not_num$Q23 == "Disagree"] <- 1
data_num$Q23_B[data_not_num$Q23 == "Strongly Disagree"] <- 0
data_num$Q23_B[data_not_num$Q23 == ""] <- 1.5


data_num$Q28_B[data_not_num$Q28 == "Strongly Agree"] <- 3
data_num$Q28_B[data_not_num$Q28 == "Agree"] <- 2
data_num$Q28_B[data_not_num$Q28 == "Disagree"] <- 1
data_num$Q28_B[data_not_num$Q28 == "Strongly Disagree"] <- 0
data_num$Q28_B[data_not_num$Q28 == ""] <- 1.5

data_num$ENCOURAGEMENT <- data_num$Q8_B + data_num$Q14_B + data_num$Q18_B + data_num$Q23_B + data_num$Q28_B

# all

data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Agree"] <- 2
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Disagree"] <- 1
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q8_B[data_not_num_plus_autolab_all$Q8 == ""] <- 1.5

data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Agree"] <- 2
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Disagree"] <- 1
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q14_B[data_not_num_plus_autolab_all$Q14 == ""] <- 1.5

data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Agree"] <- 2
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Disagree"] <- 1
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q18_B[data_not_num_plus_autolab_all$Q18 == ""] <- 1.5


data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Agree"] <- 2
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Disagree"] <- 1
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q23_B[data_not_num_plus_autolab_all$Q23 == ""] <- 1.5


data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Agree"] <- 2
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Disagree"] <- 1
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_all$Q28_B[data_not_num_plus_autolab_all$Q28 == ""] <- 1.5

data_num_plus_autolab_all$ENCOURAGEMENT <- data_num_plus_autolab_all$Q8_B + data_num_plus_autolab_all$Q14_B + data_num_plus_autolab_all$Q18_B + data_num_plus_autolab_all$Q23_B + data_num_plus_autolab_all$Q28_B


# W4

data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Agree"] <- 2
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q8_B[data_not_num_plus_autolab_w4$Q8 == ""] <- 1.5

data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Agree"] <- 2
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q14_B[data_not_num_plus_autolab_w4$Q14 == ""] <- 1.5

data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Agree"] <- 2
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q18_B[data_not_num_plus_autolab_w4$Q18 == ""] <- 1.5


data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Agree"] <- 2
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q23_B[data_not_num_plus_autolab_w4$Q23 == ""] <- 1.5


data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Agree"] <- 2
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w4$Q28_B[data_not_num_plus_autolab_w4$Q28 == ""] <- 1.5

data_num_plus_autolab_w4$ENCOURAGEMENT <- data_num_plus_autolab_w4$Q8_B + data_num_plus_autolab_w4$Q14_B + data_num_plus_autolab_w4$Q18_B + data_num_plus_autolab_w4$Q23_B + data_num_plus_autolab_w4$Q28_B

# w5

data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Agree"] <- 2
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q8_B[data_not_num_plus_autolab_w5$Q8 == ""] <- 1.5

data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Agree"] <- 2
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q14_B[data_not_num_plus_autolab_w5$Q14 == ""] <- 1.5

data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Agree"] <- 2
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q18_B[data_not_num_plus_autolab_w5$Q18 == ""] <- 1.5


data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Agree"] <- 2
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q23_B[data_not_num_plus_autolab_w5$Q23 == ""] <- 1.5


data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Agree"] <- 2
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w5$Q28_B[data_not_num_plus_autolab_w5$Q28 == ""] <- 1.5

data_num_plus_autolab_w5$ENCOURAGEMENT <- data_num_plus_autolab_w5$Q8_B + data_num_plus_autolab_w5$Q14_B + data_num_plus_autolab_w5$Q18_B + data_num_plus_autolab_w5$Q23_B + data_num_plus_autolab_w5$Q28_B

# w7

data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Agree"] <- 2
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q8_B[data_not_num_plus_autolab_w7$Q8 == ""] <- 1.5

data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Agree"] <- 2
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q14_B[data_not_num_plus_autolab_w7$Q14 == ""] <- 1.5

data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Agree"] <- 2
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q18_B[data_not_num_plus_autolab_w7$Q18 == ""] <- 1.5


data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Agree"] <- 2
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q23_B[data_not_num_plus_autolab_w7$Q23 == ""] <- 1.5


data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Agree"] <- 3
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Agree"] <- 2
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Disagree"] <- 1
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == "Strongly Disagree"] <- 0
data_num_plus_autolab_w7$Q28_B[data_not_num_plus_autolab_w7$Q28 == ""] <- 1.5

data_num_plus_autolab_w7$ENCOURAGEMENT <- data_num_plus_autolab_w7$Q8_B + data_num_plus_autolab_w7$Q14_B + data_num_plus_autolab_w7$Q18_B + data_num_plus_autolab_w7$Q23_B + data_num_plus_autolab_w7$Q28_B



names(data_num_plus_autolab)

# DONE WITH ATTITUDES

data_s23_num_untrimmed <- data_num
data_s23_num_untrimmed_plus_autolab_all <-  data_num_plus_autolab_all
data_s23_num_untrimmed_plus_autolab_w4 <-  data_num_plus_autolab_w4
data_s23_num_untrimmed_plus_autolab_w5 <-  data_num_plus_autolab_w5
data_s23_num_untrimmed_plus_autolab_w7 <-  data_num_plus_autolab_w7

data_s23_not_num_untrimmed <- data_not_num
data_s23_not_num_untrimmed_plus_autolab_all <-  data_not_num_plus_autolab_all
data_s23_not_num_untrimmed_plus_autolab_w4 <-  data_not_num_plus_autolab_w4
data_s23_not_num_untrimmed_plus_autolab_w5 <-  data_not_num_plus_autolab_w5
data_s23_not_num_untrimmed_plus_autolab_w7 <-  data_not_num_plus_autolab_w7

# Remove unneeded attributes

# DATA_NOT_NUM

names(data_not_num)
selected_variables <- c("NetID", "gender_cd", "ethnic_cd", "course_repeat_ind", "sending_school_type_cd", "orig_admit_type_cd", "curr_admit_type_cd","citizen_status_cd","SUCCESS", "Q1","Q2", "Q4", "Q35")

data_not_num_ss <- data_not_num # SAVE!

data_not_num_temp <- data_not_num[selected_variables]
data_not_num <- data_not_num_temp

# Same for Autolab data
names(data_not_num_plus_autolab_w4)

data_not_num_plus_autolab_ss_all <- data_not_num_plus_autolab_all # SAVE!
data_not_num_plus_autolab_temp_all <- data_not_num_plus_autolab_all[selected_variables]
data_not_num_plus_autolab_all <- data_not_num_plus_autolab_temp_all


data_not_num_plus_autolab_ss_w4 <- data_not_num_plus_autolab_w4 # SAVE!
data_not_num_plus_autolab_temp_w4 <- data_not_num_plus_autolab_w4[selected_variables]
data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_temp_w4

data_not_num_plus_autolab_ss_w5 <- data_not_num_plus_autolab_w5 # SAVE!
data_not_num_plus_autolab_temp_w5 <- data_not_num_plus_autolab_w5[selected_variables]
data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_temp_w5

data_not_num_plus_autolab_ss_w7 <- data_not_num_plus_autolab_w7 # SAVE!
data_not_num_plus_autolab_temp_w7 <- data_not_num_plus_autolab_w7[selected_variables]
data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_temp_w7


# DATA_NUM

# Paste from Spring 2021

names(data_num)
names(data_num_plus_autolab)

selected_variables <- c("Final.Points","Exam1", "Exam2","Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11","X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14","RecWeek15", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_ss <- data_num # SAVE!

data_num_temp <- data_num[selected_variables]
names(data_num_temp)
data_num <- data_num_temp

# DATA_NUM_WITH_AUTOLAB

names(data_num_plus_autolab_w4)

data_num_plus_autolab_w4$max_submissions
selected_variables <- c("Final.Points","Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES","max_submissions", "max_time_f_l_subm", "max_time_consecutive_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission", "min_time_b4_deadline_first_submission",  "max_time_b4_deadline_last_submission", "min_time_b4_deadline_last_submission")

#selected_variables <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.", "X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.", "X8..Find.Duplicate..1067540.", "X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.", "X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.", "Recitation.10..1129728.", "Recitation.2..1129729.", "Recitation.3..1129730.", "Recitation.7..1129732.", "Recitation.4..1129733.","Recitation.12..1129734.", "Recitation.5..1129735.", "Recitation.8..1129736.", "Recitation.13..1129737.",  "Recitation.11..1129738.", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "ATTITUDES")

data_num_plus_autolab_ss_all <- data_num_plus_autolab_all # SAVE!
data_num_plus_autolab_temp_all <- data_num_plus_autolab_all[selected_variables]
data_num_plus_autolab_all <- data_num_plus_autolab_temp_all

data_num_plus_autolab_ss_w4 <- data_num_plus_autolab_w4 # SAVE!
data_num_plus_autolab_temp_w4 <- data_num_plus_autolab_w4[selected_variables]
data_num_plus_autolab_w4 <- data_num_plus_autolab_temp_w4

data_num_plus_autolab_ss_w5 <- data_num_plus_autolab_w5 # SAVE!
data_num_plus_autolab_temp_w5 <- data_num_plus_autolab_w5[selected_variables]
data_num_plus_autolab_w5 <- data_num_plus_autolab_temp_w5

data_num_plus_autolab_ss_w7 <- data_num_plus_autolab_w7 # SAVE!
data_num_plus_autolab_temp_w7 <- data_num_plus_autolab_w7[selected_variables]
data_num_plus_autolab_w7 <- data_num_plus_autolab_temp_w7

names(data_num_plus_autolab_w7)


# select meaningful variables from non-numeric features
str(data_not_num)

success_s <- data_not_num$SUCCESS
success_s_a_all <- data_not_num_plus_autolab_all$SUCCESS
success_s_a_w4 <- data_not_num_plus_autolab_w4$SUCCESS
success_s_a_w5 <- data_not_num_plus_autolab_w5$SUCCESS
success_s_a_w7 <- data_not_num_plus_autolab_w7$SUCCESS


# SAVE THE NUM AND NOT NUM DATA FRAMES

data_num_s <- data_num
data_not_num_s <- data_not_num

data_num_a_s_all <- data_num_plus_autolab_all
data_not_num_a_s_all <-data_not_num_plus_autolab_all

data_num_a_s_w4 <- data_num_plus_autolab_w4
data_not_num_a_s_w4 <-data_not_num_plus_autolab_w4

data_num_a_s_w5 <- data_num_plus_autolab_w5
data_not_num_a_s_w5 <-data_not_num_plus_autolab_w5

data_num_a_s_w7 <- data_num_plus_autolab_w7
data_not_num_a_s_w7 <-data_not_num_plus_autolab_w7



# Done paste Spring 2021

names(data_num)

table(data_num$Exit.Survey..1127030.) # get rid of
table(data_num$Recitations.Final.Points) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of 
table(data_num$Recitations.Current.Score) # get rid of
# etc etc etc Recitations...
# same for Quizzes and Assignments! we won't have this info half way through the semester
# same for Final.Points, etc.

# DATA_NUM_WITH_AUTOLAB

names(data_num)

names(data_not_num)

## RECOVER NUM AND NOT NUM DATA FRAMES

names(data_not_num)
names(data_num)

drops_not_num <- c("NetID", "SUCCESS")

data_not_num <- data_not_num[ , !(names(data_not_num) %in% drops_not_num)]
#data_not_num$Duration..in.seconds. <- as.integer(data_not_num$Duration..in.seconds.)

data_not_num_plus_autolab_all <- data_not_num_plus_autolab_all[ , !(names(data_not_num_plus_autolab_all) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


data_not_num_plus_autolab_w4 <- data_not_num_plus_autolab_w4[ , !(names(data_not_num_plus_autolab_w4) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w5 <- data_not_num_plus_autolab_w5[ , !(names(data_not_num_plus_autolab_w5) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)

data_not_num_plus_autolab_w7 <- data_not_num_plus_autolab_w7[ , !(names(data_not_num_plus_autolab_w7) %in% drops_not_num)]
#data_not_num_plus_autolab$Duration..in.seconds. <- as.integer(data_not_num_plus_autolab$Duration..in.seconds.)


str(data_not_num)

library(lattice)
library(caret)
# one-hot encoding


# get rid of constant(empty) fields, otherwise can't do one-hot encoding because of errors..
library(janitor)
data_not_num_saved <- data_not_num
data_not_num <- remove_constant(data_not_num_saved, na.rm= TRUE)

data_not_num_plus_autolab_saved_all <- data_not_num_plus_autolab_all
data_not_num_plus_autolab_all <- remove_constant(data_not_num_plus_autolab_saved_all, na.rm= TRUE)


data_not_num_plus_autolab_saved_w4 <- data_not_num_plus_autolab_w4
data_not_num_plus_autolab_w4 <- remove_constant(data_not_num_plus_autolab_saved_w4, na.rm= TRUE)

data_not_num_plus_autolab_saved_w5 <- data_not_num_plus_autolab_w5
data_not_num_plus_autolab_w5 <- remove_constant(data_not_num_plus_autolab_saved_w5, na.rm= TRUE)

data_not_num_plus_autolab_saved_w7 <- data_not_num_plus_autolab_w7
data_not_num_plus_autolab_w7 <- remove_constant(data_not_num_plus_autolab_saved_w7, na.rm= TRUE)



library(caret)

dummy <- dummyVars(" ~ .", data=data_not_num)
final_df <- data.frame(predict(dummy, newdata=data_not_num))

dummy_a_all <- dummyVars(" ~ .", data=data_not_num_plus_autolab_all)
final_df_a_all <- data.frame(predict(dummy_a_all, newdata=data_not_num_plus_autolab_all))


dummy_a_w4 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w4)
final_df_a_w4 <- data.frame(predict(dummy_a_w4, newdata=data_not_num_plus_autolab_w4))

dummy_a_w5 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w5)
final_df_a_w5 <- data.frame(predict(dummy_a_w5, newdata=data_not_num_plus_autolab_w5))

dummy_a_w7 <- dummyVars(" ~ .", data=data_not_num_plus_autolab_w7)
final_df_a_w7 <- data.frame(predict(dummy_a_w7, newdata=data_not_num_plus_autolab_w7))


# Need to check for zero-variance features.. save to do later ...

# Mix numeric and categorical variables
data_s23_preprocessed <- cbind(data_num, final_df)
data_s23_preprocessed$SUCCESS <- success_s
data_s23_no_na <- na.omit(data_s23_preprocessed)
success_s <- data_s23_no_na$SUCCESS
data_s23_no_na <- data_s23_no_na[, !(names(data_s23_no_na) %in% c("SUCCESS"))]
#length(success_a_w4)
#table(data_num$RecWeek2)
#var(data_num$RecWeek3)
#names(data_s23_no_na)

#checking for constant columns...
data_s23_no_na_saved <- data_s23_no_na
data_s23_no_na <- remove_constant(data_s23_no_na_saved, na.rm= TRUE)

# plus autolab...

#all

data_s23_preprocessed_a_all <- cbind(data_num_plus_autolab_all, final_df_a_all)
data_s23_preprocessed_a_all$SUCCESS <- success_s_a_all
data_s23_no_na_plus_autolab_all <- na.omit(data_s23_preprocessed_a_all)
success_a_all <- data_s23_no_na_plus_autolab_all$SUCCESS
data_s23_no_na_plus_autolab_all <- data_s23_no_na_plus_autolab_all[, !(names(data_s23_no_na_plus_autolab_all) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_s23_no_na_plus_autolab_saved_all <- data_s23_no_na_plus_autolab_all
data_s23_no_na_plus_autolab_all <- remove_constant(data_s23_no_na_plus_autolab_saved_all, na.rm= TRUE)


#W4

data_s23_preprocessed_a_w4 <- cbind(data_num_plus_autolab_w4, final_df_a_w4)
data_s23_preprocessed_a_w4$SUCCESS <- success_s_a_w4
data_s23_no_na_plus_autolab_w4 <- na.omit(data_s23_preprocessed_a_w4)
success_a_w4 <- data_s23_no_na_plus_autolab_w4$SUCCESS
data_s23_no_na_plus_autolab_w4 <- data_s23_no_na_plus_autolab_w4[, !(names(data_s23_no_na_plus_autolab_w4) %in% c("SUCCESS"))]
#length(success_a)


#checking for constant columns...
data_s23_no_na_plus_autolab_saved_w4 <- data_s23_no_na_plus_autolab_w4
data_s23_no_na_plus_autolab_w4 <- remove_constant(data_s23_no_na_plus_autolab_saved_w4, na.rm= TRUE)

#W5

data_s23_preprocessed_a_w5 <- cbind(data_num_plus_autolab_w5, final_df_a_w5)
data_s23_preprocessed_a_w5$SUCCESS <- success_s_a_w5
data_s23_no_na_plus_autolab_w5 <- na.omit(data_s23_preprocessed_a_w5)
success_a_w5 <- data_s23_no_na_plus_autolab_w5$SUCCESS
data_s23_no_na_plus_autolab_w5 <- data_s23_no_na_plus_autolab_w5[, !(names(data_s23_no_na_plus_autolab_w5) %in% c("SUCCESS"))]

#checking for constant columns...
data_s23_no_na_plus_autolab_saved_w5 <- data_s23_no_na_plus_autolab_w5
data_s23_no_na_plus_autolab_w5 <- remove_constant(data_s23_no_na_plus_autolab_saved_w5, na.rm= TRUE)

#w7

data_s23_preprocessed_a_w7 <- cbind(data_num_plus_autolab_w7, final_df_a_w7)
data_s23_preprocessed_a_w7$SUCCESS <- success_s_a_w7
data_s23_no_na_plus_autolab_w7 <- na.omit(data_s23_preprocessed_a_w7)
success_a_w7 <- data_s23_no_na_plus_autolab_w7$SUCCESS
data_s23_no_na_plus_autolab_w7 <- data_s23_no_na_plus_autolab_w7[, !(names(data_s23_no_na_plus_autolab_w7) %in% c("SUCCESS"))]



#checking for constant columns...
data_s23_no_na_plus_autolab_saved_w7 <- data_s23_no_na_plus_autolab_w7
data_s23_no_na_plus_autolab_w7 <- remove_constant(data_s23_no_na_plus_autolab_saved_w7, na.rm= TRUE)


# Need to check for correlated features
cor_matrix <- cor(data_s23_no_na)
#write.csv(cor_matrix,file="cortmp.csv")

for (i in 1:nrow(cor_matrix)){
  correlations <-  which((abs(cor_matrix[i,]) > 0.90))
  if(length(correlations)> 0){
    print(colnames(data_s23_no_na)[i])
    print(correlations)
  }
}

# REMOVE CORRELATED VARS: COPY FROM SPRING 2021 data

indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

remove_corrs <- data_s23_no_na[-c(indexes_to_drop)]

data_s23_no_na_no_corr <- remove_corrs

names(remove_corrs)

cor_matrix <- cor(data_s23_no_na_no_corr)
indexes_to_drop <- findCorrelation(cor_matrix, cutoff = 0.90)

# indexes to drop is now empty, which means NO CORRELATIONS OVER 0.9!
names(data_s23_no_na_no_corr)

# DONE REMOVONG CORR VARS


# AUTOLAB DATA : remove correlated variables

# all

# Need to check for correlated features
cor_matrix_a <- cor(data_s23_no_na_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s23_no_na_plus_autolab_all[-c(indexes_to_drop)]
data_s23_no_na_no_corr_plus_autolab_all <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s23_no_na_no_corr_plus_autolab_all)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)# should be empty


# W4

# Need to check for correlated features
cor_matrix_a <- cor(data_s23_no_na_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s23_no_na_plus_autolab_w4[-c(indexes_to_drop)]
data_s23_no_na_no_corr_plus_autolab_w4 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s23_no_na_no_corr_plus_autolab_w4)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

# w5

# Need to check for correlated features
cor_matrix_a <- cor(data_s23_no_na_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s23_no_na_plus_autolab_w5[-c(indexes_to_drop)]
data_s23_no_na_no_corr_plus_autolab_w5 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s23_no_na_no_corr_plus_autolab_w5)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

# w7

# Need to check for correlated features
cor_matrix_a <- cor(data_s23_no_na_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)

remove_corrs <- data_s23_no_na_plus_autolab_w7[-c(indexes_to_drop)]
data_s23_no_na_no_corr_plus_autolab_w7 <- remove_corrs

# Double check ...

cor_matrix_a <- cor(data_s23_no_na_no_corr_plus_autolab_w7)
indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.90)


# empty, no more variables with correlations over 0.9!

# get rid of features with variance under 0.005
# copied from Spring 2021
# BETTER?? Apply variances on data without correlations

variances <- sapply(data_s23_no_na_no_corr, var)
variances_a_all <- sapply(data_s23_no_na_no_corr_plus_autolab_all, var)
variances_a_w4 <- sapply(data_s23_no_na_no_corr_plus_autolab_w4, var)
variances_a_w5 <- sapply(data_s23_no_na_no_corr_plus_autolab_w5, var)
variances_a_w7 <- sapply(data_s23_no_na_no_corr_plus_autolab_w7, var)


low_variance_features <- c()

colnames(data_s23_no_na_no_corr)[1]

for (i in 1:ncol(data_s23_no_na_no_corr)){
  
  if(variances[i] < 0.005)
  {
    low_variance_features <- c(low_variance_features, colnames(data_s23_no_na_no_corr)[i])
    print(i)
    print(colnames(data_s23_no_na_no_corr)[i])
    print(variances[i])
  }
}  

# Data Autolab 

# ALL

low_variance_features_a_all <- c()

for (i in 1:ncol(data_s23_no_na_no_corr_plus_autolab_all)){
  
  if(variances_a_all[i] < 0.005)
  {
    low_variance_features_a_all <- c(low_variance_features_a_all, colnames(data_s23_no_na_no_corr_plus_autolab_all)[i])
    print(i)
    print(colnames(data_s23_no_na_no_corr_plus_autolab_all)[i])
    print(variances_a_all[i])
  }
}  


#W4

low_variance_features_a_w4 <- c()

for (i in 1:ncol(data_s23_no_na_no_corr_plus_autolab_w4)){
  
  if(variances_a_w4[i] < 0.005)
  {
    low_variance_features_a_w4 <- c(low_variance_features_a_w4, colnames(data_s23_no_na_no_corr_plus_autolab_w4)[i])
    print(i)
    print(colnames(data_s23_no_na_no_corr_plus_autolab_w4)[i])
    print(variances_a_w4[i])
  }
}  

#w5

low_variance_features_a_w5 <- c()

for (i in 1:ncol(data_s23_no_na_no_corr_plus_autolab_w5)){
  
  if(variances_a_w5[i] < 0.005)
  {
    low_variance_features_a_w5 <- c(low_variance_features_a_w5, colnames(data_s23_no_na_no_corr_plus_autolab_w5)[i])
    print(i)
    print(colnames(data_s23_no_na_no_corr_plus_autolab_w5)[i])
    print(variances_a_w5[i])
  }
}  

#W7

low_variance_features_a_w7 <- c()

for (i in 1:ncol(data_s23_no_na_no_corr_plus_autolab_w7)){
  
  if(variances_a_w7[i] < 0.005)
  {
    low_variance_features_a_w7 <- c(low_variance_features_a_w7, colnames(data_s23_no_na_no_corr_plus_autolab_w7)[i])
    print(i)
    print(colnames(data_s23_no_na_no_corr_plus_autolab_w7)[i])
    print(variances_a_w7[i])
  }
}  



# done copied from Spring 2021

# Drop low variance features from Spring 2021 code

drops_n <- low_variance_features
drops_n_a_all <- low_variance_features_a_all
drops_n_a_w4 <- low_variance_features_a_w4
drops_n_a_w5 <- low_variance_features_a_w5
drops_n_a_w7 <- low_variance_features_a_w7


data_s23_final <- data_s23_no_na_no_corr[ , !(names(data_s23_no_na_no_corr) %in% drops_n)]
data_s23_no_na_no_corr_no_low_var <- data_s23_final

data_s23_final_a_all <- data_s23_no_na_no_corr_plus_autolab_all[ , !(names(data_s23_no_na_no_corr_plus_autolab_all) %in% drops_n_a_all)]
data_s23_no_na_no_corr_no_low_var_a_all <- data_s23_final_a_all


data_s23_final_a_w4 <- data_s23_no_na_no_corr_plus_autolab_w4[ , !(names(data_s23_no_na_no_corr_plus_autolab_w4) %in% drops_n_a_w4)]
data_s23_no_na_no_corr_no_low_var_a_w4 <- data_s23_final_a_w4

data_s23_final_a_w5 <- data_s23_no_na_no_corr_plus_autolab_w5[ , !(names(data_s23_no_na_no_corr_plus_autolab_w5) %in% drops_n_a_w5)]
data_s23_no_na_no_corr_no_low_var_a_w5 <- data_s23_final_a_w5

data_s23_final_a_w7 <- data_s23_no_na_no_corr_plus_autolab_w7[ , !(names(data_s23_no_na_no_corr_plus_autolab_w7) %in% drops_n_a_w7)]
data_s23_no_na_no_corr_no_low_var_a_w7 <- data_s23_final_a_w7


data_s23_final$SUCCESS <- success_s
data_s23_final_a_all$SUCCESS <- success_a_all
data_s23_final_a_w4$SUCCESS <- success_a_w4
data_s23_final_a_w5$SUCCESS <- success_a_w5
data_s23_final_a_w7$SUCCESS <- success_a_w7

data_s23_no_na_no_corr_no_low_var$SUCCESS <- success_s
data_s23_no_na_no_corr_no_low_var_a_all$SUCCESS <- success_a_all
data_s23_no_na_no_corr_no_low_var_a_w4$SUCCESS <- success_a_w4
data_s23_no_na_no_corr_no_low_var_a_w5$SUCCESS <- success_a_w5
data_s23_no_na_no_corr_no_low_var_a_w7$SUCCESS <- success_a_w7


names(data_s23_no_na_no_corr_no_low_var_a_w4)
# DONE with Drop low variance features from Spring 2021 code


table(data_f20_no_na_a$SUCCESS)
# check again for zero variance
#final_df_no_na <- remove_constant(data_no_na, na.rm= TRUE)


# Feature importance

control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)

# for data with autolab up to week 7 ...
control <- trainControl(method="repeatedcv", number=10, repeats=3)
# train the model
#data_no_na <- na.omit(data_f20_preprocessed)
model <- train(SUCCESS~., data=data_f20_final_a, method="lvq", preProcess="scale", trControl=control)

# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)


# RECURSIVE FEATURE ELIMINATION... NOT DONE!

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=10)
# run the RFE algorithm
results <- rfe(PimaIndiansDiabetes[,1:8], PimaIndiansDiabetes[,9], sizes=c(1:8), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))


# Write the final result in a file
getwd()
write.csv(data_s23_final, "Data_s23_After_Processing.csv", row.names = FALSE)
write.csv(data_s23_final_a_all, "Data_s23_After_Processing_w_Autolab_ALL.csv", row.names = FALSE)
write.csv(data_s23_final_a_w4, "Data_s23_After_Processing_w_Autolab_W4.csv", row.names = FALSE)
write.csv(data_s23_final_a_w5, "Data_s23_After_Processing_w_Autolab_W5.csv", row.names = FALSE)
write.csv(data_s23_final_a_w7, "Data_s23_After_Processing_w_Autolab_W7.csv", row.names = FALSE)

# DATA WITH ALL THE FEATURES: data_f20_no_na
# No correlated features and no features with 0 variance

names(data_s23_final)



# DATA WITH ALL THE FEATURES: data_s21
# No na, no correlated features and no features with very small variance


write.csv(data_f20_final, "Data_F20_Final.csv", row.names = FALSE)
write.csv(data_s21_final, "Data_S21_Final.csv", row.names = FALSE)

write.csv(data_f20_final_a, "Data_F20_Final_W_Autolab.csv", row.names = FALSE)
write.csv(data_s21_final_a, "Data_S21_Final_W_Autolab.csv", row.names = FALSE)


a <- read.csv("Data_F20_Final.csv")
b <- read.csv("Data_S21_Final.csv")
c <- read.csv("Data_F20_Final_W_Autolab.csv")
d <- read.csv("Data_S21_Final_W_Autolab.csv")

# Done preprocessing for SPRING 21!

names(data_f20_final)
names(data_s21_final)

data_common_columns_s21 <- data_s21_final[, intersect(colnames(data_f20_final), colnames(data_s21_final))]
data_common_columns_f20 <- data_f20_final[, intersect(colnames(data_f20_final), colnames(data_s21_final))]

data_common_columns_s21_a <- data_s21_final_a[, intersect(colnames(data_f20_final_a), colnames(data_s21_final_a))]
data_common_columns_f20_a <- data_f20_final_a[, intersect(colnames(data_f20_final_a), colnames(data_s21_final_a))]

# # Commenting for now becasue scaling will be done in a little bit
# # F20
# 
# # save the SUCCESS column
# f_20_success <- data_common_columns_f20$SUCCESS
# 
# # remove the SUCCESS variable because it is not numeric
# data_common_columns_f20_numeric <- data_common_columns_f20[, !(names(data_common_columns_f20)) %in% c("SUCCESS")]
# 
# # scale the data
# test_f_20 <- data.frame(apply(data_common_columns_f20_numeric, 2, function(x){x/max(x)}))
# test_f_20$SUCCESS <- f_20_success
# 
# # save it in new data frame
# data_common_columns_f20_normalized <- test_f_20
# 
# 
# # F20 with Autolab
# 
# # save the SUCCESS column
# f_20_a_success <- data_common_columns_f20_a$SUCCESS
# 
# # remove the SUCCESS variable because it is not numeric
# data_common_columns_f20_a_numeric <- data_common_columns_f20_a[, !(names(data_common_columns_f20_a)) %in% c("SUCCESS")]
# 
# # scale the data
# test_f_a_20 <- data.frame(apply(data_common_columns_f20_a_numeric, 2, function(x){x/max(x)}))
# test_f_a_20$SUCCESS <- f_20_a_success
# 
# # save it in new data frame
# data_common_columns_f20_a_normalized <- test_f_a_20
# 
# 
# # S21
# 
# # save the SUCCESS column
# s_21_success <- data_common_columns_s21$SUCCESS
# 
# # remove the SUCCESS variable because it is not numeric
# data_common_columns_s21_numeric <- data_common_columns_s21[, !(names(data_common_columns_s21)) %in% c("SUCCESS")]
# 
# # scale the data
# test_s_21 <- data.frame(apply(data_common_columns_s21_numeric, 2, function(x){x/max(x)}))
# test_s_21$SUCCESS <- s_21_success
# 
# # save it in new data frame
# data_common_columns_s21_normalized <- test_s_21
# 
# 
# # S21 with Autolab
# 
# # save the SUCCESS column
# s_21_a_success <- data_common_columns_s21_a$SUCCESS
# 
# # remove the SUCCESS variable because it is not numeric
# data_common_columns_s21_a_numeric <- data_common_columns_s21_a[, !(names(data_common_columns_s21_a)) %in% c("SUCCESS")]
# 
# # scale the data
# test_s_21_a <- data.frame(apply(data_common_columns_s21_a_numeric, 2, function(x){x/max(x)}))
# test_s_21_a$SUCCESS <- s_21_a_success
# 
# # save it in new data frame
# data_common_columns_s21_a_normalized <- test_s_21_a
# 
# # write normalized data frames in files..
# 
# write.csv(data_common_columns_s21_normalized, "Data_S21_Common_Columns_Normalized.csv", row.names = FALSE)
# a <- read.csv("Data_S21_Common_Columns_Normalized.csv")
# 
# write.csv(data_common_columns_f20_normalized, "Data_F20_Common_Columns_Normalized.csv", row.names = FALSE)
# b <- read.csv("Data_f20_Common_Columns_Normalized.csv")
# 
# write.csv(data_common_columns_s21_a_normalized, "Data_S21_A_Common_Columns_Normalized.csv", row.names = FALSE)
# c <- read.csv("Data_S21_A_Common_Columns_Normalized.csv")
# 
# write.csv(data_common_columns_f20_a_normalized, "Data_F20_A_Common_Columns_Normalized.csv", row.names = FALSE)
# d <- read.csv("Data_f20_A_Common_Columns_Normalized.csv")

#####################################################
#           AGGREGATE      DATASETS
####################################################

# STATIC ...

aggregate_f20 <- data_f20_final
aggregate_f22 <- data_f22_final

aggregate_f20$Major <- aggregate_f20$Q1Computer.Science..BS.
aggregate_f22$Major <- aggregate_f22$Q1Computer.Science..BS.

aggregate_f20_w4 <- data_f20_final
aggregate_f22_w4 <- data_f22_final

aggregate_f20_w4$Major <- aggregate_f20$Q1Computer.Science..BS.
aggregate_f22_w4$Major <- aggregate_f22$Q1Computer.Science..BS.

aggregate_f20_w5 <- data_f20_final
aggregate_f22_w5 <- data_f22_final

aggregate_f20_w5$Major <- aggregate_f20$Q1Computer.Science..BS.
aggregate_f22_w5$Major <- aggregate_f22$Q1Computer.Science..BS.

aggregate_f20_w7 <- data_f20_final
aggregate_f22_w7 <- data_f22_final

aggregate_f20_w7$Major <- aggregate_f20$Q1Computer.Science..BS.
aggregate_f22_w7$Major <- aggregate_f22$Q1Computer.Science..BS.

aggregate_f20$Assignments <- (aggregate_f20$X0 + aggregate_f20$X1 + aggregate_f20$X2 + aggregate_f20$X3 + aggregate_f20$X4 + aggregate_f20$X5 + aggregate_f20$X6 + aggregate_f20$X7 + aggregate_f20$X8 + aggregate_f20$X9 + aggregate_f20$X10 + aggregate_f20$X11 + aggregate_f20$X12 + aggregate_f20$X13 + aggregate_f20$X14 + aggregate_f20$X15)/16
aggregate_f20$Recitations <- (aggregate_f20$RecWeek3 + aggregate_f20$RecWeek4 + aggregate_f20$RecWeek5 + aggregate_f20$RecWeek6 + aggregate_f20$RecWeek7 + aggregate_f20$RecWeek8 + aggregate_f20$RecWeek10 + aggregate_f20$RecWeek11 + aggregate_f20$RecWeek12 + aggregate_f20$RecWeek13 + aggregate_f20$RecWeek14)/11
aggregate_f20$Exams <- (aggregate_f20$Exam1 + aggregate_f20$Exam2 + aggregate_f20$Exam4)/3

aggregate_f22$Assignments <- (aggregate_f22$X0 + aggregate_f22$X1 + aggregate_f22$X2 + aggregate_f22$X3 + aggregate_f22$X4 + aggregate_f22$X5 + aggregate_f22$X6 + aggregate_f22$X7 + aggregate_f22$X8 + aggregate_f22$X9 + aggregate_f22$X10 + aggregate_f22$X11 + aggregate_f22$X12 + aggregate_f22$X13 + aggregate_f22$X14 + aggregate_f22$X15)/16
aggregate_f22$Recitations <- (aggregate_f22$RecWeek3 + aggregate_f22$RecWeek4 + aggregate_f22$RecWeek5 + aggregate_f22$RecWeek6 + aggregate_f22$RecWeek7 + aggregate_f22$RecWeek8 + aggregate_f22$RecWeek10 + aggregate_f22$RecWeek11 + aggregate_f22$RecWeek12 + aggregate_f22$RecWeek13 + aggregate_f22$RecWeek14)/11
aggregate_f22$Exams <- (aggregate_f22$Exam1 + aggregate_f22$Exam2 + aggregate_f22$Exam4)/3


# assignments and recitations up to week 4
aggregate_f20_w4$Assignments <-   (aggregate_f20$X0 + aggregate_f20$X1 + aggregate_f20$X2 + aggregate_f20$X3)/4
aggregate_f20_w4$Recitations <-  (aggregate_f20$RecWeek3 + aggregate_f20$RecWeek4)/2
  
aggregate_f22_w4$Assignments <-   (aggregate_f22$X0 + aggregate_f22$X1 + aggregate_f22$X2 + aggregate_f22$X3)/4
aggregate_f22_w4$Recitations <-  (aggregate_f22$RecWeek3 + aggregate_f22$RecWeek4)/2


# assignments and recitations up to week 5
aggregate_f20_w5$Assignments <-  (aggregate_f20$X0 + aggregate_f20$X1 + aggregate_f20$X2 + aggregate_f20$X3)/4#(data_common_columns_f20_normalized$X.Pseudocode + data_common_columns_f20_normalized$X.HelloWorld + data_common_columns_f20_normalized$X.Wind.Chill + data_common_columns_f20_normalized$X.Order.Check + data_common_columns_f20_normalized$X.Largest.of.Five + data_common_columns_f20_normalized$X.Check.Digit)/6
aggregate_f20_w5$Recitations <-  (aggregate_f20$RecWeek3 + aggregate_f20$RecWeek4 + aggregate_f20$RecWeek5)/3

aggregate_f22_w5$Assignments <-  (aggregate_f22$X0 + aggregate_f22$X1 + aggregate_f22$X2 + aggregate_f22$X3)/4#(data_common_columns_f22_normalized$X.Pseudocode + data_common_columns_f22_normalized$X.HelloWorld + data_common_columns_f22_normalized$X.Wind.Chill + data_common_columns_f22_normalized$X.Order.Check + data_common_columns_f22_normalized$X.Largest.of.Five + data_common_columns_f22_normalized$X.Check.Digit)/6
aggregate_f22_w5$Recitations <-  (aggregate_f22$RecWeek3 + aggregate_f22$RecWeek4 + aggregate_f22$RecWeek5)/3

  
# assignments and recitations up to week 5
aggregate_f20_w7$Assignments <-  (aggregate_f20$X0 + aggregate_f20$X1 + aggregate_f20$X2 + aggregate_f20$X3 + aggregate_f20$X4 + aggregate_f20$X5 + aggregate_f20$X6 + aggregate_f20$X7 + aggregate_f20$X8)/9
aggregate_f20_w7$Recitations <- (aggregate_f20$RecWeek3 + aggregate_f20$RecWeek4 + aggregate_f20$RecWeek5 + aggregate_f20$RecWeek6 + aggregate_f20$RecWeek7)/5
aggregate_f20_w7$Exam <- aggregate_f20$Exam1
  
aggregate_f22_w7$Assignments <-  (aggregate_f22$X0 + aggregate_f22$X1 + aggregate_f22$X2 + aggregate_f22$X3 + aggregate_f22$X4 + aggregate_f22$X5 + aggregate_f22$X6 + aggregate_f22$X7 + aggregate_f22$X8)/9
aggregate_f22_w7$Recitations <- (aggregate_f22$RecWeek3 + aggregate_f22$RecWeek4 + aggregate_f22$RecWeek5 + aggregate_f22$RecWeek6 + aggregate_f22$RecWeek7)/5
aggregate_f22_w7$Exam <- aggregate_f22$Exam1


# get rid of unnecessary features
test <- aggregate_f20[, -grep("Q1|X|RecWeek", colnames(aggregate_f20))]
aggregate_f20 <- test

test <- aggregate_f22[, -grep("Q1|X|RecWeek", colnames(aggregate_f22))]
aggregate_f22 <- test

names(aggregate_f22)

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")
#test_f20 <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
#test_f22 <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

aggregate_f20 <- aggregate_f20[ , !(names(aggregate_f20) %in% drops_f20)]
aggregate_f22 <- aggregate_f22[ , !(names(aggregate_f22) %in% drops_f22)]




#names(aggregate_f20)
#drops = c("Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13", "RecWeek14", "Q1Biological.Sciences..BA.", "Q1Computer.Science..BA.", "Q1Computer.Science..BS.","Q1Economics", "Q1Genetics..BA.",  "Q1Information.Technology.and.Informatics..BA.", "Q1Mathematics..BA.or.BS.", "Q1Undecided")
#aggregate_f22 <- aggregate_f22[ , !(names(aggregate_f22) %in% drops)]
#aggregate_f20 <- aggregate_f20[ , !(names(aggregate_f20) %in% drops)]

static_aggregate_f20 <- aggregate_f20
static_aggregate_f22 <- aggregate_f22

#W4
# get rid of unnecessary features
test <- aggregate_f20_w4[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_w4))]
aggregate_f20_w4 <- test

test <- aggregate_f22_w4[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_w4))]
aggregate_f22_w4 <- test

names(aggregate_f22_w4)

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")

aggregate_f20_w4 <- aggregate_f20_w4[ , !(names(aggregate_f20_w4) %in% drops_f20)]
aggregate_f22_w4 <- aggregate_f22_w4[ , !(names(aggregate_f22_w4) %in% drops_f22)]

static_aggregate_f20_w4 <- aggregate_f20_w4
static_aggregate_f22_w4 <- aggregate_f22_w4


#w5
# get rid of unnecessary features
test <- aggregate_f20_w5[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_w5))]
aggregate_f20_w5 <- test

test <- aggregate_f22_w5[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_w5))]
aggregate_f22_w5 <- test

names(aggregate_f22_w5)

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")

aggregate_f20_w5 <- aggregate_f20_w5[ , !(names(aggregate_f20_w5) %in% drops_f20)]
aggregate_f22_w5 <- aggregate_f22_w5[ , !(names(aggregate_f22_w5) %in% drops_f22)]

static_aggregate_f20_w5 <- aggregate_f20_w5
static_aggregate_f22_w5 <- aggregate_f22_w5


#w7
# get rid of unnecessary features
test <- aggregate_f20_w7[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_w7))]
aggregate_f20_w7 <- test

test <- aggregate_f22_w7[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_w7))]
aggregate_f22_w7 <- test

names(aggregate_f22_w7)

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")

aggregate_f20_w7 <- aggregate_f20_w7[ , !(names(aggregate_f20_w7) %in% drops_f20)]
aggregate_f22_w7 <- aggregate_f22_w7[ , !(names(aggregate_f22_w7) %in% drops_f22)]

static_aggregate_f20_w7 <- aggregate_f20_w7
static_aggregate_f22_w7 <- aggregate_f22_w7


# DYNAMIC ...
names(aggregate_f22_a_all)

aggregate_f20_a_all <- data_f20_final_a_all
aggregate_f22_a_all <- data_f22_final_a_all

aggregate_f20_a_all$Major <- aggregate_f20_a_all$Q1Computer.Science..BS.
aggregate_f22_a_all$Major <- aggregate_f22_a_all$Q1Computer.Science..BS.

aggregate_f20_a_all$Assignments <- (aggregate_f20_a_all$X0 + aggregate_f20_a_all$X1 + aggregate_f20_a_all$X2 + aggregate_f20_a_all$X3 + aggregate_f20_a_all$X4 + aggregate_f20_a_all$X5 + aggregate_f20_a_all$X6 + aggregate_f20_a_all$X7 + aggregate_f20_a_all$X8 + aggregate_f20_a_all$X9 + aggregate_f20_a_all$X10 + aggregate_f20_a_all$X11 + aggregate_f20_a_all$X12 + aggregate_f20_a_all$X13 + aggregate_f20_a_all$X14 + aggregate_f20_a_all$X15)/16
aggregate_f20_a_all$Recitations <- (aggregate_f20_a_all$RecWeek3 + aggregate_f20_a_all$RecWeek4 + aggregate_f20_a_all$RecWeek5 + aggregate_f20_a_all$RecWeek6 + aggregate_f20_a_all$RecWeek7 + aggregate_f20_a_all$RecWeek8 + aggregate_f20_a_all$RecWeek10 + aggregate_f20_a_all$RecWeek11 + aggregate_f20_a_all$RecWeek12 + aggregate_f20_a_all$RecWeek13 + aggregate_f20_a_all$RecWeek14)/11
aggregate_f20_a_all$Exams <- (aggregate_f20_a_all$Exam1 + aggregate_f20_a_all$Exam2 + aggregate_f20_a_all$Exam4)/3

aggregate_f22_a_all$Assignments <- (aggregate_f22_a_all$X0 + aggregate_f22_a_all$X1 + aggregate_f22_a_all$X2 + aggregate_f22_a_all$X3 + aggregate_f22_a_all$X4 + aggregate_f22_a_all$X5 + aggregate_f22_a_all$X6 + aggregate_f22_a_all$X7 + aggregate_f22_a_all$X8 + aggregate_f22_a_all$X9 + aggregate_f22_a_all$X10 + aggregate_f22_a_all$X11 + aggregate_f22_a_all$X12 + aggregate_f22_a_all$X13 + aggregate_f22_a_all$X14 + aggregate_f22_a_all$X15)/16
aggregate_f22_a_all$Recitations <- (aggregate_f22_a_all$RecWeek3 + aggregate_f22_a_all$RecWeek4 + aggregate_f22_a_all$RecWeek5 + aggregate_f22_a_all$RecWeek6 + aggregate_f22_a_all$RecWeek7 + aggregate_f22_a_all$RecWeek8 + aggregate_f22_a_all$RecWeek10 + aggregate_f22_a_all$RecWeek11 + aggregate_f22_a_all$RecWeek12 + aggregate_f22_a_all$RecWeek13 + aggregate_f22_a_all$RecWeek14)/11
aggregate_f22_a_all$Exams <- (aggregate_f22_a_all$Exam1 + aggregate_f22_a_all$Exam2 + aggregate_f22_a_all$Exam4)/3



aggregate_f20_a_w4 <- data_f20_final_a_w4
aggregate_f22_a_w4 <- data_f22_final_a_w4

aggregate_f20_a_w4$Major <- aggregate_f20_a_w4$Q1Computer.Science..BS.
aggregate_f22_a_w4$Major <- aggregate_f22_a_w4$Q1Computer.Science..BS.

aggregate_f20_a_w4$Assignments <- (aggregate_f20_a_w4$X0 + aggregate_f20_a_w4$X1 + aggregate_f20_a_w4$X2 + aggregate_f20_a_w4$X3 + aggregate_f20_a_w4$X4 + aggregate_f20_a_w4$X5 + aggregate_f20_a_w4$X6 + aggregate_f20_a_w4$X7 + aggregate_f20_a_w4$X8 + aggregate_f20_a_w4$X9 + aggregate_f20_a_w4$X10 + aggregate_f20_a_w4$X11 + aggregate_f20_a_w4$X12 + aggregate_f20_a_w4$X13 + aggregate_f20_a_w4$X14 + aggregate_f20_a_w4$X15)/16
aggregate_f20_a_w4$Recitations <- (aggregate_f20_a_w4$RecWeek3 + aggregate_f20_a_w4$RecWeek4 + aggregate_f20_a_w4$RecWeek5 + aggregate_f20_a_w4$RecWeek6 + aggregate_f20_a_w4$RecWeek7 + aggregate_f20_a_w4$RecWeek8 + aggregate_f20_a_w4$RecWeek10 + aggregate_f20_a_w4$RecWeek11 + aggregate_f20_a_w4$RecWeek12 + aggregate_f20_a_w4$RecWeek13 + aggregate_f20_a_w4$RecWeek14)/11
aggregate_f20_a_w4$Exams <- (aggregate_f20_a_w4$Exam1 + aggregate_f20_a_w4$Exam2 + aggregate_f20_a_w4$Exam4)/3

aggregate_f22_a_w4$Assignments <- (aggregate_f22_a_w4$X0 + aggregate_f22_a_w4$X1 + aggregate_f22_a_w4$X2 + aggregate_f22_a_w4$X3 + aggregate_f22_a_w4$X4 + aggregate_f22_a_w4$X5 + aggregate_f22_a_w4$X6 + aggregate_f22_a_w4$X7 + aggregate_f22_a_w4$X8 + aggregate_f22_a_w4$X9 + aggregate_f22_a_w4$X10 + aggregate_f22_a_w4$X11 + aggregate_f22_a_w4$X12 + aggregate_f22_a_w4$X13 + aggregate_f22_a_w4$X14 + aggregate_f22_a_w4$X15)/16
aggregate_f22_a_w4$Recitations <- (aggregate_f22_a_w4$RecWeek3 + aggregate_f22_a_w4$RecWeek4 + aggregate_f22_a_w4$RecWeek5 + aggregate_f22_a_w4$RecWeek6 + aggregate_f22_a_w4$RecWeek7 + aggregate_f22_a_w4$RecWeek8 + aggregate_f22_a_w4$RecWeek10 + aggregate_f22_a_w4$RecWeek11 + aggregate_f22_a_w4$RecWeek12 + aggregate_f22_a_w4$RecWeek13 + aggregate_f22_a_w4$RecWeek14)/11
aggregate_f22_a_w4$Exams <- (aggregate_f22_a_w4$Exam1 + aggregate_f22_a_w4$Exam2 + aggregate_f22_a_w4$Exam4)/3


aggregate_f20_a_w5 <- data_f20_final_a_w5
aggregate_f22_a_w5 <- data_f22_final_a_w5

aggregate_f20_a_w5$Major <- aggregate_f20_a_w5$Q1Computer.Science..BS.
aggregate_f22_a_w5$Major <- aggregate_f22_a_w5$Q1Computer.Science..BS.

aggregate_f20_a_w5$Assignments <- (aggregate_f20_a_w5$X0 + aggregate_f20_a_w5$X1 + aggregate_f20_a_w5$X2 + aggregate_f20_a_w5$X3 + aggregate_f20_a_w5$X4 + aggregate_f20_a_w5$X5 + aggregate_f20_a_w5$X6 + aggregate_f20_a_w5$X7 + aggregate_f20_a_w5$X8 + aggregate_f20_a_w5$X9 + aggregate_f20_a_w5$X10 + aggregate_f20_a_w5$X11 + aggregate_f20_a_w5$X12 + aggregate_f20_a_w5$X13 + aggregate_f20_a_w5$X14 + aggregate_f20_a_w5$X15)/16
aggregate_f20_a_w5$Recitations <- (aggregate_f20_a_w5$RecWeek3 + aggregate_f20_a_w5$RecWeek4 + aggregate_f20_a_w5$RecWeek5 + aggregate_f20_a_w5$RecWeek6 + aggregate_f20_a_w5$RecWeek7 + aggregate_f20_a_w5$RecWeek8 + aggregate_f20_a_w5$RecWeek10 + aggregate_f20_a_w5$RecWeek11 + aggregate_f20_a_w5$RecWeek12 + aggregate_f20_a_w5$RecWeek13 + aggregate_f20_a_w5$RecWeek14)/11
aggregate_f20_a_w5$Exams <- (aggregate_f20_a_w5$Exam1 + aggregate_f20_a_w5$Exam2 + aggregate_f20_a_w5$Exam4)/3

aggregate_f22_a_w5$Assignments <- (aggregate_f22_a_w5$X0 + aggregate_f22_a_w5$X1 + aggregate_f22_a_w5$X2 + aggregate_f22_a_w5$X3 + aggregate_f22_a_w5$X4 + aggregate_f22_a_w5$X5 + aggregate_f22_a_w5$X6 + aggregate_f22_a_w5$X7 + aggregate_f22_a_w5$X8 + aggregate_f22_a_w5$X9 + aggregate_f22_a_w5$X10 + aggregate_f22_a_w5$X11 + aggregate_f22_a_w5$X12 + aggregate_f22_a_w5$X13 + aggregate_f22_a_w5$X14 + aggregate_f22_a_w5$X15)/16
aggregate_f22_a_w5$Recitations <- (aggregate_f22_a_w5$RecWeek3 + aggregate_f22_a_w5$RecWeek4 + aggregate_f22_a_w5$RecWeek5 + aggregate_f22_a_w5$RecWeek6 + aggregate_f22_a_w5$RecWeek7 + aggregate_f22_a_w5$RecWeek8 + aggregate_f22_a_w5$RecWeek10 + aggregate_f22_a_w5$RecWeek11 + aggregate_f22_a_w5$RecWeek12 + aggregate_f22_a_w5$RecWeek13 + aggregate_f22_a_w5$RecWeek14)/11
aggregate_f22_a_w5$Exams <- (aggregate_f22_a_w5$Exam1 + aggregate_f22_a_w5$Exam2 + aggregate_f22_a_w5$Exam4)/3


aggregate_f20_a_w7 <- data_f20_final_a_w7
aggregate_f22_a_w7 <- data_f22_final_a_w7

aggregate_f20_a_w7$Major <- aggregate_f20_a_w7$Q1Computer.Science..BS.
aggregate_f22_a_w7$Major <- aggregate_f22_a_w7$Q1Computer.Science..BS.

aggregate_f20_a_w7$Assignments <- (aggregate_f20_a_w7$X0 + aggregate_f20_a_w7$X1 + aggregate_f20_a_w7$X2 + aggregate_f20_a_w7$X3 + aggregate_f20_a_w7$X4 + aggregate_f20_a_w7$X5 + aggregate_f20_a_w7$X6 + aggregate_f20_a_w7$X7 + aggregate_f20_a_w7$X8 + aggregate_f20_a_w7$X9 + aggregate_f20_a_w7$X10 + aggregate_f20_a_w7$X11 + aggregate_f20_a_w7$X12 + aggregate_f20_a_w7$X13 + aggregate_f20_a_w7$X14 + aggregate_f20_a_w7$X15)/16
aggregate_f20_a_w7$Recitations <- (aggregate_f20_a_w7$RecWeek3 + aggregate_f20_a_w7$RecWeek4 + aggregate_f20_a_w7$RecWeek5 + aggregate_f20_a_w7$RecWeek6 + aggregate_f20_a_w7$RecWeek7 + aggregate_f20_a_w7$RecWeek8 + aggregate_f20_a_w7$RecWeek10 + aggregate_f20_a_w7$RecWeek11 + aggregate_f20_a_w7$RecWeek12 + aggregate_f20_a_w7$RecWeek13 + aggregate_f20_a_w7$RecWeek14)/11
aggregate_f20_a_w7$Exams <- (aggregate_f20_a_w7$Exam1 + aggregate_f20_a_w7$Exam2 + aggregate_f20_a_w7$Exam4)/3

aggregate_f22_a_w7$Assignments <- (aggregate_f22_a_w7$X0 + aggregate_f22_a_w7$X1 + aggregate_f22_a_w7$X2 + aggregate_f22_a_w7$X3 + aggregate_f22_a_w7$X4 + aggregate_f22_a_w7$X5 + aggregate_f22_a_w7$X6 + aggregate_f22_a_w7$X7 + aggregate_f22_a_w7$X8 + aggregate_f22_a_w7$X9 + aggregate_f22_a_w7$X10 + aggregate_f22_a_w7$X11 + aggregate_f22_a_w7$X12 + aggregate_f22_a_w7$X13 + aggregate_f22_a_w7$X14 + aggregate_f22_a_w7$X15)/16
aggregate_f22_a_w7$Recitations <- (aggregate_f22_a_w7$RecWeek3 + aggregate_f22_a_w7$RecWeek4 + aggregate_f22_a_w7$RecWeek5 + aggregate_f22_a_w7$RecWeek6 + aggregate_f22_a_w7$RecWeek7 + aggregate_f22_a_w7$RecWeek8 + aggregate_f22_a_w7$RecWeek10 + aggregate_f22_a_w7$RecWeek11 + aggregate_f22_a_w7$RecWeek12 + aggregate_f22_a_w7$RecWeek13 + aggregate_f22_a_w7$RecWeek14)/11
aggregate_f22_a_w7$Exams <- (aggregate_f22_a_w7$Exam1 + aggregate_f22_a_w7$Exam2 + aggregate_f22_a_w7$Exam4)/3


# get rid of unnecessary features
names(aggregate_f22_a_all)
drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15", "RecWeek2", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13", "RecWeek14", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.","Q1Criminal.Justice..BA." ,"Q1Economics", "Q1Genetics..BA.",  "Q1Information.Technology.and.Informatics..BA.", "Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Statistics..BA.","Q1Statistics.Mathematics..BA.", "Q1Undecided")
drops_f22 <- c("Exam1", "Exam2", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14", "X15",  "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12", "RecWeek13", "RecWeek14", "Q1Biological.Sciences..BA.","Q1Cognitive.Science..BA.", "Q1Computer.Science..BA.", "Q1Computer.Science..BS.","Q1Economics", "Q1English..BA.","Q1Genetics..BA.",  "Q1Information.Technology.and.Informatics..BA.", "Q1Mathematics..BA.or.BS.","Q1Molecular.Biology.and.Biochemistry..BA.","Q1Physics...General.Option..BA.","Q1Physics...Professional.Option..BS.","Q1Political.Science..BA.", "Q1Undecided")
#test_f20 <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
#test_f22 <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

aggregate_f20_a_all <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
aggregate_f22_a_all <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

dynamic_aggregate_all_f20 <- aggregate_f20_a_all
dynamic_aggregate_all_f22 <- aggregate_f22_a_all

!(names(aggregate_f20_a_all) %in% names(aggregate_f22_a_all))

# W4
# get rid of unnecessary features
names(aggregate_f22_a_w4)

test <- aggregate_f20_a_w4[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_a_w4))]
aggregate_f20_a_w4 <- test

test <- aggregate_f22_a_w4[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_a_w4))]
aggregate_f22_a_w4 <- test

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")
#test_f20 <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
#test_f22 <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

aggregate_f20_a_w4 <- aggregate_f20_a_w4[ , !(names(aggregate_f20_a_w4) %in% drops_f20)]
aggregate_f22_a_w4 <- aggregate_f22_a_w4[ , !(names(aggregate_f22_a_w4) %in% drops_f22)]

dynamic_aggregate_w4_f20 <- aggregate_f20_a_all
dynamic_aggregate_w4_f22 <- aggregate_f22_a_all

!(names(aggregate_f20_a_w4) %in% names(aggregate_f22_a_w4))

# w5
# get rid of unnecessary features
names(aggregate_f20_a_w5)

test <- aggregate_f20_a_w5[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_a_w5))]
aggregate_f20_a_w5 <- test

test <- aggregate_f22_a_w5[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_a_w5))]
aggregate_f22_a_w5 <- test

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")
#test_f20 <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
#test_f22 <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

aggregate_f20_a_w5 <- aggregate_f20_a_w5[ , !(names(aggregate_f20_a_w5) %in% drops_f20)]
aggregate_f22_a_w5 <- aggregate_f22_a_w5[ , !(names(aggregate_f22_a_w5) %in% drops_f22)]

dynamic_aggregate_w5_f20 <- aggregate_f20_a_all
dynamic_aggregate_w5_f22 <- aggregate_f22_a_all

!(names(aggregate_f20_a_w5) %in% names(aggregate_f22_a_w5))

# w7
# get rid of unnecessary features
names(aggregate_f22_a_w7)

test <- aggregate_f20_a_w7[, -grep("Q1|X|RecWeek", colnames(aggregate_f20_a_w7))]
aggregate_f20_a_w7 <- test

test <- aggregate_f22_a_w7[, -grep("Q1|X|RecWeek", colnames(aggregate_f22_a_w7))]
aggregate_f22_a_w7 <- test

drops_f20 <- c("Exam1", "Exam2", "Exam3", "Exam4")
drops_f22 <- c("Exam1", "Exam2", "Exam4")
#test_f20 <- aggregate_f20_a_all[ , !(names(aggregate_f20_a_all) %in% drops_f20)]
#test_f22 <- aggregate_f22_a_all[ , !(names(aggregate_f22_a_all) %in% drops_f22)]

aggregate_f20_a_w7 <- aggregate_f20_a_w7[ , !(names(aggregate_f20_a_w7) %in% drops_f20)]
aggregate_f22_a_w7 <- aggregate_f22_a_w7[ , !(names(aggregate_f22_a_w7) %in% drops_f22)]

dynamic_aggregate_w7_f20 <- aggregate_f20_a_all
dynamic_aggregate_w7_f22 <- aggregate_f22_a_all

!(names(aggregate_f20_a_w7) %in% names(aggregate_f22_a_w7))



#####################################################
#    DATA for F20 and F22: Train on F20, Test on F22
####################################################


# Identify Common columns


#data_common_columns_s21 <- data_s21_final[, intersect(colnames(data_f20_final), colnames(data_s21_final))]
#data_common_columns_f20 <- data_f20_final[, intersect(colnames(data_f20_final), colnames(data_s21_final))]

#data_common_columns_s21_a <- data_s21_final_a[, intersect(colnames(data_f20_final_a), colnames(data_s21_final_a))]
#data_common_columns_f20_a <- data_f20_final_a[, intersect(colnames(data_f20_final_a), colnames(data_s21_final_a))]


data_common_columns_f20 <- data_f20_final[, intersect(colnames(data_f20_final), colnames(data_f22_final))]
data_common_columns_f22 <- data_f22_final[, intersect(colnames(data_f22_final), colnames(data_f20_final))]

data_common_columns_f20_a_all <- data_f20_final_a_all[, intersect(colnames(data_f22_final_a_all), colnames(data_f20_final_a_all))]
data_common_columns_f22_a_all <- data_f22_final_a_all[, intersect(colnames(data_f22_final_a_all), colnames(data_f20_final_a_all))]

data_common_columns_f20_a_w4 <- data_f20_final_a_w4[, intersect(colnames(data_f22_final_a_w4), colnames(data_f20_final_a_w4))]
data_common_columns_f22_a_w4 <- data_f22_final_a_w4[, intersect(colnames(data_f22_final_a_w4), colnames(data_f20_final_a_w4))]

data_common_columns_f20_a_w5 <- data_f20_final_a_w5[, intersect(colnames(data_f22_final_a_w5), colnames(data_f20_final_a_w5))]
data_common_columns_f22_a_w5 <- data_f22_final_a_w5[, intersect(colnames(data_f22_final_a_w5), colnames(data_f20_final_a_w5))]

data_common_columns_f20_a_w7 <- data_f20_final_a_w7[, intersect(colnames(data_f22_final_a_w7), colnames(data_f20_final_a_w7))]
data_common_columns_f22_a_w7 <- data_f22_final_a_w7[, intersect(colnames(data_f22_final_a_w7), colnames(data_f20_final_a_w7))]

# AGGREGATE

# STATIC ...

data_common_columns_f20_static_ag <- static_aggregate_f20[, intersect(colnames(static_aggregate_f20), colnames(static_aggregate_f22))]
data_common_columns_f22_static_ag <- static_aggregate_f22[, intersect(colnames(static_aggregate_f22), colnames(static_aggregate_f20))]

data_common_columns_f20_static_ag_w4 <- static_aggregate_f20_w4[, intersect(colnames(static_aggregate_f20_w4), colnames(static_aggregate_f22_w4))]
data_common_columns_f22_static_ag_w4 <- static_aggregate_f22_w4[, intersect(colnames(static_aggregate_f22_w4), colnames(static_aggregate_f20_w4))]

data_common_columns_f20_static_ag_w5 <- static_aggregate_f20_w5[, intersect(colnames(static_aggregate_f20_w5), colnames(static_aggregate_f22_w5))]
data_common_columns_f22_static_ag_w5 <- static_aggregate_f22_w5[, intersect(colnames(static_aggregate_f22_w5), colnames(static_aggregate_f20_w5))]

data_common_columns_f20_static_ag_w7 <- static_aggregate_f20_w7[, intersect(colnames(static_aggregate_f20_w7), colnames(static_aggregate_f22_w7))]
data_common_columns_f22_static_ag_w7 <- static_aggregate_f22_w7[, intersect(colnames(static_aggregate_f22_w7), colnames(static_aggregate_f20_w7))]


# DYNAMIC ...
data_common_columns_f20_ag_a_all <- dynamic_aggregate_all_f20[, intersect(colnames(dynamic_aggregate_all_f20), colnames(dynamic_aggregate_all_f22))]
data_common_columns_f22_ag_a_all <- dynamic_aggregate_all_f22[, intersect(colnames(dynamic_aggregate_all_f22), colnames(dynamic_aggregate_all_f20))]

data_common_columns_f20_ag_a_w4 <- dynamic_aggregate_w4_f20[, intersect(colnames(dynamic_aggregate_w4_f20), colnames(dynamic_aggregate_w4_f22))]
data_common_columns_f22_ag_a_w4 <- dynamic_aggregate_w4_f22[, intersect(colnames(dynamic_aggregate_w4_f22), colnames(dynamic_aggregate_w4_f20))]

data_common_columns_f20_ag_a_w5 <- dynamic_aggregate_w5_f20[, intersect(colnames(dynamic_aggregate_w5_f20), colnames(dynamic_aggregate_w5_f22))]
data_common_columns_f22_ag_a_w5 <- dynamic_aggregate_w5_f22[, intersect(colnames(dynamic_aggregate_w5_f22), colnames(dynamic_aggregate_w5_f20))]

data_common_columns_f20_ag_a_w7 <- dynamic_aggregate_w7_f20[, intersect(colnames(dynamic_aggregate_w7_f20), colnames(dynamic_aggregate_w7_f22))]
data_common_columns_f22_ag_a_w7 <- dynamic_aggregate_w7_f22[, intersect(colnames(dynamic_aggregate_w7_f22), colnames(dynamic_aggregate_w7_f20))]

#################################
#
#   S C A L E.  T H E   D A T A
#
################################


# F20

# save the SUCCESS column
f_20_success <- data_common_columns_f20$SUCCESS
f_20_finalPoints <- data_common_columns_f20$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_numeric <- data_common_columns_f20[, !(names(data_common_columns_f20)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_normalized <- test_f_20

write.csv(data_common_columns_f20_normalized, "Data_F20_Common_Columns_Normalized.csv", row.names = FALSE)
#write.csv(data_common_columns_f20_normalized, "Data_F20_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# AGGREGATE

# STATIC

# ALL

# save the SUCCESS column
f_20_success <- data_common_columns_f20_static_ag$SUCCESS
f_20_finalPoints <- data_common_columns_f20_static_ag$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_static_ag_numeric <- data_common_columns_f20_static_ag[, !(names(data_common_columns_f20_static_ag)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_static_ag_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_static_ag_normalized <- test_f_20

write.csv(data_common_columns_f20_normalized, "Data_F20_AG_STATIC_Common_Columns_Normalized.csv", row.names = FALSE)

# W4

# save the SUCCESS column
f_20_success <- data_common_columns_f20_static_ag_w4$SUCCESS
f_20_finalPoints <- data_common_columns_f20_static_ag_w4$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_static_ag_w4_numeric <- data_common_columns_f20_static_ag_w4[, !(names(data_common_columns_f20_static_ag_w4)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_static_ag_w4_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_static_ag_w4_normalized <- test_f_20

write.csv(data_common_columns_f20_static_ag_w4_normalized, "Data_F20_AG_STATIC_W4_Common_Columns_Normalized.csv", row.names = FALSE)

# w5

# save the SUCCESS column
f_20_success <- data_common_columns_f20_static_ag_w5$SUCCESS
f_20_finalPoints <- data_common_columns_f20_static_ag_w5$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_static_ag_w5_numeric <- data_common_columns_f20_static_ag_w5[, !(names(data_common_columns_f20_static_ag_w5)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_static_ag_w5_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_static_ag_w5_normalized <- test_f_20

write.csv(data_common_columns_f20_static_ag_w5_normalized, "Data_F20_AG_STATIC_w5_Common_Columns_Normalized.csv", row.names = FALSE)

# w7

# save the SUCCESS column
f_20_success <- data_common_columns_f20_static_ag_w7$SUCCESS
f_20_finalPoints <- data_common_columns_f20_static_ag_w7$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_static_ag_w7_numeric <- data_common_columns_f20_static_ag_w7[, !(names(data_common_columns_f20_static_ag_w7)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_static_ag_w7_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_static_ag_w7_normalized <- test_f_20

write.csv(data_common_columns_f20_static_ag_w7_normalized, "Data_F20_AG_STATIC_w7_Common_Columns_Normalized.csv", row.names = FALSE)


# DYNAMIC
# ALL

# save the SUCCESS column
f_20_success <- data_common_columns_f20_ag_a_all$SUCCESS
f_20_finalPoints <- data_common_columns_f20_ag_a_all$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_ag_a_all_numeric <- data_common_columns_f20_ag_a_all[, !(names(data_common_columns_f20_ag_a_all)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_ag_a_all_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_ag_a_all_normalized <- test_f_20

write.csv(data_common_columns_f20_ag_a_all_normalized, "Data_F20_AG_DYNAMIC_Common_Columns_Normalized.csv", row.names = FALSE)

# W4

# save the SUCCESS column
f_20_success <- data_common_columns_f20_ag_a_w4$SUCCESS
f_20_finalPoints <- data_common_columns_f20_ag_a_w4$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_ag_a_w4_numeric <- data_common_columns_f20_ag_a_w4[, !(names(data_common_columns_f20_ag_a_w4)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_ag_a_w4_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_ag_a_w4_normalized <- test_f_20

write.csv(data_common_columns_f20_ag_a_w4_normalized, "Data_F20_AG_DYNAMIC_W4_Common_Columns_Normalized.csv", row.names = FALSE)

# w5

# save the SUCCESS column
f_20_success <- data_common_columns_f20_ag_a_w5$SUCCESS
f_20_finalPoints <- data_common_columns_f20_ag_a_w5$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_ag_a_w5_numeric <- data_common_columns_f20_ag_a_w5[, !(names(data_common_columns_f20_ag_a_w5)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_ag_a_w5_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_ag_a_w5_normalized <- test_f_20

write.csv(data_common_columns_f20_ag_a_w5_normalized, "Data_F20_AG_DYNAMIC_w5_Common_Columns_Normalized.csv", row.names = FALSE)

# w7

# save the SUCCESS column
f_20_success <- data_common_columns_f20_ag_a_w7$SUCCESS
f_20_finalPoints <- data_common_columns_f20_ag_a_w7$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_ag_a_w7_numeric <- data_common_columns_f20_ag_a_w7[, !(names(data_common_columns_f20_ag_a_w7)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f20_ag_a_w7_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f20_ag_a_w7_normalized <- test_f_20

write.csv(data_common_columns_f20_ag_a_w7_normalized, "Data_F20_AG_DYNAMIC_w7_Common_Columns_Normalized.csv", row.names = FALSE)



# F20 with Autolab: NON-AGGREGATE

# ALL

# save the SUCCESS column
f_20_a_success_all <- data_common_columns_f20_a_all$SUCCESS
f_20_a_finalPoints_all <- data_common_columns_f20_a_all$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_a_all_numeric <- data_common_columns_f20_a_all[, !(names(data_common_columns_f20_a_all)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_20_all <- data.frame(apply(data_common_columns_f20_a_all_numeric, 2, function(x){x/max(x)}))
test_f_a_20_all$SUCCESS <- f_20_a_success_all
test_f_a_20_all$Final.Points <- f_20_a_finalPoints_all

# save it in new data frame
data_common_columns_f20_a_all_normalized <- test_f_a_20_all

write.csv(data_common_columns_f20_a_all_normalized, "Data_F20_Autolab_all_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f20_a_all_normalized, "Data_F20_Autolab_all_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# W4

# save the SUCCESS column
f_20_a_success_w4 <- data_common_columns_f20_a_w4$SUCCESS
f_20_a_finalPoints_w4 <- data_common_columns_f20_a_w4$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_a_w4_numeric <- data_common_columns_f20_a_w4[, !(names(data_common_columns_f20_a_w4)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_20_w4 <- data.frame(apply(data_common_columns_f20_a_w4_numeric, 2, function(x){x/max(x)}))
test_f_a_20_w4$SUCCESS <- f_20_a_success_w4
test_f_a_20_w4$Final.Points <- f_20_a_finalPoints_w4

# save it in new data frame
data_common_columns_f20_a_w4_normalized <- test_f_a_20_w4
write.csv(data_common_columns_f20_a_w4_normalized, "Data_F20_Autolab_W4_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f20_a_w4_normalized, "Data_F20_Autolab_W4_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

#W5

# save the SUCCESS column
f_20_a_success_w5 <- data_common_columns_f20_a_w5$SUCCESS
f_20_a_finalPoints_w5 <- data_common_columns_f20_a_w5$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_a_w5_numeric <- data_common_columns_f20_a_w5[, !(names(data_common_columns_f20_a_w5)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_20_w5 <- data.frame(apply(data_common_columns_f20_a_w5_numeric, 2, function(x){x/max(x)}))
test_f_a_20_w5$SUCCESS <- f_20_a_success_w5
test_f_a_20_w5$Final.Points <- f_20_a_finalPoints_w5

# save it in new data frame
data_common_columns_f20_a_w5_normalized <- test_f_a_20_w5
write.csv(data_common_columns_f20_a_w5_normalized, "Data_F20_Autolab_W5_Common_Columns_Normalized.csv", row.names = FALSE)

write.csv(data_common_columns_f20_a_w5_normalized, "Data_F20_Autolab_W5_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# W7

# save the SUCCESS column
f_20_a_success_w7 <- data_common_columns_f20_a_w7$SUCCESS
f_20_a_finalPoints_w7 <- data_common_columns_f20_a_w7$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f20_a_w7_numeric <- data_common_columns_f20_a_w7[, !(names(data_common_columns_f20_a_w7)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_20_w7 <- data.frame(apply(data_common_columns_f20_a_w7_numeric, 2, function(x){x/max(x)}))
test_f_a_20_w7$SUCCESS <- f_20_a_success_w7
test_f_a_20_w7$Final.Points <- f_20_a_finalPoints_w7

# save it in new data frame
data_common_columns_f20_a_w7_normalized <- test_f_a_20_w7
write.csv(data_common_columns_f20_a_w7_normalized, "Data_F20_Autolab_W7_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f20_a_w7_normalized, "Data_F20_Autolab_W7_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# F22

# save the SUCCESS column
f_22_success <- data_common_columns_f22$SUCCESS
f_22_finalPoints <- data_common_columns_f22$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_numeric <- data_common_columns_f22[, !(names(data_common_columns_f22)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_22 <- data.frame(apply(data_common_columns_f22_numeric, 2, function(x){x/max(x)}))
test_f_22$SUCCESS <- f_22_success
test_f_22$Final.Points <- f_22_finalPoints

# save it in new data frame
data_common_columns_f22_normalized <- test_f_22

write.csv(data_common_columns_f22_normalized, "Data_F22_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f22_normalized, "Data_F22_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# F22 with Autolab

# ALL

# save the SUCCESS column
f_22_a_success_all <- data_common_columns_f22_a_all$SUCCESS
f_22_a_finalPoints_all <- data_common_columns_f22_a_all$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_a_all_numeric <- data_common_columns_f22_a_all[, !(names(data_common_columns_f22_a_all)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_22_all <- data.frame(apply(data_common_columns_f22_a_all_numeric, 2, function(x){x/max(x)}))
test_f_a_22_all$SUCCESS <- f_22_a_success_all
test_f_a_22_all$Final.Points <- f_22_a_finalPoints_all

# save it in new data frame
data_common_columns_f22_a_all_normalized <- test_f_a_22_all

write.csv(data_common_columns_f22_a_all_normalized, "Data_F22_Autolab_all_Common_Columns_Normalized.csv", row.names = FALSE)
#names(data_common_columns_f22_a_all_normalized)
#write.csv(data_common_columns_f22_a_all_normalized, "Data_F22_Autolab_all_Common_Columns_Normalized_600_700.csv", row.names = FALSE)


# W4

# save the SUCCESS column
f_22_a_success_w4 <- data_common_columns_f22_a_w4$SUCCESS
f_22_a_finalPoints_w4 <- data_common_columns_f22_a_w4$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_a_w4_numeric <- data_common_columns_f22_a_w4[, !(names(data_common_columns_f22_a_w4)) %in% c("SUCCESS", "FinalPoints")]

# scale the data
test_f_a_22_w4 <- data.frame(apply(data_common_columns_f22_a_w4_numeric, 2, function(x){x/max(x)}))
test_f_a_22_w4$SUCCESS <- f_22_a_success_w4
test_f_a_22_w4$Final.Points <- f_22_a_finalPoints_w4

# save it in new data frame
data_common_columns_f22_a_w4_normalized <- test_f_a_22_w4

write.csv(data_common_columns_f22_a_w4_normalized, "Data_F22_Autolab_W4_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f22_a_w4_normalized, "Data_F22_Autolab_W4_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# w5

# save the SUCCESS column
f_22_a_success_w5 <- data_common_columns_f22_a_w5$SUCCESS
f_22_a_finalPoints_w5 <- data_common_columns_f22_a_w5$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_a_w5_numeric <- data_common_columns_f22_a_w5[, !(names(data_common_columns_f22_a_w5)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_22_w5 <- data.frame(apply(data_common_columns_f22_a_w5_numeric, 2, function(x){x/max(x)}))
test_f_a_22_w5$SUCCESS <- f_22_a_success_w5
test_f_a_22_w5$Final.Points <- f_22_a_finalPoints_w5

# save it in new data frame
data_common_columns_f22_a_w5_normalized <- test_f_a_22_w5

write.csv(data_common_columns_f22_a_w5_normalized, "Data_F22_Autolab_W5_Common_Columns_Normalized.csv", row.names = FALSE)

#write.csv(data_common_columns_f22_a_w5_normalized, "Data_F22_Autolab_W5_Common_Columns_Normalized_600_700.csv", row.names = FALSE)


# w7

# save the SUCCESS column
f_22_a_success_w7 <- data_common_columns_f22_a_w7$SUCCESS
f_22_a_finalPoints_w7 <- data_common_columns_f22_a_w7$Final.Points

# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_a_w7_numeric <- data_common_columns_f22_a_w7[, !(names(data_common_columns_f22_a_w7)) %in% c("SUCCESS", "Final.Points")]

# scale the data
test_f_a_22_w7 <- data.frame(apply(data_common_columns_f22_a_w7_numeric, 2, function(x){x/max(x)}))
test_f_a_22_w7$SUCCESS <- f_22_a_success_w7
test_f_a_22_w7$Final.Points <- f_22_a_finalPoints_w7

# save it in new data frame
data_common_columns_f22_a_w7_normalized <- test_f_a_22_w7

ncol(data_common_columns_f22_a_w7_normalized)


write.csv(data_common_columns_f22_a_w7_normalized, "Data_F22_Autolab_W7_Common_Columns_Normalized.csv", row.names = FALSE)
#write.csv(data_common_columns_f22_a_w7_normalized, "Data_F22_Autolab_W7_Common_Columns_Normalized_600_700.csv", row.names = FALSE)

# AGGREGATE

# STATIC

# ALL

# save the SUCCESS column
f_20_success <- data_common_columns_f22_static_ag$SUCCESS
f_20_finalPoints <- data_common_columns_f22_static_ag$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_static_ag_numeric <- data_common_columns_f22_static_ag[, !(names(data_common_columns_f22_static_ag)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_static_ag_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_static_ag_normalized <- test_f_20

write.csv(data_common_columns_f22_normalized, "Data_f22_AG_STATIC_Common_Columns_Normalized.csv", row.names = FALSE)

# W4

# save the SUCCESS column
f_20_success <- data_common_columns_f22_static_ag_w4$SUCCESS
f_20_finalPoints <- data_common_columns_f22_static_ag_w4$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_static_ag_w4_numeric <- data_common_columns_f22_static_ag_w4[, !(names(data_common_columns_f22_static_ag_w4)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_static_ag_w4_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_static_ag_w4_normalized <- test_f_20

write.csv(data_common_columns_f22_static_ag_w4_normalized, "Data_f22_AG_STATIC_W4_Common_Columns_Normalized.csv", row.names = FALSE)

# w5

# save the SUCCESS column
f_20_success <- data_common_columns_f22_static_ag_w5$SUCCESS
f_20_finalPoints <- data_common_columns_f22_static_ag_w5$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_static_ag_w5_numeric <- data_common_columns_f22_static_ag_w5[, !(names(data_common_columns_f22_static_ag_w5)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_static_ag_w5_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_static_ag_w5_normalized <- test_f_20

write.csv(data_common_columns_f22_static_ag_w5_normalized, "Data_f22_AG_STATIC_w5_Common_Columns_Normalized.csv", row.names = FALSE)

# w7

# save the SUCCESS column
f_20_success <- data_common_columns_f22_static_ag_w7$SUCCESS
f_20_finalPoints <- data_common_columns_f22_static_ag_w7$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_static_ag_w7_numeric <- data_common_columns_f22_static_ag_w7[, !(names(data_common_columns_f22_static_ag_w7)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_static_ag_w7_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_static_ag_w7_normalized <- test_f_20

write.csv(data_common_columns_f22_static_ag_w7_normalized, "Data_f22_AG_STATIC_w7_Common_Columns_Normalized.csv", row.names = FALSE)


# DYNAMIC
# ALL

# save the SUCCESS column
f_20_success <- data_common_columns_f22_ag_a_all$SUCCESS
f_20_finalPoints <- data_common_columns_f22_ag_a_all$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_ag_a_all_numeric <- data_common_columns_f22_ag_a_all[, !(names(data_common_columns_f22_ag_a_all)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_ag_a_all_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_ag_a_all_normalized <- test_f_20

write.csv(data_common_columns_f22_ag_a_all_normalized, "Data_f22_AG_DYNAMIC_Common_Columns_Normalized.csv", row.names = FALSE)

# W4

# save the SUCCESS column
f_20_success <- data_common_columns_f22_ag_a_w4$SUCCESS
f_20_finalPoints <- data_common_columns_f22_ag_a_w4$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_ag_a_w4_numeric <- data_common_columns_f22_ag_a_w4[, !(names(data_common_columns_f22_ag_a_w4)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_ag_a_w4_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_ag_a_w4_normalized <- test_f_20

write.csv(data_common_columns_f22_ag_a_w4_normalized, "Data_f22_AG_DYNAMIC_W4_Common_Columns_Normalized.csv", row.names = FALSE)

# w5

# save the SUCCESS column
f_20_success <- data_common_columns_f22_ag_a_w5$SUCCESS
f_20_finalPoints <- data_common_columns_f22_ag_a_w5$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_ag_a_w5_numeric <- data_common_columns_f22_ag_a_w5[, !(names(data_common_columns_f22_ag_a_w5)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_ag_a_w5_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_ag_a_w5_normalized <- test_f_20

write.csv(data_common_columns_f22_ag_a_w5_normalized, "Data_f22_AG_DYNAMIC_w5_Common_Columns_Normalized.csv", row.names = FALSE)

# w7

# save the SUCCESS column
f_20_success <- data_common_columns_f22_ag_a_w7$SUCCESS
f_20_finalPoints <- data_common_columns_f22_ag_a_w7$Final.Points
# remove the SUCCESS variable because it is not numeric
data_common_columns_f22_ag_a_w7_numeric <- data_common_columns_f22_ag_a_w7[, !(names(data_common_columns_f22_ag_a_w7)) %in% c("Final.Points","SUCCESS")]

# scale the data
test_f_20 <- data.frame(apply(data_common_columns_f22_ag_a_w7_numeric, 2, function(x){x/max(x)}))
test_f_20$SUCCESS <- f_20_success
test_f_20$Final.Points <- f_20_finalPoints
# save it in new data frame
data_common_columns_f22_ag_a_w7_normalized <- test_f_20

write.csv(data_common_columns_f22_ag_a_w7_normalized, "Data_f22_AG_DYNAMIC_w7_Common_Columns_Normalized.csv", row.names = FALSE)




############################################################
#                                                         #
#      ML MODELS :::  START HERE BY READING THE DATA      #
#                                                         #
##########################################################

setwd("")

data_common_columns_f20_normalized <- read.csv("Data_F20_Common_Columns_Normalized.csv")
data_common_columns_f22_normalized <- read.csv("Data_f22_Common_Columns_Normalized.csv")
data_common_columns_f20_a_all_normalized <- read.csv("Data_F20_Autolab_all_Common_Columns_Normalized.csv")
data_common_columns_f22_a_all_normalized <- read.csv("Data_f22_Autolab_all_Common_Columns_Normalized.csv")
data_common_columns_f20_a_w4_normalized <- read.csv("Data_F20_Autolab_W4_Common_Columns_Normalized.csv")
data_common_columns_f22_a_w4_normalized <- read.csv("Data_f22_Autolab_W4_Common_Columns_Normalized.csv")
data_common_columns_f20_a_w5_normalized <- read.csv("Data_F20_Autolab_W5_Common_Columns_Normalized.csv")
data_common_columns_f22_a_w5_normalized <- read.csv("Data_f22_Autolab_W5_Common_Columns_Normalized.csv")
data_common_columns_f20_a_w7_normalized <- read.csv("Data_F20_Autolab_W7_Common_Columns_Normalized.csv")
data_common_columns_f22_a_w7_normalized <- read.csv("Data_f22_Autolab_W7_Common_Columns_Normalized.csv")

data_common_columns_f20_normalized$SUCCESS <- as.factor(data_common_columns_f20_normalized$SUCCESS)
data_common_columns_f22_normalized$SUCCESS <- as.factor(data_common_columns_f22_normalized$SUCCESS)
data_common_columns_f20_a_all_normalized$SUCCESS <- as.factor(data_common_columns_f20_a_all_normalized$SUCCESS)
data_common_columns_f22_a_all_normalized$SUCCESS <- as.factor(data_common_columns_f22_a_all_normalized$SUCCESS)
data_common_columns_f20_a_w4_normalized$SUCCESS <- as.factor(data_common_columns_f20_a_w4_normalized$SUCCESS)
data_common_columns_f22_a_w4_normalized$SUCCESS <- as.factor(data_common_columns_f22_a_w4_normalized$SUCCESS)
data_common_columns_f20_a_w5_normalized$SUCCESS <- as.factor(data_common_columns_f20_a_w5_normalized$SUCCESS)
data_common_columns_f22_a_w5_normalized$SUCCESS <- as.factor(data_common_columns_f22_a_w5_normalized$SUCCESS)
data_common_columns_f20_a_w7_normalized$SUCCESS <- as.factor(data_common_columns_f20_a_w7_normalized$SUCCESS)
data_common_columns_f22_a_w7_normalized$SUCCESS <- as.factor(data_common_columns_f22_a_w7_normalized$SUCCESS)

str(data_common_columns_f20_normalized$SUCCESS)

# CAN ALSO READ ALL THE AGGREGATE DATA!


# NOW, ALL THE DATA IS NORMALIZED AND SPRING AND FALL HAVE THE SAME COLUMNS...
# DATA TO USE:  data_common_columns_f20, data_common_columns_s21
# and data_common_columns_f20_a, data_common_columns_s21_a

# FOLLOW THIS TUTORIAL: https://machinelearningmastery.com/machine-learning-in-r-step-by-step/
library(caret)
#install.packages("caret", dependencies=c("Depends", "Suggests"))
library(aod)
#library(ggplot2)
library(tidyverse)
library(mlbench)

#library(ggplot2)
#library(lattice)
#library(caret)


# ------   SAVE  ALL  THE  DATA  !! ------------

# unnormalized data

data_f22_un_saved <- data_common_columns_f22
data_f20_un_saved <- data_common_columns_f20

data_f22_un_saved_a_all <- data_common_columns_f22_a_all
data_f20_un_saved_a_all <- data_common_columns_f20_a_all

data_f22_un_saved_a_w4 <- data_common_columns_f22_a_w4
data_f20_un_saved_a_w4 <- data_common_columns_f20_a_w4

data_f22_un_saved_a_w5 <- data_common_columns_f22_a_w5
data_f20_un_saved_a_w5 <- data_common_columns_f20_a_w5

data_f22_un_saved_a_w7 <- data_common_columns_f22_a_w7
data_f20_un_saved_a_w7 <- data_common_columns_f20_a_w7

data_not_balanced_not_aggregate_static_all_ft_f20_un <- data_common_columns_f20
data_not_balanced_not_aggregate_static_all_ft_f22_un <- data_common_columns_f22

# normalized data

data_f22_saved <- data_common_columns_f22_normalized
data_f20_saved <- data_common_columns_f20_normalized

data_f22_saved_a_all <- data_common_columns_f22_a_all_normalized
data_f20_saved_a_all <- data_common_columns_f20_a_all_normalized

data_f22_saved_a_w4 <- data_common_columns_f22_a_w4_normalized
data_f20_saved_a_w4 <- data_common_columns_f20_a_w4_normalized

data_f22_saved_a_w5 <- data_common_columns_f22_a_w5_normalized
data_f20_saved_a_w5 <- data_common_columns_f20_a_w5_normalized

data_f22_saved_a_w7 <- data_common_columns_f22_a_w7_normalized
data_f20_saved_a_w7 <- data_common_columns_f20_a_w7_normalized

data_not_balanced_not_aggregate_static_all_ft_f20 <- data_common_columns_f20_normalized
data_not_balanced_not_aggregate_static_all_ft_f22 <- data_common_columns_f22_normalized

data_f20 <- data_f20_saved
data_f22 <- data_f22_saved

#table(data_f20_no_na$SUCCESS)

data_f22_final <- data_f22_saved
data_f20_final <- data_f20_saved

data_f22_testing <- data_f22_saved
data_f20_training <- data_f20_saved

names(data_f22_final)
names(data_f20_final)


# data is already normalized.


# -------  STEP  1:  USE  ALL  THE  DATA  ! -----------

# SET UP DATA FOR TRAINING AND TESTING


# set up experiment

#######################################################
#
#.           BUILD VARIOUS DATA SETS!
#
#######################################################


names(data_common_columns_s21_normalized)


#data_autolab_f20 <- read.csv("Data_Autolab_Processed_F20.csv", header = TRUE)
#data_autolab_f20_w4 <- read.csv("Data_Autolab_Processed_F20_W4.csv", header = TRUE)
#data_autolab_f20_w5 <- read.csv("Data_Autolab_Processed_F20_W5.csv", header = TRUE)
#data_autolab_f20_w7 <- read.csv("Data_Autolab_Processed_F20_W7.csv", header = TRUE)

#data_autolab_f22 <- read.csv("Data_Autolab_Processed_f22.csv", header = TRUE)
#data_autolab_f22_w4 <- read.csv("Data_Autolab_Processed_f22_W4.csv", header = TRUE)
#data_autolab_f22_w5 <- read.csv("Data_Autolab_Processed_f22_W5.csv", header = TRUE)
#data_autolab_f22_w7 <- read.csv("Data_Autolab_Processed_f22_W7.csv", header = TRUE)


# AGGREGATE FEATURES : ***** SKIP THIS ***** BECAUSE THEY ARE ALREADY BUILT BEFORE

aggregate_features_data_common_columns_f20_normalized_all <- data_common_columns_f20_normalized
aggregate_features_data_common_columns_f22_normalized_all <- data_common_columns_f22_normalized
aggregate_features_data_common_columns_f20_a_all_normalized_all <- data_common_columns_f20_a_all_normalized
aggregate_features_data_common_columns_f22_a_all_normalized_all <- data_common_columns_f22_a_all_normalized
aggregate_features_data_common_columns_f20_a_w4_normalized_all <- data_common_columns_f20_a_w4_normalized
aggregate_features_data_common_columns_f22_a_w4_normalized_all <- data_common_columns_f22_a_w4_normalized
aggregate_features_data_common_columns_f20_a_w5_normalized_all <- data_common_columns_f20_a_w5_normalized
aggregate_features_data_common_columns_f22_a_w5_normalized_all <- data_common_columns_f22_a_w5_normalized
aggregate_features_data_common_columns_f20_a_w7_normalized_all <- data_common_columns_f20_a_w7_normalized
aggregate_features_data_common_columns_f22_a_w7_normalized_all <- data_common_columns_f22_a_w7_normalized

aggregate_features_data_common_columns_f20_all <- data_common_columns_f20
aggregate_features_data_common_columns_f22_all <- data_common_columns_f22
aggregate_features_data_common_columns_f20_a_all_all <- data_common_columns_f20_a_all
aggregate_features_data_common_columns_f22_a_all_all <- data_common_columns_f22_a_all
aggregate_features_data_common_columns_f20_a_w4_all <- data_common_columns_f20_a_w4
aggregate_features_data_common_columns_f22_a_w4_all <- data_common_columns_f22_a_w4
aggregate_features_data_common_columns_f20_a_w5_all <- data_common_columns_f20_a_w5
aggregate_features_data_common_columns_f22_a_w5_all <- data_common_columns_f22_a_w5
aggregate_features_data_common_columns_f20_a_w7_all <- data_common_columns_f20_a_w7
aggregate_features_data_common_columns_f22_a_w7_all <- data_common_columns_f22_a_w7


#names(aggregate_features_data_common_columns_f22_a_all_normalized_all)

# FALL 20 STATIC

# assignments up to w4, up to w5, up to w7, and up to w10
# the data is normalized, so average over the columns we aggregate
# IDEA: for models using data up to w4, use only column .. W4, etc. OTHERWISE, they are correlated which is BAD
aggregate_features_data_common_columns_f20_normalized_all$AssignmentsW4 <- (data_common_columns_f20_normalized$X0 + data_common_columns_f20_normalized$X1 + data_common_columns_f20_normalized$X2 + data_common_columns_f20_normalized$X3)/4
aggregate_features_data_common_columns_f20_normalized_all$AssignmentsW5 <- aggregate_features_data_common_columns_f20_normalized_all$AssignmentsW4#(data_common_columns_f20_normalized$X.Pseudocode + data_common_columns_f20_normalized$X.HelloWorld + data_common_columns_f20_normalized$X.Wind.Chill + data_common_columns_f20_normalized$X.Order.Check + data_common_columns_f20_normalized$X.Largest.of.Five + data_common_columns_f20_normalized$X.Check.Digit)/6
aggregate_features_data_common_columns_f20_normalized_all$AssignmentsW7 <- (data_common_columns_f20_normalized$X0 + data_common_columns_f20_normalized$X1 + data_common_columns_f20_normalized$X2 + data_common_columns_f20_normalized$X3 + data_common_columns_f20_normalized$X4 + data_common_columns_f20_normalized$X5 + data_common_columns_f20_normalized$X6 + data_common_columns_f20_normalized$X7 + data_common_columns_f20_normalized$X8)/9
aggregate_features_data_common_columns_f20_normalized_all$AssignmentsW10 <- (data_common_columns_f20_normalized$X0 + data_common_columns_f20_normalized$X1 + data_common_columns_f20_normalized$X2 + data_common_columns_f20_normalized$X3 + data_common_columns_f20_normalized$X4 + data_common_columns_f20_normalized$X5 + data_common_columns_f20_normalized$X6 + data_common_columns_f20_normalized$X7 + data_common_columns_f20_normalized$X8 + data_common_columns_f20_normalized$X9 + data_common_columns_f20_normalized$X10 + data_common_columns_f20_normalized$X11)/12

aggregate_features_data_common_columns_f20_all$AssignmentsW4 <- (data_common_columns_f20$X0 + data_common_columns_f20$X1 + data_common_columns_f20$X2 + data_common_columns_f20$X3)/4
aggregate_features_data_common_columns_f20_all$AssignmentsW5 <- aggregate_features_data_common_columns_f20_all$AssignmentsW4#(data_common_columns_f20_normalized$X.Pseudocode + data_common_columns_f20_normalized$X.HelloWorld + data_common_columns_f20_normalized$X.Wind.Chill + data_common_columns_f20_normalized$X.Order.Check + data_common_columns_f20_normalized$X.Largest.of.Five + data_common_columns_f20_normalized$X.Check.Digit)/6
aggregate_features_data_common_columns_f20_all$AssignmentsW7 <- (data_common_columns_f20$X0 + data_common_columns_f20$X1 + data_common_columns_f20$X2 + data_common_columns_f20$X3 + data_common_columns_f20$X4 + data_common_columns_f20$X5 + data_common_columns_f20$X6 + data_common_columns_f20$X7 + data_common_columns_f20$X8)/9
aggregate_features_data_common_columns_f20_all$AssignmentsW10 <- (data_common_columns_f20$X0 + data_common_columns_f20$X1 + data_common_columns_f20$X2 + data_common_columns_f20$X3 + data_common_columns_f20$X4 + data_common_columns_f20$X5 + data_common_columns_f20$X6 + data_common_columns_f20$X7 + data_common_columns_f20$X8 + data_common_columns_f20$X9 + data_common_columns_f20$X10 + data_common_columns_f20$X11)/12


# Recitations
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW3 <- data_common_columns_f20_normalized$RecWeek3
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW4 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW5 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4 + data_common_columns_f20_normalized$RecWeek5)/3
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW6 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4 + data_common_columns_f20_normalized$RecWeek5 + data_common_columns_f20_normalized$RecWeek6)/4
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW7 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4 + data_common_columns_f20_normalized$RecWeek5 + data_common_columns_f20_normalized$RecWeek6 + data_common_columns_f20_normalized$RecWeek7)/5
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW8 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4 + data_common_columns_f20_normalized$RecWeek5 + data_common_columns_f20_normalized$RecWeek6 + data_common_columns_f20_normalized$RecWeek7 + data_common_columns_f20_normalized$RecWeek8)/6
aggregate_features_data_common_columns_f20_normalized_all$RecitationsW10 <- (data_common_columns_f20_normalized$RecWeek3 + data_common_columns_f20_normalized$RecWeek4 + data_common_columns_f20_normalized$RecWeek5 + data_common_columns_f20_normalized$RecWeek6 + data_common_columns_f20_normalized$RecWeek7 + data_common_columns_f20_normalized$RecWeek8 + data_common_columns_f20_normalized$RecWeek10)/7

aggregate_features_data_common_columns_f20_all$RecitationsW3 <- data_common_columns_f20$RecWeek3
aggregate_features_data_common_columns_f20_all$RecitationsW4 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4)/2
aggregate_features_data_common_columns_f20_all$RecitationsW5 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4 + data_common_columns_f20$RecWeek5)/3
aggregate_features_data_common_columns_f20_all$RecitationsW6 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4 + data_common_columns_f20$RecWeek5 + data_common_columns_f20$RecWeek6)/4
aggregate_features_data_common_columns_f20_all$RecitationsW7 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4 + data_common_columns_f20$RecWeek5 + data_common_columns_f20$RecWeek6 + data_common_columns_f20$RecWeek7)/5
aggregate_features_data_common_columns_f20_all$RecitationsW8 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4 + data_common_columns_f20$RecWeek5 + data_common_columns_f20$RecWeek6 + data_common_columns_f20$RecWeek7 + data_common_columns_f20$RecWeek8)/6
aggregate_features_data_common_columns_f20_all$RecitationsW10 <- (data_common_columns_f20$RecWeek3 + data_common_columns_f20$RecWeek4 + data_common_columns_f20$RecWeek5 + data_common_columns_f20$RecWeek6 + data_common_columns_f20$RecWeek7 + data_common_columns_f20$RecWeek8 + data_common_columns_f20$RecWeek10)/7


#names(data_common_columns_f20_normalized)

# EXAMS!
aggregate_features_data_common_columns_f20_normalized_all$ExamW7 <- data_common_columns_f20_normalized$Exam1
aggregate_features_data_common_columns_f20_all$ExamW7 <- data_common_columns_f20$Exam1


# attitudes
aggregate_features_data_common_columns_f20_normalized_all$ATTITUDES <- (data_common_columns_f20_normalized$ATTITUDES + data_common_columns_f20_normalized$BELONGINGNESS + data_common_columns_f20_normalized$ENGAGEMENT + data_common_columns_f20_normalized$CONFIDENCE + data_common_columns_f20_normalized$INTEREST + data_common_columns_f20_normalized$USEFULNESS + data_common_columns_f20_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f20_all$ATTITUDES <- (data_common_columns_f20$ATTITUDES + data_common_columns_f20$BELONGINGNESS + data_common_columns_f20$ENGAGEMENT + data_common_columns_f20$CONFIDENCE + data_common_columns_f20$INTEREST + data_common_columns_f20$USEFULNESS + data_common_columns_f20$ENCOURAGEMENT)/7


# major BS CS or not
aggregate_features_data_common_columns_f20_normalized_all$Major <- data_common_columns_f20_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f20_all$Major <- data_common_columns_f20$Q1Computer.Science..BS.



drops <- c("Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11","RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
aggregate_features_data_common_columns_f20_normalized_all <- aggregate_features_data_common_columns_f20_normalized_all[ , !(names(aggregate_features_data_common_columns_f20_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f20_all <- aggregate_features_data_common_columns_f20_all[ , !(names(aggregate_features_data_common_columns_f20_all) %in% drops)]


#names(aggregate_features_data_common_columns_f20_normalized_all)

# Fall F22 STATIC

# assignments up to w4, up to w5, up to w7, and up to w10
# the data is normalized, so average over the columns we aggregate
# IDEA: for models using data up to w4, use only column .. W4, etc. OTHERWISE, they are correlated which is BAD
aggregate_features_data_common_columns_f22_normalized_all$AssignmentsW4 <- (data_common_columns_f22_normalized$X0 + data_common_columns_f22_normalized$X1 + data_common_columns_f22_normalized$X2 + data_common_columns_f22_normalized$X3)/4
aggregate_features_data_common_columns_f22_normalized_all$AssignmentsW5 <- aggregate_features_data_common_columns_f22_normalized_all$AssignmentsW4#(data_common_columns_f22_normalized$X.Pseudocode + data_common_columns_f22_normalized$X.HelloWorld + data_common_columns_f22_normalized$X.Wind.Chill + data_common_columns_f22_normalized$X.Order.Check + data_common_columns_f22_normalized$X.Largest.of.Five + data_common_columns_f22_normalized$X.Check.Digit)/6
aggregate_features_data_common_columns_f22_normalized_all$AssignmentsW7 <- (data_common_columns_f22_normalized$X0 + data_common_columns_f22_normalized$X1 + data_common_columns_f22_normalized$X2 + data_common_columns_f22_normalized$X3 + data_common_columns_f22_normalized$X4 + data_common_columns_f22_normalized$X5 + data_common_columns_f22_normalized$X6 + data_common_columns_f22_normalized$X7 + data_common_columns_f22_normalized$X8)/9
aggregate_features_data_common_columns_f22_normalized_all$AssignmentsW10 <- (data_common_columns_f22_normalized$X0 + data_common_columns_f22_normalized$X1 + data_common_columns_f22_normalized$X2 + data_common_columns_f22_normalized$X3 + data_common_columns_f22_normalized$X4 + data_common_columns_f22_normalized$X5 + data_common_columns_f22_normalized$X6 + data_common_columns_f22_normalized$X7 + data_common_columns_f22_normalized$X8 + data_common_columns_f22_normalized$X9 + data_common_columns_f22_normalized$X10 + data_common_columns_f22_normalized$X11)/12

aggregate_features_data_common_columns_f22_all$AssignmentsW4 <- (data_common_columns_f22$X0 + data_common_columns_f22$X1 + data_common_columns_f22$X2 + data_common_columns_f22$X3)/4
aggregate_features_data_common_columns_f22_all$AssignmentsW5 <- aggregate_features_data_common_columns_f22_all$AssignmentsW4#(data_common_columns_f22$X.Pseudocode + data_common_columns_f22$X.HelloWorld + data_common_columns_f22$X.Wind.Chill + data_common_columns_f22$X.Order.Check + data_common_columns_f22$X.Largest.of.Five + data_common_columns_f22$X.Check.Digit)/6
aggregate_features_data_common_columns_f22_all$AssignmentsW7 <- (data_common_columns_f22$X0 + data_common_columns_f22$X1 + data_common_columns_f22$X2 + data_common_columns_f22$X3 + data_common_columns_f22$X4 + data_common_columns_f22$X5 + data_common_columns_f22$X6 + data_common_columns_f22$X7 + data_common_columns_f22$X8)/9
aggregate_features_data_common_columns_f22_all$AssignmentsW10 <- (data_common_columns_f22$X0 + data_common_columns_f22$X1 + data_common_columns_f22$X2 + data_common_columns_f22$X3 + data_common_columns_f22$X4 + data_common_columns_f22$X5 + data_common_columns_f22$X6 + data_common_columns_f22$X7 + data_common_columns_f22$X8 + data_common_columns_f22$X9 + data_common_columns_f22$X10 + data_common_columns_f22$X11)/12


# Recitations
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW3 <- data_common_columns_f22_normalized$RecWeek3
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW4 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW5 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4 + data_common_columns_f22_normalized$RecWeek5)/3
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW6 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4 + data_common_columns_f22_normalized$RecWeek5 + data_common_columns_f22_normalized$RecWeek6)/4
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW7 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4 + data_common_columns_f22_normalized$RecWeek5 + data_common_columns_f22_normalized$RecWeek6 + data_common_columns_f22_normalized$RecWeek7)/5
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW8 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4 + data_common_columns_f22_normalized$RecWeek5 + data_common_columns_f22_normalized$RecWeek6 + data_common_columns_f22_normalized$RecWeek7 + data_common_columns_f22_normalized$RecWeek8)/6
aggregate_features_data_common_columns_f22_normalized_all$RecitationsW10 <- (data_common_columns_f22_normalized$RecWeek3 + data_common_columns_f22_normalized$RecWeek4 + data_common_columns_f22_normalized$RecWeek5 + data_common_columns_f22_normalized$RecWeek6 + data_common_columns_f22_normalized$RecWeek7 + data_common_columns_f22_normalized$RecWeek8 + data_common_columns_f22_normalized$RecWeek10)/7

aggregate_features_data_common_columns_f22_all$RecitationsW3 <- data_common_columns_f22$RecWeek3
aggregate_features_data_common_columns_f22_all$RecitationsW4 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4)/2
aggregate_features_data_common_columns_f22_all$RecitationsW5 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4 + data_common_columns_f22$RecWeek5)/3
aggregate_features_data_common_columns_f22_all$RecitationsW6 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4 + data_common_columns_f22$RecWeek5 + data_common_columns_f22$RecWeek6)/4
aggregate_features_data_common_columns_f22_all$RecitationsW7 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4 + data_common_columns_f22$RecWeek5 + data_common_columns_f22$RecWeek6 + data_common_columns_f22$RecWeek7)/5
aggregate_features_data_common_columns_f22_all$RecitationsW8 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4 + data_common_columns_f22$RecWeek5 + data_common_columns_f22$RecWeek6 + data_common_columns_f22$RecWeek7 + data_common_columns_f22$RecWeek8)/6
aggregate_features_data_common_columns_f22_all$RecitationsW10 <- (data_common_columns_f22$RecWeek3 + data_common_columns_f22$RecWeek4 + data_common_columns_f22$RecWeek5 + data_common_columns_f22$RecWeek6 + data_common_columns_f22$RecWeek7 + data_common_columns_f22$RecWeek8 + data_common_columns_f22$RecWeek10)/7


# EXAMS!
aggregate_features_data_common_columns_f22_normalized_all$ExamW7 <- data_common_columns_f22_normalized$Exam1
aggregate_features_data_common_columns_f22_all$ExamW7 <- data_common_columns_f22$Exam1


# attitudes
aggregate_features_data_common_columns_f22_normalized_all$ATTITUDES <- (data_common_columns_f22_normalized$ATTITUDES + data_common_columns_f22_normalized$BELONGINGNESS + data_common_columns_f22_normalized$ENGAGEMENT + data_common_columns_f22_normalized$CONFIDENCE + data_common_columns_f22_normalized$INTEREST + data_common_columns_f22_normalized$USEFULNESS + data_common_columns_f22_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f22_all$ATTITUDES <- (data_common_columns_f22$ATTITUDES + data_common_columns_f22$BELONGINGNESS + data_common_columns_f22$ENGAGEMENT + data_common_columns_f22$CONFIDENCE + data_common_columns_f22$INTEREST + data_common_columns_f22$USEFULNESS + data_common_columns_f22$ENCOURAGEMENT)/7


# major BS CS or not
aggregate_features_data_common_columns_f22_normalized_all$Major <- data_common_columns_f22_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f22_all$Major <- data_common_columns_f22$Q1Computer.Science..BS.


drops <- c("Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10","RecWeek11","RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
aggregate_features_data_common_columns_f22_normalized_all <- aggregate_features_data_common_columns_f22_normalized_all[ , !(names(aggregate_features_data_common_columns_f22_normalized_all) %in% drops)]
names(aggregate_features_data_common_columns_f22_normalized_all)
aggregate_features_data_common_columns_f22_all <- aggregate_features_data_common_columns_f22_all[ , !(names(aggregate_features_data_common_columns_f22_all) %in% drops)]

# FALL 20 DYNAMIC


# assignments up to w4, up to w5, up to w7, and up to w10
# the data is normalized, so average over the columns we aggregate
# IDEA: for models using data up to w4, use only column .. W4, etc. OTHERWISE, they are correlated which is BAD
aggregate_features_data_common_columns_f20_a_w4_normalized_all$AssignmentsW4 <- (data_common_columns_f20_a_w4_normalized$X0 + data_common_columns_f20_a_w4_normalized$X1 + data_common_columns_f20_a_w4_normalized$X2 + data_common_columns_f20_a_w4_normalized$X3)/4
aggregate_features_data_common_columns_f20_a_w5_normalized_all$AssignmentsW4 <- (data_common_columns_f20_a_w5_normalized$X0 + data_common_columns_f20_a_w5_normalized$X1 + data_common_columns_f20_a_w5_normalized$X2 + data_common_columns_f20_a_w5_normalized$X3)/4
aggregate_features_data_common_columns_f20_a_w7_normalized_all$AssignmentsW4 <- (data_common_columns_f20_a_w7_normalized$X0 + data_common_columns_f20_a_w7_normalized$X1 + data_common_columns_f20_a_w7_normalized$X2 + data_common_columns_f20_a_w7_normalized$X3)/4
aggregate_features_data_common_columns_f20_a_all_normalized_all$AssignmentsW4 <- (data_common_columns_f20_a_all_normalized$X0 + data_common_columns_f20_a_all_normalized$X1 + data_common_columns_f20_a_all_normalized$X2 + data_common_columns_f20_a_all_normalized$X3)/4

aggregate_features_data_common_columns_f20_a_w4_all$AssignmentsW4 <- (data_common_columns_f20_a_w4$X0 + data_common_columns_f20_a_w4$X1 + data_common_columns_f20_a_w4$X2 + data_common_columns_f20_a_w4$X3)/4
aggregate_features_data_common_columns_f20_a_w5_all$AssignmentsW4 <- (data_common_columns_f20_a_w5$X0 + data_common_columns_f20_a_w5$X1 + data_common_columns_f20_a_w5$X2 + data_common_columns_f20_a_w5$X3)/4
aggregate_features_data_common_columns_f20_a_w7_all$AssignmentsW4 <- (data_common_columns_f20_a_w7$X0 + data_common_columns_f20_a_w7$X1 + data_common_columns_f20_a_w7$X2 + data_common_columns_f20_a_w7$X3)/4


aggregate_features_data_common_columns_f20_a_w5_normalized_all$AssignmentsW5 <- (data_common_columns_f20_a_w5_normalized$X0 + data_common_columns_f20_a_w5_normalized$X1 + data_common_columns_f20_a_w5_normalized$X2 + data_common_columns_f20_a_w5_normalized$X3)/4
aggregate_features_data_common_columns_f20_a_w7_normalized_all$AssignmentsW7 <- (data_common_columns_f20_a_w7_normalized$X0 + data_common_columns_f20_a_w7_normalized$X1 + data_common_columns_f20_a_w7_normalized$X2 + data_common_columns_f20_a_w7_normalized$X3)/4
aggregate_features_data_common_columns_f20_a_all_normalized_all$AssignmentsW7 <- (data_common_columns_f20_a_all_normalized$X0 + data_common_columns_f20_a_all_normalized$X1 + data_common_columns_f20_a_all_normalized$X2 + data_common_columns_f20_a_all_normalized$X3)/4

aggregate_features_data_common_columns_f20_a_w5_all$AssignmentsW5 <- (data_common_columns_f20_a_w5$X0 + data_common_columns_f20_a_w5$X1 + data_common_columns_f20_a_w5$X2 + data_common_columns_f20_a_w5$X3)/4
aggregate_features_data_common_columns_f20_a_w7_all$AssignmentsW7 <- (data_common_columns_f20_a_w7$X0 + data_common_columns_f20_a_w7$X1 + data_common_columns_f20_a_w7$X2 + data_common_columns_f20_a_w7$X3)/4

aggregate_features_data_common_columns_f20_a_w7_normalized_all$AssignmentsW7 <- (data_common_columns_f20_a_w7_normalized$X0 + data_common_columns_f20_a_w7_normalized$X1 + data_common_columns_f20_a_w7_normalized$X2 + data_common_columns_f20_a_w7_normalized$X3 + data_common_columns_f20_a_w7_normalized$X4 + data_common_columns_f20_a_w7_normalized$X5 + data_common_columns_f20_a_w7_normalized$X6 + data_common_columns_f20_a_w7_normalized$X7 + data_common_columns_f20_a_w7_normalized$X8)/9
aggregate_features_data_common_columns_f20_a_all_normalized_all$AssignmentsW7 <- (data_common_columns_f20_a_all_normalized$X0 + data_common_columns_f20_a_all_normalized$X1 + data_common_columns_f20_a_all_normalized$X2 + data_common_columns_f20_a_all_normalized$X3 + data_common_columns_f20_a_all_normalized$X4 + data_common_columns_f20_a_all_normalized$X5 + data_common_columns_f20_a_all_normalized$X6 + data_common_columns_f20_a_all_normalized$X7 + data_common_columns_f20_a_all_normalized$X8)/9
#aggregate_features_data_common_columns_f20_a_normalized_all$AssignmentsW10 <- (data_common_columns_f20_a_normalized$X0 + data_common_columns_f20_a_normalized$X1 + data_common_columns_f20_a_normalized$X2 + data_common_columns_f20_a_normalized$X3 + data_common_columns_f20_a_normalized$X4 + data_common_columns_f20_a_normalized$X5 + data_common_columns_f20_a_normalized$X6 + data_common_columns_f20_a_normalized$X7 + data_common_columns_f20_a_normalized$X8 + data_common_columns_f20_a_normalized$X9 + data_common_columns_f20_a_normalized$X10 + data_common_columns_f20_a_normalized$X11)/12
#aggregate_features_data_common_columns_f20_a_w7_all$AssignmentsW7 <- (data_common_columns_f20_a_w7$X0 + data_common_columns_f20_a_w7$X1 + data_common_columns_f20_a_w7$X2 + data_common_columns_f20_a_w7$X3 + data_common_columns_f20_a_w7$X4 + data_common_columns_f20_a_w7$X5 + data_common_columns_f20_a_w7$X6 + data_common_columns_f20_a_w7$X7 + data_common_columns_f20_a_w7$X8)/9


aggregate_features_data_common_columns_f20_a_all_normalized_all$Assignments <- (data_common_columns_f20_a_all_normalized$X0 + data_common_columns_f20_a_all_normalized$X1 + data_common_columns_f20_a_all_normalized$X2 + data_common_columns_f20_a_all_normalized$X3 + data_common_columns_f20_a_all_normalized$X4 + data_common_columns_f20_a_all_normalized$X5 + data_common_columns_f20_a_all_normalized$X6 + data_common_columns_f20_a_all_normalized$X7 + data_common_columns_f20_a_all_normalized$X8 + data_common_columns_f20_a_all_normalized$X9 + data_common_columns_f20_a_all_normalized$X10 + data_common_columns_f20_a_all_normalized$X11 + data_common_columns_f20_a_all_normalized$X12 + data_common_columns_f20_a_all_normalized$X13 + data_common_columns_f20_a_all_normalized$X14 + data_common_columns_f20_a_all_normalized$X15)/15
aggregate_features_data_common_columns_f20_a_all_normalized_all$Recitations <- (data_common_columns_f20_a_all_normalized$RecWeek3 + data_common_columns_f20_a_all_normalized$RecWeek4 + data_common_columns_f20_a_all_normalized$RecWeek5 + data_common_columns_f20_a_all_normalized$RecWeek6 + data_common_columns_f20_a_all_normalized$RecWeek7 + data_common_columns_f20_a_all_normalized$RecWeek8 + data_common_columns_f20_a_all_normalized$RecWeek10 + data_common_columns_f20_a_all_normalized$RecWeek11 + data_common_columns_f20_a_all_normalized$RecWeek12 + data_common_columns_f20_a_all_normalized$RecWeek13 + data_common_columns_f20_a_all_normalized$RecWeek14)/11
aggregate_features_data_common_columns_f20_a_all_normalized_all$Exams <- (data_common_columns_f20_a_all_normalized$Exam1 + data_common_columns_f20_a_all_normalized$Exam2 + data_common_columns_f20_a_all_normalized$Exam4)/3
aggregate_features_data_common_columns_f20_a_all_normalized_all$ATTITUDES <- (data_common_columns_f20_a_all_normalized$ATTITUDES + data_common_columns_f20_a_all_normalized$BELONGINGNESS + data_common_columns_f20_a_all_normalized$ENGAGEMENT + data_common_columns_f20_a_all_normalized$CONFIDENCE + data_common_columns_f20_a_all_normalized$INTEREST + data_common_columns_f20_a_all_normalized$USEFULNESS + data_common_columns_f20_a_all_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f20_a_all_normalized_all$Major <- data_common_columns_f20_a_all_normalized$Q1Computer.Science..BS.

#aggregate_features_data_common_columns_f20_a_all_all$Assignments <- (data_common_columns_f20_a_all$X0 + data_common_columns_f20_a_all$X1 + data_common_columns_f20_a_all$X2 + data_common_columns_f20_a_all$X3 + data_common_columns_f20_a_all$X4 + data_common_columns_f20_a_all$X5 + data_common_columns_f20_a_all$X6 + data_common_columns_f20_a_all$X7 + data_common_columns_f20_a_all$X8 + data_common_columns_f20_a_all$X9 + data_common_columns_f20_a_all$X10 + data_common_columns_f20_a_all$X11 + data_common_columns_f20_a_all$X12 + data_common_columns_f20_a_all$X13 + data_common_columns_f20_a_all$X14 + data_common_columns_f20_a_all$X15)/15
#aggregate_features_data_common_columns_f20_a_all_all$Recitations <- (data_common_columns_f20_a_all$RecWeek3 + data_common_columns_f20_a_all$RecWeek4 + data_common_columns_f20_a_all$RecWeek5 + data_common_columns_f20_a_all$RecWeek6 + data_common_columns_f20_a_all$RecWeek7 + data_common_columns_f20_a_all$RecWeek8 + data_common_columns_f20_a_all$RecWeek10 + data_common_columns_f20_a_all$RecWeek11 + data_common_columns_f20_a_all$RecWeek12 + data_common_columns_f20_a_all$RecWeek13 + data_common_columns_f20_a_all$RecWeek14)/11
#aggregate_features_data_common_columns_f20_a_all_all$Exams <- (data_common_columns_f20_a_all$Exam1 + data_common_columns_f20_a_all$Exam2 + data_common_columns_f20_a_all$Exam4)/3
#aggregate_features_data_common_columns_f20_a_all_all$ATTITUDES <- (data_common_columns_f20_a_all$ATTITUDES + data_common_columns_f20_a_all$BELONGINGNESS + data_common_columns_f20_a_all$ENGAGEMENT + data_common_columns_f20_a_all$CONFIDENCE + data_common_columns_f20_a_all$INTEREST + data_common_columns_f20_a_all$USEFULNESS + data_common_columns_f20_a_all$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f20_a_all_all$Major <- data_common_columns_f20_a_all$Q1Computer.Science..BS.

# Recitations
aggregate_features_data_common_columns_f20_a_w4_normalized_all$RecitationsW3 <- data_common_columns_f20_a_w4_normalized$RecWeek3
aggregate_features_data_common_columns_f20_a_w5_normalized_all$RecitationsW3 <- data_common_columns_f20_a_w5_normalized$RecWeek3
aggregate_features_data_common_columns_f20_a_w7_normalized_all$RecitationsW3 <- data_common_columns_f20_a_w7_normalized$RecWeek3

aggregate_features_data_common_columns_f20_a_w4_normalized_all$RecitationsW4 <- (data_common_columns_f20_a_w4_normalized$RecWeek3 + data_common_columns_f20_a_w4_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f20_a_w5_normalized_all$RecitationsW4 <- (data_common_columns_f20_a_w5_normalized$RecWeek3 + data_common_columns_f20_a_w5_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f20_a_w7_normalized_all$RecitationsW4 <- (data_common_columns_f20_a_w7_normalized$RecWeek3 + data_common_columns_f20_a_w7_normalized$RecWeek4)/2

aggregate_features_data_common_columns_f20_a_w5_normalized_all$RecitationsW5 <- (data_common_columns_f20_a_w5_normalized$RecWeek3 + data_common_columns_f20_a_w5_normalized$RecWeek4 + data_common_columns_f20_a_w5_normalized$RecWeek5)/3
aggregate_features_data_common_columns_f20_a_w7_normalized_all$RecitationsW5 <- (data_common_columns_f20_a_w7_normalized$RecWeek3 + data_common_columns_f20_a_w7_normalized$RecWeek4 + data_common_columns_f20_a_w7_normalized$RecWeek5)/3

aggregate_features_data_common_columns_f20_a_w7_normalized_all$RecitationsW7 <- (data_common_columns_f20_a_w7_normalized$RecWeek3 + data_common_columns_f20_a_w7_normalized$RecWeek4 + data_common_columns_f20_a_w7_normalized$RecWeek5 + data_common_columns_f20_a_w7_normalized$RecWeek6 + data_common_columns_f20_a_w7_normalized$RecWeek7)/5


#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW6 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4 + data_common_columns_f20_a_w7$RecWeek5 + data_common_columns_f20_a_w7$RecWeek6)/4
#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW7 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4 + data_common_columns_f20_a_w7$RecWeek5 + data_common_columns_f20_a_w7$RecWeek6 + data_common_columns_f20_a_w7$RecWeek7)/5
#aggregate_features_data_common_columns_f20_a_all$RecitationsW8 <- (data_common_columns_f20_a$RecWeek3 + data_common_columns_f20_a$RecWeek4 + data_common_columns_f20_a$RecWeek5 + data_common_columns_f20_a$RecWeek6 + data_common_columns_f20_a$RecWeek7 + data_common_columns_f20_a$RecWeek8)/6
#aggregate_features_data_common_columns_f20_a_all$RecitationsW10 <- (data_common_columns_f20_a$RecWeek3 + data_common_columns_f20_a$RecWeek4 + data_common_columns_f20_a$RecWeek5 + data_common_columns_f20_a$RecWeek6 + data_common_columns_f20_a$RecWeek7 + data_common_columns_f20_a$RecWeek8 + data_common_columns_f20_a$RecWeek10)/7

#aggregate_features_data_common_columns_f20_a_w4_all$RecitationsW3 <- data_common_columns_f20_a_w4$RecWeek3
#aggregate_features_data_common_columns_f20_a_w5_all$RecitationsW3 <- data_common_columns_f20_a_w5$RecWeek3
#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW3 <- data_common_columns_f20_a_w7$RecWeek3

#aggregate_features_data_common_columns_f20_a_w4_all$RecitationsW4 <- (data_common_columns_f20_a_w4$RecWeek3 + data_common_columns_f20_a_w4$RecWeek4)/2
#aggregate_features_data_common_columns_f20_a_w5_all$RecitationsW4 <- (data_common_columns_f20_a_w5$RecWeek3 + data_common_columns_f20_a_w5$RecWeek4)/2
#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW4 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4)/2

#aggregate_features_data_common_columns_f20_a_w5_all$RecitationsW5 <- (data_common_columns_f20_a_w5$RecWeek3 + data_common_columns_f20_a_w5$RecWeek4 + data_common_columns_f20_a_w5$RecWeek5)/3
#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW5 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4 + data_common_columns_f20_a_w7$RecWeek5)/3


#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW6 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4 + data_common_columns_f20_a_w7$RecWeek5 + data_common_columns_f20_a_w7$RecWeek6)/4
#aggregate_features_data_common_columns_f20_a_w7_all$RecitationsW7 <- (data_common_columns_f20_a_w7$RecWeek3 + data_common_columns_f20_a_w7$RecWeek4 + data_common_columns_f20_a_w7$RecWeek5 + data_common_columns_f20_a_w7$RecWeek6 + data_common_columns_f20_a_w7$RecWeek7)/5
#aggregate_features_data_common_columns_f20_a_all$RecitationsW8 <- (data_common_columns_f20_a$RecWeek3 + data_common_columns_f20_a$RecWeek4 + data_common_columns_f20_a$RecWeek5 + data_common_columns_f20_a$RecWeek6 + data_common_columns_f20_a$RecWeek7 + data_common_columns_f20_a$RecWeek8)/6
#aggregate_features_data_common_columns_f20_a_all$RecitationsW10 <- (data_common_columns_f20_a$RecWeek3 + data_common_columns_f20_a$RecWeek4 + data_common_columns_f20_a$RecWeek5 + data_common_columns_f20_a$RecWeek6 + data_common_columns_f20_a$RecWeek7 + data_common_columns_f20_a$RecWeek8 + data_common_columns_f20_a$RecWeek10)/7



# EXAMS!
aggregate_features_data_common_columns_f20_a_w7_normalized_all$ExamW7 <- data_common_columns_f20_a_w7_normalized$Exam1
#aggregate_features_data_common_columns_f20_a_w7_all$ExamW7 <- data_common_columns_f20_a_w7$Exam1


# attitudes
aggregate_features_data_common_columns_f20_a_w4_normalized_all$ATTITUDES <- (data_common_columns_f20_a_w4_normalized$ATTITUDES + data_common_columns_f20_a_w4_normalized$BELONGINGNESS + data_common_columns_f20_a_w4_normalized$ENGAGEMENT + data_common_columns_f20_a_w4_normalized$CONFIDENCE + data_common_columns_f20_a_w4_normalized$INTEREST + data_common_columns_f20_a_w4_normalized$USEFULNESS + data_common_columns_f20_a_w4_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f20_a_w5_normalized_all$ATTITUDES <- (data_common_columns_f20_a_w5_normalized$ATTITUDES + data_common_columns_f20_a_w5_normalized$BELONGINGNESS + data_common_columns_f20_a_w5_normalized$ENGAGEMENT + data_common_columns_f20_a_w5_normalized$CONFIDENCE + data_common_columns_f20_a_w5_normalized$INTEREST + data_common_columns_f20_a_w5_normalized$USEFULNESS + data_common_columns_f20_a_w5_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f20_a_w7_normalized_all$ATTITUDES <- (data_common_columns_f20_a_w7_normalized$ATTITUDES + data_common_columns_f20_a_w7_normalized$BELONGINGNESS + data_common_columns_f20_a_w7_normalized$ENGAGEMENT + data_common_columns_f20_a_w7_normalized$CONFIDENCE + data_common_columns_f20_a_w7_normalized$INTEREST + data_common_columns_f20_a_w7_normalized$USEFULNESS + data_common_columns_f20_a_w7_normalized$ENCOURAGEMENT)/7

#aggregate_features_data_common_columns_f20_a_w4_all$ATTITUDES <- (data_common_columns_f20_a_w4$ATTITUDES + data_common_columns_f20_a_w4$BELONGINGNESS + data_common_columns_f20_a_w4$ENGAGEMENT + data_common_columns_f20_a_w4$CONFIDENCE + data_common_columns_f20_a_w4$INTEREST + data_common_columns_f20_a_w4$USEFULNESS + data_common_columns_f20_a_w4$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f20_a_w5_all$ATTITUDES <- (data_common_columns_f20_a_w5$ATTITUDES + data_common_columns_f20_a_w5$BELONGINGNESS + data_common_columns_f20_a_w5$ENGAGEMENT + data_common_columns_f20_a_w5$CONFIDENCE + data_common_columns_f20_a_w5$INTEREST + data_common_columns_f20_a_w5$USEFULNESS + data_common_columns_f20_a_w5$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f20_a_w7_all$ATTITUDES <- (data_common_columns_f20_a_w7$ATTITUDES + data_common_columns_f20_a_w7$BELONGINGNESS + data_common_columns_f20_a_w7$ENGAGEMENT + data_common_columns_f20_a_w7$CONFIDENCE + data_common_columns_f20_a_w7$INTEREST + data_common_columns_f20_a_w7$USEFULNESS + data_common_columns_f20_a_w7$ENCOURAGEMENT)/7

# major BS CS or not
aggregate_features_data_common_columns_f20_a_w4_normalized_all$Major <- data_common_columns_f20_a_w4_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f20_a_w5_normalized_all$Major <- data_common_columns_f20_a_w5_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f20_a_w7_normalized_all$Major <- data_common_columns_f20_a_w7_normalized$Q1Computer.Science..BS.

#aggregate_features_data_common_columns_f20_a_w4_all$Major <- data_common_columns_f20_a_w4$Q1Computer.Science..BS.
#aggregate_features_data_common_columns_f20_a_w5_all$Major <- data_common_columns_f20_a_w5$Q1Computer.Science..BS.
#aggregate_features_data_common_columns_f20_a_w7_all$Major <- data_common_columns_f20_a_w7$Q1Computer.Science..BS.



#names(data_common_columns_f20_a_normalized)
drops <- c("Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12","RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
aggregate_features_data_common_columns_f20_a_w4_normalized_all <- aggregate_features_data_common_columns_f20_a_w4_normalized_all[ , !(names(aggregate_features_data_common_columns_f20_a_w4_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f20_a_w5_normalized_all <- aggregate_features_data_common_columns_f20_a_w5_normalized_all[ , !(names(aggregate_features_data_common_columns_f20_a_w5_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f20_a_w7_normalized_all <- aggregate_features_data_common_columns_f20_a_w7_normalized_all[ , !(names(aggregate_features_data_common_columns_f20_a_w7_normalized_all) %in% drops)]

#aggregate_features_data_common_columns_f20_a_w4_all <- aggregate_features_data_common_columns_f20_a_w4_all[ , !(names(aggregate_features_data_common_columns_f20_a_w4_all) %in% drops)]
#aggregate_features_data_common_columns_f20_a_w5_all <- aggregate_features_data_common_columns_f20_a_w5_all[ , !(names(aggregate_features_data_common_columns_f20_a_w5_all) %in% drops)]
#aggregate_features_data_common_columns_f20_a_w7_all <- aggregate_features_data_common_columns_f20_a_w7_all[ , !(names(aggregate_features_data_common_columns_f20_a_w7_all) %in% drops)]


names(aggregate_features_data_common_columns_f20_a_all_normalized_all)
drops <- c("AssignmentsW7", "AssignmentsW4","Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12","RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
test <- aggregate_features_data_common_columns_f20_a_all_normalized_all[ , !(names(aggregate_features_data_common_columns_f20_a_all_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f20_a_all_normalized_all <- test

#test <- aggregate_features_data_common_columns_f20_a_all_all[ , !(names(aggregate_features_data_common_columns_f20_a_all_all) %in% drops)]
#aggregate_features_data_common_columns_f20_a_all_all <- test

#names(aggregate_features_data_common_columns_f20_a_all_normalized_all)
#names(test)
#dim(test)

# FALL 22 DYAMIC


# assignments up to w4, up to w5, up to w7, and up to w10
# the data is normalized, so average over the columns we aggregate
# IDEA: for models using data up to w4, use only column .. W4, etc. OTHERWISE, they are correlated which is BAD
aggregate_features_data_common_columns_f22_a_w4_normalized_all$AssignmentsW4 <- (data_common_columns_f22_a_w4_normalized$X0 + data_common_columns_f22_a_w4_normalized$X1 + data_common_columns_f22_a_w4_normalized$X2 + data_common_columns_f22_a_w4_normalized$X3)/4
aggregate_features_data_common_columns_f22_a_w5_normalized_all$AssignmentsW4 <- (data_common_columns_f22_a_w5_normalized$X0 + data_common_columns_f22_a_w5_normalized$X1 + data_common_columns_f22_a_w5_normalized$X2 + data_common_columns_f22_a_w5_normalized$X3)/4
aggregate_features_data_common_columns_f22_a_w7_normalized_all$AssignmentsW4 <- (data_common_columns_f22_a_w7_normalized$X0 + data_common_columns_f22_a_w7_normalized$X1 + data_common_columns_f22_a_w7_normalized$X2 + data_common_columns_f22_a_w7_normalized$X3)/4

#aggregate_features_data_common_columns_f22_a_w4_all$AssignmentsW4 <- (data_common_columns_f22_a_w4$X0 + data_common_columns_f22_a_w4$X1 + data_common_columns_f22_a_w4$X2 + data_common_columns_f22_a_w4$X3)/4
#aggregate_features_data_common_columns_f22_a_w5_all$AssignmentsW4 <- (data_common_columns_f22_a_w5$X0 + data_common_columns_f22_a_w5$X1 + data_common_columns_f22_a_w5$X2 + data_common_columns_f22_a_w5$X3)/4
#aggregate_features_data_common_columns_f22_a_w7_all$AssignmentsW4 <- (data_common_columns_f22_a_w7$X0 + data_common_columns_f22_a_w7$X1 + data_common_columns_f22_a_w7$X2 + data_common_columns_f22_a_w7$X3)/4


aggregate_features_data_common_columns_f22_a_w5_normalized_all$AssignmentsW5 <- (data_common_columns_f22_a_w5_normalized$X0 + data_common_columns_f22_a_w5_normalized$X1 + data_common_columns_f22_a_w5_normalized$X2 + data_common_columns_f22_a_w5_normalized$X3)/4
aggregate_features_data_common_columns_f22_a_w7_normalized_all$AssignmentsW5 <- (data_common_columns_f22_a_w7_normalized$X0 + data_common_columns_f22_a_w7_normalized$X1 + data_common_columns_f22_a_w7_normalized$X2 + data_common_columns_f22_a_w7_normalized$X3)/4

#aggregate_features_data_common_columns_f22_a_w5_all$AssignmentsW5 <- (data_common_columns_f22_a_w5$X0 + data_common_columns_f22_a_w5$X1 + data_common_columns_f22_a_w5$X2 + data_common_columns_f22_a_w5$X3)/4
#aggregate_features_data_common_columns_f22_a_w7_all$AssignmentsW5 <- (data_common_columns_f22_a_w7$X0 + data_common_columns_f22_a_w7$X1 + data_common_columns_f22_a_w7$X2 + data_common_columns_f22_a_w7$X3)/4


aggregate_features_data_common_columns_f22_a_w7_normalized_all$AssignmentsW7 <- (data_common_columns_f22_a_w7_normalized$X0 + data_common_columns_f22_a_w7_normalized$X1 + data_common_columns_f22_a_w7_normalized$X2 + data_common_columns_f22_a_w7_normalized$X3 + data_common_columns_f22_a_w7_normalized$X4 + data_common_columns_f22_a_w7_normalized$X5 + data_common_columns_f22_a_w7_normalized$X6 + data_common_columns_f22_a_w7_normalized$X7 + data_common_columns_f22_a_w7_normalized$X8)/9
#aggregate_features_data_common_columns_f22_a_normalized_all$AssignmentsW10 <- (data_common_columns_f22_a_normalized$X0 + data_common_columns_f22_a_normalized$X1 + data_common_columns_f22_a_normalized$X2 + data_common_columns_f22_a_normalized$X3 + data_common_columns_f22_a_normalized$X4 + data_common_columns_f22_a_normalized$X5 + data_common_columns_f22_a_normalized$X6 + data_common_columns_f22_a_normalized$X7 + data_common_columns_f22_a_normalized$X8 + data_common_columns_f22_a_normalized$X9 + data_common_columns_f22_a_normalized$X10 + data_common_columns_f22_a_normalized$X11)/12
#aggregate_features_data_common_columns_f22_a_w7_all$AssignmentsW7 <- (data_common_columns_f22_a_w7$X0 + data_common_columns_f22_a_w7$X1 + data_common_columns_f22_a_w7$X2 + data_common_columns_f22_a_w7$X3 + data_common_columns_f22_a_w7$X4 + data_common_columns_f22_a_w7$X5 + data_common_columns_f22_a_w7$X6 + data_common_columns_f22_a_w7$X7 + data_common_columns_f22_a_w7$X8)/9

# Dynamic features: all features

aggregate_features_data_common_columns_f22_a_all_normalized_all$Assignments <- (data_common_columns_f22_a_all_normalized$X0 + data_common_columns_f22_a_all_normalized$X1 + data_common_columns_f22_a_all_normalized$X2 + data_common_columns_f22_a_all_normalized$X3 + data_common_columns_f22_a_all_normalized$X4 + data_common_columns_f22_a_all_normalized$X5 + data_common_columns_f22_a_all_normalized$X6 + data_common_columns_f22_a_all_normalized$X7 + data_common_columns_f22_a_all_normalized$X8 + data_common_columns_f22_a_all_normalized$X9 + data_common_columns_f22_a_all_normalized$X10 + data_common_columns_f22_a_all_normalized$X11 + data_common_columns_f22_a_all_normalized$X12 + data_common_columns_f22_a_all_normalized$X13 + data_common_columns_f22_a_all_normalized$X14 + data_common_columns_f22_a_all_normalized$X15)/15
aggregate_features_data_common_columns_f22_a_all_normalized_all$Recitations <- (data_common_columns_f22_a_all_normalized$RecWeek3 + data_common_columns_f22_a_all_normalized$RecWeek4 + data_common_columns_f22_a_all_normalized$RecWeek5 + data_common_columns_f22_a_all_normalized$RecWeek6 + data_common_columns_f22_a_all_normalized$RecWeek7 + data_common_columns_f22_a_all_normalized$RecWeek8 + data_common_columns_f22_a_all_normalized$RecWeek10 + data_common_columns_f22_a_all_normalized$RecWeek11 + data_common_columns_f22_a_all_normalized$RecWeek12 + data_common_columns_f22_a_all_normalized$RecWeek13 + data_common_columns_f22_a_all_normalized$RecWeek14)/11
aggregate_features_data_common_columns_f22_a_all_normalized_all$Exams <- (data_common_columns_f22_a_all_normalized$Exam1 + data_common_columns_f22_a_all_normalized$Exam2 + data_common_columns_f22_a_all_normalized$Exam4)/3
aggregate_features_data_common_columns_f22_a_all_normalized_all$ATTITUDES <- (data_common_columns_f22_a_all_normalized$ATTITUDES + data_common_columns_f22_a_all_normalized$BELONGINGNESS + data_common_columns_f22_a_all_normalized$ENGAGEMENT + data_common_columns_f22_a_all_normalized$CONFIDENCE + data_common_columns_f22_a_all_normalized$INTEREST + data_common_columns_f22_a_all_normalized$USEFULNESS + data_common_columns_f22_a_all_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f22_a_all_normalized_all$Major <- data_common_columns_f22_a_all_normalized$Q1Computer.Science..BS.

#aggregate_features_data_common_columns_f22_a_all_all$Assignments <- (data_common_columns_f22_a_all$X0 + data_common_columns_f22_a_all$X1 + data_common_columns_f22_a_all$X2 + data_common_columns_f22_a_all$X3 + data_common_columns_f22_a_all$X4 + data_common_columns_f22_a_all$X5 + data_common_columns_f22_a_all$X6 + data_common_columns_f22_a_all$X7 + data_common_columns_f22_a_all$X8 + data_common_columns_f22_a_all$X9 + data_common_columns_f22_a_all$X10 + data_common_columns_f22_a_all$X11 + data_common_columns_f22_a_all$X12 + data_common_columns_f22_a_all$X13 + data_common_columns_f22_a_all$X14 + data_common_columns_f22_a_all$X15)/15
#aggregate_features_data_common_columns_f22_a_all_all$Recitations <- (data_common_columns_f22_a_all$RecWeek3 + data_common_columns_f22_a_all$RecWeek4 + data_common_columns_f22_a_all$RecWeek5 + data_common_columns_f22_a_all$RecWeek6 + data_common_columns_f22_a_all$RecWeek7 + data_common_columns_f22_a_all$RecWeek8 + data_common_columns_f22_a_all$RecWeek10 + data_common_columns_f22_a_all$RecWeek11 + data_common_columns_f22_a_all$RecWeek12 + data_common_columns_f22_a_all$RecWeek13 + data_common_columns_f22_a_all$RecWeek14)/11
#aggregate_features_data_common_columns_f22_a_all_all$Exams <- (data_common_columns_f22_a_all$Exam1 + data_common_columns_f22_a_all$Exam2 + data_common_columns_f22_a_all$Exam4)/3
#aggregate_features_data_common_columns_f22_a_all_all$ATTITUDES <- (data_common_columns_f22_a_all$ATTITUDES + data_common_columns_f22_a_all$BELONGINGNESS + data_common_columns_f22_a_all$ENGAGEMENT + data_common_columns_f22_a_all$CONFIDENCE + data_common_columns_f22_a_all$INTEREST + data_common_columns_f22_a_all$USEFULNESS + data_common_columns_f22_a_all$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f22_a_all_all$Major <- data_common_columns_f22_a_all$Q1Computer.Science..BS.


# Recitations
aggregate_features_data_common_columns_f22_a_w4_normalized_all$RecitationsW3 <- data_common_columns_f22_a_w4_normalized$RecWeek3
aggregate_features_data_common_columns_f22_a_w5_normalized_all$RecitationsW3 <- data_common_columns_f22_a_w5_normalized$RecWeek3
aggregate_features_data_common_columns_f22_a_w7_normalized_all$RecitationsW3 <- data_common_columns_f22_a_w7_normalized$RecWeek3

aggregate_features_data_common_columns_f22_a_w4_normalized_all$RecitationsW4 <- (data_common_columns_f22_a_w4_normalized$RecWeek3 + data_common_columns_f22_a_w4_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f22_a_w5_normalized_all$RecitationsW4 <- (data_common_columns_f22_a_w5_normalized$RecWeek3 + data_common_columns_f22_a_w5_normalized$RecWeek4)/2
aggregate_features_data_common_columns_f22_a_w7_normalized_all$RecitationsW4 <- (data_common_columns_f22_a_w7_normalized$RecWeek3 + data_common_columns_f22_a_w7_normalized$RecWeek4)/2

aggregate_features_data_common_columns_f22_a_w5_normalized_all$RecitationsW5 <- (data_common_columns_f22_a_w5_normalized$RecWeek3 + data_common_columns_f22_a_w5_normalized$RecWeek4 + data_common_columns_f22_a_w5_normalized$RecWeek5)/3
aggregate_features_data_common_columns_f22_a_w7_normalized_all$RecitationsW5 <- (data_common_columns_f22_a_w7_normalized$RecWeek3 + data_common_columns_f22_a_w7_normalized$RecWeek4 + data_common_columns_f22_a_w7_normalized$RecWeek5)/3

aggregate_features_data_common_columns_f22_a_w7_normalized_all$RecitationsW6 <- (data_common_columns_f22_a_w7_normalized$RecWeek3 + data_common_columns_f22_a_w7_normalized$RecWeek4 + data_common_columns_f22_a_w7_normalized$RecWeek5 + data_common_columns_f22_a_w7_normalized$RecWeek6)/4
aggregate_features_data_common_columns_f22_a_w7_normalized_all$RecitationsW7 <- (data_common_columns_f22_a_w7_normalized$RecWeek3 + data_common_columns_f22_a_w7_normalized$RecWeek4 + data_common_columns_f22_a_w7_normalized$RecWeek5 + data_common_columns_f22_a_w7_normalized$RecWeek6 + data_common_columns_f22_a_w7_normalized$RecWeek7)/5
#aggregate_features_data_common_columns_f22_a_normalized_all$RecitationsW8 <- (data_common_columns_f22_a_normalized$RecWeek3 + data_common_columns_f22_a_normalized$RecWeek4 + data_common_columns_f22_a_normalized$RecWeek5 + data_common_columns_f22_a_normalized$RecWeek6 + data_common_columns_f22_a_normalized$RecWeek7 + data_common_columns_f22_a_normalized$RecWeek8)/6
#aggregate_features_data_common_columns_f22_a_normalized_all$RecitationsW10 <- (data_common_columns_f22_a_normalized$RecWeek3 + data_common_columns_f22_a_normalized$RecWeek4 + data_common_columns_f22_a_normalized$RecWeek5 + data_common_columns_f22_a_normalized$RecWeek6 + data_common_columns_f22_a_normalized$RecWeek7 + data_common_columns_f22_a_normalized$RecWeek8 + data_common_columns_f22_a_normalized$RecWeek10)/7

#aggregate_features_data_common_columns_f22_a_w4_all$RecitationsW3 <- data_common_columns_f22_a_w4$RecWeek3
#aggregate_features_data_common_columns_f22_a_w5_all$RecitationsW3 <- data_common_columns_f22_a_w5$RecWeek3
#aggregate_features_data_common_columns_f22_a_w7_all$RecitationsW3 <- data_common_columns_f22_a_w7$RecWeek3

#aggregate_features_data_common_columns_f22_a_w4_all$RecitationsW4 <- (data_common_columns_f22_a_w4$RecWeek3 + data_common_columns_f22_a_w4$RecWeek4)/2
#aggregate_features_data_common_columns_f22_a_w5_all$RecitationsW4 <- (data_common_columns_f22_a_w5$RecWeek3 + data_common_columns_f22_a_w5$RecWeek4)/2
#aggregate_features_data_common_columns_f22_a_w7_all$RecitationsW4 <- (data_common_columns_f22_a_w7$RecWeek3 + data_common_columns_f22_a_w7$RecWeek4)/2

#aggregate_features_data_common_columns_f22_a_w5_all$RecitationsW5 <- (data_common_columns_f22_a_w5$RecWeek3 + data_common_columns_f22_a_w5$RecWeek4 + data_common_columns_f22_a_w5$RecWeek5)/3
#aggregate_features_data_common_columns_f22_a_w7_all$RecitationsW5 <- (data_common_columns_f22_a_w7$RecWeek3 + data_common_columns_f22_a_w7$RecWeek4 + data_common_columns_f22_a_w7$RecWeek5)/3

#aggregate_features_data_common_columns_f22_a_w7_all$RecitationsW6 <- (data_common_columns_f22_a_w7$RecWeek3 + data_common_columns_f22_a_w7$RecWeek4 + data_common_columns_f22_a_w7$RecWeek5 + data_common_columns_f22_a_w7$RecWeek6)/4
#aggregate_features_data_common_columns_f22_a_w7_all$RecitationsW7 <- (data_common_columns_f22_a_w7$RecWeek3 + data_common_columns_f22_a_w7$RecWeek4 + data_common_columns_f22_a_w7$RecWeek5 + data_common_columns_f22_a_w7$RecWeek6 + data_common_columns_f22_a_w7$RecWeek7)/5
#aggregate_features_data_common_columns_f22_a_all$RecitationsW8 <- (data_common_columns_f22_a$RecWeek3 + data_common_columns_f22_a$RecWeek4 + data_common_columns_f22_a$RecWeek5 + data_common_columns_f22_a$RecWeek6 + data_common_columns_f22_a$RecWeek7 + data_common_columns_f22_a$RecWeek8)/6
#aggregate_features_data_common_columns_f22_a_all$RecitationsW10 <- (data_common_columns_f22_a$RecWeek3 + data_common_columns_f22_a$RecWeek4 + data_common_columns_f22_a$RecWeek5 + data_common_columns_f22_a$RecWeek6 + data_common_columns_f22_a$RecWeek7 + data_common_columns_f22_a$RecWeek8 + data_common_columns_f22_a$RecWeek10)/7



# EXAMS!
aggregate_features_data_common_columns_f22_a_w7_normalized_all$ExamW7 <- data_common_columns_f22_a_w7_normalized$Exam1
#aggregate_features_data_common_columns_f22_a_w7_all$ExamW7 <- data_common_columns_f22_a_w7$Exam1


# attitudes
aggregate_features_data_common_columns_f22_a_w4_normalized_all$ATTITUDES <- (data_common_columns_f22_a_w4_normalized$ATTITUDES + data_common_columns_f22_a_w4_normalized$BELONGINGNESS + data_common_columns_f22_a_w4_normalized$ENGAGEMENT + data_common_columns_f22_a_w4_normalized$CONFIDENCE + data_common_columns_f22_a_w4_normalized$INTEREST + data_common_columns_f22_a_w4_normalized$USEFULNESS + data_common_columns_f22_a_w4_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f22_a_w5_normalized_all$ATTITUDES <- (data_common_columns_f22_a_w5_normalized$ATTITUDES + data_common_columns_f22_a_w5_normalized$BELONGINGNESS + data_common_columns_f22_a_w5_normalized$ENGAGEMENT + data_common_columns_f22_a_w5_normalized$CONFIDENCE + data_common_columns_f22_a_w5_normalized$INTEREST + data_common_columns_f22_a_w5_normalized$USEFULNESS + data_common_columns_f22_a_w5_normalized$ENCOURAGEMENT)/7
aggregate_features_data_common_columns_f22_a_w7_normalized_all$ATTITUDES <- (data_common_columns_f22_a_w7_normalized$ATTITUDES + data_common_columns_f22_a_w7_normalized$BELONGINGNESS + data_common_columns_f22_a_w7_normalized$ENGAGEMENT + data_common_columns_f22_a_w7_normalized$CONFIDENCE + data_common_columns_f22_a_w7_normalized$INTEREST + data_common_columns_f22_a_w7_normalized$USEFULNESS + data_common_columns_f22_a_w7_normalized$ENCOURAGEMENT)/7

#aggregate_features_data_common_columns_f22_a_w4_all$ATTITUDES <- (data_common_columns_f22_a_w4$ATTITUDES + data_common_columns_f22_a_w4$BELONGINGNESS + data_common_columns_f22_a_w4$ENGAGEMENT + data_common_columns_f22_a_w4$CONFIDENCE + data_common_columns_f22_a_w4$INTEREST + data_common_columns_f22_a_w4$USEFULNESS + data_common_columns_f22_a_w4$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f22_a_w5_all$ATTITUDES <- (data_common_columns_f22_a_w5$ATTITUDES + data_common_columns_f22_a_w5$BELONGINGNESS + data_common_columns_f22_a_w5$ENGAGEMENT + data_common_columns_f22_a_w5$CONFIDENCE + data_common_columns_f22_a_w5$INTEREST + data_common_columns_f22_a_w5$USEFULNESS + data_common_columns_f22_a_w5$ENCOURAGEMENT)/7
#aggregate_features_data_common_columns_f22_a_w7_all$ATTITUDES <- (data_common_columns_f22_a_w7$ATTITUDES + data_common_columns_f22_a_w7$BELONGINGNESS + data_common_columns_f22_a_w7$ENGAGEMENT + data_common_columns_f22_a_w7$CONFIDENCE + data_common_columns_f22_a_w7$INTEREST + data_common_columns_f22_a_w7$USEFULNESS + data_common_columns_f22_a_w7$ENCOURAGEMENT)/7

#names(data_common_columns_f20_normalized)


# major BS CS or not
aggregate_features_data_common_columns_f22_a_w4_normalized_all$Major <- data_common_columns_f22_a_w4_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f22_a_w5_normalized_all$Major <- data_common_columns_f22_a_w5_normalized$Q1Computer.Science..BS.
aggregate_features_data_common_columns_f22_a_w7_normalized_all$Major <- data_common_columns_f22_a_w7_normalized$Q1Computer.Science..BS.

#aggregate_features_data_common_columns_f22_a_w4_all$Major <- data_common_columns_f22_a_w4$Q1Computer.Science..BS.
#aggregate_features_data_common_columns_f22_a_w5_all$Major <- data_common_columns_f22_a_w5$Q1Computer.Science..BS.
#aggregate_features_data_common_columns_f22_a_w7_all$Major <- data_common_columns_f22_a_w7$Q1Computer.Science..BS.

drops <- c("Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10","RecWeek11","RecWeek12", "RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
aggregate_features_data_common_columns_f22_a_w4_normalized_all <- aggregate_features_data_common_columns_f22_a_w4_normalized_all[ , !(names(aggregate_features_data_common_columns_f22_a_w4_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f22_a_w5_normalized_all <- aggregate_features_data_common_columns_f22_a_w5_normalized_all[ , !(names(aggregate_features_data_common_columns_f22_a_w5_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f22_a_w7_normalized_all <- aggregate_features_data_common_columns_f22_a_w7_normalized_all[ , !(names(aggregate_features_data_common_columns_f22_a_w7_normalized_all) %in% drops)]

#aggregate_features_data_common_columns_f22_a_w4_all <- aggregate_features_data_common_columns_f22_a_w4_all[ , !(names(aggregate_features_data_common_columns_f22_a_w4_all) %in% drops)]
#aggregate_features_data_common_columns_f22_a_w5_all <- aggregate_features_data_common_columns_f22_a_w5_all[ , !(names(aggregate_features_data_common_columns_f22_a_w5_all) %in% drops)]
#aggregate_features_data_common_columns_f22_a_w7_all <- aggregate_features_data_common_columns_f22_a_w7_all[ , !(names(aggregate_features_data_common_columns_f22_a_w7_all) %in% drops)]

names(aggregate_features_data_common_columns_f22_a_w4_all)


names(aggregate_features_data_common_columns_f22_a_all_normalized_all)
drops <- c("Exam1","Exam2", "Exam3", "Exam4", "X0", "X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10", "X11", "X12", "X13", "X14","X15", "RecWeek3", "RecWeek4", "RecWeek5", "RecWeek6", "RecWeek7", "RecWeek8", "RecWeek10", "RecWeek11", "RecWeek12","RecWeek13","RecWeek14", "ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Computer.Science..BA.", "Q1Computer.Science..BS.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided" )
test <- aggregate_features_data_common_columns_f22_a_all_normalized_all[ , !(names(aggregate_features_data_common_columns_f22_a_all_normalized_all) %in% drops)]
aggregate_features_data_common_columns_f22_a_all_normalized_all <- test
names(aggregate_features_data_common_columns_f22_a_all_normalized_all)

#test <- aggregate_features_data_common_columns_f22_a_all_all[ , !(names(aggregate_features_data_common_columns_f22_a_all_all) %in% drops)]
#aggregate_features_data_common_columns_f22_a_all_all <- test
ncol(aggregate_features_data_common_columns_f20_a_w7_normalized_all)
ncol(aggregate_features_data_common_columns_f22_a_w7_normalized_all)

!(names(aggregate_features_data_common_columns_f22_a_w7_normalized_all) %in% names(aggregate_features_data_common_columns_f20_a_w7_normalized_all) )

#names(test)
#dim(aggregate_features_data_common_columns_f22_a_all_normalized_all)

# WRITE AGGREGATE FEATURES IN A FILE

setwd("")

write.csv(aggregate_features_data_common_columns_f20_normalized_all, "Data_F20_Aggregate_Features_All.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_normalized_all, "Data_F22_Aggregate_Features_All.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_all_normalized_all, "Data_F20_Autolab_ALL_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_all_normalized_all, "Data_F22_Autolab_ALL_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w4_normalized_all, "Data_F20_Autolab_W4_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w4_normalized_all, "Data_F22_Autolab_W4_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w5_normalized_all, "Data_F20_Autolab_W5_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w5_normalized_all, "Data_F22_Autolab_W5_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w7_normalized_all, "Data_F20_Autolab_W7_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w7_normalized_all, "Data_F22_Autolab_W7_Aggregate_Features.csv", row.names = FALSE)

write.csv(aggregate_features_data_common_columns_f20_all, "Data_F20_NN_Aggregate_Features_All.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_all, "Data_F22_NN_Aggregate_Features_All.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_all_all, "Data_F20_NN_Autolab_ALL_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_all_all, "Data_F22_NN_Autolab_ALL_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w4_all, "Data_F20_NN_Autolab_W4_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w4_all, "Data_F22_NN_Autolab_W4_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w5_all, "Data_F20_NN_Autolab_W5_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w5_all, "Data_F22_NN_Autolab_W5_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f20_a_w7_all, "Data_F20_NN_Autolab_W7_Aggregate_Features.csv", row.names = FALSE)
write.csv(aggregate_features_data_common_columns_f22_a_w7_all, "Data_F22_NN_Autolab_W7_Aggregate_Features.csv", row.names = FALSE)

# CAN START HERE AND READ AGGREGATE FEATURES FROIM FILES: Commented for Now

aggregate_features_data_common_columns_f20_normalized_all <- read.csv("Data_F20_Aggregate_Features_All.csv", header = TRUE)
aggregate_features_data_common_columns_f22_normalized_all <- read.csv("Data_F22_Aggregate_Features_All.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_all_normalized_all <- read.csv("Data_F20_Autolab_ALL_Aggregate_Features.csv", )
aggregate_features_data_common_columns_f22_a_all_normalized_all <- read.csv("Data_F22_Autolab_ALL_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w4_normalized_all <- read.csv("Data_F20_Autolab_W4_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w4_normalized_all <- read.csv("Data_F22_Autolab_W4_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w5_normalized_all <- read.csv("Data_F20_Autolab_W5_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w5_normalized_all <- read.csv("Data_F22_Autolab_W5_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w7_normalized_all <- read.csv("Data_F20_Autolab_W7_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w7_normalized_all <- read.csv("Data_F22_Autolab_W7_Aggregate_Features.csv", header = TRUE)

ncol(aggregate_features_data_common_columns_f20_a_w7_normalized_all)
ncol(aggregate_features_data_common_columns_f22_a_w7_normalized_all)
!(names(aggregate_features_data_common_columns_f22_a_w7_normalized_all) %in% names(aggregate_features_data_common_columns_f20_a_w7_normalized_all))
# non-scaled data
aggregate_features_data_common_columns_f20_all <- read.csv("Data_F20_NN_Aggregate_Features_All.csv", header = TRUE)
aggregate_features_data_common_columns_f22_all <- read.csv(, "Data_F22_NN_Aggregate_Features_All.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_all_all <- read.csv("Data_F20_NN_Autolab_ALL_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_all_all <- read.csv("Data_F22_NN_Autolab_ALL_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w4_all <- read.csv("Data_F20_NN_Autolab_W4_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w4_all <- read.csv("Data_F22_NN_Autolab_W4_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w5_all <- read.csv("Data_F20_NN_Autolab_W5_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w5_all <- read.csv("Data_F22_NN_Autolab_W5_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f20_a_w7_all <- read.csv("Data_F20_NN_Autolab_W7_Aggregate_Features.csv", header = TRUE)
aggregate_features_data_common_columns_f22_a_w7_all <- read.csv("Data_F22_NN_Autolab_W7_Aggregate_Features.csv", header = TRUE)




 
# # non-aggregate features
# 
# data_common_columns_f20_normalized <- read.csv("Data_F20_Common_Columns_Normalized.csv", header = TRUE)
# data_common_columns_f20_a_w4_normalized <- read.csv("Data_F20_Autolab_Common_Columns_Normalized.csv", header = TRUE)
# data_common_columns_f22_normalized <- read.csv("Data_F22_Common_Columns_Normalized.csv", header = TRUE)
# data_common_columns_f22_a_normalized <- read.csv("Data_F22_Autolab_Common_Columns_Normalized.csv", header = TRUE)
# 
# 
# # aggregate features
# aggregate_features_data_common_columns_f20_normalized_all <- read.csv("Data_F20_Aggregate_Features_All.csv", header = TRUE)
# aggregate_features_data_common_columns_f22_normalized_all <- read.csv("Data_F22_Aggregate_Features_All.csv", header = TRUE)
# aggregate_features_data_common_columns_f20_a_normalized_all <- read.csv("Data_F20_Autolab_Aggregate_Features_All.csv", header = TRUE)
# aggregate_features_data_common_columns_f22_a_normalized_all <- read.csv("Data_F22_Autolab_Aggregate_Features_All.csv", header = TRUE)

########################################################################
#
#.       For Week k, KEEP ONLY Week k features
#
#########################################################################

# DATASETS WITH AGGREGATE FEATURES WEEK 3 : ONLY REGISTRAR DATA
#names(aggregate_features_data_common_columns_f20_normalized_all)

# these are the attributes available from the registrar data
keeps_reg <- c("Final.Points","gender_cdM","ethnic_cd3","ethnic_cd4", "ethnic_cd5","ethnic_cd6" ,"ethnic_cd8","ethnic_cdN","ethnic_cdT","course_repeat_indY","sending_school_type_cd.1","sending_school_type_cd.2","sending_school_type_cd.3" ,"sending_school_type_cd.5", "sending_school_type_cd.6", "orig_admit_type_cd.0", "orig_admit_type_cd.2", "curr_admit_type_cd.1","curr_admit_type_cd.2","curr_admit_type_cd.4","curr_admit_type_cd.6","curr_admit_type_cd.9","citizen_status_cd.1","citizen_status_cd.2","citizen_status_cd.3", "SUCCESS")

# these are the attributes available from the registrar data to start building for aggregate features
keeps_w3_ag <- c("Final.Points","RecitationsW3","gender_cdM","ethnic_cd3","ethnic_cd4", "ethnic_cd5","ethnic_cd6" ,"ethnic_cd8","ethnic_cdN","ethnic_cdT","course_repeat_indY","sending_school_type_cd.1","sending_school_type_cd.2","sending_school_type_cd.3" ,"sending_school_type_cd.5", "sending_school_type_cd.6", "orig_admit_type_cd.0", "orig_admit_type_cd.2", "curr_admit_type_cd.1","curr_admit_type_cd.2","curr_admit_type_cd.4","curr_admit_type_cd.6","curr_admit_type_cd.9","citizen_status_cd.1","citizen_status_cd.2","citizen_status_cd.3", "SUCCESS")

# autolab data has a few extra features
keeps_w3_ag_a <- c(keeps_w3_ag, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")

aggregate_features_f20_w3 <- aggregate_features_data_common_columns_f20_normalized_all[,names(aggregate_features_data_common_columns_f20_normalized_all) %in% keeps_w3_ag]
aggregate_features_f22_w3 <- aggregate_features_data_common_columns_f22_normalized_all[,names(aggregate_features_data_common_columns_f22_normalized_all) %in% keeps_w3_ag]
aggregate_features_f20_a_w3 <- aggregate_features_data_common_columns_f20_a_all_normalized_all[,names(aggregate_features_data_common_columns_f20_a_all_normalized_all) %in% keeps_w3_ag_a]
aggregate_features_f22_a_w3 <- aggregate_features_data_common_columns_f22_a_all_normalized_all[,names(aggregate_features_data_common_columns_f22_a_all_normalized_all) %in% keeps_w3_ag_a]

#aggregate_features_f20_a_w3 <- aggregate_features_data_common_columns_f20_a_w4_normalized_all[,names(aggregate_features_data_common_columns_f20_a_w4_normalized_all) %in% keeps_w3_ag_a]
#aggregate_features_f22_a_w3 <- aggregate_features_data_common_columns_f22_a_w4_normalized_all[,names(aggregate_features_data_common_columns_f22_a_w4_normalized_all) %in% keeps_w3_ag_a]
#names(data_common_columns_f20_a_normalized)

names(aggregate_features_data_common_columns_f22_a_all_normalized_all)

# SKIP W3: NO AGGREGATE W3 DATA SETS

# NON-AGGREGATE Features
#keeps_w3_nag <- c(keeps_reg, "RecWeek3"). # not aggreagte
#keeps_w3_nag_a <- c(keeps_w3_nag, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_first_submission")

#features_f20_w3 <- data_common_columns_f20_normalized[,names(data_common_columns_f20_normalized) %in% keeps_w3_nag]
#features_f22_w3 <- data_common_columns_f22_normalized[,names(data_common_columns_f22_normalized) %in% keeps_w3_nag]
#features_f20_a_w3 <- data_common_columns_f20_a_w4_normalized[,names(data_common_columns_f20_a_w4_normalized) %in% keeps_w3_nag_a]
#features_f22_a_w3 <- data_common_columns_f22_a_w4_normalized[,names(data_common_columns_f22_a_w4_normalized) %in% keeps_w3_nag_a]


# these are the all the features from intro survey and registrar data
# to these we'll add aggregate features that have to do with recitations, assignments, and exams.
keeps_intro_reg <- c(keeps_reg, "ATTITUDES","Q2I.am.interested.in.computer.science","Q2I.think.this.course.would.be.helpful","Q2It.fulfills.another.requirement..Please.explain.","Q2It.is.an.elective","Q2It.is.required.for.my.major","Q2It.is.required.for.my.minor","Q2Other..please.explain","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes", "Q4High.school.class.or.classes.other.than.AP", "Q4I.have.no.previous.knowledge.of.computer.science", "Q4I.learned.computer.science.by.myself", "Q4Other..please.explain", "Q35Difficult", "Q35Easy", "Q35Neutral", "Q35Very.difficult", "Q35Very.Easy", "Major")
keep_intro_reg_a <- c(keeps_reg, "ATTITUDES","Q2I.am.interested.in.computer.science","Q2I.think.this.course.would.be.helpful","Q2It.fulfills.another.requirement..Please.explain.","Q2It.is.an.elective","Q2It.is.required.for.my.major","Q2It.is.required.for.my.minor","Q2Other..please.explain","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes", "Q4High.school.class.or.classes.other.than.AP", "Q4I.have.no.previous.knowledge.of.computer.science", "Q4I.learned.computer.science.by.myself", "Q4Other..please.explain", "Q35Difficult", "Q35Easy", "Q35Neutral", "Q35Very.difficult", "Q35Very.Easy", "Major")

# non-aggregate features
#keeps_intro_reg_na <- c(keeps_w3_nag,"ENGAGEMENT","CONFIDENCE","INTEREST","USEFULNESS","ENCOURAGEMENT","ATTITUDES","Q1Biological.Sciences..BA.","Q1Computer.Science..BA.","Q1Computer.Science..BS.","Q1Economics","Q1Genetics..BA.","Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Undecided", "Q2I.am.interested.in.computer.science","Q2I.think.this.course.would.be.helpful","Q2It.fulfills.another.requirement..Please.explain.","Q2It.is.an.elective","Q2It.is.required.for.my.major","Q2It.is.required.for.my.minor","Q2Other..please.explain","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes", "Q4High.school.class.or.classes.other.than.AP", "Q4I.have.no.previous.knowledge.of.computer.science", "Q4I.learned.computer.science.by.myself", "Q4Other..please.explain", "Q35Difficult", "Q35Easy", "Q35Neutral", "Q35Very.difficult", "Q35Very.Easy", "Major")
#keeps_intro_reg_na_a <- c(keeps_w3_nag_a,"ENGAGEMENT","CONFIDENCE","INTEREST","USEFULNESS","ENCOURAGEMENT","ATTITUDES","Q1Biological.Sciences..BA.","Q1Computer.Science..BA.","Q1Computer.Science..BS.","Q1Economics","Q1Genetics..BA.","Q1Information.Technology.and.Informatics..BA.","Q1Mathematics..BA.or.BS.","Q1Undecided", "Q2I.am.interested.in.computer.science","Q2I.think.this.course.would.be.helpful","Q2It.fulfills.another.requirement..Please.explain.","Q2It.is.an.elective","Q2It.is.required.for.my.major","Q2It.is.required.for.my.minor","Q2Other..please.explain","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes", "Q4High.school.class.or.classes.other.than.AP", "Q4I.have.no.previous.knowledge.of.computer.science", "Q4I.learned.computer.science.by.myself", "Q4Other..please.explain", "Q35Difficult", "Q35Easy", "Q35Neutral", "Q35Very.difficult", "Q35Very.Easy", "Major")


# DATASETS WITH AGGREGATE FEATURES WEEK 4 : REGISTRAR, INTRO SURVEY, REC W4, ASSIGNMENS W4 DATA
#names(aggregate_features_data_common_columns_f20_normalized_all)
keeps <- c(keeps_intro_reg, "RecitationsW4", "AssignmentsW4")
keeps_a <- c(keeps, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_last_submission")

# AGGREGATE FEATURES
aggregate_features_f20_w4 <- aggregate_features_data_common_columns_f20_normalized_all[,names(aggregate_features_data_common_columns_f20_normalized_all) %in% keeps]
aggregate_features_f22_w4 <- aggregate_features_data_common_columns_f22_normalized_all[,names(aggregate_features_data_common_columns_f22_normalized_all) %in% keeps]
aggregate_features_f20_a_w4 <- aggregate_features_data_common_columns_f20_a_w4_normalized_all[,names(aggregate_features_data_common_columns_f20_a_w4_normalized_all) %in% keeps_a]
aggregate_features_f22_a_w4 <- aggregate_features_data_common_columns_f22_a_w4_normalized_all[,names(aggregate_features_data_common_columns_f22_a_w4_normalized_all) %in% keeps_a]

names(aggregate_features_f22_a_w4)

# NON-AGGREGATE Features

keeps_na <- c(keeps_intro_reg, "RecWeek3","RecWeek4","X0", "X1", "X2", "X3")

keeps_na_a <- c(keeps_na, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "max_time_b4_deadline_last_submission")
features_f20_w4 <- data_common_columns_f20_normalized[,names(data_common_columns_f20_normalized) %in% keeps_na]
features_f22_w4 <- data_common_columns_f22_normalized[,names(data_common_columns_f22_normalized) %in% keeps_na]
features_f20_a_w4 <- data_common_columns_f20_a_w4_normalized[,names(data_common_columns_f20_a_w4_normalized) %in% keeps_na_a]
features_f22_a_w4 <- data_common_columns_f22_a_w4_normalized[,names(data_common_columns_f22_a_w4_normalized) %in% keeps_na_a]

names(features_f20_a_w4)

# DATASETS WITH AGGREGATE FEATURES WEEK 5 : REGISTRAR, INTRO SURVEY, REC W5, ASSIGNMENS W4 DATA

keeps <- c(keeps_intro_reg, "AssignmentsW4","RecitationsW5")
# "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission"
keeps_a <- c(keeps, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")
aggregate_features_f20_w5 <- aggregate_features_data_common_columns_f20_normalized_all[,names(aggregate_features_data_common_columns_f20_normalized_all) %in% keeps]
aggregate_features_f22_w5 <- aggregate_features_data_common_columns_f22_normalized_all[,names(aggregate_features_data_common_columns_f22_normalized_all) %in% keeps]
aggregate_features_f20_a_w5 <- aggregate_features_data_common_columns_f20_a_w5_normalized_all[,names(aggregate_features_data_common_columns_f20_a_w5_normalized_all) %in% keeps_a]
aggregate_features_f22_a_w5 <- aggregate_features_data_common_columns_f22_a_w5_normalized_all[,names(aggregate_features_data_common_columns_f22_a_w5_normalized_all) %in% keeps_a]

names(aggregate_features_f20_a_w5)

# NON-AGGREGATE Features

keeps_na <- c(keeps_na, "RecWeek5")
keeps_na_a <- c(keeps_na, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")

features_f20_w5 <- data_common_columns_f20_normalized[,names(data_common_columns_f20_normalized) %in% keeps_na]
features_f22_w5 <- data_common_columns_f22_normalized[,names(data_common_columns_f22_normalized) %in% keeps_na]
features_f20_a_w5 <- data_common_columns_f20_a_w5_normalized[,names(data_common_columns_f20_a_w5_normalized) %in% keeps_na]
features_f22_a_w5 <- data_common_columns_f22_a_w5_normalized[,names(data_common_columns_f22_a_w5_normalized) %in% keeps_na]


names(data_common_columns_f22_a_w5_normalized)


# DATASETS WITH AGGREGATE FEATURES WEEK 6 : REGISTRAR, INTRO SURVEY, REC W6, ASSIGNMENS W4 DATA

keeps <- c(keeps_intro_reg, "AssignmentsW4","RecitationsW6")
keeps_a <- c(keeps, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")

aggregate_features_f20_w6 <- aggregate_features_data_common_columns_f20_normalized_all[,names(aggregate_features_data_common_columns_f20_normalized_all) %in% keeps]
aggregate_features_f22_w6 <- aggregate_features_data_common_columns_f22_normalized_all[,names(aggregate_features_data_common_columns_f22_normalized_all) %in% keeps]
aggregate_features_f20_a_w6 <- aggregate_features_data_common_columns_f20_a_w5_normalized_all[,names(aggregate_features_data_common_columns_f20_a_w5_normalized_all) %in% keeps_a]
aggregate_features_f22_a_w6 <- aggregate_features_data_common_columns_f22_a_w5_normalized_all[,names(aggregate_features_data_common_columns_f22_a_w5_normalized_all) %in% keeps_a]

#names(aggregate_features_f20_w6)

# NON-AGGREGATE Features

keeps_na <- c(keeps_na, "RecWeek6")
keeps_na_a <- c(keeps_na, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")

features_f20_w6 <- data_common_columns_f20_normalized[,names(data_common_columns_f20_normalized) %in% keeps_na]
features_f22_w6 <- data_common_columns_f22_normalized[,names(data_common_columns_f22_normalized) %in% keeps_na]
features_f20_a_w6 <- data_common_columns_f20_a_w5_normalized[,names(data_common_columns_f20_a_w5_normalized) %in% keeps_na_a]
features_f22_a_w6 <- data_common_columns_f22_a_w5_normalized[,names(data_common_columns_f22_a_w5_normalized) %in% keeps_na_a]

#names(features_f20_a_w6)

# DATASETS WITH AGGREGATE FEATURES WEEK 7 : REGISTRAR, INTRO SURVEY, REC W7, ASSIGNMENS W7, Exam 1 DATA

keeps <- c(keeps_intro_reg, "RecitationsW7","AssignmentsW7","ExamW7")
keeps_a <- c(keeps, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")
aggregate_features_f20_w7 <- aggregate_features_data_common_columns_f20_normalized_all[,names(aggregate_features_data_common_columns_f20_normalized_all) %in% keeps]
aggregate_features_f22_w7 <- aggregate_features_data_common_columns_f22_normalized_all[,names(aggregate_features_data_common_columns_f22_normalized_all) %in% keeps]
aggregate_features_f20_a_w7 <- aggregate_features_data_common_columns_f20_a_w7_normalized_all[,names(aggregate_features_data_common_columns_f20_a_w7_normalized_all) %in% keeps_a]
aggregate_features_f22_a_w7 <- aggregate_features_data_common_columns_f22_a_w7_normalized_all[,names(aggregate_features_data_common_columns_f22_a_w7_normalized_all) %in% keeps_a]

names(aggregate_features_f22_a_w7)

ncol(aggregate_features_data_common_columns_f20_a_w7_normalized_all)
ncol(aggregate_features_data_common_columns_f22_a_w7_normalized_all)

#names(aggregate_features_data_common_columns_f22_normalized_all_balanced)

# NON-AGGREGATE Features

keeps_na <- c(keeps_na,"X4","X5","X6","X7","X8" ,"RecWeek7", "Exam1")
keeps_na_a <- c(keeps_na, "max_submissions", "max_score_consecutive_submissions", "min_score_consecutive_submissions", "min_time_b4_deadline_first_submission")

features_f20_w7 <- data_common_columns_f20_normalized[,names(data_common_columns_f20_normalized) %in% keeps_na]
features_f22_w7 <- data_common_columns_f22_normalized[,names(data_common_columns_f22_normalized) %in% keeps_na]
features_f20_a_w7 <- data_common_columns_f20_a_w7_normalized[,names(data_common_columns_f20_a_w7_normalized) %in% keeps_na_a]
features_f22_a_w7 <- data_common_columns_f22_a_w7_normalized[,names(data_common_columns_f22_a_w7_normalized) %in% keeps_na_a]

#names(aggregate_features_data_common_columns_f20_a_w4_normalized_all)
#names(aggregate_features_f22_a_w7)
# TO DO DATASETS WITH AGGREGATE FEATURES WEEKS 8-10 : REGISTRAR, INTRO SURVEY, REC W5, ASSIGNMENS W5 DATA

#########        MAKE EVERYTHING ORGANIZED        ############

# NOT AGGREGATE, STATIC, NOT BALANCED

not_aggregate_not_dynamic_not_balanced_f20_all <- data_common_columns_f20_normalized
not_aggregate_not_dynamic_not_balanced_f22_all <- data_common_columns_f22_normalized
# sanity check
ncol(not_aggregate_not_dynamic_not_balanced_f20_all)
ncol(not_aggregate_not_dynamic_not_balanced_f22_all)

#not_aggregate_not_dynamic_not_balanced_f20_w3 <- features_f20_w3
#not_aggregate_not_dynamic_not_balanced_f22_w3 <- features_f22_w3
#ncol(not_aggregate_not_dynamic_not_balanced_f20_w3)
#ncol(not_aggregate_not_dynamic_not_balanced_f22_w3)

not_aggregate_not_dynamic_not_balanced_f20_w4 <- features_f20_w4
not_aggregate_not_dynamic_not_balanced_f22_w4 <- features_f22_w4
ncol(not_aggregate_not_dynamic_not_balanced_f20_w4)
ncol(not_aggregate_not_dynamic_not_balanced_f22_w4)

not_aggregate_not_dynamic_not_balanced_f20_w5 <- features_f20_w5
not_aggregate_not_dynamic_not_balanced_f22_w5 <- features_f22_w5
ncol(not_aggregate_not_dynamic_not_balanced_f20_w5)
ncol(not_aggregate_not_dynamic_not_balanced_f22_w5)

#not_aggregate_not_dynamic_not_balanced_f20_w6 <- features_f20_w6
#not_aggregate_not_dynamic_not_balanced_f22_w6 <- features_f22_w6
#ncol(not_aggregate_not_dynamic_not_balanced_f20_w6)
#ncol(not_aggregate_not_dynamic_not_balanced_f22_w6)

not_aggregate_not_dynamic_not_balanced_f20_w7 <- features_f20_w7
not_aggregate_not_dynamic_not_balanced_f22_w7 <- features_f22_w7
ncol(not_aggregate_not_dynamic_not_balanced_f20_w7)
ncol(not_aggregate_not_dynamic_not_balanced_f22_w7)


# AGGREGATE, STATIC, NOT BALANCED

aggregate_not_dynamic_not_balanced_f20_all <- data_common_columns_f20_static_ag_normalized
aggregate_not_dynamic_not_balanced_f22_all <- data_common_columns_f22_static_ag_normalized
ncol(aggregate_not_dynamic_not_balanced_f20_all)
ncol(aggregate_not_dynamic_not_balanced_f22_all)

#aggregate_not_dynamic_not_balanced_f20_w3 <- data_common_columns_f20_static_ag_w4_normalized   aggregate_features_f20_w3
#aggregate_not_dynamic_not_balanced_f22_w3 <- aggregate_features_f22_w3
#ncol(aggregate_not_dynamic_not_balanced_f20_w3)
#ncol(aggregate_not_dynamic_not_balanced_f22_w3)

aggregate_not_dynamic_not_balanced_f20_w4 <- data_common_columns_f20_static_ag_w4#aggregate_features_f20_w4
aggregate_not_dynamic_not_balanced_f22_w4 <- data_common_columns_f22_static_ag_w4
ncol(aggregate_not_dynamic_not_balanced_f20_w4)
ncol(aggregate_not_dynamic_not_balanced_f22_w4)

aggregate_not_dynamic_not_balanced_f20_w5 <- data_common_columns_f20_static_ag_w5
aggregate_not_dynamic_not_balanced_f22_w5 <- data_common_columns_f22_static_ag_w5
ncol(aggregate_not_dynamic_not_balanced_f20_w5)
ncol(aggregate_not_dynamic_not_balanced_f22_w5)

#aggregate_not_dynamic_not_balanced_f20_w6 <- aggregate_features_f20_w6
#aggregate_not_dynamic_not_balanced_f22_w6 <- aggregate_features_f22_w6
#ncol(aggregate_not_dynamic_not_balanced_f20_w6)
#ncol(aggregate_not_dynamic_not_balanced_f22_w6)

aggregate_not_dynamic_not_balanced_f20_w7 <- data_common_columns_f20_static_ag_w7
aggregate_not_dynamic_not_balanced_f22_w7 <- data_common_columns_f22_static_ag_w7
ncol(aggregate_not_dynamic_not_balanced_f20_w7)
ncol(aggregate_not_dynamic_not_balanced_f22_w7)

# NOT AGRREGATE, DYNAMIC, NOT BALANCED

#data_common_columns_f22_a_all_normalized <- data_common_columns_f22_a_all_normalized[,!names(data_common_columns_f22_a_all_normalized) %in% c("FinalPoints")]
#test <- data_common_columns_f22_a_all_normalized[,!names(data_common_columns_f22_a_all_normalized) %in% c("FinalPoints")]
#data_common_columns_f22_a_all_normalized <- test

not_aggregate_dynamic_not_balanced_f20_all <- data_common_columns_f20_a_all_normalized
not_aggregate_dynamic_not_balanced_f22_all <- data_common_columns_f22_a_all_normalized
ncol(not_aggregate_dynamic_not_balanced_f20_all)
ncol(not_aggregate_dynamic_not_balanced_f22_all)

not_aggregate_dynamic_not_balanced_f20_w4 <- data_common_columns_f20_a_w4_normalized 
not_aggregate_dynamic_not_balanced_f22_w4 <- data_common_columns_f22_a_w4_normalized 
ncol(not_aggregate_dynamic_not_balanced_f20_w4)
ncol(not_aggregate_dynamic_not_balanced_f22_w4)

not_aggregate_dynamic_not_balanced_f20_w5 <- data_common_columns_f20_a_w5_normalized 
not_aggregate_dynamic_not_balanced_f22_w5 <- data_common_columns_f22_a_w5_normalized 
ncol(not_aggregate_dynamic_not_balanced_f20_w5)
ncol(not_aggregate_dynamic_not_balanced_f22_w5)

not_aggregate_dynamic_not_balanced_f20_w7 <- data_common_columns_f20_a_w7_normalized 
not_aggregate_dynamic_not_balanced_f22_w7 <- data_common_columns_f22_a_w7_normalized 
ncol(not_aggregate_dynamic_not_balanced_f20_w7)
ncol(not_aggregate_dynamic_not_balanced_f22_w7)

# AGGREGATE, DYNAMIC, NOT BALANCED

aggregate_dynamic_not_balanced_f20_all <- data_common_columns_f20_ag_a_all_normalized#aggregate_features_data_common_columns_f20_a_all_normalized_all
aggregate_dynamic_not_balanced_f22_all <- data_common_columns_f22_ag_a_all_normalized#aggregate_features_data_common_columns_f22_a_all_normalized_all
ncol(aggregate_dynamic_not_balanced_f20_all)
ncol(aggregate_dynamic_not_balanced_f22_all)


aggregate_dynamic_not_balanced_f20_w4 <- data_common_columns_f20_a_w4_normalized#aggregate_features_data_common_columns_f20_a_w4_normalized_all
aggregate_dynamic_not_balanced_f22_w4 <- data_common_columns_f22_a_w4_normalized#aggregate_features_data_common_columns_f22_a_w4_normalized_all
ncol(aggregate_dynamic_not_balanced_f20_w4)
ncol(aggregate_dynamic_not_balanced_f22_w4)

aggregate_dynamic_not_balanced_f20_w5 <- data_common_columns_f20_a_w5_normalized#aggregate_features_data_common_columns_f20_a_w5_normalized_all
aggregate_dynamic_not_balanced_f22_w5 <- data_common_columns_f22_a_w5_normalized#aggregate_features_data_common_columns_f22_a_w5_normalized_all
ncol(aggregate_dynamic_not_balanced_f20_w5)
ncol(aggregate_dynamic_not_balanced_f22_w5)

#aggregate_dynamic_not_balanced_f20_w7 <- aggregate_features_data_common_columns_f20_a_w7_normalized_all
#aggregate_dynamic_not_balanced_f22_w7 <- aggregate_features_data_common_columns_f22_a_w7_normalized_all
aggregate_dynamic_not_balanced_f20_w7 <- data_common_columns_f20_a_w7_normalized#aggregate_features_f20_a_w7
aggregate_dynamic_not_balanced_f22_w7 <- data_common_columns_f20_a_w7_normalized#aggregate_features_f22_a_w7
ncol(aggregate_dynamic_not_balanced_f20_w7)
ncol(aggregate_dynamic_not_balanced_f22_w7)



############################
#    BALANCE DATASETS     #
############################

# NOT AGGREGATE, STATIC, BALANCED

dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_all[not_aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_all[not_aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_all[not_aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f20_all <- dataset_trunc

dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_all[not_aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_all[not_aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_all[not_aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f22_all <- dataset_trunc

# sanity check
ncol(not_aggregate_not_dynamic_balanced_f20_all)
ncol(not_aggregate_not_dynamic_balanced_f22_all)

# dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_w3[not_aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==1,]
# dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_w3[not_aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==2,]
# dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_w3[not_aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# not_aggregate_not_dynamic_balanced_f20_w3 <- dataset_trunc
# 
# dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_w3[not_aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==1,]
# dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_w3[not_aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==2,]
# dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_w3[not_aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# not_aggregate_not_dynamic_balanced_f22_w3 <- dataset_trunc
# 
# # sanity check
# ncol(not_aggregate_not_dynamic_balanced_f20_w3)
# ncol(not_aggregate_not_dynamic_balanced_f22_w3)


dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_w4[not_aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_w4[not_aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_w4[not_aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f20_w4 <- dataset_trunc

dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_w4[not_aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_w4[not_aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_w4[not_aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f22_w4 <- dataset_trunc

# sanity check
ncol(not_aggregate_not_dynamic_balanced_f20_w4)
ncol(not_aggregate_not_dynamic_balanced_f22_w4)

dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_w5[not_aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_w5[not_aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_w5[not_aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f20_w5 <- dataset_trunc

dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_w5[not_aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_w5[not_aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_w5[not_aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f22_w5 <- dataset_trunc

# sanity check
ncol(not_aggregate_not_dynamic_balanced_f20_w5)
ncol(not_aggregate_not_dynamic_balanced_f22_w5)

# dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_w6[not_aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==1,]
# dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_w6[not_aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==2,]
# dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_w6[not_aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# not_aggregate_not_dynamic_balanced_f20_w6 <- dataset_trunc
# 
# dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_w6[not_aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==1,]
# dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_w6[not_aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==2,]
# dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_w6[not_aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# not_aggregate_not_dynamic_balanced_f22_w6 <- dataset_trunc
# 
# # sanity check
# ncol(not_aggregate_not_dynamic_balanced_f20_w6)
# ncol(not_aggregate_not_dynamic_balanced_f22_w6)

dataset_success <- not_aggregate_not_dynamic_not_balanced_f20_w7[not_aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f20_w7[not_aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f20_w7[not_aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f20_w7 <- dataset_trunc

dataset_success <- not_aggregate_not_dynamic_not_balanced_f22_w7[not_aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==1,]
dataset_not_success <- not_aggregate_not_dynamic_not_balanced_f22_w7[not_aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==2,]
dataset_struggling <- not_aggregate_not_dynamic_not_balanced_f22_w7[not_aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_not_dynamic_balanced_f22_w7 <- dataset_trunc

# sanity check
ncol(not_aggregate_not_dynamic_balanced_f20_w7)
ncol(not_aggregate_not_dynamic_balanced_f22_w7)

# AGGREGATE, STATIC, BALANCED

dataset_success <- aggregate_not_dynamic_not_balanced_f20_all[aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_all[aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_all[aggregate_not_dynamic_not_balanced_f20_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f20_all <- dataset_trunc

dataset_success <- aggregate_not_dynamic_not_balanced_f22_all[aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_all[aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_all[aggregate_not_dynamic_not_balanced_f22_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f22_all <- dataset_trunc

# sanity check
ncol(aggregate_not_dynamic_balanced_f20_all)
ncol(aggregate_not_dynamic_balanced_f22_all)

# dataset_success <- aggregate_not_dynamic_not_balanced_f20_w3[aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==1,]
# dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_w3[aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==2,]
# dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_w3[aggregate_not_dynamic_not_balanced_f20_w3$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# aggregate_not_dynamic_balanced_f20_w3 <- dataset_trunc
# 
# dataset_success <- aggregate_not_dynamic_not_balanced_f22_w3[aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==1,]
# dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_w3[aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==2,]
# dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_w3[aggregate_not_dynamic_not_balanced_f22_w3$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# aggregate_not_dynamic_balanced_f22_w3 <- dataset_trunc
# 
# # sanity check
# ncol(aggregate_not_dynamic_balanced_f20_w3)
# ncol(aggregate_not_dynamic_balanced_f22_w3)

dataset_success <- aggregate_not_dynamic_not_balanced_f20_w4[aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_w4[aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_w4[aggregate_not_dynamic_not_balanced_f20_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f20_w4 <- dataset_trunc

dataset_success <- aggregate_not_dynamic_not_balanced_f22_w4[aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_w4[aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_w4[aggregate_not_dynamic_not_balanced_f22_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f22_w4 <- dataset_trunc

# sanity check
ncol(aggregate_not_dynamic_balanced_f20_w4)
ncol(aggregate_not_dynamic_balanced_f22_w4)

dataset_success <- aggregate_not_dynamic_not_balanced_f20_w5[aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_w5[aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_w5[aggregate_not_dynamic_not_balanced_f20_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f20_w5 <- dataset_trunc

dataset_success <- aggregate_not_dynamic_not_balanced_f22_w5[aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_w5[aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_w5[aggregate_not_dynamic_not_balanced_f22_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f22_w5 <- dataset_trunc

# sanity check
ncol(aggregate_not_dynamic_balanced_f20_w5)
ncol(aggregate_not_dynamic_balanced_f22_w5)

# dataset_success <- aggregate_not_dynamic_not_balanced_f20_w6[aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==1,]
# dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_w6[aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==2,]
# dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_w6[aggregate_not_dynamic_not_balanced_f20_w6$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# aggregate_not_dynamic_balanced_f20_w6 <- dataset_trunc
# 
# dataset_success <- aggregate_not_dynamic_not_balanced_f22_w6[aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==1,]
# dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_w6[aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==2,]
# dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_w6[aggregate_not_dynamic_not_balanced_f22_w6$SUCCESS==3,]
# 
# dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
# table(dataset_trunc$SUCCESS) # more balanced
# 
# aggregate_not_dynamic_balanced_f22_w6 <- dataset_trunc
# 
# # sanity check
# ncol(aggregate_not_dynamic_balanced_f20_w6)
# ncol(aggregate_not_dynamic_balanced_f22_w6)

dataset_success <- aggregate_not_dynamic_not_balanced_f20_w7[aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f20_w7[aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f20_w7[aggregate_not_dynamic_not_balanced_f20_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f20_w7 <- dataset_trunc

dataset_success <- aggregate_not_dynamic_not_balanced_f22_w7[aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==1,]
dataset_not_success <- aggregate_not_dynamic_not_balanced_f22_w7[aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==2,]
dataset_struggling <- aggregate_not_dynamic_not_balanced_f22_w7[aggregate_not_dynamic_not_balanced_f22_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_not_dynamic_balanced_f22_w7 <- dataset_trunc

# sanity check
ncol(aggregate_not_dynamic_balanced_f20_w7)
ncol(aggregate_not_dynamic_balanced_f22_w7)


# NOT AGRREGATE, DYNAMIC, BALANCED

# ALL

dataset_success <- not_aggregate_dynamic_not_balanced_f20_all[not_aggregate_dynamic_not_balanced_f20_all$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f20_all[not_aggregate_dynamic_not_balanced_f20_all$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f20_all[not_aggregate_dynamic_not_balanced_f20_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f20_all <- dataset_trunc

dataset_success <- not_aggregate_dynamic_not_balanced_f22_all[not_aggregate_dynamic_not_balanced_f22_all$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f22_all[not_aggregate_dynamic_not_balanced_f22_all$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f22_all[not_aggregate_dynamic_not_balanced_f22_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f20_all <- dataset_trunc

# a few adjustments, since LDA cannot handle this dataset..
df <- not_aggregate_dynamic_balanced_f20_all
new <- df[,apply(df, 2, var, na.rm=TRUE) != 0]
names(new)
table(not_aggregate_dynamic_balanced_f20_all$ethnic_cd)
table(not_aggregate_dynamic_balanced_f20_all$citizen_status_cd.3)
table(not_aggregate_dynamic_balanced_f20_all$Q1Genetics..BA.)
table(not_aggregate_dynamic_balanced_f20_all$Q1Mathematics..BA.or.BS.)
table(not_aggregate_dynamic_balanced_f20_all$Q1Cell.Biology.and.Neuroscience..BA.) ## CONSTANT??
table(not_aggregate_dynamic_balanced_f20_all$Q1Mathematics..Actuarial..BA.)
table(not_aggregate_dynamic_balanced_f20_all$Q1Political.Science..BA.)
table(not_aggregate_dynamic_balanced_f20_all$Q1Statistics.Mathematics..BA.)



names(not_aggregate_dynamic_balanced_f20_all)

drops <- c("ethnic_cd", "Q1Genetics..BA.", "citizen_status_cd.3", "Q1Mathematics..BA.or.BS.","Q1Cell.Biology.and.Neuroscience..BA.", "Q1Mathematics..Actuarial..BA.","Q1Political.Science..BA.","Q1Statistics.Mathematics..BA.")
test <- not_aggregate_dynamic_balanced_f20_all[ , !(names(not_aggregate_dynamic_balanced_f20_all) %in% drops)]
not_aggregate_dynamic_balanced_f20_all <- test

test <- not_aggregate_dynamic_not_balanced_f22_all[ , !(names(not_aggregate_dynamic_not_balanced_f22_all) %in% drops)]
not_aggregate_dynamic_not_balanced_f22_all <- test

# THIS IS OPTIONAL BECAUSE WE USE NOT BALANCED TEST SET
test <- not_aggregate_dynamic_balanced_f22_all[ , !(names(not_aggregate_dynamic_balanced_f22_all) %in% drops)]
not_aggregate_dynamic_balanced_f22_all <- test

# sanity check: 
ncol(not_aggregate_dynamic_balanced_f20_all)
ncol(not_aggregate_dynamic_not_balanced_f22_all)


# W4

dataset_success <- not_aggregate_dynamic_not_balanced_f20_w4[not_aggregate_dynamic_not_balanced_f20_w4$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f20_w4[not_aggregate_dynamic_not_balanced_f20_w4$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f20_w4[not_aggregate_dynamic_not_balanced_f20_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f20_w4 <- dataset_trunc

dataset_success <- not_aggregate_dynamic_not_balanced_f22_w4[not_aggregate_dynamic_not_balanced_f22_w4$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f22_w4[not_aggregate_dynamic_not_balanced_f22_w4$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f22_w4[not_aggregate_dynamic_not_balanced_f22_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f22_w4 <- dataset_trunc

# sanity check
ncol(not_aggregate_dynamic_balanced_f20_w4)
ncol(not_aggregate_dynamic_balanced_f22_w4)

dataset_success <- not_aggregate_dynamic_not_balanced_f20_w5[not_aggregate_dynamic_not_balanced_f20_w5$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f20_w5[not_aggregate_dynamic_not_balanced_f20_w5$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f20_w5[not_aggregate_dynamic_not_balanced_f20_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f20_w5 <- dataset_trunc

dataset_success <- not_aggregate_dynamic_not_balanced_f22_w5[not_aggregate_dynamic_not_balanced_f22_w5$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f22_w5[not_aggregate_dynamic_not_balanced_f22_w5$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f22_w5[not_aggregate_dynamic_not_balanced_f22_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f22_w5 <- dataset_trunc

# sanity check
ncol(not_aggregate_dynamic_balanced_f20_w5)
ncol(not_aggregate_dynamic_balanced_f22_w5)

# W7

names(not_aggregate_dynamic_not_balanced_f20_w7)

table(not_aggregate_dynamic_not_balanced_f20_w7$ethnic_cdN)
table(not_aggregate_dynamic_not_balanced_f20_w7$sending_school_type_cd.6)
table(not_aggregate_dynamic_not_balanced_f20_w7$Q1Economics)
table(not_aggregate_dynamic_not_balanced_f20_w7$Q1Undecided)

drops <- c("ethnic_cdN")
test <- not_aggregate_dynamic_not_balanced_f20_w7[ , !(names(not_aggregate_dynamic_not_balanced_f20_w7) %in% drops)]
not_aggregate_dynamic_not_balanced_f20_w7 <- test

test <- not_aggregate_dynamic_not_balanced_f22_w7[ , !(names(not_aggregate_dynamic_not_balanced_f22_w7) %in% drops)]
not_aggregate_dynamic_not_balanced_f22_w7 <- test

dataset_success <- not_aggregate_dynamic_not_balanced_f20_w7[not_aggregate_dynamic_not_balanced_f20_w7$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f20_w7[not_aggregate_dynamic_not_balanced_f20_w7$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f20_w7[not_aggregate_dynamic_not_balanced_f20_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f20_w7 <- dataset_trunc

dataset_success <- not_aggregate_dynamic_not_balanced_f22_w7[not_aggregate_dynamic_not_balanced_f22_w7$SUCCESS==1,]
dataset_not_success <- not_aggregate_dynamic_not_balanced_f22_w7[not_aggregate_dynamic_not_balanced_f22_w7$SUCCESS==2,]
dataset_struggling <- not_aggregate_dynamic_not_balanced_f22_w7[not_aggregate_dynamic_not_balanced_f22_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

not_aggregate_dynamic_balanced_f22_w7 <- dataset_trunc

# sanity check
ncol(not_aggregate_dynamic_balanced_f20_w7)
ncol(not_aggregate_dynamic_balanced_f22_w7)

# AGGREGATE, DYNAMIC, BALANCED

# ALL
# aggregate_dynamic_not_balanced_f20_all
dataset_success <- aggregate_dynamic_not_balanced_f20_all[aggregate_dynamic_not_balanced_f20_all$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f20_all[aggregate_dynamic_not_balanced_f20_all$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f20_all[aggregate_dynamic_not_balanced_f20_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f20_all <- dataset_trunc

dataset_success <- aggregate_dynamic_not_balanced_f22_all[aggregate_dynamic_not_balanced_f22_all$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f22_all[aggregate_dynamic_not_balanced_f22_all$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f22_all[aggregate_dynamic_not_balanced_f22_all$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f22_all <- dataset_trunc

# sanity check
ncol(aggregate_dynamic_balanced_f20_all)
ncol(aggregate_dynamic_balanced_f22_all)


# W4

dataset_success <- aggregate_dynamic_not_balanced_f20_w4[aggregate_dynamic_not_balanced_f20_w4$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f20_w4[aggregate_dynamic_not_balanced_f20_w4$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f20_w4[aggregate_dynamic_not_balanced_f20_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f20_w4 <- dataset_trunc

dataset_success <- aggregate_dynamic_not_balanced_f22_w4[aggregate_dynamic_not_balanced_f22_w4$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f22_w4[aggregate_dynamic_not_balanced_f22_w4$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f22_w4[aggregate_dynamic_not_balanced_f22_w4$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f22_w4 <- dataset_trunc

# sanity check
ncol(aggregate_dynamic_balanced_f20_w4)
ncol(aggregate_dynamic_balanced_f22_w4)

dataset_success <- aggregate_dynamic_not_balanced_f20_w5[aggregate_dynamic_not_balanced_f20_w5$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f20_w5[aggregate_dynamic_not_balanced_f20_w5$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f20_w5[aggregate_dynamic_not_balanced_f20_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f20_w5 <- dataset_trunc

dataset_success <- aggregate_dynamic_not_balanced_f22_w5[aggregate_dynamic_not_balanced_f22_w5$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f22_w5[aggregate_dynamic_not_balanced_f22_w5$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f22_w5[aggregate_dynamic_not_balanced_f22_w5$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f22_w5 <- dataset_trunc

# sanity check
ncol(aggregate_dynamic_balanced_f20_w5)
ncol(aggregate_dynamic_balanced_f22_w5)

dataset_success <- aggregate_dynamic_not_balanced_f20_w7[aggregate_dynamic_not_balanced_f20_w7$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f20_w7[aggregate_dynamic_not_balanced_f20_w7$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f20_w7[aggregate_dynamic_not_balanced_f20_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f20_w7 <- dataset_trunc

dataset_success <- aggregate_dynamic_not_balanced_f22_w7[aggregate_dynamic_not_balanced_f22_w7$SUCCESS==1,]
dataset_not_success <- aggregate_dynamic_not_balanced_f22_w7[aggregate_dynamic_not_balanced_f22_w7$SUCCESS==2,]
dataset_struggling <- aggregate_dynamic_not_balanced_f22_w7[aggregate_dynamic_not_balanced_f22_w7$SUCCESS==3,]

dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 50), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

aggregate_dynamic_balanced_f22_w7 <- dataset_trunc

# sanity check
ncol(aggregate_dynamic_balanced_f20_w7)
ncol(aggregate_dynamic_balanced_f22_w7)

ncol(aggregate_dynamic_not_balanced_f20_w7)
ncol(aggregate_dynamic_not_balanced_f22_w7)

names(aggregate_dynamic_not_balanced_f22_w7)
aggregate_dynamic_not_balanced_f22_w7



# NOW, BUILD THE DATASETS

dynamic_ft <- TRUE # true add autolab/dyn features, false: just static features
balanced <- TRUE # balanced dataset or not
aggregate <- TRUE # use aggregate features or not

all_ft <- FALSE
pred_ft <- FALSE
w3_ft <- FALSE
w4_ft <- FALSE
w5_ft <- FALSE
w6_ft <- FALSE
w7_ft <- TRUE
w8_ft <- FALSE

# choose training/test set accordingly

#####################################################################
#
#     IMPOPRTANT NOTE: TEST DATA DOES NOT HAVE TO BE BALANCED!!   #
#
#####################################################################

#####################
#    ALL FEATURES!!
#####################


# NOT BALANCED

#not_aggregate_static_not_balanced_f20_all_ft <- data_common_columns_f20_normalized
#not_aggregate_static_not_balanced_f22_all_ft <- data_common_columns_f22_normalized

# sanity check: need to have the same number of columns
#ncol(not_aggregate_static_not_balanced_f20_all_ft)
#ncol(not_aggregate_static_not_balanced_f22_all_ft)

#not_aggregate_dynamic_not_balanced_f20_all_ft <- data_common_columns_f20_a_normalized
#not_aggregate_dynamic_not_balanced_f22_all_ft <- data_common_columns_f22_a_normalized

# sanity check: need to have the same number of columns
#ncol(not_aggregate_dynamic_not_balanced_f20_all_ft)
#ncol(not_aggregate_dynamic_not_balanced_f22_all_ft)

#aggregate_static_not_balanced_f20_all_ft <- aggregate_features_data_common_columns_f20_normalized_all
#aggregate_static_not_balanced_f22_all_ft <- aggregate_features_data_common_columns_f22_normalized_all

# sanity check: need to have the same number of columns
#ncol(aggregate_static_not_balanced_f20_all_ft)
#ncol(aggregate_static_not_balanced_f22_all_ft)

#aggregate_dynamic_not_balanced_f20_all_ft <- aggregate_features_data_common_columns_f20_a_normalized_all
#aggregate_dynamic_not_balanced_f22_all_ft <- aggregate_features_data_common_columns_f22_a_normalized_all

# sanity check: need to have the same number of columns
#ncol(aggregate_dynamic_not_balanced_f20_all_ft)
#ncol(aggregate_dynamic_not_balanced_f22_all_ft)





# BALANCED

#not_aggregate_static_balanced_f20_all_ft <- data_common_columns_f20_normalized_all_balanced
#not_aggregate_static_balanced_f22_all_ft <- data_common_columns_f22_normalized

# #sanity check
# ncol(not_aggregate_static_balanced_f20_all_ft)
# ncol(not_aggregate_static_balanced_f22_all_ft)

#not_aggregate_dynamic_balanced_f20_all_ft <- data_common_columns_f20_a_normalized_all_balanced
#not_aggregate_dynamic_balanced_f22_all_ft <- data_common_columns_f22_a_normalized

# # sanity check
# ncol(not_aggregate_dynamic_balanced_f20_all_ft)
# ncol(not_aggregate_dynamic_balanced_f22_all_ft)

#aggregate_static_balanced_f20_all_ft <- aggregate_features_data_common_columns_f20_normalized_all_balanced
#aggregate_static_balanced_f22_all_ft <- aggregate_features_data_common_columns_f22_normalized_all

# # sanity check
# ncol(aggregate_static_balanced_f20_all_ft)
# ncol(aggregate_static_balanced_f22_all_ft)

#aggregate_dynamic_balanced_f20_all_ft <- aggregate_features_data_common_columns_f20_a_normalized_all_balanced
#aggregate_dynamic_balanced_f22_all_ft <- aggregate_features_data_common_columns_f22_a_normalized_all

# sanity check
#ncol(aggregate_dynamic_balanced_f20_all_ft)
#ncol(aggregate_dynamic_balanced_f22_all_ft)


##################################
#    W4 FEATURES!!
##################################


# NOT BALANCED

# not_aggregate_static_not_balanced_f20_w4_ft <- data_common_columns_f20_normalized
# not_aggregate_static_not_balanced_f22_w4_ft <- data_common_columns_f22_normalized
# 
# # sanity check: need to have the same number of columns
# #ncol(not_aggregate_static_not_balanced_f20_w4_ft)
# #ncol(not_aggregate_static_not_balanced_f22_w4_ft)
# 
# not_aggregate_dynamic_not_balanced_f20_w4_ft <- data_common_columns_f20_a_normalized
# not_aggregate_dynamic_not_balanced_f22_w4_ft <- data_common_columns_f22_a_normalized
# 
# # sanity check: need to have the same number of columns
# #ncol(not_aggregate_dynamic_not_balanced_f20_w4_ft)
# #ncol(not_aggregate_dynamic_not_balanced_f22_w4_ft)
# 
# aggregate_static_not_balanced_f20_w4_ft <- aggregate_features_data_common_columns_f20_normalized_all
# aggregate_static_not_balanced_f22_w4_ft <- aggregate_features_data_common_columns_f22_normalized_all
# 
# # sanity check: need to have the same number of columns
# #ncol(aggregate_static_not_balanced_f20_w4_ft)
# #ncol(aggregate_static_not_balanced_f22_w4_ft)
# 
# aggregate_dynamic_not_balanced_f20_w4_ft <- aggregate_features_data_common_columns_f20_a_normalized_all
# aggregate_dynamic_not_balanced_f22_w4_ft <- aggregate_features_data_common_columns_f22_a_normalized_all
# 
# # sanity check: need to have the same number of columns
# #ncol(aggregate_dynamic_not_balanced_f20_w4_ft)
# #ncol(aggregate_dynamic_not_balanced_f22_w4_ft)
# 
# 
# 
# 
# 
# # BALANCED
# 
# not_aggregate_static_balanced_f20_w4_ft <- data_common_columns_f20_normalized_all_balanced
# not_aggregate_static_balanced_f22_w4_ft <- data_common_columns_f22_normalized
# 
# # #sanity check
# # ncol(not_aggregate_static_balanced_f20_w4_ft)
# # ncol(not_aggregate_static_balanced_f22_w4_ft)
# 
# not_aggregate_dynamic_balanced_f20_w4_ft <- data_common_columns_f20_a_normalized_all_balanced
# not_aggregate_dynamic_balanced_f22_w4_ft <- data_common_columns_f22_a_normalized
# 
# # # sanity check
# # ncol(not_aggregate_dynamic_balanced_f20_w4_ft)
# # ncol(not_aggregate_dynamic_balanced_f22_w4_ft)
# 
# aggregate_static_balanced_f20_w4_ft <- aggregate_features_data_common_columns_f20_normalized_all_balanced
# aggregate_static_balanced_f22_w4_ft <- aggregate_features_data_common_columns_f22_normalized_all
# 
# # # sanity check
# # ncol(aggregate_static_balanced_f20_w4_ft)
# # ncol(aggregate_static_balanced_f22_w4_ft)
# 
# aggregate_dynamic_balanced_f20_w4_ft <- aggregate_features_data_common_columns_f20_a_normalized_all_balanced
# aggregate_dynamic_balanced_f22_w4_ft <- aggregate_features_data_common_columns_f22_a_normalized_all
# 
# # sanity check
# ncol(aggregate_dynamic_balanced_f20_w4_ft)
# ncol(aggregate_dynamic_balanced_f22_w4_ft)




#table(aggregate_features_data_common_columns_f20_a_normalized_all$SUCCESS)


# CHOOSE TRAINING AND TEST SET BASED ON PARAMETERS

if(aggregate & balanced & !dynamic_ft) { 
  print("Aggregate, Balanced, Static") 
  if(all_ft) {
    print("ALL FEATURES")
    #data_training <- aggregate_features_data_common_columns_f20_normalized_all_balanced
    #data_testing <- aggregate_features_data_common_columns_f22_normalized_all # no need for test data to be balanced
    data_training <- aggregate_not_dynamic_balanced_f20_all
    data_testing <- aggregate_not_dynamic_not_balanced_f22_all
  }
  
  if(w3_ft){
    print("W3 FEATURES")
    #data_training <- aggregate_features_f20_w3_balanced
    #data_testing <- aggregate_features_f22_w3 # no need for test data to be balanced
    data_training <- aggregate_not_dynamic_balanced_f20_w3
    data_testing <- aggregate_not_dynamic_not_balanced_f22_w3
  }
  if(w4_ft){
    print("W4 FEATURES")
    #data_training <- aggregate_features_f20_w4_balanced
    #data_testing <- aggregate_features_f22_w4 # no need for test data to be balanced
    data_training <- aggregate_not_dynamic_balanced_f20_w4
    data_testing <- aggregate_not_dynamic_not_balanced_f22_w4
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
  }  
  
  if(w5_ft){
    print("W5 FEATURES")
    #data_training <- aggregate_features_f20_w5_balanced
    #data_testing <- aggregate_features_f22_w5 # no need for test data to be balanced
    data_training <- aggregate_not_dynamic_balanced_f20_w5
    data_testing <- aggregate_not_dynamic_not_balanced_f22_w5
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
    
  }
  
  if(w6_ft){
    print("W6 FEATURES")
    data_training <- aggregate_not_dynamic_balanced_f20_w6
    data_testing <- aggregate_not_dynamic_not_balanced_f22_w6 # no need for test data to be balanced
  }
  if(w7_ft){
    print("W7 FEATURES")
    data_training <- aggregate_not_dynamic_balanced_f20_w7
    data_testing <- aggregate_not_dynamic_not_balanced_f22_w7 # no need for test data to be balanced
  }
  
} else if (!aggregate & balanced & !dynamic_ft) { 
  print("Not Aggregate, Balanced, and Static") 
  if(all_ft) {
    print("ALL FEATURES")
    #data_training <- data_common_columns_f20_normalized_all_balanced
    #data_testing <- data_common_columns_f22_normalized # no need for test data to be balanced
    data_training <- not_aggregate_not_dynamic_balanced_f20_all
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_all
  }
  
  if(w3_ft){
    print("W3 FEATURES")
    #data_training <- features_f20_w3_balanced
    #data_testing <- features_f22_w3 # no need for test data to be balanced
    data_training <-not_aggregate_not_dynamic_balanced_f20_w3
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_w3
  }
  if(w4_ft){
    print("W4 FEATURES")
    data_training <- not_aggregate_not_dynamic_balanced_f20_w4
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_w4 # no need for test data to be balanced
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
    
  }  
  
  if(w5_ft){
    print("W5 FEATURES")
    data_training <- not_aggregate_not_dynamic_balanced_f20_w5
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_w5 # no need for test data to be balanced
  }
  
  if(w6_ft){
    print("W6 FEATURES")
    data_training <- not_aggregate_not_dynamic_balanced_f20_w6
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_w6 # no need for test data to be balanced
  }
  if(w7_ft){
    print("W7 FEATURES")
    data_training <- not_aggregate_not_dynamic_balanced_f20_w7
    data_testing <- not_aggregate_not_dynamic_not_balanced_f22_w7 # no need for test data to be balanced
  }
}  else if (!aggregate & balanced & dynamic_ft ){
  print("Not Aggregate, Balanced, and Dynamic") 
  if(all_ft) {
    print("ALL FEATURES.")
    data_training <- not_aggregate_dynamic_balanced_f20_all
    data_testing <- not_aggregate_dynamic_not_balanced_f22_all
    #data_training <- data_common_columns_f20_a_normalized_all_balanced
    #data_testing <- data_common_columns_f22_a_normalized # no need for test data to be balanced
    #data_training <- not_aggregate_dynamic_balanced_f20
  }
  
  if(w3_ft){
    print("W3 FEATURES. NO DATA. ONLY W4, W5, W7.")
    #data_training <- features_f20_w3_a_balanced
    #data_testing <- features_f22_a_w3 # no need for test data to be balanced
  }
  if(w4_ft){
    print("W4 FEATURES")
    
    drops = c("Q35Very.Easy")
    test <- not_aggregate_dynamic_balanced_f20_w4[ , !(names(not_aggregate_dynamic_balanced_f20_w4) %in% drops)]
    not_aggregate_dynamic_balanced_f20_w4 <- test
    test <- not_aggregate_dynamic_not_balanced_f22_w4[ , !(names(not_aggregate_dynamic_not_balanced_f22_w4) %in% drops)]
    not_aggregate_dynamic_not_balanced_f22_w4 <- test
    
    data_training <- not_aggregate_dynamic_balanced_f20_w4
    data_testing <- not_aggregate_dynamic_not_balanced_f22_w4 # no need for test data to be balanced
  }  
  
  if(w5_ft){
    print("W5 FEATURES")
    data_training <- not_aggregate_dynamic_balanced_f20_w5
    data_testing <- not_aggregate_dynamic_not_balanced_f22_w5 # no need for test data to be balanced
  }
  
  if(w6_ft){
    print("W6 FEATURES. NOT DONE.")
    #data_training <- features_f20_w6_a_balanced
    #data_testing <- features_f22_a_w6 # no need for test data to be balanced
  }
  if(w7_ft){
    print("W7 FEATURES")
    data_training <- not_aggregate_dynamic_balanced_f20_w7
    data_testing <- not_aggregate_dynamic_not_balanced_f22_w7 # no need for test data to be balanced
  }
  
}  else if(aggregate & balanced & dynamic_ft) {
  print("Aggregate, Balanced, Dynamic")
  if(all_ft) {
    print("ALL FEATURES.")
    data_training <- aggregate_dynamic_balanced_f20_all
    data_testing <- aggregate_dynamic_not_balanced_f22_all # no need for test data to be balanced
    #data_training <- aggregate_dynamic_
  }
  
  if(w3_ft){
    print("W3 FEATURES. NOT DONE.")
    #data_training <- aggregate_features_f20_w3_a_balanced
    #data_testing <- aggregate_features_f22_a_w3 # no need for test data to be balanced
  }
  if(w4_ft){
    print("W4 FEATURES")
    data_training <- aggregate_dynamic_balanced_f20_w4
    data_testing <- aggregate_dynamic_not_balanced_f22_w4 # no need for test data to be balanced
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
    
  }  
  
  if(w5_ft){
    print("W5 FEATURES")
    data_training <- aggregate_dynamic_balanced_f20_w5
    data_testing <- aggregate_dynamic_not_balanced_f22_w5 # no need for test data to be balanced
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
    
  }
  
  if(w6_ft){
    print("W6 FEATURES. NOT DONE")
    #data_training <- aggregate_features_f20_w6_a_balanced
    #data_testing <- aggregate_features_f22_a_w6 # no need for test data to be balanced
  }
  if(w7_ft){
    print("W7 FEATURES")
    data_training <- aggregate_dynamic_balanced_f20_w7
    data_testing <- aggregate_dynamic_not_balanced_f22_w7 # no need for test data to be balanced
    data_training$SUCCESS <- as.factor(data_training$SUCCESS)
    data_testing$SUCCESS <- as.factor(data_testing$SUCCESS)
    
  }
} else {
  print("Nothing.")
}

names(data_testing)
names(data_training)

str(data_training)

train_finalPoints <- data_training$Final.Points
test_finalPoints <- data_testing$Final.Points

drops = c("Final.Points","sending_school_type_cd.2", "Q2Other..please.explain", "Q1Biological.Sciences..BA.", "Q1Genetics..BA.")
data_training <- data_training[ , !(names(data_training) %in% drops)]
data_testing <- data_testing[ , !(names(data_testing) %in% drops)]


#drops = c("sending_school_type_cd.2", "Q2Other..please.explain", "Q1Biological.Sciences..BA.", "Q1Genetics..BA.")
#data_training <- data_training[ , !(names(data_training) %in% drops)]
#data_testing <- data_testing[ , !(names(data_testing) %in% drops)]

names(data_training)
library(caret)

# range of scores for struggling students
min_points_struggling <- 600
max_points_struggling <- 750


all_ft_pseudosens_lda <- list()
all_ft_pseudosens_knn <- list()
all_ft_pseudosens_svm <- list()
all_ft_pseudosens_cart <- list()
all_ft_pseudosens_rf <- list()


all_ft_sensitivities_lda <- list()
all_ft_sensitivities_lda_c1 <- list()
all_ft_sensitivities_lda_c2 <- list()
all_ft_sensitivities_lda_c3 <- list()

all_ft_sensitivities_knn <- list()
all_ft_sensitivities_knn_c1 <- list()
all_ft_sensitivities_knn_c2 <- list()
all_ft_sensitivities_knn_c3 <- list()

all_ft_sensitivities_svm <- list()
all_ft_sensitivities_svm_c1 <- list()
all_ft_sensitivities_svm_c2 <- list()
all_ft_sensitivities_svm_c3 <- list()

all_ft_sensitivities_cart <- list()
all_ft_sensitivities_cart_c1 <- list()
all_ft_sensitivities_cart_c2 <- list()
all_ft_sensitivities_cart_c3 <- list()

all_ft_sensitivities_rf <- list()
all_ft_sensitivities_rf_c1 <- list()
all_ft_sensitivities_rf_c2 <- list()
all_ft_sensitivities_rf_c3 <- list()


all_ft_specificities_lda <- list()
all_ft_specificities_lda_c1 <- list()
all_ft_specificities_lda_c2 <- list()
all_ft_specificities_lda_c3 <- list()

all_ft_specificities_knn <- list()
all_ft_specificities_knn_c1 <- list()
all_ft_specificities_knn_c2 <- list()
all_ft_specificities_knn_c3 <- list()

all_ft_specificities_svm <- list()
all_ft_specificities_svm_c1 <- list()
all_ft_specificities_svm_c2 <- list()
all_ft_specificities_svm_c3 <- list()

all_ft_specificities_cart <- list()
all_ft_specificities_cart_c1 <- list()
all_ft_specificities_cart_c2 <- list()
all_ft_specificities_cart_c3 <- list()

all_ft_specificities_rf <- list()
all_ft_specificities_rf_c1 <- list()
all_ft_specificities_rf_c2 <- list()
all_ft_specificities_rf_c3 <- list()

all_accuracy_lda <- list()
all_accuracy_knn <- list()
all_accuracy_svm <- list()
all_accuracy_cart <- list()
all_accuracy_rf <- list()

counter <- 0

#str(data_testing)

data_f20_saved <- data_training

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  counter <- counter+1
  print(counter)
  data_f20 <- data_training
  
  if (counter>9){
    break
  }
  
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  #validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  #validation <- data_f20[-validation_index,]
  # select Spring 2021 as data for validation
  validation <- data_testing # this has been set to data from spring 21
  
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  #data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output I.E Independent and Dependent Variables
  
  x<- data_training[, !names(data_training) %in% c("SUCCESS")]
  y <- data_training[,names(data_training) %in% c("SUCCESS")]
  
  # Need to check for correlated features in training data
  cor_matrix_a <- cor(x)
  indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
  
  remove_corrs <- x[-c(indexes_to_drop)]
  x <- remove_corrs
  
  # Double check ...
  
  cor_matrix_a <- cor(x)
  indexes_to_drop <- findCorrelation(cor_matrix_a, cutoff = 0.70)
  
  
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  #fit.lda <- train(SUCCESS~., data=dataset_clean, method="lda", metric=metric, trControl=control)
  
  # crxCV.lda <- lda(V16 ~ ., data = crxRed, CV = TRUE)
  #crx.glm <- glm(SUCCESS ~ ., data = dataset_clean, family = binomial, na.action = na.exclude)
  #vif(crx.glm)
  # check for near zero variance, according to Chat
  
  #library(caret)
  nzv_indices <- nearZeroVar(dataset, saveMetrics = FALSE)  # Get indices of near-zero variance variables
  
  # Get the names of these variables
  nzv_names <- names(dataset)[nzv_indices]
  
  # Print the list of near-zero variance variable names
  #print(nzv_names)
  
  dataset_clean <- dataset[, -nzv_indices]
  
  
  # check for collinearity
  
  # Check the rank of the dataset
  #print(qr(model.matrix(SUCCESS ~ ., data = dataset_clean))$rank)
  #print(ncol(dataset_clean))
  # different numbers, means that collinearity exists
  
  #print(qr(model.matrix(x))$rank)
  #print(ncol(dataset_clean))
  
  # ensure no two columns are duplicates
  #dup_vars <- names(dataset_clean)[duplicated(as.list(dataset_clean))]
  #print(dup_vars)
  
  #  Check for linear dependencies
  #linear_dep <- x[,60:72]
  #cors <- cor(linear_dep)
  #ld_vars <- findLinearCombos(model.matrix(SUCCESS ~ ., data = dataset_clean))
  #ld_vars <- findLinearCombos(x)
  
  # Print the variables causing issues
  #print(ld_vars)
  
  #names(dataset_clean)
  
  # Remove the problematic variables
  #if (!is.null(ld_vars$remove)) {
  #  dataset_clean <- dataset_clean[, -ld_vars$remove]
  #}
  
  
  # a) linear algorithm
  set.seed(sample(1:100, 1))
  #fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  fit.lda <- train(SUCCESS~., data=dataset_clean, method="lda", metric=metric, trControl=control)
  
  # b) nonlinear algorithms
  # CART
  set.seed(sample(1:100, 1))
  #fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  fit.cart <- train(SUCCESS~., data=dataset, method="rpart", metric=metric, trControl=control)
  
  
  # kNN
  set.seed(sample(1:100, 1))
  #fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  fit.knn <- train(SUCCESS~., data=dataset, method="knn", metric=metric, trControl=control)
  
  
  # c) advanced algorithms
  # SVM
  set.seed(sample(1:100, 1))
  #fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  fit.svm <- train(SUCCESS~., data=dataset, method="svmRadial", metric=metric, trControl=control)
  
  
  # Random Forest
  set.seed(sample(1:100, 1))
  #fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  fit.rf <- train(SUCCESS~., data=dataset, method="rf", metric=metric, trControl=control)
  
  
  
  #plot(fit.rf)
  #ADD ACCURACIES
  
  all_accuracy_lda <- append(all_accuracy_lda,mean(fit.lda$resample$Accuracy))
  all_accuracy_knn <- append(all_accuracy_knn,mean(fit.knn$resample$Accuracy))
  all_accuracy_cart <- append(all_accuracy_cart,mean(fit.cart$resample$Accuracy))
  all_accuracy_svm <- append(all_accuracy_svm,mean(fit.svm$resample$Accuracy))
  all_accuracy_rf <- append(all_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  save_validation <- validation
  save_validation$SUCCESS
  
  validation_s <- validation$SUCCESS
  validation_success <- validation$SUCCESS
  
  validation$SUCCESS <- validation_success
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  #cm_lda <- confusionMatrix(predictions, data_testing$SUCCESS)
  
  struggling_by_points <- ((test_finalPoints >= min_points_struggling) & (test_finalPoints <= max_points_struggling))
  validation$SUCCESS[struggling_by_points]
  preds <- predictions[struggling_by_points]
  #pseudosensitivity <- (sum(preds == 3) / length(preds)) 
  all_ft_pseudosens_lda <- append(all_ft_pseudosens_lda, (sum(preds == 3) / length(preds)))
  
  # MISCLASSIFIED..
  
  misclass_indeces <- which(predictions != validation$SUCCESS)
  misclassified <- validation[misclass_indeces,]
  misclassified$PredSUCCESS <- predictions[misclass_indeces]
  misclassified$Final.Points <- test_finalPoints[misclass_indeces]
  
  # choose struggling students who are misclassified
  misclassified_struggling <- misclassified[misclassified$SUCCESS==3,]
  
  # write them in a file
  fname <- paste("LDA",counter,"StrugglingMisclassifiedLDA.csv", sep = "")
  write.csv(misclassified_struggling, fname, row.names = FALSE)
  
  if(nrow(misclassified_struggling)>0){
    # Save histogram into a file
    print("Writing LDA hist in file ...")
    fname = paste("H_LDA",counter,".png", sep="")
    png(filename=fname)
    hist(misclassified_struggling$Final.Point, xlab = 'Final Points', ylab = 'Count', main = 'Final Points of Misclassified Struggling Students (LDA)')
    dev.off()
  }
  
  
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  
  all_ft_sensitivities_lda <- append(all_ft_sensitivities_lda, lda_sens)
  all_ft_sensitivities_lda_c1 <- append(all_ft_sensitivities_lda_c1, lda_sens[[1]])
  all_ft_sensitivities_lda_c2 <- append(all_ft_sensitivities_lda_c2, lda_sens[[2]])
  all_ft_sensitivities_lda_c3 <- append(all_ft_sensitivities_lda_c3, lda_sens[[3]])
  
  all_ft_specificities_lda <- append(all_ft_specificities_lda, cm_lda$byClass[,"Specificity"])
  all_ft_specificities_lda_c1 <- append(all_ft_specificities_lda_c1, lda_spec[[1]])
  all_ft_specificities_lda_c2 <- append(all_ft_specificities_lda_c2, lda_spec[[2]])
  all_ft_specificities_lda_c3 <- append(all_ft_specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  # pseudospecificity...
  struggling_by_points <- ((test_finalPoints >= min_points_struggling) & (test_finalPoints <= max_points_struggling))
  validation$SUCCESS[struggling_by_points]
  preds <- predictions[struggling_by_points]
  all_ft_pseudosens_knn <- append(all_ft_pseudosens_knn, (sum(preds == 3) / length(preds)))
  
  
  # MISCLASSIFIED..
  
  misclass_indeces <- which(predictions != validation$SUCCESS)
  misclassified <- validation[misclass_indeces,]
  misclassified$PredSUCCESS <- predictions[misclass_indeces]
  misclassified$Final.Points <- test_finalPoints[misclass_indeces]
  
  # choose struggling students who are misclassified
  misclassified_struggling <- misclassified[misclassified$SUCCESS==3,]
  
  # write them in a file
  fname <- paste("KNN",counter,"StrugglingMisclassifiedKNN.csv", sep = "")
  write.csv(misclassified_struggling, fname, row.names = FALSE)
  
  # Save histogram into a file
  print("Writing KNN hist in file ...")
  
  fname = paste("H_KNN",counter,".png", sep="")
  png(filename=fname)
  hist(misclassified_struggling$Final.Point, xlab = 'Final Points', ylab = 'Count', main = 'Final Points of Misclassified Struggling Students (KNN)')
  dev.off()
  
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  all_ft_sensitivities_knn <- append(all_ft_sensitivities_knn, knn_sens)
  all_ft_sensitivities_knn_c1 <- append(all_ft_sensitivities_knn_c1, knn_sens[[1]])
  all_ft_sensitivities_knn_c2 <- append(all_ft_sensitivities_knn_c2, knn_sens[[2]])
  all_ft_sensitivities_knn_c3 <- append(all_ft_sensitivities_knn_c3, knn_sens[[3]])
  
  all_ft_specificities_knn <- append(all_ft_specificities_knn, cm_knn$byClass[,"Specificity"])
  all_ft_specificities_knn_c1 <- append(all_ft_specificities_knn_c1, knn_spec[[1]])
  all_ft_specificities_knn_c2 <- append(all_ft_specificities_knn_c2, knn_spec[[2]])
  all_ft_specificities_knn_c3 <- append(all_ft_specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  
  # pseudospecificity...
  struggling_by_points <- ((test_finalPoints >= min_points_struggling) & (test_finalPoints <= max_points_struggling))
  validation$SUCCESS[struggling_by_points]
  preds <- predictions[struggling_by_points]
  all_ft_pseudosens_svm <- append(all_ft_pseudosens_svm, (sum(preds == 3) / length(preds)))
  
  
  # MISCLASSIFIED..
  
  misclass_indeces <- which(predictions != validation$SUCCESS)
  misclassified <- validation[misclass_indeces,]
  misclassified$PredSUCCESS <- predictions[misclass_indeces]
  misclassified$Final.Points <- test_finalPoints[misclass_indeces]
  
  # choose struggling students who are misclassified
  misclassified_struggling <- misclassified[misclassified$SUCCESS==3,]
  
  # write them in a file
  fname <- paste("SVM",counter,"StrugglingMisclassifiedSVM.csv", sep = "")
  write.csv(misclassified_struggling, fname, row.names = FALSE)
  
  if(nrow(misclassified_struggling)>0){
    # Save histogram into a file
    print("Writing SVM hist in file ...")
    fname = paste("H_SVM",counter,".png", sep="")
    png(filename=fname)
    hist(misclassified_struggling$Final.Point, xlab = 'Final Points', ylab = 'Count', main = 'Final Points of Misclassified Struggling Students (SVM)')
    dev.off()
  }
  
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  all_ft_sensitivities_svm <- append(all_ft_sensitivities_svm, svm_sens)
  all_ft_sensitivities_svm_c1 <- append(all_ft_sensitivities_svm_c1, svm_sens[[1]])
  all_ft_sensitivities_svm_c2 <- append(all_ft_sensitivities_svm_c2, svm_sens[[2]])
  all_ft_sensitivities_svm_c3 <- append(all_ft_sensitivities_svm_c3, svm_sens[[3]])
  
  all_ft_specificities_svm <- append(all_ft_specificities_svm, cm_svm$byClass[,"Specificity"])
  all_ft_specificities_svm_c1 <- append(all_ft_specificities_svm_c1, svm_spec[[1]])
  all_ft_specificities_svm_c2 <- append(all_ft_specificities_svm_c2, svm_spec[[2]])
  all_ft_specificities_svm_c3 <- append(all_ft_specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  
  # pseudospecificity...
  struggling_by_points <- ((test_finalPoints >= min_points_struggling) & (test_finalPoints <= max_points_struggling))
  validation$SUCCESS[struggling_by_points]
  preds <- predictions[struggling_by_points]
  all_ft_pseudosens_cart <- append(all_ft_pseudosens_cart, (sum(preds == 3) / length(preds)))
  
  #count <- sum(struggling_by_points == TRUE)
  print("Number of struggling students by final points: ")
  sum(struggling_by_points == TRUE)
  
  # MISCLASSIFIED..
  
  misclass_indeces <- which(predictions != validation$SUCCESS)
  misclassified <- validation[misclass_indeces,]
  misclassified$PredSUCCESS <- predictions[misclass_indeces]
  misclassified$Final.Points <- test_finalPoints[misclass_indeces]
  
  # choose struggling students who are misclassified
  misclassified_struggling <- misclassified[misclassified$SUCCESS==3,]
  
  # write them in a file
  print("Writing CART hist in file ...")
  fname <- paste("CART",counter,"StrugglingMisclassifiedCART.csv", sep = "")
  write.csv(misclassified_struggling, fname, row.names = FALSE)
  
  # Save histogram into a file
  fname = paste("H_CART",counter,".png", sep="")
  png(filename=fname)
  hist(misclassified_struggling$Final.Point, xlab = 'Final Points', ylab = 'Count', main = 'Final Points of Misclassified Struggling Students (CART)')
  dev.off()
  
  
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  all_ft_sensitivities_cart <- append(all_ft_sensitivities_cart, cart_sens)
  all_ft_sensitivities_cart_c1 <- append(all_ft_sensitivities_cart_c1, cart_sens[[1]])
  all_ft_sensitivities_cart_c2 <- append(all_ft_sensitivities_cart_c2, cart_sens[[2]])
  all_ft_sensitivities_cart_c3 <- append(all_ft_sensitivities_cart_c3, cart_sens[[3]])
  
  all_ft_specificities_cart <- append(all_ft_specificities_cart, cm_cart$byClass[,"Specificity"])
  all_ft_specificities_cart_c1 <- append(all_ft_specificities_cart_c1, cart_spec[[1]])
  all_ft_specificities_cart_c2 <- append(all_ft_specificities_cart_c2, cart_spec[[2]])
  all_ft_specificities_cart_c3 <- append(all_ft_specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  
  # pseudospecificity...
  struggling_by_points <- ((test_finalPoints >= min_points_struggling) & (test_finalPoints <= max_points_struggling))
  validation$SUCCESS[struggling_by_points]
  preds <- predictions[struggling_by_points]
  all_ft_pseudosens_rf <- append(all_ft_pseudosens_rf, (sum(preds == 3) / length(preds)))
  
  
  # MISCLASSIFIED..
  
  misclass_indeces <- which(predictions != validation$SUCCESS)
  misclassified <- validation[misclass_indeces,]
  misclassified$PredSUCCESS <- predictions[misclass_indeces]
  misclassified$Final.Points <- test_finalPoints[misclass_indeces]
  
  # choose struggling students who are misclassified
  misclassified_struggling <- misclassified[misclassified$SUCCESS==3,]
  
  # write them in a file
  fname <- paste("RF",counter,"StrugglingMisclassifiedRF.csv", sep = "")
  write.csv(misclassified_struggling, fname, row.names = FALSE)
  
  if(nrow(misclassified_struggling)>0){
    # Save histogram into a file
    print("Writing RF hist in file ...")
    fname = paste("H_RF",counter,".png", sep="")
    png(filename=fname)
    hist(misclassified_struggling$Final.Point, xlab = 'Final Points', ylab = 'Count', main = 'Final Points of Misclassified Struggling Students (RF)')
    dev.off()
  }
  
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  all_ft_sensitivities_rf <- append(all_ft_sensitivities_rf, rf_sens)
  all_ft_sensitivities_rf_c1 <- append(all_ft_sensitivities_rf_c1, rf_sens[[1]])
  all_ft_sensitivities_rf_c2 <- append(all_ft_sensitivities_rf_c2, rf_sens[[2]])
  all_ft_sensitivities_rf_c3 <- append(all_ft_sensitivities_rf_c3, rf_sens[[3]])
  
  all_ft_specificities_rf <- append(all_ft_specificities_rf, cm_rf$byClass[,"Specificity"])
  all_ft_specificities_rf_c1 <- append(all_ft_specificities_rf_c1, rf_spec[[1]])
  all_ft_specificities_rf_c2 <- append(all_ft_specificities_rf_c2, rf_spec[[2]])
  all_ft_specificities_rf_c3 <- append(all_ft_specificities_rf_c3, rf_spec[[3]])
}
# END REPEAT!!

print("ACCURACIES")
print("MIN")
min(unlist(all_accuracy_lda))
min(unlist(all_accuracy_knn))
min(unlist(all_accuracy_svm))
min(unlist(all_accuracy_cart))
min(unlist(all_accuracy_rf))

print("MEAN")
mean(unlist(all_accuracy_lda))
mean(unlist(all_accuracy_knn))
mean(unlist(all_accuracy_svm))
mean(unlist(all_accuracy_cart))
mean(unlist(all_accuracy_rf))

print("MAX")
max(unlist(all_accuracy_lda))
max(unlist(all_accuracy_knn))
max(unlist(all_accuracy_svm))
max(unlist(all_accuracy_cart))
max(unlist(all_accuracy_rf))



print("MIN C1")
min(unlist(all_ft_sensitivities_lda_c1))
min(unlist(all_ft_sensitivities_knn_c1))
min(unlist(all_ft_sensitivities_svm_c1))
min(unlist(all_ft_sensitivities_cart_c1))
min(unlist(all_ft_sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_sensitivities_lda_c1))
mean(unlist(all_ft_sensitivities_knn_c1))
mean(unlist(all_ft_sensitivities_svm_c1))
mean(unlist(all_ft_sensitivities_cart_c1))
mean(unlist(all_ft_sensitivities_rf_c1))


print("MAX C1")
max(unlist(all_ft_sensitivities_lda_c1))
max(unlist(all_ft_sensitivities_knn_c1))
max(unlist(all_ft_sensitivities_svm_c1))
max(unlist(all_ft_sensitivities_cart_c1))
max(unlist(all_ft_sensitivities_rf_c1))

print("MIN C2")
min(unlist(all_ft_sensitivities_lda_c2))
min(unlist(all_ft_sensitivities_knn_c2))
min(unlist(all_ft_sensitivities_svm_c2))
min(unlist(all_ft_sensitivities_cart_c2))
min(unlist(all_ft_sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_sensitivities_lda_c2))
mean(unlist(all_ft_sensitivities_knn_c2))
mean(unlist(all_ft_sensitivities_svm_c2))
mean(unlist(all_ft_sensitivities_cart_c2))
mean(unlist(all_ft_sensitivities_rf_c2))


print("MAX C2")
max(unlist(all_ft_sensitivities_lda_c2))
max(unlist(all_ft_sensitivities_knn_c2))
max(unlist(all_ft_sensitivities_svm_c2))
max(unlist(all_ft_sensitivities_cart_c2))
max(unlist(all_ft_sensitivities_rf_c2))


print("MIN C3")
min(unlist(all_ft_sensitivities_lda_c3))
min(unlist(all_ft_sensitivities_knn_c3))
min(unlist(all_ft_sensitivities_svm_c3))
min(unlist(all_ft_sensitivities_cart_c3))
min(unlist(all_ft_sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_sensitivities_lda_c3))
mean(unlist(all_ft_sensitivities_knn_c3))
mean(unlist(all_ft_sensitivities_svm_c3))
mean(unlist(all_ft_sensitivities_cart_c3))
mean(unlist(all_ft_sensitivities_rf_c3))


print("MAX C3")
max(unlist(all_ft_sensitivities_lda_c3))
max(unlist(all_ft_sensitivities_knn_c3))
max(unlist(all_ft_sensitivities_svm_c3))
max(unlist(all_ft_sensitivities_cart_c3))
max(unlist(all_ft_sensitivities_rf_c3))

# Pseudosensitivities

print("PSEUDOSENSITIVITY MIN C3")
min(unlist(all_ft_pseudosens_lda))
min(unlist(all_ft_pseudosens_knn))
min(unlist(all_ft_pseudosens_svm))
min(unlist(all_ft_pseudosens_cart))
min(unlist(all_ft_pseudosens_rf))

print("PSEUDOSENSITIVITY MEAN C3")
mean(unlist(all_ft_pseudosens_lda))
mean(unlist(all_ft_pseudosens_knn))
mean(unlist(all_ft_pseudosens_svm))
mean(unlist(all_ft_pseudosens_cart))
mean(unlist(all_ft_pseudosens_rf))


print("PSEUDOSENSITIVITY MAX C3")
max(unlist(all_ft_pseudosens_lda))
max(unlist(all_ft_pseudosens_knn))
max(unlist(all_ft_pseudosens_svm))
max(unlist(all_ft_pseudosens_cart))
max(unlist(all_ft_pseudosens_rf))



print("SPECIFICITIES")

print("MIN C1")
min(unlist(all_ft_specificities_lda_c1))
min(unlist(all_ft_specificities_knn_c1))
min(unlist(all_ft_specificities_svm_c1))
min(unlist(all_ft_specificities_cart_c1))
min(unlist(all_ft_specificities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_specificities_lda_c1))
mean(unlist(all_ft_specificities_knn_c1))
mean(unlist(all_ft_specificities_svm_c1))
mean(unlist(all_ft_specificities_cart_c1))
mean(unlist(all_ft_specificities_rf_c1))


print("MAX C1")
max(unlist(all_ft_specificities_lda_c1))
max(unlist(all_ft_specificities_knn_c1))
max(unlist(all_ft_specificities_svm_c1))
max(unlist(all_ft_specificities_cart_c1))
max(unlist(all_ft_specificities_rf_c1))

print("MIN C2")
min(unlist(all_ft_specificities_lda_c2))
min(unlist(all_ft_specificities_knn_c2))
min(unlist(all_ft_specificities_svm_c2))
min(unlist(all_ft_specificities_cart_c2))
min(unlist(all_ft_specificities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_specificities_lda_c2))
mean(unlist(all_ft_specificities_knn_c2))
mean(unlist(all_ft_specificities_svm_c2))
mean(unlist(all_ft_specificities_cart_c2))
mean(unlist(all_ft_specificities_rf_c2))


print("MAX C2")
max(unlist(all_ft_specificities_lda_c2))
max(unlist(all_ft_specificities_knn_c2))
max(unlist(all_ft_specificities_svm_c2))
max(unlist(all_ft_specificities_cart_c2))
max(unlist(all_ft_specificities_rf_c2))


print("MIN C3")
min(unlist(all_ft_specificities_lda_c3))
min(unlist(all_ft_specificities_knn_c3))
min(unlist(all_ft_specificities_svm_c3))
min(unlist(all_ft_specificities_cart_c3))
min(unlist(all_ft_specificities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_specificities_lda_c3))
mean(unlist(all_ft_specificities_knn_c3))
mean(unlist(all_ft_specificities_svm_c3))
mean(unlist(all_ft_specificities_cart_c3))
mean(unlist(all_ft_specificities_rf_c3))


print("MAX C3")
max(unlist(all_ft_specificities_lda_c3))
max(unlist(all_ft_specificities_knn_c3))
max(unlist(all_ft_specificities_svm_c3))
max(unlist(all_ft_specificities_cart_c3))
max(unlist(all_ft_specificities_rf_c3))



# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
validation$SUCCESS_num[validation$SUCCESS == "1"] <- 1
validation$SUCCESS_num[validation$SUCCESS == "2"] <- 2
validation$SUCCESS_num[validation$SUCCESS == "3"] <- 3
# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

table(validation$SUCCESS)
table(validation$SUCCESS_num)

# -----------------------------------------------------------------------------

##########################################################################
#
#     MOST PRED. FEAT.
#
#########################################################################
names(data_common_columns_f20_normalized)
data_common_columns_f20_normalized_most_pred <- data_common_columns_f20_normalized[names(data_common_columns_f20_normalized) %in% c("Exam.1","Exam.2", "Exam.3", "Exam.4", "X.Check.Digit", "X.Random.Walker","X.Find.Duplicate","X.RU.Rotten.Tomatoes", "X.Polygon.Transform","X.Sierpinski",  "X.RecursiveAppend", "X.Vehicle.Scenario.Analysis","X.Heart.Transplant", "X.Written.Assignment", "BELONGINGNESS","Q1Computer.Science..BA.","Q1Computer.Science..BA.","Q1Undecided","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes","Q4High.school.class.or.classes.other.than.AP","Q4I.have.no.previous.knowledge.of.computer.science","Q4I.learned.computer.science.by.myself","Q35Difficult","Q35Easy","Q35Neutral","Q35Very.difficult","SUCCESS")]
data_common_columns_s21_normalized_most_pred <- data_common_columns_s21_normalized[names(data_common_columns_s21_normalized) %in% c("Exam.1","Exam.2", "Exam.3", "Exam.4", "X.Check.Digit", "X.Random.Walker","X.Find.Duplicate","X.RU.Rotten.Tomatoes", "X.Polygon.Transform","X.Sierpinski",  "X.RecursiveAppend", "X.Vehicle.Scenario.Analysis","X.Heart.Transplant", "X.Written.Assignment", "BELONGINGNESS","Q1Computer.Science..BA.","Q1Computer.Science..BA.","Q1Undecided","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes","Q4High.school.class.or.classes.other.than.AP","Q4I.have.no.previous.knowledge.of.computer.science","Q4I.learned.computer.science.by.myself","Q35Difficult","Q35Easy","Q35Neutral","Q35Very.difficult","SUCCESS")]

names(data_common_columns_f20_a_normalized)

data_common_columns_f20_a_normalized_most_pred <- data_common_columns_f20_a_normalized[names(data_common_columns_f20_a_normalized) %in% c("Exam.1","Exam.2", "Exam.3", "Exam.4", "X.Check.Digit", "X.Random.Walker","X.Find.Duplicate","X.RU.Rotten.Tomatoes", "X.Polygon.Transform","X.Sierpinski",  "X.RecursiveAppend", "X.Vehicle.Scenario.Analysis","X.Heart.Transplant", "X.Written.Assignment", "BELONGINGNESS","Q1Computer.Science..BA.","Q1Computer.Science..BA.","Q1Undecided","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes","Q4High.school.class.or.classes.other.than.AP","Q4I.have.no.previous.knowledge.of.computer.science","Q4I.learned.computer.science.by.myself","Q35Difficult","Q35Easy","Q35Neutral","Q35Very.difficult","max_submissions","max_score_consecutive_submissions","min_score_consecutive_submissions","max_time_b4_deadline_first_submission","SUCCESS")]
data_common_columns_s21_a_normalized_most_pred <- data_common_columns_s21_a_normalized[names(data_common_columns_s21_a_normalized) %in% c("Exam.1","Exam.2", "Exam.3", "Exam.4", "X.Check.Digit", "X.Random.Walker","X.Find.Duplicate","X.RU.Rotten.Tomatoes", "X.Polygon.Transform","X.Sierpinski",  "X.RecursiveAppend", "X.Vehicle.Scenario.Analysis","X.Heart.Transplant", "X.Written.Assignment", "BELONGINGNESS","Q1Computer.Science..BA.","Q1Computer.Science..BA.","Q1Undecided","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes","Q4High.school.class.or.classes.other.than.AP","Q4I.have.no.previous.knowledge.of.computer.science","Q4I.learned.computer.science.by.myself","Q35Difficult","Q35Easy","Q35Neutral","Q35Very.difficult","max_submissions","max_score_consecutive_submissions","min_score_consecutive_submissions","max_time_b4_deadline_first_submission","SUCCESS")]


data_training <- data_common_columns_f20_a_normalized_most_pred
data_testing <- data_common_columns_s21_a_normalized_most_pred

#data_testing$SUCCESS

all_ft_sensitivities_lda <- list()
all_ft_sensitivities_lda_c1 <- list()
all_ft_sensitivities_lda_c2 <- list()
all_ft_sensitivities_lda_c3 <- list()

all_ft_sensitivities_knn <- list()
all_ft_sensitivities_knn_c1 <- list()
all_ft_sensitivities_knn_c2 <- list()
all_ft_sensitivities_knn_c3 <- list()

all_ft_sensitivities_svm <- list()
all_ft_sensitivities_svm_c1 <- list()
all_ft_sensitivities_svm_c2 <- list()
all_ft_sensitivities_svm_c3 <- list()

all_ft_sensitivities_cart <- list()
all_ft_sensitivities_cart_c1 <- list()
all_ft_sensitivities_cart_c2 <- list()
all_ft_sensitivities_cart_c3 <- list()

all_ft_sensitivities_rf <- list()
all_ft_sensitivities_rf_c1 <- list()
all_ft_sensitivities_rf_c2 <- list()
all_ft_sensitivities_rf_c3 <- list()


all_ft_specificities_lda <- list()
all_ft_specificities_lda_c1 <- list()
all_ft_specificities_lda_c2 <- list()
all_ft_specificities_lda_c3 <- list()

all_ft_specificities_knn <- list()
all_ft_specificities_knn_c1 <- list()
all_ft_specificities_knn_c2 <- list()
all_ft_specificities_knn_c3 <- list()

all_ft_specificities_svm <- list()
all_ft_specificities_svm_c1 <- list()
all_ft_specificities_svm_c2 <- list()
all_ft_specificities_svm_c3 <- list()

all_ft_specificities_cart <- list()
all_ft_specificities_cart_c1 <- list()
all_ft_specificities_cart_c2 <- list()
all_ft_specificities_cart_c3 <- list()

all_ft_specificities_rf <- list()
all_ft_specificities_rf_c1 <- list()
all_ft_specificities_rf_c2 <- list()
all_ft_specificities_rf_c3 <- list()

all_accuracy_lda <- list()
all_accuracy_knn <- list()
all_accuracy_svm <- list()
all_accuracy_cart <- list()
all_accuracy_rf <- list()

counter <- 0


data_f20_saved <- data_training

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  counter <- counter+1
  print(counter)
  data_f20 <- data_training
  
  if (counter>9){
    break
  }
  
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  #validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  #validation <- data_f20[-validation_index,]
  # select Spring 2021 as data for validation
  validation <- data_testing # this has been set to data from spring 21
  
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  #data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output I.E Independent and Dependent Variables
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  
  # a) linear algorithm
  set.seed(sample(1:100, 1))
  #fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  fit.lda <- train(SUCCESS~., data=data_f20, method="lda", metric=metric, trControl=control)
  
  names(data_training)
  # b) nonlinear algorithms
  # CART
  set.seed(sample(1:100, 1))
  #fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  fit.cart <- train(SUCCESS~., data=data_f20, method="rpart", metric=metric, trControl=control)
  
  
  # kNN
  set.seed(sample(1:100, 1))
  #fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  fit.knn <- train(SUCCESS~., data=data_f20, method="knn", metric=metric, trControl=control)
  
  
  # c) advanced algorithms
  # SVM
  set.seed(sample(1:100, 1))
  #fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  fit.svm <- train(SUCCESS~., data=data_f20, method="svmRadial", metric=metric, trControl=control)
  
  
  # Random Forest
  set.seed(sample(1:100, 1))
  #fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  fit.rf <- train(SUCCESS~., data=data_f20, method="rf", metric=metric, trControl=control)
  
  
  
  #plot(fit.rf)
  #ADD ACCURACIES
  
  all_accuracy_lda <- append(all_accuracy_lda,mean(fit.lda$resample$Accuracy))
  all_accuracy_knn <- append(all_accuracy_knn,mean(fit.knn$resample$Accuracy))
  all_accuracy_cart <- append(all_accuracy_cart,mean(fit.cart$resample$Accuracy))
  all_accuracy_svm <- append(all_accuracy_svm,mean(fit.svm$resample$Accuracy))
  all_accuracy_rf <- append(all_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  
  save_validation <- validation
  save_validation$SUCCESS
  
  validation_s <- validation$SUCCESS
  validation_success <- validation$SUCCESS
  
  
  validation$SUCCESS <- validation_success
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  #cm_lda <- confusionMatrix(predictions, data_testing$SUCCESS)
  
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  
  all_ft_sensitivities_lda <- append(all_ft_sensitivities_lda, lda_sens)
  all_ft_sensitivities_lda_c1 <- append(all_ft_sensitivities_lda_c1, lda_sens[[1]])
  all_ft_sensitivities_lda_c2 <- append(all_ft_sensitivities_lda_c2, lda_sens[[2]])
  all_ft_sensitivities_lda_c3 <- append(all_ft_sensitivities_lda_c3, lda_sens[[3]])
  
  all_ft_specificities_lda <- append(all_ft_specificities_lda, cm_lda$byClass[,"Specificity"])
  all_ft_specificities_lda_c1 <- append(all_ft_specificities_lda_c1, lda_spec[[1]])
  all_ft_specificities_lda_c2 <- append(all_ft_specificities_lda_c2, lda_spec[[2]])
  all_ft_specificities_lda_c3 <- append(all_ft_specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  all_ft_sensitivities_knn <- append(all_ft_sensitivities_knn, knn_sens)
  all_ft_sensitivities_knn_c1 <- append(all_ft_sensitivities_knn_c1, knn_sens[[1]])
  all_ft_sensitivities_knn_c2 <- append(all_ft_sensitivities_knn_c2, knn_sens[[2]])
  all_ft_sensitivities_knn_c3 <- append(all_ft_sensitivities_knn_c3, knn_sens[[3]])
  
  all_ft_specificities_knn <- append(all_ft_specificities_knn, cm_knn$byClass[,"Specificity"])
  all_ft_specificities_knn_c1 <- append(all_ft_specificities_knn_c1, knn_spec[[1]])
  all_ft_specificities_knn_c2 <- append(all_ft_specificities_knn_c2, knn_spec[[2]])
  all_ft_specificities_knn_c3 <- append(all_ft_specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  all_ft_sensitivities_svm <- append(all_ft_sensitivities_svm, svm_sens)
  all_ft_sensitivities_svm_c1 <- append(all_ft_sensitivities_svm_c1, svm_sens[[1]])
  all_ft_sensitivities_svm_c2 <- append(all_ft_sensitivities_svm_c2, svm_sens[[2]])
  all_ft_sensitivities_svm_c3 <- append(all_ft_sensitivities_svm_c3, svm_sens[[3]])
  
  all_ft_specificities_svm <- append(all_ft_specificities_svm, cm_svm$byClass[,"Specificity"])
  all_ft_specificities_svm_c1 <- append(all_ft_specificities_svm_c1, svm_spec[[1]])
  all_ft_specificities_svm_c2 <- append(all_ft_specificities_svm_c2, svm_spec[[2]])
  all_ft_specificities_svm_c3 <- append(all_ft_specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  all_ft_sensitivities_cart <- append(all_ft_sensitivities_cart, cart_sens)
  all_ft_sensitivities_cart_c1 <- append(all_ft_sensitivities_cart_c1, cart_sens[[1]])
  all_ft_sensitivities_cart_c2 <- append(all_ft_sensitivities_cart_c2, cart_sens[[2]])
  all_ft_sensitivities_cart_c3 <- append(all_ft_sensitivities_cart_c3, cart_sens[[3]])
  
  all_ft_specificities_cart <- append(all_ft_specificities_cart, cm_cart$byClass[,"Specificity"])
  all_ft_specificities_cart_c1 <- append(all_ft_specificities_cart_c1, cart_spec[[1]])
  all_ft_specificities_cart_c2 <- append(all_ft_specificities_cart_c2, cart_spec[[2]])
  all_ft_specificities_cart_c3 <- append(all_ft_specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  all_ft_sensitivities_rf <- append(all_ft_sensitivities_rf, rf_sens)
  all_ft_sensitivities_rf_c1 <- append(all_ft_sensitivities_rf_c1, rf_sens[[1]])
  all_ft_sensitivities_rf_c2 <- append(all_ft_sensitivities_rf_c2, rf_sens[[2]])
  all_ft_sensitivities_rf_c3 <- append(all_ft_sensitivities_rf_c3, rf_sens[[3]])
  
  all_ft_specificities_rf <- append(all_ft_specificities_rf, cm_rf$byClass[,"Specificity"])
  all_ft_specificities_rf_c1 <- append(all_ft_specificities_rf_c1, rf_spec[[1]])
  all_ft_specificities_rf_c2 <- append(all_ft_specificities_rf_c2, rf_spec[[2]])
  all_ft_specificities_rf_c3 <- append(all_ft_specificities_rf_c3, rf_spec[[3]])
}
# END REPEAT!!

print("ACCURACIES")
print("MIN")
min(unlist(all_accuracy_lda))
min(unlist(all_accuracy_knn))
min(unlist(all_accuracy_svm))
min(unlist(all_accuracy_cart))
min(unlist(all_accuracy_rf))

print("MEAN")
mean(unlist(all_accuracy_lda))
mean(unlist(all_accuracy_knn))
mean(unlist(all_accuracy_svm))
mean(unlist(all_accuracy_cart))
mean(unlist(all_accuracy_rf))

print("MAX")
max(unlist(all_accuracy_lda))
max(unlist(all_accuracy_knn))
max(unlist(all_accuracy_svm))
max(unlist(all_accuracy_cart))
max(unlist(all_accuracy_rf))



print("MIN C1")
min(unlist(all_ft_sensitivities_lda_c1))
min(unlist(all_ft_sensitivities_knn_c1))
min(unlist(all_ft_sensitivities_svm_c1))
min(unlist(all_ft_sensitivities_cart_c1))
min(unlist(all_ft_sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_sensitivities_lda_c1))
mean(unlist(all_ft_sensitivities_knn_c1))
mean(unlist(all_ft_sensitivities_svm_c1))
mean(unlist(all_ft_sensitivities_cart_c1))
mean(unlist(all_ft_sensitivities_rf_c1))


print("MAX C1")
max(unlist(all_ft_sensitivities_lda_c1))
max(unlist(all_ft_sensitivities_knn_c1))
max(unlist(all_ft_sensitivities_svm_c1))
max(unlist(all_ft_sensitivities_cart_c1))
max(unlist(all_ft_sensitivities_rf_c1))

print("MIN C2")
min(unlist(all_ft_sensitivities_lda_c2))
min(unlist(all_ft_sensitivities_knn_c2))
min(unlist(all_ft_sensitivities_svm_c2))
min(unlist(all_ft_sensitivities_cart_c2))
min(unlist(all_ft_sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_sensitivities_lda_c2))
mean(unlist(all_ft_sensitivities_knn_c2))
mean(unlist(all_ft_sensitivities_svm_c2))
mean(unlist(all_ft_sensitivities_cart_c2))
mean(unlist(all_ft_sensitivities_rf_c2))


print("MAX C2")
max(unlist(all_ft_sensitivities_lda_c2))
max(unlist(all_ft_sensitivities_knn_c2))
max(unlist(all_ft_sensitivities_svm_c2))
max(unlist(all_ft_sensitivities_cart_c2))
max(unlist(all_ft_sensitivities_rf_c2))


print("MIN C3")
min(unlist(all_ft_sensitivities_lda_c3))
min(unlist(all_ft_sensitivities_knn_c3))
min(unlist(all_ft_sensitivities_svm_c3))
min(unlist(all_ft_sensitivities_cart_c3))
min(unlist(all_ft_sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_sensitivities_lda_c3))
mean(unlist(all_ft_sensitivities_knn_c3))
mean(unlist(all_ft_sensitivities_svm_c3))
mean(unlist(all_ft_sensitivities_cart_c3))
mean(unlist(all_ft_sensitivities_rf_c3))


print("MAX C3")
max(unlist(all_ft_sensitivities_lda_c3))
max(unlist(all_ft_sensitivities_knn_c3))
max(unlist(all_ft_sensitivities_svm_c3))
max(unlist(all_ft_sensitivities_cart_c3))
max(unlist(all_ft_sensitivities_rf_c3))

print("SPECIFICITIES")

print("MIN C1")
min(unlist(all_ft_specificities_lda_c1))
min(unlist(all_ft_specificities_knn_c1))
min(unlist(all_ft_specificities_svm_c1))
min(unlist(all_ft_specificities_cart_c1))
min(unlist(all_ft_specificities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_specificities_lda_c1))
mean(unlist(all_ft_specificities_knn_c1))
mean(unlist(all_ft_specificities_svm_c1))
mean(unlist(all_ft_specificities_cart_c1))
mean(unlist(all_ft_specificities_rf_c1))


print("MAX C1")
max(unlist(all_ft_specificities_lda_c1))
max(unlist(all_ft_specificities_knn_c1))
max(unlist(all_ft_specificities_svm_c1))
max(unlist(all_ft_specificities_cart_c1))
max(unlist(all_ft_specificities_rf_c1))

print("MIN C2")
min(unlist(all_ft_specificities_lda_c2))
min(unlist(all_ft_specificities_knn_c2))
min(unlist(all_ft_specificities_svm_c2))
min(unlist(all_ft_specificities_cart_c2))
min(unlist(all_ft_specificities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_specificities_lda_c2))
mean(unlist(all_ft_specificities_knn_c2))
mean(unlist(all_ft_specificities_svm_c2))
mean(unlist(all_ft_specificities_cart_c2))
mean(unlist(all_ft_specificities_rf_c2))


print("MAX C2")
max(unlist(all_ft_specificities_lda_c2))
max(unlist(all_ft_specificities_knn_c2))
max(unlist(all_ft_specificities_svm_c2))
max(unlist(all_ft_specificities_cart_c2))
max(unlist(all_ft_specificities_rf_c2))


print("MIN C3")
min(unlist(all_ft_specificities_lda_c3))
min(unlist(all_ft_specificities_knn_c3))
min(unlist(all_ft_specificities_svm_c3))
min(unlist(all_ft_specificities_cart_c3))
min(unlist(all_ft_specificities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_specificities_lda_c3))
mean(unlist(all_ft_specificities_knn_c3))
mean(unlist(all_ft_specificities_svm_c3))
mean(unlist(all_ft_specificities_cart_c3))
mean(unlist(all_ft_specificities_rf_c3))


print("MAX C3")
max(unlist(all_ft_specificities_lda_c3))
max(unlist(all_ft_specificities_knn_c3))
max(unlist(all_ft_specificities_svm_c3))
max(unlist(all_ft_specificities_cart_c3))
max(unlist(all_ft_specificities_rf_c3))



# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
validation$SUCCESS_num[validation$SUCCESS == "1"] <- 1
validation$SUCCESS_num[validation$SUCCESS == "2"] <- 2
validation$SUCCESS_num[validation$SUCCESS == "3"] <- 3
# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

table(validation$SUCCESS)
table(validation$SUCCESS_num)



# MODELS USING MOST PREDICTIVE FEATURES!! ALRRADY DONE ABOVE SKIP TO WEEK 3 L 6700

names(dataset_no_const_var)

# boxplot(BELONGINGNESS~SUCCESS,data=dataset_no_const_var, main="Belongingness",
#         xlab="SUCCESS", ylab="Score")
# 
# boxplot(CONFIDENCE~SUCCESS,data=dataset_no_const_var, main="Confidence",
#         xlab="SUCCESS", ylab="Score")
# 
# boxplot(INTEREST~SUCCESS,data=dataset_no_const_var, main="Interest",
#         xlab="SUCCESS", ylab="Score")
# 
# boxplot(USEFULNESS~SUCCESS,data=dataset_no_const_var, main="Usefulness",
#         xlab="SUCCESS", ylab="Score")
# 
# boxplot(ENCOURAGEMENT~SUCCESS,data=dataset_no_const_var, main="Encouragement",
#         xlab="SUCCESS", ylab="Score")

#. CODE FROM INTERNET



# Create 2 vectors
a <- sample(2:24, 20 , replace=T)
b <- sample(4:14, 8 , replace=T)

# Make a list of these 2 vectors
C <- list(a,b)

# Change the names of the elements of the list :
names(C) <- c(paste("Category 1\n n=" , length(a) , sep=""), paste("Category 2\n n=" , length(b) , sep=""))

# Change the mgp argument: avoid text overlaps axis
par(mgp=c(3,2,0))

# Final Boxplot
boxplot(C , col="#69b3a2" , ylab="value" )



# DONE WITH CODE FROM INTERNET

boxplot(BELONGINGNESS~SUCCESS,data=data_common_columns_f20_normalized, main="Belongingness",
        xlab="SUCCESS", ylab="Score")

boxplot(CONFIDENCE~SUCCESS,data=dataset_no_const_var, main="Confidence",
        xlab="SUCCESS", ylab="Score")

boxplot(INTEREST~SUCCESS,data=dataset_no_const_var, main="Interest",
        xlab="SUCCESS", ylab="Score")

boxplot(USEFULNESS~SUCCESS,data=dataset_no_const_var, main="Usefulness",
        xlab="SUCCESS", ylab="Score")

boxplot(ENCOURAGEMENT~SUCCESS,data=dataset_no_const_var, main="Encouragement",
        xlab="SUCCESS", ylab="Score")

saved_data_no_var_no_corr <- data_f20_saved
names(data_most_pred)
data_most_pred <- saved_data_no_var_no_corr[names(saved_data_no_var_no_corr) %in% c("Quiz.1..1068907.","Quiz.2..1127309.", "Quiz.3..1127314.", "Quiz.4..1129289.", "X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.", "X10..Polygon.Transform..1126937.","X11..Sierpinski..1126948.",  "X13..RecursiveAppend..1126971.", "X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X16..Assignment.8...Complexity.Analysis..1129495.", "BELONGINGNESS","Q1Computer.Science..BA.","Q1Computer.Science..BS.","Q1Undecided","Q4AP.CS.Principles","Q4AP.CSA..Java.","Q4College.class.or.classes","Q4High.school.class.or.classes.other.than.AP","Q4I.have.no.previous.knowledge.of.computer.science","Q4I.learned.computer.science.by.myself","Q35Difficult","Q35Easy","Q35Neutral","Q35Very.difficult","Q39_1Somewhat.agree","SUCCESS")]
names(saved_data_no_var_no_corr)
names(data_most_pred)

# ------   SAVE  ALL  THE  DATA  !! ------------

data_f20_saved <- data_most_pred
data_f20_saved_again <- data_f20_saved
data_f20 <- data_f20_saved

pred_ft_sensitivities_lda <- list()
pred_ft_sensitivities_lda_c1 <- list()
pred_ft_sensitivities_lda_c2 <- list()
pred_ft_sensitivities_lda_c3 <- list()

pred_ft_sensitivities_knn <- list()
pred_ft_sensitivities_knn_c1 <- list()
pred_ft_sensitivities_knn_c2 <- list()
pred_ft_sensitivities_knn_c3 <- list()

pred_ft_sensitivities_svm <- list()
pred_ft_sensitivities_svm_c1 <- list()
pred_ft_sensitivities_svm_c2 <- list()
pred_ft_sensitivities_svm_c3 <- list()

pred_ft_sensitivities_cart <- list()
pred_ft_sensitivities_cart_c1 <- list()
pred_ft_sensitivities_cart_c2 <- list()
pred_ft_sensitivities_cart_c3 <- list()

pred_ft_sensitivities_rf <- list()
pred_ft_sensitivities_rf_c1 <- list()
pred_ft_sensitivities_rf_c2 <- list()
pred_ft_sensitivities_rf_c3 <- list()


pred_ft_specificities_lda <- list()
pred_ft_specificities_lda_c1 <- list()
pred_ft_specificities_lda_c2 <- list()
pred_ft_specificities_lda_c3 <- list()

pred_ft_specificities_knn <- list()
pred_ft_specificities_knn_c1 <- list()
pred_ft_specificities_knn_c2 <- list()
pred_ft_specificities_knn_c3 <- list()

pred_ft_specificities_svm <- list()
pred_ft_specificities_svm_c1 <- list()
pred_ft_specificities_svm_c2 <- list()
pred_ft_specificities_svm_c3 <- list()

pred_ft_specificities_cart <- list()
pred_ft_specificities_cart_c1 <- list()
pred_ft_specificities_cart_c2 <- list()
pred_ft_specificities_cart_c3 <- list()

pred_ft_specificities_rf <- list()
pred_ft_specificities_rf_c1 <- list()
pred_ft_specificities_rf_c2 <- list()
pred_ft_specificities_rf_c3 <- list()

#ADD ACCURACIES

pred_accuracy_lda <- list()
pred_accuracy_knn <- list()
pred_accuracy_cart <- list()
pred_accuracy_svm <- list()
pred_accuracy_rf <- list()

counter <- 0


data_f20_saved <- data_training

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  counter <- counter+1
  print(counter)
  data_f20 <- data_training
  
  if (counter>9){
    break
  }
  
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  #validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  #validation <- data_f20[-validation_index,]
  # select Spring 2021 as data for validation
  validation <- data_testing # this has been set to data from spring 21
  
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  #data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output I.E Independent and Dependent Variables
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  
  # a) linear algorithm
  set.seed(sample(1:100, 1))
  #fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  fit.lda <- train(SUCCESS~., data=data_f20, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(sample(1:100, 1))
  #fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  fit.cart <- train(SUCCESS~., data=data_f20, method="rpart", metric=metric, trControl=control)
  
  
  # kNN
  set.seed(sample(1:100, 1))
  #fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  fit.knn <- train(SUCCESS~., data=data_f20, method="knn", metric=metric, trControl=control)
  
  
  # c) advanced algorithms
  # SVM
  set.seed(sample(1:100, 1))
  #fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  fit.svm <- train(SUCCESS~., data=data_f20, method="svmRadial", metric=metric, trControl=control)
  
  
  # Random Forest
  set.seed(sample(1:100, 1))
  #fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  fit.rf <- train(SUCCESS~., data=data_f20, method="rf", metric=metric, trControl=control)
  
  
  
  #plot(fit.rf)
  #ADD ACCURACIES
  
  pred_accuracy_lda <- append(pred_accuracy_lda,mean(fit.lda$resample$Accuracy))
  pred_accuracy_knn <- append(pred_accuracy_knn,mean(fit.knn$resample$Accuracy))
  pred_accuracy_cart <- append(pred_accuracy_cart,mean(fit.cart$resample$Accuracy))
  pred_accuracy_svm <- append(pred_accuracy_svm,mean(fit.svm$resample$Accuracy))
  pred_accuracy_rf <- append(pred_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  
  save_validation <- validation
  save_validation$SUCCESS
  
  validation_s <- validation$SUCCESS
  validation_success <- validation$SUCCESS
  
  
  validation$SUCCESS <- validation_success
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  #cm_lda <- confusionMatrix(predictions, data_testing$SUCCESS)
  
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  
  pred_ft_sensitivities_lda <- append(pred_ft_sensitivities_lda, lda_sens)
  pred_ft_sensitivities_lda_c1 <- append(pred_ft_sensitivities_lda_c1, lda_sens[[1]])
  pred_ft_sensitivities_lda_c2 <- append(pred_ft_sensitivities_lda_c2, lda_sens[[2]])
  pred_ft_sensitivities_lda_c3 <- append(pred_ft_sensitivities_lda_c3, lda_sens[[3]])
  
  pred_ft_specificities_lda <- append(pred_ft_specificities_lda, cm_lda$byClass[,"Specificity"])
  pred_ft_specificities_lda_c1 <- append(pred_ft_specificities_lda_c1, lda_spec[[1]])
  pred_ft_specificities_lda_c2 <- append(pred_ft_specificities_lda_c2, lda_spec[[2]])
  pred_ft_specificities_lda_c3 <- append(pred_ft_specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  pred_ft_sensitivities_knn <- append(pred_ft_sensitivities_knn, knn_sens)
  pred_ft_sensitivities_knn_c1 <- append(pred_ft_sensitivities_knn_c1, knn_sens[[1]])
  pred_ft_sensitivities_knn_c2 <- append(pred_ft_sensitivities_knn_c2, knn_sens[[2]])
  pred_ft_sensitivities_knn_c3 <- append(pred_ft_sensitivities_knn_c3, knn_sens[[3]])
  
  pred_ft_specificities_knn <- append(pred_ft_specificities_knn, cm_knn$byClass[,"Specificity"])
  pred_ft_specificities_knn_c1 <- append(pred_ft_specificities_knn_c1, knn_spec[[1]])
  pred_ft_specificities_knn_c2 <- append(pred_ft_specificities_knn_c2, knn_spec[[2]])
  pred_ft_specificities_knn_c3 <- append(pred_ft_specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  pred_ft_sensitivities_svm <- append(pred_ft_sensitivities_svm, svm_sens)
  pred_ft_sensitivities_svm_c1 <- append(pred_ft_sensitivities_svm_c1, svm_sens[[1]])
  pred_ft_sensitivities_svm_c2 <- append(pred_ft_sensitivities_svm_c2, svm_sens[[2]])
  pred_ft_sensitivities_svm_c3 <- append(pred_ft_sensitivities_svm_c3, svm_sens[[3]])
  
  pred_ft_specificities_svm <- append(pred_ft_specificities_svm, cm_svm$byClass[,"Specificity"])
  pred_ft_specificities_svm_c1 <- append(pred_ft_specificities_svm_c1, svm_spec[[1]])
  pred_ft_specificities_svm_c2 <- append(pred_ft_specificities_svm_c2, svm_spec[[2]])
  pred_ft_specificities_svm_c3 <- append(pred_ft_specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  pred_ft_sensitivities_cart <- append(pred_ft_sensitivities_cart, cart_sens)
  pred_ft_sensitivities_cart_c1 <- append(pred_ft_sensitivities_cart_c1, cart_sens[[1]])
  pred_ft_sensitivities_cart_c2 <- append(pred_ft_sensitivities_cart_c2, cart_sens[[2]])
  pred_ft_sensitivities_cart_c3 <- append(pred_ft_sensitivities_cart_c3, cart_sens[[3]])
  
  pred_ft_specificities_cart <- append(pred_ft_specificities_cart, cm_cart$byClass[,"Specificity"])
  pred_ft_specificities_cart_c1 <- append(pred_ft_specificities_cart_c1, cart_spec[[1]])
  pred_ft_specificities_cart_c2 <- append(pred_ft_specificities_cart_c2, cart_spec[[2]])
  pred_ft_specificities_cart_c3 <- append(pred_ft_specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  pred_ft_sensitivities_rf <- append(pred_ft_sensitivities_rf, rf_sens)
  pred_ft_sensitivities_rf_c1 <- append(pred_ft_sensitivities_rf_c1, rf_sens[[1]])
  pred_ft_sensitivities_rf_c2 <- append(pred_ft_sensitivities_rf_c2, rf_sens[[2]])
  pred_ft_sensitivities_rf_c3 <- append(pred_ft_sensitivities_rf_c3, rf_sens[[3]])
  
  pred_ft_specificities_rf <- append(pred_ft_specificities_rf, cm_rf$byClass[,"Specificity"])
  pred_ft_specificities_rf_c1 <- append(pred_ft_specificities_rf_c1, rf_spec[[1]])
  pred_ft_specificities_rf_c2 <- append(pred_ft_specificities_rf_c2, rf_spec[[2]])
  pred_ft_specificities_rf_c3 <- append(pred_ft_specificities_rf_c3, rf_spec[[3]])
}
# END REPEAT!!
print("ACCURACIES")
print("MIN")
min(unlist(pred_accuracy_lda))
min(unlist(pred_accuracy_knn))
min(unlist(pred_accuracy_svm))
min(unlist(pred_accuracy_cart))
min(unlist(pred_accuracy_rf))

print("MEAN")
mean(unlist(pred_accuracy_lda))
mean(unlist(pred_accuracy_knn))
mean(unlist(pred_accuracy_svm))
mean(unlist(pred_accuracy_cart))
mean(unlist(pred_accuracy_rf))

print("MAX")
max(unlist(pred_accuracy_lda))
max(unlist(pred_accuracy_knn))
max(unlist(pred_accuracy_svm))
max(unlist(pred_accuracy_cart))
max(unlist(pred_accuracy_rf))

print("SENSTIVITIES")

print("MIN C1")
min(unlist(pred_ft_sensitivities_lda_c1))
min(unlist(pred_ft_sensitivities_knn_c1))
min(unlist(pred_ft_sensitivities_svm_c1))
min(unlist(pred_ft_sensitivities_cart_c1))
min(unlist(pred_ft_sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(pred_ft_sensitivities_lda_c1))
mean(unlist(pred_ft_sensitivities_knn_c1))
mean(unlist(pred_ft_sensitivities_svm_c1))
mean(unlist(pred_ft_sensitivities_cart_c1))
mean(unlist(pred_ft_sensitivities_rf_c1))


print("MAX C1")
max(unlist(pred_ft_sensitivities_lda_c1))
max(unlist(pred_ft_sensitivities_knn_c1))
max(unlist(pred_ft_sensitivities_svm_c1))
max(unlist(pred_ft_sensitivities_cart_c1))
max(unlist(pred_ft_sensitivities_rf_c1))

print("MIN C2")
min(unlist(pred_ft_sensitivities_lda_c2))
min(unlist(pred_ft_sensitivities_knn_c2))
min(unlist(pred_ft_sensitivities_svm_c2))
min(unlist(pred_ft_sensitivities_cart_c2))
min(unlist(pred_ft_sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(pred_ft_sensitivities_lda_c2))
mean(unlist(pred_ft_sensitivities_knn_c2))
mean(unlist(pred_ft_sensitivities_svm_c2))
mean(unlist(pred_ft_sensitivities_cart_c2))
mean(unlist(pred_ft_sensitivities_rf_c2))


print("MAX C2")
max(unlist(pred_ft_sensitivities_lda_c2))
max(unlist(pred_ft_sensitivities_knn_c2))
max(unlist(pred_ft_sensitivities_svm_c2))
max(unlist(pred_ft_sensitivities_cart_c2))
max(unlist(pred_ft_sensitivities_rf_c2))


print("MIN C3")
min(unlist(pred_ft_sensitivities_lda_c3))
min(unlist(pred_ft_sensitivities_knn_c3))
min(unlist(pred_ft_sensitivities_svm_c3))
min(unlist(pred_ft_sensitivities_cart_c3))
min(unlist(pred_ft_sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(pred_ft_sensitivities_lda_c3))
mean(unlist(pred_ft_sensitivities_knn_c3))
mean(unlist(pred_ft_sensitivities_svm_c3))
mean(unlist(pred_ft_sensitivities_cart_c3))
mean(unlist(pred_ft_sensitivities_rf_c3))


print("MAX C3")
max(unlist(pred_ft_sensitivities_lda_c3))
max(unlist(pred_ft_sensitivities_knn_c3))
max(unlist(pred_ft_sensitivities_svm_c3))
max(unlist(pred_ft_sensitivities_cart_c3))
max(unlist(pred_ft_sensitivities_rf_c3))

print("SPECIFICITIES")

print("MIN C1")
min(unlist(pred_ft_specificities_lda_c1))
min(unlist(pred_ft_specificities_knn_c1))
min(unlist(pred_ft_specificities_svm_c1))
min(unlist(pred_ft_specificities_cart_c1))
min(unlist(pred_ft_specificities_rf_c1))

print("MEAN C1")
mean(unlist(pred_ft_specificities_lda_c1))
mean(unlist(pred_ft_specificities_knn_c1))
mean(unlist(pred_ft_specificities_svm_c1))
mean(unlist(pred_ft_specificities_cart_c1))
mean(unlist(pred_ft_specificities_rf_c1))


print("MAX C1")
max(unlist(pred_ft_specificities_lda_c1))
max(unlist(pred_ft_specificities_knn_c1))
max(unlist(pred_ft_specificities_svm_c1))
max(unlist(pred_ft_specificities_cart_c1))
max(unlist(pred_ft_specificities_rf_c1))

print("MIN C2")
min(unlist(pred_ft_specificities_lda_c2))
min(unlist(pred_ft_specificities_knn_c2))
min(unlist(pred_ft_specificities_svm_c2))
min(unlist(pred_ft_specificities_cart_c2))
min(unlist(pred_ft_specificities_rf_c2))

print("MEAN C2")
mean(unlist(pred_ft_specificities_lda_c2))
mean(unlist(pred_ft_specificities_knn_c2))
mean(unlist(pred_ft_specificities_svm_c2))
mean(unlist(pred_ft_specificities_cart_c2))
mean(unlist(pred_ft_specificities_rf_c2))


print("MAX C2")
max(unlist(pred_ft_specificities_lda_c2))
max(unlist(pred_ft_specificities_knn_c2))
max(unlist(pred_ft_specificities_svm_c2))
max(unlist(pred_ft_specificities_cart_c2))
max(unlist(pred_ft_specificities_rf_c2))


print("MIN C3")
min(unlist(pred_ft_specificities_lda_c3))
min(unlist(pred_ft_specificities_knn_c3))
min(unlist(pred_ft_specificities_svm_c3))
min(unlist(pred_ft_specificities_cart_c3))
min(unlist(pred_ft_specificities_rf_c3))

print("MEAN C3")
mean(unlist(pred_ft_specificities_lda_c3))
mean(unlist(pred_ft_specificities_knn_c3))
mean(unlist(pred_ft_specificities_svm_c3))
mean(unlist(pred_ft_specificities_cart_c3))
mean(unlist(pred_ft_specificities_rf_c3))


print("MAX C3")
max(unlist(pred_ft_specificities_lda_c3))
max(unlist(pred_ft_specificities_knn_c3))
max(unlist(pred_ft_specificities_svm_c3))
max(unlist(pred_ft_specificities_cart_c3))
max(unlist(pred_ft_specificities_rf_c3))


# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
validation$SUCCESS_num[validation$SUCCESS == "1"] <- 1
validation$SUCCESS_num[validation$SUCCESS == "2"] <- 2
validation$SUCCESS_num[validation$SUCCESS == "3"] <- 3
# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

table(validation$SUCCESS)
table(validation$SUCCESS_num)

#get rid of temporary variable
#validation<- validation[, !names(validation) %in% c("SUCCESS_num")]

# STEP 1 DONE!

# STEP 2
#predictions <- as.numeric(predictions)-1

# indeces in validation of mismatches
#mismatched_indeces <- which(abs(as.numeric(predictions) - validation$SUCCESS_num)==1)
mismatched_indeces <- which(as.numeric(predictions)!=validation$SUCCESS_num)

mismatched <- validation[mismatched_indeces,]

# write them in a file!

write.csv(mismatched, "SVM_mismatched_all_data_var_contributing_to_grades_3_classes.csv")

predictions[mismatched_indeces]

################################################
# 
#     MODELS WITH DATA AVAIABLE DURING WEEK 3
#
################################################ 

# features: all features in intro survey
# all features in registrar data
# grades: Rec 1, Rec 2, 
# Week 4: Assignment Pseudocode
# Week 5: Assignment Hello World

names(data_common_columns_f20_normalized)
drops <- c("Exam.2", "Exam.4", "Exam.1","Exam.3","X.HelloWorld","X.Wind.Chill", "X.Check.Digit", "X.Largest.of.Five", "X.Check.Digit", "X.Random.Walker","X.Find.Duplicate","X.RU.Rotten.Tomatoes.","X.Polygon.Transform", "X.Sierpinski","X.Weather.Generator", "X.RecursiveAppend","X.Vehicle.Scenario.Analysis", "X.Heart.Transplant","X.Pseudocode", "X.Written.Assignment","X.Order.Check","X.RU.Rotten.Tomatoes",  "Recitation.Week.6", "Recitation.Week.10","Recitation.Week.3", "Recitation.Week.7","Recitation.Week.4", "Recitation.Week.5","Recitation.Week.8", "Recitation.Week.13")
data_common_columns_f20_normalized_week3 <- data_common_columns_f20_normalized[ , !(names(data_common_columns_f20_normalized) %in% drops)]
data_common_columns_s21_normalized_week3 <- data_common_columns_s21_normalized[ , !(names(data_common_columns_s21_normalized) %in% drops)]

data_common_columns_f20_a_normalized_week3 <- data_common_columns_f20_a_normalized[ , !(names(data_common_columns_f20_a_normalized) %in% drops)]
data_common_columns_s21_a_normalized_week3 <- data_common_columns_s21_a_normalized[ , !(names(data_common_columns_s21_a_normalized) %in% drops)]

names(data_common_columns_f20_normalized_week3)

# AGGREGATE FEATURES FOR WEEK 3

# Fall 2020 Data

aggregate_features_f20_normalized_w3 <- data_common_columns_f20_normalized_week3

# ATITUDES...
aggregate_features_f20_normalized_w3$ATTITUDES <- (data_common_columns_f20_normalized_week3$ENGAGEMENT +  data_common_columns_f20_normalized_week3$BELONGINGNESS + data_common_columns_f20_normalized_week3$CONFIDENCE + data_common_columns_f20_normalized_week3$INTEREST + data_common_columns_f20_normalized_week3$USEFULNESS + data_common_columns_f20_normalized_week3$ENCOURAGEMENT + data_common_columns_f20_normalized_week3$ATTITUDES)/7

# REGISTRAR DATA...
aggregate_features_f20_normalized_w3$ethnic_cd <- data_common_columns_f20_normalized_week3$ethnic_cd
aggregate_features_f20_normalized_w3$ethnic_cd3 <- data_common_columns_f20_normalized_week3$ethnic_cd3
aggregate_features_f20_normalized_w3$ethnic_cd4 <- data_common_columns_f20_normalized_week3$ethnic_cd4
aggregate_features_f20_normalized_w3$ethnic_cd5 <- data_common_columns_f20_normalized_week3$ethnic_cd5
aggregate_features_f20_normalized_w3$ethnic_cd6 <- data_common_columns_f20_normalized_week3$ethnic_cd6
aggregate_features_f20_normalized_w3$ethnic_cd8 <- data_common_columns_f20_normalized_week3$ethnic_cd8
aggregate_features_f20_normalized_w3$ethnic_cdT <- data_common_columns_f20_normalized_week3$ethnic_cdT

aggregate_features_f20_normalized_w3$sending_school_type_cd.1 <- data_common_columns_f20_normalized_week3$sending_school_type_cd.1
aggregate_features_f20_normalized_w3$sending_school_type_cd.2 <- data_common_columns_f20_normalized_week3$sending_school_type_cd.2
aggregate_features_f20_normalized_w3$sending_school_type_cd.3 <- data_common_columns_f20_normalized_week3$sending_school_type_cd.3
aggregate_features_f20_normalized_w3$sending_school_type_cd.5 <- data_common_columns_f20_normalized_week3$sending_school_type_cd.5
aggregate_features_f20_normalized_w3$sending_school_type_cd.6 <- data_common_columns_f20_normalized_week3$sending_school_type_cd.6

aggregate_features_f20_normalized_w3$orig_admit_type_cd.0 <- data_common_columns_f20_normalized_week3$orig_admit_type_cd.0
aggregate_features_f20_normalized_w3$orig_admit_type_cd.2 <- data_common_columns_f20_normalized_week3$orig_admit_type_cd.2

aggregate_features_f20_normalized_w3$curr_admit_type_cd.1 <- data_common_columns_f20_normalized_week3$curr_admit_type_cd.1
aggregate_features_f20_normalized_w3$curr_admit_type_cd.4 <- data_common_columns_f20_normalized_week3$curr_admit_type_cd.4
aggregate_features_f20_normalized_w3$curr_admit_type_cd.6 <- data_common_columns_f20_normalized_week3$curr_admit_type_cd.6
aggregate_features_f20_normalized_w3$curr_admit_type_cd.9 <- data_common_columns_f20_normalized_week3$curr_admit_type_cd.9

aggregate_features_f20_normalized_w3$citizen_status_cd.1 <- data_common_columns_f20_normalized_week3$citizen_status_cd.1
aggregate_features_f20_normalized_w3$citizen_status_cd.2 <- data_common_columns_f20_normalized_week3$citizen_status_cd.2
aggregate_features_f20_normalized_w3$citizen_status_cd.3 <- data_common_columns_f20_normalized_week3$citizen_status_cd.3


# INTRO SURVEY
aggregate_features_f20_normalized_w3$CS_Major <- data_common_columns_f20_normalized_week3$Q1Computer.Science..BS.

aggregate_features_f20_normalized_w3$Q2I.am.interested.in.computer.science <- data_common_columns_f20_normalized_week3$Q2I.am.interested.in.computer.science
aggregate_features_f20_normalized_w3$Q2I.think.this.course.would.be.helpful <- data_common_columns_f20_normalized_week3$Q2I.think.this.course.would.be.helpful
aggregate_features_f20_normalized_w3$Q2It.fulfills.another.requirement..Please.explain. <- data_common_columns_f20_normalized_week3$Q2It.fulfills.another.requirement..Please.explain.
aggregate_features_f20_normalized_w3$Q2It.is.an.elective <- data_common_columns_f20_normalized_week3$Q2It.is.an.elective
aggregate_features_f20_normalized_w3$Q2It.is.required.for.my.major <- data_common_columns_f20_normalized_week3$Q2It.is.required.for.my.major
aggregate_features_f20_normalized_w3$Q2It.is.required.for.my.minor <- data_common_columns_f20_normalized_week3$Q2It.is.required.for.my.minor
aggregate_features_f20_normalized_w3$Q2Other..please.explain <- data_common_columns_f20_normalized_week3$Q2Other..please.explain


aggregate_features_f20_normalized_w3$Q4AP.CS.Principles <- data_common_columns_f20_normalized_week3$Q4AP.CS.Principles
aggregate_features_f20_normalized_w3$Q4AP.CSA..Java. <- data_common_columns_f20_normalized_week3$Q4AP.CSA..Java.
aggregate_features_f20_normalized_w3$Q4College.class.or.classes <- data_common_columns_f20_normalized_week3$Q4College.class.or.classes
aggregate_features_f20_normalized_w3$Q4High.school.class.or.classes.other.than.AP <- data_common_columns_f20_normalized_week3$Q4High.school.class.or.classes.other.than.AP
aggregate_features_f20_normalized_w3$Q4I.have.no.previous.knowledge.of.computer.science <- data_common_columns_f20_normalized_week3$Q4I.have.no.previous.knowledge.of.computer.science
aggregate_features_f20_normalized_w3$Q4I.learned.computer.science.by.myself <- data_common_columns_f20_normalized_week3$Q4I.learned.computer.science.by.myself
aggregate_features_f20_normalized_w3$Q4Other..please.explain <- data_common_columns_f20_normalized_week3$Q4Other..please.explain

aggregate_features_f20_normalized_w3$Q35Difficult <- data_common_columns_f20_normalized_week3$Q35Difficult
aggregate_features_f20_normalized_w3$Q35Easy <- data_common_columns_f20_normalized_week3$Q35Easy
aggregate_features_f20_normalized_w3$Q35Neutral <- data_common_columns_f20_normalized_week3$Q35Neutral
aggregate_features_f20_normalized_w3$Q35Very.difficult <- data_common_columns_f20_normalized_week3$Q35Very.difficult
aggregate_features_f20_normalized_w3$Q35Very.Easy <- data_common_columns_f20_normalized_week3$Q35Very.Easy

drops = c("ENGAGEMENT", "BELONGINGNESS", "CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Q1Astrophysics..BS.", "Q1Biological.Sciences..BA.", "Q1Cell.Biology.and.Neuroscience..BA.", "Q1Computer.Science..BA.", "Q1Economics", "Q1Genetics..BA.", "Q1Information.Technology.and.Informatics..BA.", "Q1Mathematics..BA.or.BS.", "Q1Mathematics..Actuarial..BA.", "Q1Political.Science..BA.", "Q1Psychology..BA.", "Q1Statistics..BA.", "Q1Statistics.Mathematics..BA.", "Q1Undecided")
aggregate_features_f20_normalized_w3 <- aggregate_features_f20_normalized_w3[ , !(names(aggregate_features_f20_normalized_w3) %in% drops)]

# Spring 2021

aggregate_features_s21_normalized_w3 <- data_common_columns_s21_normalized_week3

aggregate_features_s21_normalized_w3$ATTITUDES <- (data_common_columns_s21_normalized_week3$ENGAGEMENT +  data_common_columns_s21_normalized_week3$BELONGINGNESS + data_common_columns_s21_normalized_week3$CONFIDENCE + data_common_columns_s21_normalized_week3$INTEREST + data_common_columns_s21_normalized_week3$USEFULNESS + data_common_columns_s21_normalized_week3$ENCOURAGEMENT + data_common_columns_s21_normalized_week3$ATTITUDES)/7
aggregate_features_s21_normalized_w3$CS_Major <- data_common_columns_s21_normalized_week3$Q1Computer.Science..BS.

aggregate_features_s21_normalized_w3 <- aggregate_features_s21_normalized_w3[ , !(names(aggregate_features_s21_normalized_w3) %in% drops)]

aggregate_features_f20_normalized_w3$SUCCESS <- as.factor(aggregate_features_f20_normalized_w3$SUCCESS)
aggregate_features_s21_normalized_w3$SUCCESS <- as.factor(aggregate_features_s21_normalized_w3$SUCCESS)


data_training <- aggregate_features_f20_normalized_w3
data_testing <- aggregate_features_s21_normalized_w3



all_ft_sensitivities_lda <- list()
all_ft_sensitivities_lda_c1 <- list()
all_ft_sensitivities_lda_c2 <- list()
all_ft_sensitivities_lda_c3 <- list()

all_ft_sensitivities_knn <- list()
all_ft_sensitivities_knn_c1 <- list()
all_ft_sensitivities_knn_c2 <- list()
all_ft_sensitivities_knn_c3 <- list()

all_ft_sensitivities_svm <- list()
all_ft_sensitivities_svm_c1 <- list()
all_ft_sensitivities_svm_c2 <- list()
all_ft_sensitivities_svm_c3 <- list()

all_ft_sensitivities_cart <- list()
all_ft_sensitivities_cart_c1 <- list()
all_ft_sensitivities_cart_c2 <- list()
all_ft_sensitivities_cart_c3 <- list()

all_ft_sensitivities_rf <- list()
all_ft_sensitivities_rf_c1 <- list()
all_ft_sensitivities_rf_c2 <- list()
all_ft_sensitivities_rf_c3 <- list()


all_ft_specificities_lda <- list()
all_ft_specificities_lda_c1 <- list()
all_ft_specificities_lda_c2 <- list()
all_ft_specificities_lda_c3 <- list()

all_ft_specificities_knn <- list()
all_ft_specificities_knn_c1 <- list()
all_ft_specificities_knn_c2 <- list()
all_ft_specificities_knn_c3 <- list()

all_ft_specificities_svm <- list()
all_ft_specificities_svm_c1 <- list()
all_ft_specificities_svm_c2 <- list()
all_ft_specificities_svm_c3 <- list()

all_ft_specificities_cart <- list()
all_ft_specificities_cart_c1 <- list()
all_ft_specificities_cart_c2 <- list()
all_ft_specificities_cart_c3 <- list()

all_ft_specificities_rf <- list()
all_ft_specificities_rf_c1 <- list()
all_ft_specificities_rf_c2 <- list()
all_ft_specificities_rf_c3 <- list()

all_accuracy_lda <- list()
all_accuracy_knn <- list()
all_accuracy_svm <- list()
all_accuracy_cart <- list()
all_accuracy_rf <- list()

counter <- 0


data_f20_saved <- data_training

# ------   SAVE ALL THE DATA  ------------

data_f20_saved <- data_common_columns_f20_normalized_week3
data_f20_saved_again <- data_f20_saved
data_f20 <- data_f20_saved

all_ft_sensitivities_lda <- list()
all_ft_sensitivities_lda_c1 <- list()
all_ft_sensitivities_lda_c2 <- list()
all_ft_sensitivities_lda_c3 <- list()

all_ft_sensitivities_knn <- list()
all_ft_sensitivities_knn_c1 <- list()
all_ft_sensitivities_knn_c2 <- list()
all_ft_sensitivities_knn_c3 <- list()

all_ft_sensitivities_svm <- list()
all_ft_sensitivities_svm_c1 <- list()
all_ft_sensitivities_svm_c2 <- list()
all_ft_sensitivities_svm_c3 <- list()

all_ft_sensitivities_cart <- list()
all_ft_sensitivities_cart_c1 <- list()
all_ft_sensitivities_cart_c2 <- list()
all_ft_sensitivities_cart_c3 <- list()

all_ft_sensitivities_rf <- list()
all_ft_sensitivities_rf_c1 <- list()
all_ft_sensitivities_rf_c2 <- list()
all_ft_sensitivities_rf_c3 <- list()


all_ft_specificities_lda <- list()
all_ft_specificities_lda_c1 <- list()
all_ft_specificities_lda_c2 <- list()
all_ft_specificities_lda_c3 <- list()

all_ft_specificities_knn <- list()
all_ft_specificities_knn_c1 <- list()
all_ft_specificities_knn_c2 <- list()
all_ft_specificities_knn_c3 <- list()

all_ft_specificities_svm <- list()
all_ft_specificities_svm_c1 <- list()
all_ft_specificities_svm_c2 <- list()
all_ft_specificities_svm_c3 <- list()

all_ft_specificities_cart <- list()
all_ft_specificities_cart_c1 <- list()
all_ft_specificities_cart_c2 <- list()
all_ft_specificities_cart_c3 <- list()

all_ft_specificities_rf <- list()
all_ft_specificities_rf_c1 <- list()
all_ft_specificities_rf_c2 <- list()
all_ft_specificities_rf_c3 <- list()

#ADD ACCURACIES

all_accuracy_lda <- list()
all_accuracy_knn <- list()
all_accuracy_cart <- list()
all_accuracy_svm <- list()
all_accuracy_rf <- list()


counter <- 0


data_f20_saved <- data_training

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  counter <- counter+1
  print(counter)
  data_f20 <- data_training
  
  if (counter>9){
    break
  }
  
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  #validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  #validation <- data_f20[-validation_index,]
  # select Spring 2021 as data for validation
  validation <- data_testing # this has been set to data from spring 21
  
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  #data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output I.E Independent and Dependent Variables
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  
  # a) linear algorithm
  set.seed(sample(1:100, 1))
  #fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  fit.lda <- train(SUCCESS~., data=data_f20, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(sample(1:100, 1))
  #fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  fit.cart <- train(SUCCESS~., data=data_f20, method="rpart", metric=metric, trControl=control)
  
  
  # kNN
  set.seed(sample(1:100, 1))
  #fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  fit.knn <- train(SUCCESS~., data=data_f20, method="knn", metric=metric, trControl=control)
  
  
  # c) advanced algorithms
  # SVM
  set.seed(sample(1:100, 1))
  #fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  fit.svm <- train(SUCCESS~., data=data_f20, method="svmRadial", metric=metric, trControl=control)
  
  
  # Random Forest
  set.seed(sample(1:100, 1))
  #fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  fit.rf <- train(SUCCESS~., data=data_f20, method="rf", metric=metric, trControl=control)
  
  
  
  #plot(fit.rf)
  #ADD ACCURACIES
  
  all_accuracy_lda <- append(all_accuracy_lda,mean(fit.lda$resample$Accuracy))
  all_accuracy_knn <- append(all_accuracy_knn,mean(fit.knn$resample$Accuracy))
  all_accuracy_cart <- append(all_accuracy_cart,mean(fit.cart$resample$Accuracy))
  all_accuracy_svm <- append(all_accuracy_svm,mean(fit.svm$resample$Accuracy))
  all_accuracy_rf <- append(all_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  
  save_validation <- validation
  save_validation$SUCCESS
  
  validation_s <- validation$SUCCESS
  validation_success <- validation$SUCCESS
  
  
  validation$SUCCESS <- validation_success
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  #cm_lda <- confusionMatrix(predictions, data_testing$SUCCESS)
  
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  
  all_ft_sensitivities_lda <- append(all_ft_sensitivities_lda, lda_sens)
  all_ft_sensitivities_lda_c1 <- append(all_ft_sensitivities_lda_c1, lda_sens[[1]])
  all_ft_sensitivities_lda_c2 <- append(all_ft_sensitivities_lda_c2, lda_sens[[2]])
  all_ft_sensitivities_lda_c3 <- append(all_ft_sensitivities_lda_c3, lda_sens[[3]])
  
  all_ft_specificities_lda <- append(all_ft_specificities_lda, cm_lda$byClass[,"Specificity"])
  all_ft_specificities_lda_c1 <- append(all_ft_specificities_lda_c1, lda_spec[[1]])
  all_ft_specificities_lda_c2 <- append(all_ft_specificities_lda_c2, lda_spec[[2]])
  all_ft_specificities_lda_c3 <- append(all_ft_specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  all_ft_sensitivities_knn <- append(all_ft_sensitivities_knn, knn_sens)
  all_ft_sensitivities_knn_c1 <- append(all_ft_sensitivities_knn_c1, knn_sens[[1]])
  all_ft_sensitivities_knn_c2 <- append(all_ft_sensitivities_knn_c2, knn_sens[[2]])
  all_ft_sensitivities_knn_c3 <- append(all_ft_sensitivities_knn_c3, knn_sens[[3]])
  
  all_ft_specificities_knn <- append(all_ft_specificities_knn, cm_knn$byClass[,"Specificity"])
  all_ft_specificities_knn_c1 <- append(all_ft_specificities_knn_c1, knn_spec[[1]])
  all_ft_specificities_knn_c2 <- append(all_ft_specificities_knn_c2, knn_spec[[2]])
  all_ft_specificities_knn_c3 <- append(all_ft_specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  all_ft_sensitivities_svm <- append(all_ft_sensitivities_svm, svm_sens)
  all_ft_sensitivities_svm_c1 <- append(all_ft_sensitivities_svm_c1, svm_sens[[1]])
  all_ft_sensitivities_svm_c2 <- append(all_ft_sensitivities_svm_c2, svm_sens[[2]])
  all_ft_sensitivities_svm_c3 <- append(all_ft_sensitivities_svm_c3, svm_sens[[3]])
  
  all_ft_specificities_svm <- append(all_ft_specificities_svm, cm_svm$byClass[,"Specificity"])
  all_ft_specificities_svm_c1 <- append(all_ft_specificities_svm_c1, svm_spec[[1]])
  all_ft_specificities_svm_c2 <- append(all_ft_specificities_svm_c2, svm_spec[[2]])
  all_ft_specificities_svm_c3 <- append(all_ft_specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  all_ft_sensitivities_cart <- append(all_ft_sensitivities_cart, cart_sens)
  all_ft_sensitivities_cart_c1 <- append(all_ft_sensitivities_cart_c1, cart_sens[[1]])
  all_ft_sensitivities_cart_c2 <- append(all_ft_sensitivities_cart_c2, cart_sens[[2]])
  all_ft_sensitivities_cart_c3 <- append(all_ft_sensitivities_cart_c3, cart_sens[[3]])
  
  all_ft_specificities_cart <- append(all_ft_specificities_cart, cm_cart$byClass[,"Specificity"])
  all_ft_specificities_cart_c1 <- append(all_ft_specificities_cart_c1, cart_spec[[1]])
  all_ft_specificities_cart_c2 <- append(all_ft_specificities_cart_c2, cart_spec[[2]])
  all_ft_specificities_cart_c3 <- append(all_ft_specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  all_ft_sensitivities_rf <- append(all_ft_sensitivities_rf, rf_sens)
  all_ft_sensitivities_rf_c1 <- append(all_ft_sensitivities_rf_c1, rf_sens[[1]])
  all_ft_sensitivities_rf_c2 <- append(all_ft_sensitivities_rf_c2, rf_sens[[2]])
  all_ft_sensitivities_rf_c3 <- append(all_ft_sensitivities_rf_c3, rf_sens[[3]])
  
  all_ft_specificities_rf <- append(all_ft_specificities_rf, cm_rf$byClass[,"Specificity"])
  all_ft_specificities_rf_c1 <- append(all_ft_specificities_rf_c1, rf_spec[[1]])
  all_ft_specificities_rf_c2 <- append(all_ft_specificities_rf_c2, rf_spec[[2]])
  all_ft_specificities_rf_c3 <- append(all_ft_specificities_rf_c3, rf_spec[[3]])
}
# END REPEAT!!
names(data_no_low_var)

print("ACCURACIES")
print("MIN")
min(unlist(all_accuracy_lda))
min(unlist(all_accuracy_knn))
min(unlist(all_accuracy_svm))
min(unlist(all_accuracy_cart))
min(unlist(all_accuracy_rf))

print("MEAN")
mean(unlist(all_accuracy_lda))
mean(unlist(all_accuracy_knn))
mean(unlist(all_accuracy_svm))
mean(unlist(all_accuracy_cart))
mean(unlist(all_accuracy_rf))

print("MAX")
max(unlist(all_accuracy_lda))
max(unlist(all_accuracy_knn))
max(unlist(all_accuracy_svm))
max(unlist(all_accuracy_cart))
max(unlist(all_accuracy_rf))


print("SENSITIVITIES")
print("MIN C1")
min(unlist(all_ft_sensitivities_lda_c1))
min(unlist(all_ft_sensitivities_knn_c1))
min(unlist(all_ft_sensitivities_svm_c1))
min(unlist(all_ft_sensitivities_cart_c1))
min(unlist(all_ft_sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_sensitivities_lda_c1))
mean(unlist(all_ft_sensitivities_knn_c1))
mean(unlist(all_ft_sensitivities_svm_c1))
mean(unlist(all_ft_sensitivities_cart_c1))
mean(unlist(all_ft_sensitivities_rf_c1))


print("MAX C1")
max(unlist(all_ft_sensitivities_lda_c1))
max(unlist(all_ft_sensitivities_knn_c1))
max(unlist(all_ft_sensitivities_svm_c1))
max(unlist(all_ft_sensitivities_cart_c1))
max(unlist(all_ft_sensitivities_rf_c1))

print("MIN C2")
min(unlist(all_ft_sensitivities_lda_c2))
min(unlist(all_ft_sensitivities_knn_c2))
min(unlist(all_ft_sensitivities_svm_c2))
min(unlist(all_ft_sensitivities_cart_c2))
min(unlist(all_ft_sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_sensitivities_lda_c2))
mean(unlist(all_ft_sensitivities_knn_c2))
mean(unlist(all_ft_sensitivities_svm_c2))
mean(unlist(all_ft_sensitivities_cart_c2))
mean(unlist(all_ft_sensitivities_rf_c2))


print("MAX C2")
max(unlist(all_ft_sensitivities_lda_c2))
max(unlist(all_ft_sensitivities_knn_c2))
max(unlist(all_ft_sensitivities_svm_c2))
max(unlist(all_ft_sensitivities_cart_c2))
max(unlist(all_ft_sensitivities_rf_c2))


print("MIN C3")
min(unlist(all_ft_sensitivities_lda_c3))
min(unlist(all_ft_sensitivities_knn_c3))
min(unlist(all_ft_sensitivities_svm_c3))
min(unlist(all_ft_sensitivities_cart_c3))
min(unlist(all_ft_sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_sensitivities_lda_c3))
mean(unlist(all_ft_sensitivities_knn_c3))
mean(unlist(all_ft_sensitivities_svm_c3))
mean(unlist(all_ft_sensitivities_cart_c3))
mean(unlist(all_ft_sensitivities_rf_c3))


print("MAX C3")
max(unlist(all_ft_sensitivities_lda_c3))
max(unlist(all_ft_sensitivities_knn_c3))
max(unlist(all_ft_sensitivities_svm_c3))
max(unlist(all_ft_sensitivities_cart_c3))
max(unlist(all_ft_sensitivities_rf_c3))


print("SPECIFICITIES")
print("MIN C1")
min(unlist(all_ft_specificities_lda_c1))
min(unlist(all_ft_specificities_knn_c1))
min(unlist(all_ft_specificities_svm_c1))
min(unlist(all_ft_specificities_cart_c1))
min(unlist(all_ft_specificities_rf_c1))

print("MEAN C1")
mean(unlist(all_ft_specificities_lda_c1))
mean(unlist(all_ft_specificities_knn_c1))
mean(unlist(all_ft_specificities_svm_c1))
mean(unlist(all_ft_specificities_cart_c1))
mean(unlist(all_ft_specificities_rf_c1))


print("MAX C1")
max(unlist(all_ft_specificities_lda_c1))
max(unlist(all_ft_specificities_knn_c1))
max(unlist(all_ft_specificities_svm_c1))
max(unlist(all_ft_specificities_cart_c1))
max(unlist(all_ft_specificities_rf_c1))

print("MIN C2")
min(unlist(all_ft_specificities_lda_c2))
min(unlist(all_ft_specificities_knn_c2))
min(unlist(all_ft_specificities_svm_c2))
min(unlist(all_ft_specificities_cart_c2))
min(unlist(all_ft_specificities_rf_c2))

print("MEAN C2")
mean(unlist(all_ft_specificities_lda_c2))
mean(unlist(all_ft_specificities_knn_c2))
mean(unlist(all_ft_specificities_svm_c2))
mean(unlist(all_ft_specificities_cart_c2))
mean(unlist(all_ft_specificities_rf_c2))


print("MAX C2")
max(unlist(all_ft_specificities_lda_c2))
max(unlist(all_ft_specificities_knn_c2))
max(unlist(all_ft_specificities_svm_c2))
max(unlist(all_ft_specificities_cart_c2))
max(unlist(all_ft_specificities_rf_c2))


print("MIN C3")
min(unlist(all_ft_specificities_lda_c3))
min(unlist(all_ft_specificities_knn_c3))
min(unlist(all_ft_specificities_svm_c3))
min(unlist(all_ft_specificities_cart_c3))
min(unlist(all_ft_specificities_rf_c3))

print("MEAN C3")
mean(unlist(all_ft_specificities_lda_c3))
mean(unlist(all_ft_specificities_knn_c3))
mean(unlist(all_ft_specificities_svm_c3))
mean(unlist(all_ft_specificities_cart_c3))
mean(unlist(all_ft_specificities_rf_c3))


print("MAX C3")
max(unlist(all_ft_specificities_lda_c3))
max(unlist(all_ft_specificities_knn_c3))
max(unlist(all_ft_specificities_svm_c3))
max(unlist(all_ft_specificities_cart_c3))
max(unlist(all_ft_specificities_rf_c3))


# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
validation$SUCCESS_num[validation$SUCCESS == "1"] <- 1
validation$SUCCESS_num[validation$SUCCESS == "2"] <- 2
validation$SUCCESS_num[validation$SUCCESS == "3"] <- 3
# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

table(validation$SUCCESS)
table(validation$SUCCESS_num)

#get rid of temporary variable
#validation<- validation[, !names(validation) %in% c("SUCCESS_num")]

# MODELS WEEK 3 Again, balanced dataset

table(aggregate_features_f20_normalized_w3$SUCCESS)

table(dataset$SUCCESS)

dataset_success <- aggregate_features_f20_normalized_w3[aggregate_features_f20_normalized_w3$SUCCESS==1,]
dataset_not_success <- aggregate_features_f20_normalized_w3[aggregate_features_f20_normalized_w3$SUCCESS==2,]
dataset_struggling <- aggregate_features_f20_normalized_w3[aggregate_features_f20_normalized_w3$SUCCESS==3,]

#dataset_trunc <- dataset_struggling
dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

data_f20_saved <- dataset_trunc
data_f20 <- data_f20_saved


w3_b_ft_sensitivities_lda <- list()
w3_b_ft_sensitivities_lda_c1 <- list()
w3_b_ft_sensitivities_lda_c2 <- list()
w3_b_ft_sensitivities_lda_c3 <- list()

w3_b_ft_sensitivities_knn <- list()
w3_b_ft_sensitivities_knn_c1 <- list()
w3_b_ft_sensitivities_knn_c2 <- list()
w3_b_ft_sensitivities_knn_c3 <- list()

w3_b_ft_sensitivities_svm <- list()
w3_b_ft_sensitivities_svm_c1 <- list()
w3_b_ft_sensitivities_svm_c2 <- list()
w3_b_ft_sensitivities_svm_c3 <- list()

w3_b_ft_sensitivities_cart <- list()
w3_b_ft_sensitivities_cart_c1 <- list()
w3_b_ft_sensitivities_cart_c2 <- list()
w3_b_ft_sensitivities_cart_c3 <- list()

w3_b_ft_sensitivities_rf <- list()
w3_b_ft_sensitivities_rf_c1 <- list()
w3_b_ft_sensitivities_rf_c2 <- list()
w3_b_ft_sensitivities_rf_c3 <- list()


w3_b_ft_specificities_lda <- list()
w3_b_ft_specificities_lda_c1 <- list()
w3_b_ft_specificities_lda_c2 <- list()
w3_b_ft_specificities_lda_c3 <- list()

w3_b_ft_specificities_knn <- list()
w3_b_ft_specificities_knn_c1 <- list()
w3_b_ft_specificities_knn_c2 <- list()
w3_b_ft_specificities_knn_c3 <- list()

w3_b_ft_specificities_svm <- list()
w3_b_ft_specificities_svm_c1 <- list()
w3_b_ft_specificities_svm_c2 <- list()
w3_b_ft_specificities_svm_c3 <- list()

w3_b_ft_specificities_cart <- list()
w3_b_ft_specificities_cart_c1 <- list()
w3_b_ft_specificities_cart_c2 <- list()
w3_b_ft_specificities_cart_c3 <- list()

w3_b_ft_specificities_rf <- list()
w3_b_ft_specificities_rf_c1 <- list()
w3_b_ft_specificities_rf_c2 <- list()
w3_b_ft_specificities_rf_c3 <- list()


counter <- 0

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  counter <- counter+1
  print(counter)
  data_f20 <- data_training
  
  if (counter>9){
    break
  }
  
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  #validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  #validation <- data_f20[-validation_index,]
  # select Spring 2021 as data for validation
  validation <- data_testing # this has been set to data from spring 21
  
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  #data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output I.E Independent and Dependent Variables
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  
  # a) linear algorithm
  set.seed(sample(1:100, 1))
  #fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  fit.lda <- train(SUCCESS~., data=data_f20, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(sample(1:100, 1))
  #fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  fit.cart <- train(SUCCESS~., data=data_f20, method="rpart", metric=metric, trControl=control)
  
  
  # kNN
  set.seed(sample(1:100, 1))
  #fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  fit.knn <- train(SUCCESS~., data=data_f20, method="knn", metric=metric, trControl=control)
  
  
  # c) advanced algorithms
  # SVM
  set.seed(sample(1:100, 1))
  #fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  fit.svm <- train(SUCCESS~., data=data_f20, method="svmRadial", metric=metric, trControl=control)
  
  
  # Random Forest
  set.seed(sample(1:100, 1))
  #fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  fit.rf <- train(SUCCESS~., data=data_f20, method="rf", metric=metric, trControl=control)
  
  
  
  #plot(fit.rf)
  #ADD ACCURACIES
  
  all_accuracy_lda <- append(all_accuracy_lda,mean(fit.lda$resample$Accuracy))
  all_accuracy_knn <- append(all_accuracy_knn,mean(fit.knn$resample$Accuracy))
  all_accuracy_cart <- append(all_accuracy_cart,mean(fit.cart$resample$Accuracy))
  all_accuracy_svm <- append(all_accuracy_svm,mean(fit.svm$resample$Accuracy))
  all_accuracy_rf <- append(all_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  
  save_validation <- validation
  save_validation$SUCCESS
  
  validation_s <- validation$SUCCESS
  validation_success <- validation$SUCCESS
  
  
  validation$SUCCESS <- validation_success
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  #cm_lda <- confusionMatrix(predictions, data_testing$SUCCESS)
  
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  
  w3_b_ft_sensitivities_lda <- append(w3_b_ft_sensitivities_lda, lda_sens)
  w3_b_ft_sensitivities_lda_c1 <- append(w3_b_ft_sensitivities_lda_c1, lda_sens[[1]])
  w3_b_ft_sensitivities_lda_c2 <- append(w3_b_ft_sensitivities_lda_c2, lda_sens[[2]])
  w3_b_ft_sensitivities_lda_c3 <- append(w3_b_ft_sensitivities_lda_c3, lda_sens[[3]])
  
  w3_b_ft_specificities_lda <- append(w3_b_ft_specificities_lda, cm_lda$byClass[,"Specificity"])
  w3_b_ft_specificities_lda_c1 <- append(w3_b_ft_specificities_lda_c1, lda_spec[[1]])
  w3_b_ft_specificities_lda_c2 <- append(w3_b_ft_specificities_lda_c2, lda_spec[[2]])
  w3_b_ft_specificities_lda_c3 <- append(w3_b_ft_specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  w3_b_ft_sensitivities_knn <- append(w3_b_ft_sensitivities_knn, knn_sens)
  w3_b_ft_sensitivities_knn_c1 <- append(w3_b_ft_sensitivities_knn_c1, knn_sens[[1]])
  w3_b_ft_sensitivities_knn_c2 <- append(w3_b_ft_sensitivities_knn_c2, knn_sens[[2]])
  w3_b_ft_sensitivities_knn_c3 <- append(w3_b_ft_sensitivities_knn_c3, knn_sens[[3]])
  
  w3_b_ft_specificities_knn <- append(w3_b_ft_specificities_knn, cm_knn$byClass[,"Specificity"])
  w3_b_ft_specificities_knn_c1 <- append(w3_b_ft_specificities_knn_c1, knn_spec[[1]])
  w3_b_ft_specificities_knn_c2 <- append(w3_b_ft_specificities_knn_c2, knn_spec[[2]])
  w3_b_ft_specificities_knn_c3 <- append(w3_b_ft_specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  w3_b_ft_sensitivities_svm <- append(w3_b_ft_sensitivities_svm, svm_sens)
  w3_b_ft_sensitivities_svm_c1 <- append(w3_b_ft_sensitivities_svm_c1, svm_sens[[1]])
  w3_b_ft_sensitivities_svm_c2 <- append(w3_b_ft_sensitivities_svm_c2, svm_sens[[2]])
  w3_b_ft_sensitivities_svm_c3 <- append(w3_b_ft_sensitivities_svm_c3, svm_sens[[3]])
  
  w3_b_ft_specificities_svm <- append(w3_b_ft_specificities_svm, cm_svm$byClass[,"Specificity"])
  w3_b_ft_specificities_svm_c1 <- append(w3_b_ft_specificities_svm_c1, svm_spec[[1]])
  w3_b_ft_specificities_svm_c2 <- append(w3_b_ft_specificities_svm_c2, svm_spec[[2]])
  w3_b_ft_specificities_svm_c3 <- append(w3_b_ft_specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  w3_b_ft_sensitivities_cart <- append(w3_b_ft_sensitivities_cart, cart_sens)
  w3_b_ft_sensitivities_cart_c1 <- append(w3_b_ft_sensitivities_cart_c1, cart_sens[[1]])
  w3_b_ft_sensitivities_cart_c2 <- append(w3_b_ft_sensitivities_cart_c2, cart_sens[[2]])
  w3_b_ft_sensitivities_cart_c3 <- append(w3_b_ft_sensitivities_cart_c3, cart_sens[[3]])
  
  w3_b_ft_specificities_cart <- append(w3_b_ft_specificities_cart, cm_cart$byClass[,"Specificity"])
  w3_b_ft_specificities_cart_c1 <- append(w3_b_ft_specificities_cart_c1, cart_spec[[1]])
  w3_b_ft_specificities_cart_c2 <- append(w3_b_ft_specificities_cart_c2, cart_spec[[2]])
  w3_b_ft_specificities_cart_c3 <- append(w3_b_ft_specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  w3_b_ft_sensitivities_rf <- append(w3_b_ft_sensitivities_rf, rf_sens)
  w3_b_ft_sensitivities_rf_c1 <- append(w3_b_ft_sensitivities_rf_c1, rf_sens[[1]])
  w3_b_ft_sensitivities_rf_c2 <- append(w3_b_ft_sensitivities_rf_c2, rf_sens[[2]])
  w3_b_ft_sensitivities_rf_c3 <- append(w3_b_ft_sensitivities_rf_c3, rf_sens[[3]])
  
  w3_b_ft_specificities_rf <- append(w3_b_ft_specificities_rf, cm_rf$byClass[,"Specificity"])
  w3_b_ft_specificities_rf_c1 <- append(w3_b_ft_specificities_rf_c1, rf_spec[[1]])
  w3_b_ft_specificities_rf_c2 <- append(w3_b_ft_specificities_rf_c2, rf_spec[[2]])
  w3_b_ft_specificities_rf_c3 <- append(w3_b_ft_specificities_rf_c3, rf_spec[[3]])
}
names(data_no_low_var)

print("SENSITIVITIES")
print("MIN C1")
min(unlist(w3_b_ft_sensitivities_lda_c1))
min(unlist(w3_b_ft_sensitivities_knn_c1))
min(unlist(w3_b_ft_sensitivities_svm_c1))
min(unlist(w3_b_ft_sensitivities_cart_c1))
min(unlist(w3_b_ft_sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(w3_b_ft_sensitivities_lda_c1))
mean(unlist(w3_b_ft_sensitivities_knn_c1))
mean(unlist(w3_b_ft_sensitivities_svm_c1))
mean(unlist(w3_b_ft_sensitivities_cart_c1))
mean(unlist(w3_b_ft_sensitivities_rf_c1))


print("MAX C1")
max(unlist(w3_b_ft_sensitivities_lda_c1))
max(unlist(w3_b_ft_sensitivities_knn_c1))
max(unlist(w3_b_ft_sensitivities_svm_c1))
max(unlist(w3_b_ft_sensitivities_cart_c1))
max(unlist(w3_b_ft_sensitivities_rf_c1))

print("MIN C2")
min(unlist(w3_b_ft_sensitivities_lda_c2))
min(unlist(w3_b_ft_sensitivities_knn_c2))
min(unlist(w3_b_ft_sensitivities_svm_c2))
min(unlist(w3_b_ft_sensitivities_cart_c2))
min(unlist(w3_b_ft_sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(w3_b_ft_sensitivities_lda_c2))
mean(unlist(w3_b_ft_sensitivities_knn_c2))
mean(unlist(w3_b_ft_sensitivities_svm_c2))
mean(unlist(w3_b_ft_sensitivities_cart_c2))
mean(unlist(w3_b_ft_sensitivities_rf_c2))


print("MAX C2")
max(unlist(w3_b_ft_sensitivities_lda_c2))
max(unlist(w3_b_ft_sensitivities_knn_c2))
max(unlist(w3_b_ft_sensitivities_svm_c2))
max(unlist(w3_b_ft_sensitivities_cart_c2))
max(unlist(w3_b_ft_sensitivities_rf_c2))


print("MIN C3")
min(unlist(w3_b_ft_sensitivities_lda_c3))
min(unlist(w3_b_ft_sensitivities_knn_c3))
min(unlist(w3_b_ft_sensitivities_svm_c3))
min(unlist(w3_b_ft_sensitivities_cart_c3))
min(unlist(w3_b_ft_sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(w3_b_ft_sensitivities_lda_c3))
mean(unlist(w3_b_ft_sensitivities_knn_c3))
mean(unlist(w3_b_ft_sensitivities_svm_c3))
mean(unlist(w3_b_ft_sensitivities_cart_c3))
mean(unlist(w3_b_ft_sensitivities_rf_c3))


print("MAX C3")
max(unlist(w3_b_ft_sensitivities_lda_c3))
max(unlist(w3_b_ft_sensitivities_knn_c3))
max(unlist(w3_b_ft_sensitivities_svm_c3))
max(unlist(w3_b_ft_sensitivities_cart_c3))
max(unlist(w3_b_ft_sensitivities_rf_c3))


print("SPECIFICITIES")
print("MIN C1")
min(unlist(w3_b_ft_specificities_lda_c1))
min(unlist(w3_b_ft_specificities_knn_c1))
min(unlist(w3_b_ft_specificities_svm_c1))
min(unlist(w3_b_ft_specificities_cart_c1))
min(unlist(w3_b_ft_specificities_rf_c1))

print("MEAN C1")
mean(unlist(w3_b_ft_specificities_lda_c1))
mean(unlist(w3_b_ft_specificities_knn_c1))
mean(unlist(w3_b_ft_specificities_svm_c1))
mean(unlist(w3_b_ft_specificities_cart_c1))
mean(unlist(w3_b_ft_specificities_rf_c1))


print("MAX C1")
max(unlist(w3_b_ft_specificities_lda_c1))
max(unlist(w3_b_ft_specificities_knn_c1))
max(unlist(w3_b_ft_specificities_svm_c1))
max(unlist(w3_b_ft_specificities_cart_c1))
max(unlist(w3_b_ft_specificities_rf_c1))

print("MIN C2")
min(unlist(w3_b_ft_specificities_lda_c2))
min(unlist(w3_b_ft_specificities_knn_c2))
min(unlist(w3_b_ft_specificities_svm_c2))
min(unlist(w3_b_ft_specificities_cart_c2))
min(unlist(w3_b_ft_specificities_rf_c2))

print("MEAN C2")
mean(unlist(w3_b_ft_specificities_lda_c2))
mean(unlist(w3_b_ft_specificities_knn_c2))
mean(unlist(w3_b_ft_specificities_svm_c2))
mean(unlist(w3_b_ft_specificities_cart_c2))
mean(unlist(w3_b_ft_specificities_rf_c2))


print("MAX C2")
max(unlist(w3_b_ft_specificities_lda_c2))
max(unlist(w3_b_ft_specificities_knn_c2))
max(unlist(w3_b_ft_specificities_svm_c2))
max(unlist(w3_b_ft_specificities_cart_c2))
max(unlist(w3_b_ft_specificities_rf_c2))


print("MIN C3")
min(unlist(w3_b_ft_specificities_lda_c3))
min(unlist(w3_b_ft_specificities_knn_c3))
min(unlist(w3_b_ft_specificities_svm_c3))
min(unlist(w3_b_ft_specificities_cart_c3))
min(unlist(w3_b_ft_specificities_rf_c3))

print("MEAN C3")
mean(unlist(w3_b_ft_specificities_lda_c3))
mean(unlist(w3_b_ft_specificities_knn_c3))
mean(unlist(w3_b_ft_specificities_svm_c3))
mean(unlist(w3_b_ft_specificities_cart_c3))
mean(unlist(w3_b_ft_specificities_rf_c3))


print("MAX C3")
max(unlist(w3_b_ft_specificities_lda_c3))
max(unlist(w3_b_ft_specificities_knn_c3))
max(unlist(w3_b_ft_specificities_svm_c3))
max(unlist(w3_b_ft_specificities_cart_c3))
max(unlist(w3_b_ft_specificities_rf_c3))


# MODELS WITH DATA AVAIABLE DURING WEEK 4: SKIPPING TO BALANCED! 

# features: all features in intro survey
# all features in registrar data
# grades: Rec 1, Rec 2, Rec 3
# Week 4: Assignment Pseudocode
# Week 5: Assignment Hello World

names(data_f20_no_na)
drops <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.","Quiz.3..1127314.","X1..HelloWorld..1067474.","X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.","X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.", "X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.","Recitation.10..1129728.", "Recitation.3..1129730.", "Recitation.7..1129732.","Recitation.4..1129733.", "Recitation.12..1129734.","Recitation.5..1129735.", "Recitation.8..1129736.","Recitation.13..1129737.","Recitation.11..1129738.","Recitations.Final.Score","Quizzes.Final.Score","Assignments.Final.Score")
data_week4 <- data_f20_no_na[ , !(names(data_f20_no_na) %in% drops)]

names(data_week4)
data_week4_s <- data_week4

# add the drops from all variables because some have very small variance..
drops1 <- c( "Q1Astrophysics..BS.", "Q1Cognitive.Science..BA. ", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Criminal.Justice..BA.","Q1Linguistics..BA.","Q1Physics...Engineering.Dual.Degree","Q1Psychology..BA.", "Q1Statistics.Mathematics..BA.", "Q4","Q2It.is.an.elective", "Q2Other..please.explain", "Q39_1Strongly.disagree","Q39_3Strongly.agree","Q39_5Strongly.agree" )
data_week4 <-data_week4_s[ , !(names(data_week4_s) %in% drops1)]

#---- SKIPPING THIS TO BALANCED WEEK 4 DATA!!!

names(data_week4)

# ------   SAVE  ALL  THE  DATA  !! ------------

data_f20_saved <- data_week4
data_f20_saved_again <- data_f20_saved
data_f20 <- data_f20_saved

names(data_f20)

# 2.3. Create a Validation Dataset

# create a list of 80% of the rows in the original dataset we can use for training
validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
#validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)

# select 20% of the data for validation
validation <- data_f20[-validation_index,]
# validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
# use the remaining 80% of data to training and testing the models
data_f20_saved <- data_f20
data_f20 <- data_f20[validation_index,]
#data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]

#validation_canvas <- merge(validation, data_f20_numeric_attributes)

# 3. Summarize Dataset

# dimensions of dataset
dim(data_f20)

names(data_f20)

# list types for each attribute
sapply(data_f20, class)

# list the levels for the class
levels(data_f20$SUCCESS)

# 3.5. Class Distribution

# summarize the class distribution
percentage <- prop.table(table(data_f20$SUCCESS)) * 100
cbind(freq=table(data_f20$SUCCESS), percentage=percentage)

# summarize attribute distributions
summary(data_f20)

# 4. Visualize Dataset

# 4.1 Univariate Plots

# split input and output

x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
y <- data_f20[,names(data_f20) %in% c("SUCCESS")]

# Section 5.1.

# Run algorithms using 10-fold cross validation
set.seed(123)
control <- trainControl(method="cv", number=10)
metric <- "Accuracy"

# Section 5.2. Build Models

dataset <- x
dataset$SUCCESS <- y

dataset <- dataset[complete.cases(dataset), ]

# update x just in case any rows were removed becuase they contain na
x<- dataset[, !names(dataset) %in% c("SUCCESS")]

# requires no NAs and only numeric attributes
indexesToDrop <- findCorrelation(cor(x), cutoff = 0.8)


names(x)
corrplot(cor(x[,-indexesToDrop]))

x_no_corr <- x[,-indexesToDrop]

# get rid of correlated variables in dataset

dataset_no_corr <- dataset[,-indexesToDrop]
names(dataset)

test_var <- as.factor(dataset$SUCCESS)
dataset$SUCCESS <- test_var

# check for constant variables
sapply(x, sum) # how many elements are not 0 in that column

#drops <- c( "Q1Astrophysics..BS.", "Q1Cognitive.Science..BA. ", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Criminal.Justice..BA.","Q1Linguistics..BA.","Q1Physics...Engineering.Dual.Degree","Q1Psychology..BA.", "Q1Statistics.Mathematics..BA.", "Q4","Q2It.is.an.elective", "Q2Other..please.explain", "Q39_1Strongly.disagree","Q39_3Strongly.agree","Q39_5Strongly.agree" )
#x_no_const_var <- x[ , !(names(x) %in% drops)]
#dataset_no_const_var <- dataset[ , !(names(dataset) %in% drops)]

# a) linear algorithms
# LDA needs no correlated variables, or else there will be warnings
set.seed(7)
fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)
#fit.lda <- train(SUCCESS~., data=dataset, method="lda", metric=metric, trControl=control)
#fit.lda <- train(SUCCESS~., data=dataset_no_const_var, method="lda", metric=metric, trControl=control)
names(dataset)
# SEEING THE COEFFICIENTS OF THE LINEAR MODEL!

names(dataset)

require(MASS)
r <- lda(formula = SUCCESS~ ., 
         data = dataset, 
         prior = c(0.82,0.11,0.07))

r$prior
r$counts

# the combination of linear coefficients
r$scaling


# b) nonlinear algorithms
# CART
set.seed(7)
fit.cart <- train(SUCCESS~., data=dataset, method="rpart", metric=metric, trControl=control)
# kNN
set.seed(7)
fit.knn <- train(SUCCESS~., data=dataset, method="knn", metric=metric, trControl=control)
# c) advanced algorithms
# SVM
set.seed(7)
fit.svm <- train(SUCCESS~., data=dataset, method="svmRadial", metric=metric, trControl=control)
# Random Forest
set.seed(7)
fit.rf <- train(SUCCESS~., data=dataset, method="rf", metric=metric, trControl=control)

# 5.3 Select Best Model

# summarize accuracy of models
results <- resamples(list(lda=fit.lda, cart=fit.cart, knn=fit.knn, svm=fit.svm, rf=fit.rf))
summary(results)

# compare accuracy of models
dotplot(results)

# summarize Best Model
print(fit.rf)


# Section 6. Make Predictions

# validation set: set columns to be the same as training data...


# need to convert SUCCESS to factor...
test_var <- as.factor(validation$SUCCESS)
validation$SUCCESS <- test_var

# estimate skill of models on the validation dataset
predictions <- predict(fit.lda, validation)
confusionMatrix(predictions, validation$SUCCESS)

predictions <- predict(fit.knn, validation)
confusionMatrix(predictions, validation$SUCCESS)

predictions <- predict(fit.svm, validation)
confusionMatrix(predictions, validation$SUCCESS)

predictions <- predict(fit.cart, validation)
confusionMatrix(predictions, validation$SUCCESS)

predictions <- predict(fit.rf, validation)
confusionMatrix(predictions, validation$SUCCESS)

# WEEK 4: BALANCE THE DATASET!


drops <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.1..1068907.","Quiz.3..1127314.","X1..HelloWorld..1067474.","X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.", "X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.","X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.", "X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.","Recitation.10..1129728.", "Recitation.3..1129730.", "Recitation.7..1129732.","Recitation.4..1129733.", "Recitation.12..1129734.","Recitation.5..1129735.", "Recitation.8..1129736.","Recitation.13..1129737.","Recitation.11..1129738.","Recitations.Final.Score","Quizzes.Final.Score","Assignments.Final.Score")
data_week4 <- saved_data_no_var_no_corr[ , !(names(saved_data_no_var_no_corr) %in% drops)]

table(data_week4$SUCCESS)


dataset_success <- data_week4[data_week4$SUCCESS==1,]
dataset_not_success <- data_week4[data_week4$SUCCESS==2,]
dataset_struggling <- data_week4[data_week4$SUCCESS==3,]

#dataset_trunc <- dataset_struggling
dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

data_f20_saved <- dataset_trunc
data_f20 <- dataset_trunc

w4_b_ft__sensitivities_lda <- list()
w4_b_ft__sensitivities_lda_c1 <- list()
w4_b_ft__sensitivities_lda_c2 <- list()
w4_b_ft__sensitivities_lda_c3 <- list()

w4_b_ft__sensitivities_knn <- list()
w4_b_ft__sensitivities_knn_c1 <- list()
w4_b_ft__sensitivities_knn_c2 <- list()
w4_b_ft__sensitivities_knn_c3 <- list()

w4_b_ft__sensitivities_svm <- list()
w4_b_ft__sensitivities_svm_c1 <- list()
w4_b_ft__sensitivities_svm_c2 <- list()
w4_b_ft__sensitivities_svm_c3 <- list()

w4_b_ft__sensitivities_cart <- list()
w4_b_ft__sensitivities_cart_c1 <- list()
w4_b_ft__sensitivities_cart_c2 <- list()
w4_b_ft__sensitivities_cart_c3 <- list()

w4_b_ft__sensitivities_rf <- list()
w4_b_ft__sensitivities_rf_c1 <- list()
w4_b_ft__sensitivities_rf_c2 <- list()
w4_b_ft__sensitivities_rf_c3 <- list()


w4_b_ft__specificities_lda <- list()
w4_b_ft__specificities_lda_c1 <- list()
w4_b_ft__specificities_lda_c2 <- list()
w4_b_ft__specificities_lda_c3 <- list()

w4_b_ft__specificities_knn <- list()
w4_b_ft__specificities_knn_c1 <- list()
w4_b_ft__specificities_knn_c2 <- list()
w4_b_ft__specificities_knn_c3 <- list()

w4_b_ft__specificities_svm <- list()
w4_b_ft__specificities_svm_c1 <- list()
w4_b_ft__specificities_svm_c2 <- list()
w4_b_ft__specificities_svm_c3 <- list()

w4_b_ft__specificities_cart <- list()
w4_b_ft__specificities_cart_c1 <- list()
w4_b_ft__specificities_cart_c2 <- list()
w4_b_ft__specificities_cart_c3 <- list()

w4_b_ft__specificities_rf <- list()
w4_b_ft__specificities_rf_c1 <- list()
w4_b_ft__specificities_rf_c2 <- list()
w4_b_ft__specificities_rf_c3 <- list()


i <- 0

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  i <- i+1
  
  data_f20 <- data_f20_saved
  
  if (i>1000){
    break
  }
  print(i)
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  validation <- data_f20[-validation_index,]
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  # make sure no features with variance 0 now that we split into training and testing
  #low_var_ft <- which(apply(dataset, 2, var) < 0.05)
  #data_no_low_var <- dataset[,- as.numeric(low_var_ft)]
  
  #data_no_low_var <- dataset[,!names(dataset) %in% names(low_var_ft)]
  #validation_u <- validation[,!names(validation) %in% names(low_var_ft)]
  
  #validation_s <- validation
  #validation <- validation_u
  
  # a) linear algorithm
  set.seed(7)
  fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(7)
  fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  # kNN
  set.seed(7)
  fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  # c) advanced algorithms
  # SVM
  set.seed(7)
  fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  # Random Forest
  set.seed(7)
  fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  
  
  # Section 6. Make Predictions
  
  # need to convert SUCCESS to factor...
  test_var <- as.factor(validation$SUCCESS)
  validation$SUCCESS <- test_var
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  names(data_no_low_var)
  names(validation)
  
  w4_b_ft__sensitivities_lda <- append(w4_b_ft__sensitivities_lda, lda_sens)
  w4_b_ft__sensitivities_lda_c1 <- append(w4_b_ft__sensitivities_lda_c1, lda_sens[[1]])
  w4_b_ft__sensitivities_lda_c2 <- append(w4_b_ft__sensitivities_lda_c2, lda_sens[[2]])
  w4_b_ft__sensitivities_lda_c3 <- append(w4_b_ft__sensitivities_lda_c3, lda_sens[[3]])
  
  w4_b_ft__specificities_lda <- append(w4_b_ft__specificities_lda, cm_lda$byClass[,"Specificity"])
  w4_b_ft__specificities_lda_c1 <- append(w4_b_ft__specificities_lda_c1, lda_spec[[1]])
  w4_b_ft__specificities_lda_c2 <- append(w4_b_ft__specificities_lda_c2, lda_spec[[2]])
  w4_b_ft__specificities_lda_c3 <- append(w4_b_ft__specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  w4_b_ft__sensitivities_knn <- append(w4_b_ft__sensitivities_knn, knn_sens)
  w4_b_ft__sensitivities_knn_c1 <- append(w4_b_ft__sensitivities_knn_c1, knn_sens[[1]])
  w4_b_ft__sensitivities_knn_c2 <- append(w4_b_ft__sensitivities_knn_c2, knn_sens[[2]])
  w4_b_ft__sensitivities_knn_c3 <- append(w4_b_ft__sensitivities_knn_c3, knn_sens[[3]])
  
  w4_b_ft__specificities_knn <- append(w4_b_ft__specificities_knn, cm_knn$byClass[,"Specificity"])
  w4_b_ft__specificities_knn_c1 <- append(w4_b_ft__specificities_knn_c1, knn_spec[[1]])
  w4_b_ft__specificities_knn_c2 <- append(w4_b_ft__specificities_knn_c2, knn_spec[[2]])
  w4_b_ft__specificities_knn_c3 <- append(w4_b_ft__specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  w4_b_ft__sensitivities_svm <- append(w4_b_ft__sensitivities_svm, svm_sens)
  w4_b_ft__sensitivities_svm_c1 <- append(w4_b_ft__sensitivities_svm_c1, svm_sens[[1]])
  w4_b_ft__sensitivities_svm_c2 <- append(w4_b_ft__sensitivities_svm_c2, svm_sens[[2]])
  w4_b_ft__sensitivities_svm_c3 <- append(w4_b_ft__sensitivities_svm_c3, svm_sens[[3]])
  
  w4_b_ft__specificities_svm <- append(w4_b_ft__specificities_svm, cm_svm$byClass[,"Specificity"])
  w4_b_ft__specificities_svm_c1 <- append(w4_b_ft__specificities_svm_c1, svm_spec[[1]])
  w4_b_ft__specificities_svm_c2 <- append(w4_b_ft__specificities_svm_c2, svm_spec[[2]])
  w4_b_ft__specificities_svm_c3 <- append(w4_b_ft__specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  w4_b_ft__sensitivities_cart <- append(w4_b_ft__sensitivities_cart, cart_sens)
  w4_b_ft__sensitivities_cart_c1 <- append(w4_b_ft__sensitivities_cart_c1, cart_sens[[1]])
  w4_b_ft__sensitivities_cart_c2 <- append(w4_b_ft__sensitivities_cart_c2, cart_sens[[2]])
  w4_b_ft__sensitivities_cart_c3 <- append(w4_b_ft__sensitivities_cart_c3, cart_sens[[3]])
  
  w4_b_ft__specificities_cart <- append(w4_b_ft__specificities_cart, cm_cart$byClass[,"Specificity"])
  w4_b_ft__specificities_cart_c1 <- append(w4_b_ft__specificities_cart_c1, cart_spec[[1]])
  w4_b_ft__specificities_cart_c2 <- append(w4_b_ft__specificities_cart_c2, cart_spec[[2]])
  w4_b_ft__specificities_cart_c3 <- append(w4_b_ft__specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  w4_b_ft__sensitivities_rf <- append(w4_b_ft__sensitivities_rf, rf_sens)
  w4_b_ft__sensitivities_rf_c1 <- append(w4_b_ft__sensitivities_rf_c1, rf_sens[[1]])
  w4_b_ft__sensitivities_rf_c2 <- append(w4_b_ft__sensitivities_rf_c2, rf_sens[[2]])
  w4_b_ft__sensitivities_rf_c3 <- append(w4_b_ft__sensitivities_rf_c3, rf_sens[[3]])
  
  w4_b_ft__specificities_rf <- append(w4_b_ft__specificities_rf, cm_rf$byClass[,"Specificity"])
  w4_b_ft__specificities_rf_c1 <- append(w4_b_ft__specificities_rf_c1, rf_spec[[1]])
  w4_b_ft__specificities_rf_c2 <- append(w4_b_ft__specificities_rf_c2, rf_spec[[2]])
  w4_b_ft__specificities_rf_c3 <- append(w4_b_ft__specificities_rf_c3, rf_spec[[3]])
}

names(data_no_low_var)

print("SENSITIVITIES")
print("MIN C1")
min(unlist(w4_b_ft__sensitivities_lda_c1))
min(unlist(w4_b_ft__sensitivities_knn_c1))
min(unlist(w4_b_ft__sensitivities_svm_c1))
min(unlist(w4_b_ft__sensitivities_cart_c1))
min(unlist(w4_b_ft__sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(w4_b_ft__sensitivities_lda_c1))
mean(unlist(w4_b_ft__sensitivities_knn_c1))
mean(unlist(w4_b_ft__sensitivities_svm_c1))
mean(unlist(w4_b_ft__sensitivities_cart_c1))
mean(unlist(w4_b_ft__sensitivities_rf_c1))


print("MAX C1")
max(unlist(w4_b_ft__sensitivities_lda_c1))
max(unlist(w4_b_ft__sensitivities_knn_c1))
max(unlist(w4_b_ft__sensitivities_svm_c1))
max(unlist(w4_b_ft__sensitivities_cart_c1))
max(unlist(w4_b_ft__sensitivities_rf_c1))

print("MIN C2")
min(unlist(w4_b_ft__sensitivities_lda_c2))
min(unlist(w4_b_ft__sensitivities_knn_c2))
min(unlist(w4_b_ft__sensitivities_svm_c2))
min(unlist(w4_b_ft__sensitivities_cart_c2))
min(unlist(w4_b_ft__sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(w4_b_ft__sensitivities_lda_c2))
mean(unlist(w4_b_ft__sensitivities_knn_c2))
mean(unlist(w4_b_ft__sensitivities_svm_c2))
mean(unlist(w4_b_ft__sensitivities_cart_c2))
mean(unlist(w4_b_ft__sensitivities_rf_c2))


print("MAX C2")
max(unlist(w4_b_ft__sensitivities_lda_c2))
max(unlist(w4_b_ft__sensitivities_knn_c2))
max(unlist(w4_b_ft__sensitivities_svm_c2))
max(unlist(w4_b_ft__sensitivities_cart_c2))
max(unlist(w4_b_ft__sensitivities_rf_c2))


print("MIN C3")
min(unlist(w4_b_ft__sensitivities_lda_c3))
min(unlist(w4_b_ft__sensitivities_knn_c3))
min(unlist(w4_b_ft__sensitivities_svm_c3))
min(unlist(w4_b_ft__sensitivities_cart_c3))
min(unlist(w4_b_ft__sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(w4_b_ft__sensitivities_lda_c3))
mean(unlist(w4_b_ft__sensitivities_knn_c3))
mean(unlist(w4_b_ft__sensitivities_svm_c3))
mean(unlist(w4_b_ft__sensitivities_cart_c3))
mean(unlist(w4_b_ft__sensitivities_rf_c3))


print("MAX C3")
max(unlist(w4_b_ft__sensitivities_lda_c3))
max(unlist(w4_b_ft__sensitivities_knn_c3))
max(unlist(w4_b_ft__sensitivities_svm_c3))
max(unlist(w4_b_ft__sensitivities_cart_c3))
max(unlist(w4_b_ft__sensitivities_rf_c3))


print("SPECIFICITIES")
print("MIN C1")
min(unlist(w4_b_ft__specificities_lda_c1))
min(unlist(w4_b_ft__specificities_knn_c1))
min(unlist(w4_b_ft__specificities_svm_c1))
min(unlist(w4_b_ft__specificities_cart_c1))
min(unlist(w4_b_ft__specificities_rf_c1))

print("MEAN C1")
mean(unlist(w4_b_ft__specificities_lda_c1))
mean(unlist(w4_b_ft__specificities_knn_c1))
mean(unlist(w4_b_ft__specificities_svm_c1))
mean(unlist(w4_b_ft__specificities_cart_c1))
mean(unlist(w4_b_ft__specificities_rf_c1))


print("MAX C1")
max(unlist(w4_b_ft__specificities_lda_c1))
max(unlist(w4_b_ft__specificities_knn_c1))
max(unlist(w4_b_ft__specificities_svm_c1))
max(unlist(w4_b_ft__specificities_cart_c1))
max(unlist(w4_b_ft__specificities_rf_c1))

print("MIN C2")
min(unlist(w4_b_ft__specificities_lda_c2))
min(unlist(w4_b_ft__specificities_knn_c2))
min(unlist(w4_b_ft__specificities_svm_c2))
min(unlist(w4_b_ft__specificities_cart_c2))
min(unlist(w4_b_ft__specificities_rf_c2))

print("MEAN C2")
mean(unlist(w4_b_ft__specificities_lda_c2))
mean(unlist(w4_b_ft__specificities_knn_c2))
mean(unlist(w4_b_ft__specificities_svm_c2))
mean(unlist(w4_b_ft__specificities_cart_c2))
mean(unlist(w4_b_ft__specificities_rf_c2))


print("MAX C2")
max(unlist(w4_b_ft__specificities_lda_c2))
max(unlist(w4_b_ft__specificities_knn_c2))
max(unlist(w4_b_ft__specificities_svm_c2))
max(unlist(w4_b_ft__specificities_cart_c2))
max(unlist(w4_b_ft__specificities_rf_c2))


print("MIN C3")
min(unlist(w4_b_ft__specificities_lda_c3))
min(unlist(w4_b_ft__specificities_knn_c3))
min(unlist(w4_b_ft__specificities_svm_c3))
min(unlist(w4_b_ft__specificities_cart_c3))
min(unlist(w4_b_ft__specificities_rf_c3))

print("MEAN C3")
mean(unlist(w4_b_ft__specificities_lda_c3))
mean(unlist(w4_b_ft__specificities_knn_c3))
mean(unlist(w4_b_ft__specificities_svm_c3))
mean(unlist(w4_b_ft__specificities_cart_c3))
mean(unlist(w4_b_ft__specificities_rf_c3))


print("MAX C3")
max(unlist(w4_b_ft__specificities_lda_c3))
max(unlist(w4_b_ft__specificities_knn_c3))
max(unlist(w4_b_ft__specificities_svm_c3))
max(unlist(w4_b_ft__specificities_cart_c3))
max(unlist(w4_b_ft__specificities_rf_c3))



# WEEK 7!! (Including the first exam and a few more assignments)
# MODELS WITH DATA AVAIABLE DURING WEEK 7

# features: all features in intro survey
# all features in registrar data
# grades: Rec 1 - 6.
# Assignments: Pseudocode, HelloWorld, WindChill, Order Check
# Exams: 1 (aka Quiz 1)

drops <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.3..1127314.", "X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.","X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.", "X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.","Recitation.10..1129728.",  "Recitation.7..1129732.", "Recitation.12..1129734.", "Recitation.8..1129736.","Recitation.13..1129737.","Recitation.11..1129738.","Recitations.Final.Score","Quizzes.Final.Score","Assignments.Final.Score")
data_week7 <- saved_data_no_var_no_corr[ , !(names(saved_data_no_var_no_corr) %in% drops)]

names(data_week7)
data_week7_s <- data_week7

# add the drops from all variables because some have very small variance..
drops1 <- c( "Q1Astrophysics..BS.", "Q1Cognitive.Science..BA. ", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Criminal.Justice..BA.","Q1Linguistics..BA.","Q1Physics...Engineering.Dual.Degree","Q1Psychology..BA.", "Q1Statistics.Mathematics..BA.", "Q4","Q2It.is.an.elective", "Q2Other..please.explain", "Q39_1Strongly.disagree","Q39_3Strongly.agree","Q39_5Strongly.agree" )
data_week7 <-data_week7_s[ , !(names(data_week7_s) %in% drops1)]

# ------   SAVE  ALL  THE  DATA  !! ------------

data_f20_saved <- data_week7
data_f20_saved_again <- data_f20_saved
data_f20 <- data_f20_saved

dataset_success <- data_week7[data_week7$SUCCESS==1,]
dataset_not_success <- data_week7[data_week7$SUCCESS==2,]
dataset_struggling <- data_week7[data_week7$SUCCESS==3,]

table(data_week7$SUCCESS)

#dataset_trunc <- dataset_struggling
dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

data_f20_saved <- dataset_trunc
data_f20 <- dataset_trunc

w7_b_ft__sensitivities_lda <- list()
w7_b_ft__sensitivities_lda_c1 <- list()
w7_b_ft__sensitivities_lda_c2 <- list()
w7_b_ft__sensitivities_lda_c3 <- list()

w7_b_ft__sensitivities_knn <- list()
w7_b_ft__sensitivities_knn_c1 <- list()
w7_b_ft__sensitivities_knn_c2 <- list()
w7_b_ft__sensitivities_knn_c3 <- list()

w7_b_ft__sensitivities_svm <- list()
w7_b_ft__sensitivities_svm_c1 <- list()
w7_b_ft__sensitivities_svm_c2 <- list()
w7_b_ft__sensitivities_svm_c3 <- list()

w7_b_ft__sensitivities_cart <- list()
w7_b_ft__sensitivities_cart_c1 <- list()
w7_b_ft__sensitivities_cart_c2 <- list()
w7_b_ft__sensitivities_cart_c3 <- list()

w7_b_ft__sensitivities_rf <- list()
w7_b_ft__sensitivities_rf_c1 <- list()
w7_b_ft__sensitivities_rf_c2 <- list()
w7_b_ft__sensitivities_rf_c3 <- list()


w7_b_ft__specificities_lda <- list()
w7_b_ft__specificities_lda_c1 <- list()
w7_b_ft__specificities_lda_c2 <- list()
w7_b_ft__specificities_lda_c3 <- list()

w7_b_ft__specificities_knn <- list()
w7_b_ft__specificities_knn_c1 <- list()
w7_b_ft__specificities_knn_c2 <- list()
w7_b_ft__specificities_knn_c3 <- list()

w7_b_ft__specificities_svm <- list()
w7_b_ft__specificities_svm_c1 <- list()
w7_b_ft__specificities_svm_c2 <- list()
w7_b_ft__specificities_svm_c3 <- list()

w7_b_ft__specificities_cart <- list()
w7_b_ft__specificities_cart_c1 <- list()
w7_b_ft__specificities_cart_c2 <- list()
w7_b_ft__specificities_cart_c3 <- list()

w7_b_ft__specificities_rf <- list()
w7_b_ft__specificities_rf_c1 <- list()
w7_b_ft__specificities_rf_c2 <- list()
w7_b_ft__specificities_rf_c3 <- list()

w7_b_accuracy_lda <- list()
w7_b_accuracy_knn <- list()
w7_b_accuracy_cart <- list()
w7_b_accuracy_svm <- list()
w7_b_accuracy_rf <- list()

i <- 0

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  i <- i+1
  
  data_f20 <- data_f20_saved
  
  if (i>100){
    break
  }
  print(i)
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  validation <- data_f20[-validation_index,]
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  # make sure no features with variance 0 now that we split into training and testing
  low_var_ft <- which(apply(dataset, 2, var) < 0.05)
  data_no_low_var <- dataset[,- as.numeric(low_var_ft)]
  
  data_no_low_var <- dataset[,!names(dataset) %in% names(low_var_ft)]
  validation_u <- validation[,!names(validation) %in% names(low_var_ft)]
  
  validation_s <- validation
  validation <- validation_u
  
  # a) linear algorithm
  set.seed(7)
  fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(7)
  fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  # kNN
  set.seed(7)
  fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  # c) advanced algorithms
  # SVM
  set.seed(7)
  fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  # Random Forest
  set.seed(7)
  fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  
  # ADD ACCURACIES
  
  w7_b_accuracy_lda <- append(w7_b_accuracy_lda,mean(fit.lda$resample$Accuracy))
  w7_b_accuracy_knn <- append(w7_b_accuracy_knn,mean(fit.knn$resample$Accuracy))
  w7_b_accuracy_cart <- append(w7_b_accuracy_cart,mean(fit.cart$resample$Accuracy))
  w7_b_accuracy_svm <- append(w7_b_accuracy_svm,mean(fit.svm$resample$Accuracy))
  w7_b_accuracy_rf <- append(w7_b_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  # Section 6. Make Predictions
  
  # need to convert SUCCESS to factor...
  test_var <- as.factor(validation$SUCCESS)
  validation$SUCCESS <- test_var
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  names(data_no_low_var)
  names(validation)
  
  w7_b_ft__sensitivities_lda <- append(w7_b_ft__sensitivities_lda, lda_sens)
  w7_b_ft__sensitivities_lda_c1 <- append(w7_b_ft__sensitivities_lda_c1, lda_sens[[1]])
  w7_b_ft__sensitivities_lda_c2 <- append(w7_b_ft__sensitivities_lda_c2, lda_sens[[2]])
  w7_b_ft__sensitivities_lda_c3 <- append(w7_b_ft__sensitivities_lda_c3, lda_sens[[3]])
  
  w7_b_ft__specificities_lda <- append(w7_b_ft__specificities_lda, cm_lda$byClass[,"Specificity"])
  w7_b_ft__specificities_lda_c1 <- append(w7_b_ft__specificities_lda_c1, lda_spec[[1]])
  w7_b_ft__specificities_lda_c2 <- append(w7_b_ft__specificities_lda_c2, lda_spec[[2]])
  w7_b_ft__specificities_lda_c3 <- append(w7_b_ft__specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  w7_b_ft__sensitivities_knn <- append(w7_b_ft__sensitivities_knn, knn_sens)
  w7_b_ft__sensitivities_knn_c1 <- append(w7_b_ft__sensitivities_knn_c1, knn_sens[[1]])
  w7_b_ft__sensitivities_knn_c2 <- append(w7_b_ft__sensitivities_knn_c2, knn_sens[[2]])
  w7_b_ft__sensitivities_knn_c3 <- append(w7_b_ft__sensitivities_knn_c3, knn_sens[[3]])
  
  w7_b_ft__specificities_knn <- append(w7_b_ft__specificities_knn, cm_knn$byClass[,"Specificity"])
  w7_b_ft__specificities_knn_c1 <- append(w7_b_ft__specificities_knn_c1, knn_spec[[1]])
  w7_b_ft__specificities_knn_c2 <- append(w7_b_ft__specificities_knn_c2, knn_spec[[2]])
  w7_b_ft__specificities_knn_c3 <- append(w7_b_ft__specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  w7_b_ft__sensitivities_svm <- append(w7_b_ft__sensitivities_svm, svm_sens)
  w7_b_ft__sensitivities_svm_c1 <- append(w7_b_ft__sensitivities_svm_c1, svm_sens[[1]])
  w7_b_ft__sensitivities_svm_c2 <- append(w7_b_ft__sensitivities_svm_c2, svm_sens[[2]])
  w7_b_ft__sensitivities_svm_c3 <- append(w7_b_ft__sensitivities_svm_c3, svm_sens[[3]])
  
  w7_b_ft__specificities_svm <- append(w7_b_ft__specificities_svm, cm_svm$byClass[,"Specificity"])
  w7_b_ft__specificities_svm_c1 <- append(w7_b_ft__specificities_svm_c1, svm_spec[[1]])
  w7_b_ft__specificities_svm_c2 <- append(w7_b_ft__specificities_svm_c2, svm_spec[[2]])
  w7_b_ft__specificities_svm_c3 <- append(w7_b_ft__specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  w7_b_ft__sensitivities_cart <- append(w7_b_ft__sensitivities_cart, cart_sens)
  w7_b_ft__sensitivities_cart_c1 <- append(w7_b_ft__sensitivities_cart_c1, cart_sens[[1]])
  w7_b_ft__sensitivities_cart_c2 <- append(w7_b_ft__sensitivities_cart_c2, cart_sens[[2]])
  w7_b_ft__sensitivities_cart_c3 <- append(w7_b_ft__sensitivities_cart_c3, cart_sens[[3]])
  
  w7_b_ft__specificities_cart <- append(w7_b_ft__specificities_cart, cm_cart$byClass[,"Specificity"])
  w7_b_ft__specificities_cart_c1 <- append(w7_b_ft__specificities_cart_c1, cart_spec[[1]])
  w7_b_ft__specificities_cart_c2 <- append(w7_b_ft__specificities_cart_c2, cart_spec[[2]])
  w7_b_ft__specificities_cart_c3 <- append(w7_b_ft__specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  w7_b_ft__sensitivities_rf <- append(w7_b_ft__sensitivities_rf, rf_sens)
  w7_b_ft__sensitivities_rf_c1 <- append(w7_b_ft__sensitivities_rf_c1, rf_sens[[1]])
  w7_b_ft__sensitivities_rf_c2 <- append(w7_b_ft__sensitivities_rf_c2, rf_sens[[2]])
  w7_b_ft__sensitivities_rf_c3 <- append(w7_b_ft__sensitivities_rf_c3, rf_sens[[3]])
  
  w7_b_ft__specificities_rf <- append(w7_b_ft__specificities_rf, cm_rf$byClass[,"Specificity"])
  w7_b_ft__specificities_rf_c1 <- append(w7_b_ft__specificities_rf_c1, rf_spec[[1]])
  w7_b_ft__specificities_rf_c2 <- append(w7_b_ft__specificities_rf_c2, rf_spec[[2]])
  w7_b_ft__specificities_rf_c3 <- append(w7_b_ft__specificities_rf_c3, rf_spec[[3]])
}

names(data_no_low_var)

print("ACCURACIES")
print("MIN")
min(unlist(w7_b_accuracy_lda))
min(unlist(w7_b_accuracy_knn))
min(unlist(w7_b_accuracy_svm))
min(unlist(w7_b_accuracy_cart))
min(unlist(w7_b_accuracy_rf))

print("MEAN")
mean(unlist(w7_b_accuracy_lda))
mean(unlist(w7_b_accuracy_knn))
mean(unlist(w7_b_accuracy_svm))
mean(unlist(w7_b_accuracy_cart))
mean(unlist(w7_b_accuracy_rf))

print("MAX")
max(unlist(w7_b_accuracy_lda))
max(unlist(w7_b_accuracy_knn))
max(unlist(w7_b_accuracy_svm))
max(unlist(w7_b_accuracy_cart))
max(unlist(w7_b_accuracy_rf))

print("SENSITIVITIES")
print("MIN C1")
min(unlist(w7_b_ft__sensitivities_lda_c1))
min(unlist(w7_b_ft__sensitivities_knn_c1))
min(unlist(w7_b_ft__sensitivities_svm_c1))
min(unlist(w7_b_ft__sensitivities_cart_c1))
min(unlist(w7_b_ft__sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(w7_b_ft__sensitivities_lda_c1))
mean(unlist(w7_b_ft__sensitivities_knn_c1))
mean(unlist(w7_b_ft__sensitivities_svm_c1))
mean(unlist(w7_b_ft__sensitivities_cart_c1))
mean(unlist(w7_b_ft__sensitivities_rf_c1))


print("MAX C1")
max(unlist(w7_b_ft__sensitivities_lda_c1))
max(unlist(w7_b_ft__sensitivities_knn_c1))
max(unlist(w7_b_ft__sensitivities_svm_c1))
max(unlist(w7_b_ft__sensitivities_cart_c1))
max(unlist(w7_b_ft__sensitivities_rf_c1))

print("MIN C2")
min(unlist(w7_b_ft__sensitivities_lda_c2))
min(unlist(w7_b_ft__sensitivities_knn_c2))
min(unlist(w7_b_ft__sensitivities_svm_c2))
min(unlist(w7_b_ft__sensitivities_cart_c2))
min(unlist(w7_b_ft__sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(w7_b_ft__sensitivities_lda_c2))
mean(unlist(w7_b_ft__sensitivities_knn_c2))
mean(unlist(w7_b_ft__sensitivities_svm_c2))
mean(unlist(w7_b_ft__sensitivities_cart_c2))
mean(unlist(w7_b_ft__sensitivities_rf_c2))


print("MAX C2")
max(unlist(w7_b_ft__sensitivities_lda_c2))
max(unlist(w7_b_ft__sensitivities_knn_c2))
max(unlist(w7_b_ft__sensitivities_svm_c2))
max(unlist(w7_b_ft__sensitivities_cart_c2))
max(unlist(w7_b_ft__sensitivities_rf_c2))


print("MIN C3")
min(unlist(w7_b_ft__sensitivities_lda_c3))
min(unlist(w7_b_ft__sensitivities_knn_c3))
min(unlist(w7_b_ft__sensitivities_svm_c3))
min(unlist(w7_b_ft__sensitivities_cart_c3))
min(unlist(w7_b_ft__sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(w7_b_ft__sensitivities_lda_c3))
mean(unlist(w7_b_ft__sensitivities_knn_c3))
mean(unlist(w7_b_ft__sensitivities_svm_c3))
mean(unlist(w7_b_ft__sensitivities_cart_c3))
mean(unlist(w7_b_ft__sensitivities_rf_c3))


print("MAX C3")
max(unlist(w7_b_ft__sensitivities_lda_c3))
max(unlist(w7_b_ft__sensitivities_knn_c3))
max(unlist(w7_b_ft__sensitivities_svm_c3))
max(unlist(w7_b_ft__sensitivities_cart_c3))
max(unlist(w7_b_ft__sensitivities_rf_c3))


print("SPECIFICITIES")
print("MIN C1")
min(unlist(w7_b_ft__specificities_lda_c1))
min(unlist(w7_b_ft__specificities_knn_c1))
min(unlist(w7_b_ft__specificities_svm_c1))
min(unlist(w7_b_ft__specificities_cart_c1))
min(unlist(w7_b_ft__specificities_rf_c1))

print("MEAN C1")
mean(unlist(w7_b_ft__specificities_lda_c1))
mean(unlist(w7_b_ft__specificities_knn_c1))
mean(unlist(w7_b_ft__specificities_svm_c1))
mean(unlist(w7_b_ft__specificities_cart_c1))
mean(unlist(w7_b_ft__specificities_rf_c1))


print("MAX C1")
max(unlist(w7_b_ft__specificities_lda_c1))
max(unlist(w7_b_ft__specificities_knn_c1))
max(unlist(w7_b_ft__specificities_svm_c1))
max(unlist(w7_b_ft__specificities_cart_c1))
max(unlist(w7_b_ft__specificities_rf_c1))

print("MIN C2")
min(unlist(w7_b_ft__specificities_lda_c2))
min(unlist(w7_b_ft__specificities_knn_c2))
min(unlist(w7_b_ft__specificities_svm_c2))
min(unlist(w7_b_ft__specificities_cart_c2))
min(unlist(w7_b_ft__specificities_rf_c2))

print("MEAN C2")
mean(unlist(w7_b_ft__specificities_lda_c2))
mean(unlist(w7_b_ft__specificities_knn_c2))
mean(unlist(w7_b_ft__specificities_svm_c2))
mean(unlist(w7_b_ft__specificities_cart_c2))
mean(unlist(w7_b_ft__specificities_rf_c2))


print("MAX C2")
max(unlist(w7_b_ft__specificities_lda_c2))
max(unlist(w7_b_ft__specificities_knn_c2))
max(unlist(w7_b_ft__specificities_svm_c2))
max(unlist(w7_b_ft__specificities_cart_c2))
max(unlist(w7_b_ft__specificities_rf_c2))


print("MIN C3")
min(unlist(w7_b_ft__specificities_lda_c3))
min(unlist(w7_b_ft__specificities_knn_c3))
min(unlist(w7_b_ft__specificities_svm_c3))
min(unlist(w7_b_ft__specificities_cart_c3))
min(unlist(w7_b_ft__specificities_rf_c3))

print("MEAN C3")
mean(unlist(w7_b_ft__specificities_lda_c3))
mean(unlist(w7_b_ft__specificities_knn_c3))
mean(unlist(w7_b_ft__specificities_svm_c3))
mean(unlist(w7_b_ft__specificities_cart_c3))
mean(unlist(w7_b_ft__specificities_rf_c3))


print("MAX C3")
max(unlist(w7_b_ft__specificities_lda_c3))
max(unlist(w7_b_ft__specificities_knn_c3))
max(unlist(w7_b_ft__specificities_svm_c3))
max(unlist(w7_b_ft__specificities_cart_c3))
max(unlist(w7_b_ft__specificities_rf_c3))



# WEEK 7 MODELS WITH AUTOLAB: BALANCED

# The autolab dataset was merged with the rest of the data containing all the
# features, need to get rid of those that are available after week 7

drops <- c("Quiz.2..1127309.", "Quiz.4..1129289.", "Quiz.3..1127314.", "X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.","X6..Two.Smallest..1067529.", "X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.", "X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.", "X15..Heart.Transplant..1126986.","X16..Assignment.8...Complexity.Analysis..1129495.", "Recitation.6..1129726.", "Recitation.9..1129727.","Recitation.10..1129728.",  "Recitation.7..1129732.", "Recitation.12..1129734.", "Recitation.8..1129736.","Recitation.13..1129737.","Recitation.11..1129738.","Recitations.Final.Score","Quizzes.Final.Score","Assignments.Final.Score")
data_week7 <- saved_data_no_var_no_corr_a[ , !(names(saved_data_no_var_no_corr_a) %in% drops)]

data_week7_s <- data_week7

# add the drops from all variables because some have very small variance..
drops1 <- c( "Q1Astrophysics..BS.", "Q1Cognitive.Science..BA. ", "Q1Cell.Biology.and.Neuroscience..BA.","Q1Criminal.Justice..BA.","Q1Linguistics..BA.","Q1Physics...Engineering.Dual.Degree","Q1Psychology..BA.", "Q1Statistics.Mathematics..BA.", "Q4","Q2It.is.an.elective", "Q2Other..please.explain", "Q39_1Strongly.disagree","Q39_3Strongly.agree","Q39_5Strongly.agree" )
data_week7 <-data_week7_s[ , !(names(data_week7_s) %in% drops1)]
data_week7$SUCCESS <- as.factor(data_week7$SUCCESS)

names(data_week7)

# ------   SAVE  ALL  THE  DATA  !! ------------

data_f20_saved <- data_week7
data_f20_saved_again <- data_f20_saved
data_f20 <- data_f20_saved

dataset_success <- data_week7[data_week7$SUCCESS==1,]
dataset_not_success <- data_week7[data_week7$SUCCESS==2,]
dataset_struggling <- data_week7[data_week7$SUCCESS==3,]

table(data_week7$SUCCESS)

#dataset_trunc <- dataset_struggling
dataset_trunc <- rbind(dataset_success[sample(nrow(dataset_success), 75), ], dataset_not_success, dataset_struggling)
table(dataset_trunc$SUCCESS) # more balanced

data_f20_saved <- dataset_trunc
data_f20 <- dataset_trunc

names(data_f20)

w7_ab_ft__sensitivities_lda <- list()
w7_ab_ft__sensitivities_lda_c1 <- list()
w7_ab_ft__sensitivities_lda_c2 <- list()
w7_ab_ft__sensitivities_lda_c3 <- list()

w7_ab_ft__sensitivities_knn <- list()
w7_ab_ft__sensitivities_knn_c1 <- list()
w7_ab_ft__sensitivities_knn_c2 <- list()
w7_ab_ft__sensitivities_knn_c3 <- list()

w7_ab_ft__sensitivities_svm <- list()
w7_ab_ft__sensitivities_svm_c1 <- list()
w7_ab_ft__sensitivities_svm_c2 <- list()
w7_ab_ft__sensitivities_svm_c3 <- list()

w7_ab_ft__sensitivities_cart <- list()
w7_ab_ft__sensitivities_cart_c1 <- list()
w7_ab_ft__sensitivities_cart_c2 <- list()
w7_ab_ft__sensitivities_cart_c3 <- list()

w7_ab_ft__sensitivities_rf <- list()
w7_ab_ft__sensitivities_rf_c1 <- list()
w7_ab_ft__sensitivities_rf_c2 <- list()
w7_ab_ft__sensitivities_rf_c3 <- list()


w7_ab_ft__specificities_lda <- list()
w7_ab_ft__specificities_lda_c1 <- list()
w7_ab_ft__specificities_lda_c2 <- list()
w7_ab_ft__specificities_lda_c3 <- list()

w7_ab_ft__specificities_knn <- list()
w7_ab_ft__specificities_knn_c1 <- list()
w7_ab_ft__specificities_knn_c2 <- list()
w7_ab_ft__specificities_knn_c3 <- list()

w7_ab_ft__specificities_svm <- list()
w7_ab_ft__specificities_svm_c1 <- list()
w7_ab_ft__specificities_svm_c2 <- list()
w7_ab_ft__specificities_svm_c3 <- list()

w7_ab_ft__specificities_cart <- list()
w7_ab_ft__specificities_cart_c1 <- list()
w7_ab_ft__specificities_cart_c2 <- list()
w7_ab_ft__specificities_cart_c3 <- list()

w7_ab_ft__specificities_rf <- list()
w7_ab_ft__specificities_rf_c1 <- list()
w7_ab_ft__specificities_rf_c2 <- list()
w7_ab_ft__specificities_rf_c3 <- list()

w7_ab_accuracy_lda <- list()
w7_ab_accuracy_knn <- list()
w7_ab_accuracy_svm <- list()
w7_ab_accuracy_cart <- list()
w7_ab_accuracy_rf <- list()


i <- 0

# SELECT THE WHOLE REPEAT BLOCK TO RUN
repeat{
  i <- i+1
  
  data_f20 <- data_f20_saved
  
  if (i>1000){
    break
  }
  print(i)
  
  # 2.3. Create a Validation Dataset
  
  # create a list of 80% of the rows in the original dataset we can use for training
  validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)
  #validation_index1 <- createDataPartition(data_canvas_and_sas_f20_111$SUCCESS, p=0.80, list=FALSE)
  
  # select 20% of the data for validation
  validation <- data_f20[-validation_index,]
  # validation1 <- data_canvas_and_sas_f20_111[-validation_index1,]
  # use the remaining 80% of data to training and testing the models
  data_f20 <- data_f20[validation_index,]
  #data_canvas_and_sas_f20_111 <- data_canvas_and_sas_f20_111[validation_index1,]
  
  # split input and output
  
  x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
  y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
  
  # Run algorithms using 10-fold cross validation
  #set.seed(123)
  control <- trainControl(method="cv", number=10)
  metric <- "Accuracy"
  
  # Section 5.2. Build Models
  
  dataset <- x
  dataset$SUCCESS <- y
  
  # make sure no features with variance 0 now that we split into training and testing
  low_var_ft <- which(apply(dataset, 2, var) < 0.05)
  data_no_low_var <- dataset[,- as.numeric(low_var_ft)]
  
  data_no_low_var <- dataset[,!names(dataset) %in% names(low_var_ft)]
  validation_u <- validation[,!names(validation) %in% names(low_var_ft)]
  
  validation_s <- validation
  validation <- validation_u
  
  # a) linear algorithm
  set.seed(7)
  fit.lda <- train(SUCCESS~., data=data_no_low_var, method="lda", metric=metric, trControl=control)
  
  
  # b) nonlinear algorithms
  # CART
  set.seed(7)
  fit.cart <- train(SUCCESS~., data=data_no_low_var, method="rpart", metric=metric, trControl=control)
  # kNN
  set.seed(7)
  fit.knn <- train(SUCCESS~., data=data_no_low_var, method="knn", metric=metric, trControl=control)
  # c) advanced algorithms
  # SVM
  set.seed(7)
  fit.svm <- train(SUCCESS~., data=data_no_low_var, method="svmRadial", metric=metric, trControl=control)
  # Random Forest
  set.seed(7)
  fit.rf <- train(SUCCESS~., data=data_no_low_var, method="rf", metric=metric, trControl=control)
  
  #ADD ACCURACIES
  
  w7_ab_accuracy_lda <- append(w7_ab_accuracy_lda,mean(fit.lda$resample$Accuracy))
  w7_ab_accuracy_knn <- append(w7_ab_accuracy_knn,mean(fit.knn$resample$Accuracy))
  w7_ab_accuracy_cart <- append(w7_ab_accuracy_cart,mean(fit.cart$resample$Accuracy))
  w7_ab_accuracy_svm <- append(w7_ab_accuracy_svm,mean(fit.svm$resample$Accuracy))
  w7_ab_accuracy_rf <- append(w7_ab_accuracy_rf,mean(fit.rf$resample$Accuracy))
  
  
  
  # Section 6. Make Predictions
  
  # need to convert SUCCESS to factor...
  test_var <- as.factor(validation$SUCCESS)
  validation$SUCCESS <- test_var
  
  # estimate skill of models on the validation dataset
  predictions <- predict(fit.lda, validation)
  cm_lda <- confusionMatrix(predictions, validation$SUCCESS)
  lda_sens <- cm_lda$byClass[,"Sensitivity"]
  lda_spec <- cm_lda$byClass[,"Specificity"]
  
  names(data_no_low_var)
  names(validation)
  
  w7_ab_ft__sensitivities_lda <- append(w7_ab_ft__sensitivities_lda, lda_sens)
  w7_ab_ft__sensitivities_lda_c1 <- append(w7_ab_ft__sensitivities_lda_c1, lda_sens[[1]])
  w7_ab_ft__sensitivities_lda_c2 <- append(w7_ab_ft__sensitivities_lda_c2, lda_sens[[2]])
  w7_ab_ft__sensitivities_lda_c3 <- append(w7_ab_ft__sensitivities_lda_c3, lda_sens[[3]])
  
  w7_ab_ft__specificities_lda <- append(w7_ab_ft__specificities_lda, cm_lda$byClass[,"Specificity"])
  w7_ab_ft__specificities_lda_c1 <- append(w7_ab_ft__specificities_lda_c1, lda_spec[[1]])
  w7_ab_ft__specificities_lda_c2 <- append(w7_ab_ft__specificities_lda_c2, lda_spec[[2]])
  w7_ab_ft__specificities_lda_c3 <- append(w7_ab_ft__specificities_lda_c3, lda_spec[[3]])
  
  predictions <- predict(fit.knn, validation)
  cm_knn <- confusionMatrix(predictions, validation$SUCCESS)
  
  knn_sens <- cm_knn$byClass[,"Sensitivity"]
  knn_spec <- cm_knn$byClass[,"Specificity"]
  
  w7_ab_ft__sensitivities_knn <- append(w7_ab_ft__sensitivities_knn, knn_sens)
  w7_ab_ft__sensitivities_knn_c1 <- append(w7_ab_ft__sensitivities_knn_c1, knn_sens[[1]])
  w7_ab_ft__sensitivities_knn_c2 <- append(w7_ab_ft__sensitivities_knn_c2, knn_sens[[2]])
  w7_ab_ft__sensitivities_knn_c3 <- append(w7_ab_ft__sensitivities_knn_c3, knn_sens[[3]])
  
  w7_ab_ft__specificities_knn <- append(w7_ab_ft__specificities_knn, cm_knn$byClass[,"Specificity"])
  w7_ab_ft__specificities_knn_c1 <- append(w7_ab_ft__specificities_knn_c1, knn_spec[[1]])
  w7_ab_ft__specificities_knn_c2 <- append(w7_ab_ft__specificities_knn_c2, knn_spec[[2]])
  w7_ab_ft__specificities_knn_c3 <- append(w7_ab_ft__specificities_knn_c3, knn_spec[[3]])
  
  
  predictions <- predict(fit.svm, validation)
  cm_svm <- confusionMatrix(predictions, validation$SUCCESS)
  svm_sens <- cm_svm$byClass[,"Sensitivity"]
  svm_spec <- cm_svm$byClass[,"Specificity"]
  
  w7_ab_ft__sensitivities_svm <- append(w7_ab_ft__sensitivities_svm, svm_sens)
  w7_ab_ft__sensitivities_svm_c1 <- append(w7_ab_ft__sensitivities_svm_c1, svm_sens[[1]])
  w7_ab_ft__sensitivities_svm_c2 <- append(w7_ab_ft__sensitivities_svm_c2, svm_sens[[2]])
  w7_ab_ft__sensitivities_svm_c3 <- append(w7_ab_ft__sensitivities_svm_c3, svm_sens[[3]])
  
  w7_ab_ft__specificities_svm <- append(w7_ab_ft__specificities_svm, cm_svm$byClass[,"Specificity"])
  w7_ab_ft__specificities_svm_c1 <- append(w7_ab_ft__specificities_svm_c1, svm_spec[[1]])
  w7_ab_ft__specificities_svm_c2 <- append(w7_ab_ft__specificities_svm_c2, svm_spec[[2]])
  w7_ab_ft__specificities_svm_c3 <- append(w7_ab_ft__specificities_svm_c3, svm_spec[[3]])
  
  predictions <- predict(fit.cart, validation)
  cm_cart <- confusionMatrix(predictions, validation$SUCCESS)
  cart_sens <- cm_cart$byClass[,"Sensitivity"]
  cart_spec <- cm_cart$byClass[,"Specificity"]
  
  w7_ab_ft__sensitivities_cart <- append(w7_ab_ft__sensitivities_cart, cart_sens)
  w7_ab_ft__sensitivities_cart_c1 <- append(w7_ab_ft__sensitivities_cart_c1, cart_sens[[1]])
  w7_ab_ft__sensitivities_cart_c2 <- append(w7_ab_ft__sensitivities_cart_c2, cart_sens[[2]])
  w7_ab_ft__sensitivities_cart_c3 <- append(w7_ab_ft__sensitivities_cart_c3, cart_sens[[3]])
  
  w7_ab_ft__specificities_cart <- append(w7_ab_ft__specificities_cart, cm_cart$byClass[,"Specificity"])
  w7_ab_ft__specificities_cart_c1 <- append(w7_ab_ft__specificities_cart_c1, cart_spec[[1]])
  w7_ab_ft__specificities_cart_c2 <- append(w7_ab_ft__specificities_cart_c2, cart_spec[[2]])
  w7_ab_ft__specificities_cart_c3 <- append(w7_ab_ft__specificities_cart_c3, cart_spec[[3]])
  
  predictions <- predict(fit.rf, validation)
  cm_rf <- confusionMatrix(predictions, validation$SUCCESS)
  rf_sens <- cm_rf$byClass[,"Sensitivity"]
  rf_spec <- cm_rf$byClass[,"Specificity"]
  
  w7_ab_ft__sensitivities_rf <- append(w7_ab_ft__sensitivities_rf, rf_sens)
  w7_ab_ft__sensitivities_rf_c1 <- append(w7_ab_ft__sensitivities_rf_c1, rf_sens[[1]])
  w7_ab_ft__sensitivities_rf_c2 <- append(w7_ab_ft__sensitivities_rf_c2, rf_sens[[2]])
  w7_ab_ft__sensitivities_rf_c3 <- append(w7_ab_ft__sensitivities_rf_c3, rf_sens[[3]])
  
  w7_ab_ft__specificities_rf <- append(w7_ab_ft__specificities_rf, cm_rf$byClass[,"Specificity"])
  w7_ab_ft__specificities_rf_c1 <- append(w7_ab_ft__specificities_rf_c1, rf_spec[[1]])
  w7_ab_ft__specificities_rf_c2 <- append(w7_ab_ft__specificities_rf_c2, rf_spec[[2]])
  w7_ab_ft__specificities_rf_c3 <- append(w7_ab_ft__specificities_rf_c3, rf_spec[[3]])
}

print("ACCURACIES")
print("MIN")
min(unlist(w7_ab_accuracy_lda))
min(unlist(w7_ab_accuracy_knn))
min(unlist(w7_ab_accuracy_svm))
min(unlist(w7_ab_accuracy_cart))
min(unlist(w7_ab_accuracy_rf))

print("MEAN")
mean(unlist(w7_ab_accuracy_lda))
mean(unlist(w7_ab_accuracy_knn))
mean(unlist(w7_ab_accuracy_svm))
mean(unlist(w7_ab_accuracy_cart))
mean(unlist(w7_ab_accuracy_rf))

print("MAX")
max(unlist(w7_ab_accuracy_lda))
max(unlist(w7_ab_accuracy_knn))
max(unlist(w7_ab_accuracy_svm))
max(unlist(w7_ab_accuracy_cart))
max(unlist(w7_ab_accuracy_rf))



print("SENSITIVITIES")
print("MIN C1")
min(unlist(w7_ab_ft__sensitivities_lda_c1))
min(unlist(w7_ab_ft__sensitivities_knn_c1))
min(unlist(w7_ab_ft__sensitivities_svm_c1))
min(unlist(w7_ab_ft__sensitivities_cart_c1))
min(unlist(w7_ab_ft__sensitivities_rf_c1))

print("MEAN C1")
mean(unlist(w7_ab_ft__sensitivities_lda_c1))
mean(unlist(w7_ab_ft__sensitivities_knn_c1))
mean(unlist(w7_ab_ft__sensitivities_svm_c1))
mean(unlist(w7_ab_ft__sensitivities_cart_c1))
mean(unlist(w7_ab_ft__sensitivities_rf_c1))


print("MAX C1")
max(unlist(w7_ab_ft__sensitivities_lda_c1))
max(unlist(w7_ab_ft__sensitivities_knn_c1))
max(unlist(w7_ab_ft__sensitivities_svm_c1))
max(unlist(w7_ab_ft__sensitivities_cart_c1))
max(unlist(w7_ab_ft__sensitivities_rf_c1))

print("MIN C2")
min(unlist(w7_ab_ft__sensitivities_lda_c2))
min(unlist(w7_ab_ft__sensitivities_knn_c2))
min(unlist(w7_ab_ft__sensitivities_svm_c2))
min(unlist(w7_ab_ft__sensitivities_cart_c2))
min(unlist(w7_ab_ft__sensitivities_rf_c2))

print("MEAN C2")
mean(unlist(w7_ab_ft__sensitivities_lda_c2))
mean(unlist(w7_ab_ft__sensitivities_knn_c2))
mean(unlist(w7_ab_ft__sensitivities_svm_c2))
mean(unlist(w7_ab_ft__sensitivities_cart_c2))
mean(unlist(w7_ab_ft__sensitivities_rf_c2))


print("MAX C2")
max(unlist(w7_ab_ft__sensitivities_lda_c2))
max(unlist(w7_ab_ft__sensitivities_knn_c2))
max(unlist(w7_ab_ft__sensitivities_svm_c2))
max(unlist(w7_ab_ft__sensitivities_cart_c2))
max(unlist(w7_ab_ft__sensitivities_rf_c2))


print("MIN C3")
min(unlist(w7_ab_ft__sensitivities_lda_c3))
min(unlist(w7_ab_ft__sensitivities_knn_c3))
min(unlist(w7_ab_ft__sensitivities_svm_c3))
min(unlist(w7_ab_ft__sensitivities_cart_c3))
min(unlist(w7_ab_ft__sensitivities_rf_c3))

print("MEAN C3")
mean(unlist(w7_ab_ft__sensitivities_lda_c3))
mean(unlist(w7_ab_ft__sensitivities_knn_c3))
mean(unlist(w7_ab_ft__sensitivities_svm_c3))
mean(unlist(w7_ab_ft__sensitivities_cart_c3))
mean(unlist(w7_ab_ft__sensitivities_rf_c3))


print("MAX C3")
max(unlist(w7_ab_ft__sensitivities_lda_c3))
max(unlist(w7_ab_ft__sensitivities_knn_c3))
max(unlist(w7_ab_ft__sensitivities_svm_c3))
max(unlist(w7_ab_ft__sensitivities_cart_c3))
max(unlist(w7_ab_ft__sensitivities_rf_c3))


print("SPECIFICITIES")
print("MIN C1")
min(unlist(w7_ab_ft__specificities_lda_c1))
min(unlist(w7_ab_ft__specificities_knn_c1))
min(unlist(w7_ab_ft__specificities_svm_c1))
min(unlist(w7_ab_ft__specificities_cart_c1))
min(unlist(w7_ab_ft__specificities_rf_c1))

print("MEAN C1")
mean(unlist(w7_ab_ft__specificities_lda_c1))
mean(unlist(w7_ab_ft__specificities_knn_c1))
mean(unlist(w7_ab_ft__specificities_svm_c1))
mean(unlist(w7_ab_ft__specificities_cart_c1))
mean(unlist(w7_ab_ft__specificities_rf_c1))


print("MAX C1")
max(unlist(w7_ab_ft__specificities_lda_c1))
max(unlist(w7_ab_ft__specificities_knn_c1))
max(unlist(w7_ab_ft__specificities_svm_c1))
max(unlist(w7_ab_ft__specificities_cart_c1))
max(unlist(w7_ab_ft__specificities_rf_c1))

print("MIN C2")
min(unlist(w7_ab_ft__specificities_lda_c2))
min(unlist(w7_ab_ft__specificities_knn_c2))
min(unlist(w7_ab_ft__specificities_svm_c2))
min(unlist(w7_ab_ft__specificities_cart_c2))
min(unlist(w7_ab_ft__specificities_rf_c2))

print("MEAN C2")
mean(unlist(w7_ab_ft__specificities_lda_c2))
mean(unlist(w7_ab_ft__specificities_knn_c2))
mean(unlist(w7_ab_ft__specificities_svm_c2))
mean(unlist(w7_ab_ft__specificities_cart_c2))
mean(unlist(w7_ab_ft__specificities_rf_c2))


print("MAX C2")
max(unlist(w7_ab_ft__specificities_lda_c2))
max(unlist(w7_ab_ft__specificities_knn_c2))
max(unlist(w7_ab_ft__specificities_svm_c2))
max(unlist(w7_ab_ft__specificities_cart_c2))
max(unlist(w7_ab_ft__specificities_rf_c2))


print("MIN C3")
min(unlist(w7_ab_ft__specificities_lda_c3))
min(unlist(w7_ab_ft__specificities_knn_c3))
min(unlist(w7_ab_ft__specificities_svm_c3))
min(unlist(w7_ab_ft__specificities_cart_c3))
min(unlist(w7_ab_ft__specificities_rf_c3))

print("MEAN C3")
mean(unlist(w7_ab_ft__specificities_lda_c3))
mean(unlist(w7_ab_ft__specificities_knn_c3))
mean(unlist(w7_ab_ft__specificities_svm_c3))
mean(unlist(w7_ab_ft__specificities_cart_c3))
mean(unlist(w7_ab_ft__specificities_rf_c3))


print("MAX C3")
max(unlist(w7_ab_ft__specificities_lda_c3))
max(unlist(w7_ab_ft__specificities_knn_c3))
max(unlist(w7_ab_ft__specificities_svm_c3))
max(unlist(w7_ab_ft__specificities_cart_c3))
max(unlist(w7_ab_ft__specificities_rf_c3))


# STEP 1 DONE!


library(pROC)

roc(validation$SUCCESS, predictions, plot = TRUE)

# STEP 2
#predictions <- as.numeric(predictions)-1

# indeces in validation of mismatches
#mismatched_indeces <- which(abs(as.numeric(predictions) - validation$SUCCESS_num)==1)
mismatched_indeces <- which(as.numeric(predictions)!=validation$SUCCESS_num)

mismatched <- validation[mismatched_indeces,]

# write them in a file!

write.csv(mismatched, "SVM_mismatched_all_data_var_contributing_to_grades_3_classes.csv")

predictions[mismatched_indeces]








# NEURAL NETWORK from https://www.datacamp.com/tutorial/neural-network-models-r

# For NN on Canvas Data, see below!

# install package
install.packages("neuralnet")

# load library
require(neuralnet)

# previously..
# dataset_nn <- dataset

#dataset_nn <- dataset_no_corr
dataset_nn <- dataset

# BEFORE RUNNING BELOW Code, check SUCCESS is a factor
# if it is, the code below is unnecessary.

# turn SUCCESS variable from a factor into a number.
# temporary variable a number: 2 classes
#dataset_nn$SUCCESS_NN[dataset_nn$SUCCESS == "1"] <- 1
#dataset_nn$SUCCESS_NN[dataset_nn$SUCCESS == "0"] <- 0

# 3 classes...

dataset_nn$SUCCESS_NN[dataset_nn$SUCCESS == "1"] <- 1
dataset_nn$SUCCESS_NN[dataset_nn$SUCCESS == "2"] <- 2
dataset_nn$SUCCESS_NN[dataset_nn$SUCCESS == "3"] <- 3


# copy it into the SUCESS variable
dataset_nn$SUCCESS <- dataset_nn$SUCCESS_NN

#get rid of temporary variable
dataset_nn<- dataset_nn[, !names(dataset_nn) %in% c("SUCCESS_NN")]

# double check
str(dataset_nn)

#dataset_no_corr$SUCCESS

# RESCALE dataset for better NN model
# summarize data
library(ggplot2)
library(lattice)
library(caret)
#summary(dataset_nn[,1:65])
summary(dataset_nn[,1:21])
# calculate the pre-process parameters from the dataset
#preprocessParams <- preProcess(dataset_nn[,1:65], method=c("range"))
#preprocessParams <- preProcess(dataset_nn[,1:40], method=c("range"))
preprocessParams <- preProcess(dataset_nn[,1:21], method=c("range"))

# summarize transform parameters
print(preprocessParams)
names(preprocessParams)
# transform the dataset using the parameters
#dataset_nn_rescale <- predict(preprocessParams, dataset_nn[,1:65])
dataset_nn_rescale <- predict(preprocessParams, dataset_nn[,1:21])
names(dataset_nn_rescale)

# summarize the transformed dataset
summary(dataset_nn_rescale)


# fit neural network
nn=neuralnet(SUCCESS~.,data=dataset_nn, hidden=10,act.fct = "logistic",
             linear.output = FALSE)
# check no data missing
apply(dataset, 2, function(x) sum(is.na(x)))



# fit neural network RESCALED
nn=neuralnet(SUCCESS~.,data=dataset_nn_rescale, hidden=40,act.fct = "logistic",
             linear.output = FALSE)


#nn=neuralnet(SUCCESS~.,data=data_num1, hidden=3,act.fct = "logistic", linear.output = FALSE)
names(validation)
validation$SUCCESS
# Seclect columns that are in the training data
validation_nn <- validation[,names(validation) %in% names(dataset_nn_rescale)]
validation_nn$SUCCESS
str(validation_nn)
names(validation_nn)
# turn SUCCESS variable from a factor into a number.
# temporary variable a number
#validation_nn$SUCCESS_NN[validation_nn$SUCCESS == "1"] <- 1
#validation_nn$SUCCESS_NN[validation_nn$SUCCESS == "0"] <- 0

validation_nn$SUCCESS_num[validation_nn$SUCCESS == "1"] <- 1
validation_nn$SUCCESS_num[validation_nn$SUCCESS == "2"] <- 2
validation_nn$SUCCESS_num[validation_nn$SUCCESS == "3"] <- 3


# copy it into the SUCESS variable
validation_nn$SUCCESS <- validation_nn$SUCCESS_num

#get rid of temporary variable
validation_nn<- validation_nn[, !names(validation_nn) %in% c("SUCCESS_num")]

# double check
str(validation_nn)

# apply SAME RESCALE TRANSFORMATION on test/validation set
#validation_nn_rescale <- predict(preprocessParams, validation_nn[,1:65])
temp <- validation_nn[,1:21]
# dataset_nn_rescale <- predict(preprocessParams, dataset_nn[,1:21])
temp <- plyr::rename(temp, c("SUCCESS_NN"="SUCCESS"))
validation_nn_rescale <- predict(preprocessParams, temp)
#validation_nn_rescale$SUCCESS
str(validation_nn)


#write.csv(validation, "validationset.csv")
str(validation_nn)
# predict!

#pred <- predict(nn, validation_nn, rep = 1, all.units = FALSE)

# RESCALED!
pred <- predict(nn, validation_nn_rescale, rep = 1, all.units = FALSE)



#round(pred,1)
#validation_nn$SUCCESS
#validation$SUCCESS

# turn probabilities into predictions!

# 2-class
#predict <- ifelse(pred>0.5, 1, 0)
#predict

# 3-class
# classes are rescaled, so values are 0, 0.5, and 1.
predict <- ifelse(pred<0.25, 0, ifelse(pred>0.75, 1,0.5))

# 2-class accuracy!
# accuracy = 1 - sum(abs(predict-validation_nn$SUCCESS))/length(predict)
# accuracy

# 3-class accuracy!
accuracy = 1 - sum(predict != validation_nn_rescale$SUCCESS)/length(predict)
accuracy
# compare predicted and actual to double check the count
#mismatched_maybe <- data.frame(predicted = predict, actual = validation_nn_rescale$SUCCESS)

# RESCALED!
# 2-class
#accuracy = 1 - sum(abs(predict-validation_nn_rescale$SUCCESS))/length(predict)
#accuracy

names(dataset_nn)

table(abs(round(predict - validation_nn$SUCCESS, 1)))
sum(as.numeric(validation_nn$SUCCESS))
length(validation_nn$SUCCESS)
# plot neural network
plot(nn)

# Indeces for mispredicted data

# 2-class
#mispred <- abs(predict-validation_nn_rescale$SUCCESS)

#which(mispred == 1)               # Applying which function
# 1 4 5

#mispredicted_students <- validation_nn[which(mispred == 1),]
#predict[which(mispred == 1)]
#names(mispredicted_students)

# 3-class

mismatched_indeces <- which(as.numeric(predict)!=validation_nn$SUCCESS_num)
# accuracy = 1 - (100*#mispredicted)/#total
accuracy = 1 - length(mismatched_indeces)/nrow(validation_nn)
accuracy

mispredicted_students <- validation_nn[mismatched_indeces,]

write.csv(mispredicted_students, "NN_mispred_all_var_contributing_to_grade.csv")




# ---------    USE ONLY DATA FOR WEEKS 1 -3 !!! -------------


# MODELS WEEK 3
# REGISTRAR, INTRO SURVEY, RECITATION 1, RECITATION 2
# At this point, the data_f20_saved contains all the data

names(data_f20)

# Start with all canvas merged with registrar and intro, then balance it.
# that way, we lose the smallest amount of data

#data_f20 <- data_canvas_sas_intro_f20
data_f20 <- data_f20_saved

# Since replacing with data_f20_saved, don't need all this. Skip to line 1369. 

# replace grade with SUCCESS...3 classes using CANVAS data: Final.Points
data_f20$SUCCESS[data_f20$Final.Points >= 750] <- 1
data_f20$SUCCESS[data_f20$Final.Points <= 600] <- 2
# Struggling students from C- to D
data_f20$SUCCESS[data_f20$Final.Points > 600 & data_f20$Final.Points < 750] <- 3

table(data_f20$SUCCESS)

# Already balanced, so no need for the following lines
# SELECT 100 of class 1


#data_f20_success <- data_f20[data_f20$SUCCESS==1,]
#data_f20_not_success <- data_f20[data_f20$SUCCESS==2,]
#data_f20_struggling <- data_f20[data_f20$SUCCESS==3,]

#data_f20_trunc <- data_f20_struggling
#data_f20_trunc <- rbind(data_f20_success[sample(nrow(data_f20_success), 100), ], data_f20_not_success, data_f20_struggling)
#table(data_f20_trunc$SUCCESS) # more balanced

#data_f20 <- data_f20_trunc

# select variables that are available after week 3

str(data_f20)

data_f20$Intended.majorCS <- 0
data_f20$Intended.majorCS[data_f20$Q1 == "Computer Science (BS)"] <- 1 
table(data_f20$Intended.majorCS)

# We have this already, so no need for it!
# ATTITUDES!

#data_f20$BELONGINGNESS <- 0
#data_f20$CONFIDENCE <- 0
#data_f20$INTEREST <- 0
#data_f20$USEFULNESS <- 0
#data_f20$ENCOURAGEMENT <- 0
#data_f20$Q3_B <- 0 
#data_f20$Q11_B <- 0 
#data_f20$Q57_B <- 0 
#data_f20$Q21_B <- 0 
#data_f20$Q26_B <- 0 

# Attitudes...
# Q3: "I have self-confidence when it comes to computer science" #confidence
# Q5: "I hope that my future career will require the use of co" #interest
# Q6: "I feel comfortable in computer science" #belonging 
# Q7: "Knowledge of computer science will help me earn a living" #usefulness
# Q8: "A friend or peer has encouraged me to study computer science" #encouragement
# Q9: "I am confident that I can solve problems by using computer science" #confidence
# Q10: "I like to use computer science to solve problems" #interest
# Q11: "I feel I belong in computer science" #belonging
# Q12: "Learning to use computing skills will help me achieve" #usefulness
# Q14: "Someone I know has given me the desire to study computer science" #encouragement
# Q15: "I can learn computer science without a teacher to explain it" #confidence
# Q16: "The challenge of solving problems using computer science appeals to me" #interest
# Q43: "I feel accepted by my peers in computer science" #belonging
# Q17: "Computing skills used to understand computer science" #usefulness
# Q18: "Someone I know has praised my work in computer science" #encouragement
# Q19: "I am sure I could do advanced work in computer science" #confidence
# Q20: "I like writing computer programs" #interest
# Q21: "I know someone like me who uses computer science in their work" #belonging
# Q22: "I'll need a mastery of computer science for my future " #usefulness
# Q23: "Someone I know has discussed with me the computer science" #encouragement
# Q24: "I think I will do well in computer science" #confidence
# Q25: "I would take additional computer science courses if I had the opportunity" #interest
# Q26: "I know a lot of students like me who are interested in computer science" #belonging
# Q27: "Computer science is a worthwhile and necessary subject" #usefulness
# Q28: "Someone in my family has encouraged me to study computer science" #encouragement

#confidence: Q3, Q9, Q15, Q19, Q24
#interest: Q5, Q10, Q16, Q20, Q25
#belonging: Q6, Q11, Q43, Q21, Q26
#usefulness:Q7, Q12, Q17, Q22, Q27
#encouragement: Q8, Q14, Q18, Q23, Q28


# I don't know what this is..
#data_f20$BELONGINGNESS[data_f20$Q3 == "Strongly Agree"] <- 1
#data_f20$BELONGINGNESS[data_f20$Q3 == "Agree")] <-1
#data_f20$BELONGINGNESS[grep("C", data_f20$grade)] <-1
#data_f20$BELONGINGNESS[grep("D", data_f20$grade)] <-0
#data_f20$BELONGINGNESS[grep("F", data_f20$grade)] <-0
#data_f20$BELONGINGNESS[grep("W", data_f20$grade)] <-0

install.packages("dplyr")
library(dplyr)
# BELONGINESS is Q3, Q11, Q57, Q21, and Q26
# Q6, Q11, Q43, Q21, Q26

#data_f20 %>% mutate(Q3_B =
#                     case_when(Q3 == "Strongly Agree" ~ 3, 
#                               Q3 == "Agree" ~ 2, 
#                               Q3 == "Disagree" ~ 1, 
#                               Q3 == "Strongly Disagree" ~ 0)
#)
#data_f20$Q3_B
# Belongingness

names(data_f20)

data_f20$Q6_B[data_f20$Q6 == "Strongly Agree"] <- 3
data_f20$Q6_B[data_f20$Q6 == "Agree"] <- 2
data_f20$Q6_B[data_f20$Q6 == "Disagree"] <- 1
data_f20$Q6_B[data_f20$Q6 == "Strongly Disagree"] <- 0
data_f20$Q6_B[data_f20$Q6 == ""] <- 1.5 # average between agree and disagree

data_f20$Q11_B[data_f20$Q11 == "Strongly Agree"] <- 3
data_f20$Q11_B[data_f20$Q11 == "Agree"] <- 2
data_f20$Q11_B[data_f20$Q11 == "Disagree"] <- 1
data_f20$Q11_B[data_f20$Q11 == "Strongly Disagree"] <- 0
data_f20$Q11_B[data_f20$Q11 == ""] <- 1.5

data_f20$Q43_B[data_f20$Q43 == "Strongly Agree"] <- 3
data_f20$Q43_B[data_f20$Q43 == "Agree"] <- 2
data_f20$Q43_B[data_f20$Q43 == "Disagree"] <- 1
data_f20$Q43_B[data_f20$Q43 == "Strongly Disagree"] <- 0
data_f20$Q43_B[data_f20$Q43 == ""] <- 1.5

data_f20$Q21_B[data_f20$Q21 == "Strongly Agree"] <- 3
data_f20$Q21_B[data_f20$Q21 == "Agree"] <- 2
data_f20$Q21_B[data_f20$Q21 == "Disagree"] <- 1
data_f20$Q21_B[data_f20$Q21 == "Strongly Disagree"] <- 1.5

data_f20$Q26_B[data_f20$Q26 == "Strongly Agree"] <- 3
data_f20$Q26_B[data_f20$Q26 == "Agree"] <- 2
data_f20$Q26_B[data_f20$Q26 == "Disagree"] <- 1
data_f20$Q26_B[data_f20$Q26 == "Strongly Disagree"] <- 1.5

data_f20$BELONGINGNESS <- data_f20$Q6_B + data_f20$Q11_B + data_f20$Q21_B + data_f20$Q26_B


# Confidence
# Q3, Q9, Q15, Q19, Q24

data_f20$Q3_B[data_f20$Q3 == "Strongly Agree"] <- 3
data_f20$Q3_B[data_f20$Q3 == "Agree"] <- 2
data_f20$Q3_B[data_f20$Q3 == "Disagree"] <- 1
data_f20$Q3_B[data_f20$Q3 == "Strongly Disagree"] <- 0
data_f20$Q3_B[data_f20$Q3 == ""] <- 1.5

data_f20$Q9_B[data_f20$Q9 == "Strongly Agree"] <- 3
data_f20$Q9_B[data_f20$Q9 == "Agree"] <- 2
data_f20$Q9_B[data_f20$Q9 == "Disagree"] <- 1
data_f20$Q9_B[data_f20$Q9 == "Strongly Disagree"] <- 0
data_f20$Q9_B[data_f20$Q9 == ""] <- 1.5

data_f20$Q15_B[data_f20$Q15 == "Strongly Agree"] <- 3
data_f20$Q15_B[data_f20$Q15 == "Agree"] <- 2
data_f20$Q15_B[data_f20$Q15 == "Disagree"] <- 1
data_f20$Q15_B[data_f20$Q15 == "Strongly Disagree"] <- 0
data_f20$Q15_B[data_f20$Q15 == ""] <- 1.5


data_f20$Q19_B[data_f20$Q19 == "Strongly Agree"] <- 3
data_f20$Q19_B[data_f20$Q19 == "Agree"] <- 2
data_f20$Q19_B[data_f20$Q19 == "Disagree"] <- 1
data_f20$Q19_B[data_f20$Q19 == "Strongly Disagree"] <- 0
data_f20$Q19_B[data_f20$Q19 == ""] <- 1.5


data_f20$Q24_B[data_f20$Q24 == "Strongly Agree"] <- 3
data_f20$Q24_B[data_f20$Q24 == "Agree"] <- 2
data_f20$Q24_B[data_f20$Q24 == "Disagree"] <- 1
data_f20$Q24_B[data_f20$Q24 == "Strongly Disagree"] <- 0
data_f20$Q24_B[data_f20$Q24 == ""] <- 1.5

data_f20$CONFIDENCE <- data_f20$Q3_B + data_f20$Q9_B + data_f20$Q15_B + data_f20$Q19_B + data_f20$Q24_B

# Interest
#Q5, Q10, Q16, Q20, Q25

data_f20$Q5_B[data_f20$Q5 == "Strongly Agree"] <- 3
data_f20$Q5_B[data_f20$Q5 == "Agree"] <- 2
data_f20$Q5_B[data_f20$Q5 == "Disagree"] <- 1
data_f20$Q5_B[data_f20$Q5 == "Strongly Disagree"] <- 0
data_f20$Q5_B[data_f20$Q5 == ""] <- 1.5

data_f20$Q10_B[data_f20$Q10 == "Strongly Agree"] <- 3
data_f20$Q10_B[data_f20$Q10 == "Agree"] <- 2
data_f20$Q10_B[data_f20$Q10 == "Disagree"] <- 1
data_f20$Q10_B[data_f20$Q10 == "Strongly Disagree"] <- 0
data_f20$Q10_B[data_f20$Q10 == ""] <- 1.5

data_f20$Q16_B[data_f20$Q16 == "Strongly Agree"] <- 3
data_f20$Q16_B[data_f20$Q16 == "Agree"] <- 2
data_f20$Q16_B[data_f20$Q16 == "Disagree"] <- 1
data_f20$Q16_B[data_f20$Q16 == "Strongly Disagree"] <- 0
data_f20$Q16_B[data_f20$Q16 == ""] <- 1.5


data_f20$Q20_B[data_f20$Q20 == "Strongly Agree"] <- 3
data_f20$Q20_B[data_f20$Q20 == "Agree"] <- 2
data_f20$Q20_B[data_f20$Q20 == "Disagree"] <- 1
data_f20$Q20_B[data_f20$Q20 == "Strongly Disagree"] <- 0
data_f20$Q20_B[data_f20$Q20 == ""] <- 1.5


data_f20$Q25_B[data_f20$Q25 == "Strongly Agree"] <- 3
data_f20$Q25_B[data_f20$Q25 == "Agree"] <- 2
data_f20$Q25_B[data_f20$Q25 == "Disagree"] <- 1
data_f20$Q25_B[data_f20$Q25 == "Strongly Disagree"] <- 0
data_f20$Q25_B[data_f20$Q25 == ""] <- 1.5

data_f20$INTEREST <- data_f20$Q5_B + data_f20$Q10_B + data_f20$Q16_B + data_f20$Q20_B + data_f20$Q25_B


# Usefulness
#Q7, Q12, Q17, Q22, Q27

data_f20$Q7_B[data_f20$Q7 == "Strongly Agree"] <- 3
data_f20$Q7_B[data_f20$Q7 == "Agree"] <- 2
data_f20$Q7_B[data_f20$Q7 == "Disagree"] <- 1
data_f20$Q7_B[data_f20$Q7 == "Strongly Disagree"] <- 0
data_f20$Q7_B[data_f20$Q7 == ""] <- 1.5

data_f20$Q12_B[data_f20$Q12 == "Strongly Agree"] <- 3
data_f20$Q12_B[data_f20$Q12 == "Agree"] <- 2
data_f20$Q12_B[data_f20$Q12 == "Disagree"] <- 1
data_f20$Q12_B[data_f20$Q12 == "Strongly Disagree"] <- 0
data_f20$Q12_B[data_f20$Q12 == ""] <- 1.5

data_f20$Q17_B[data_f20$Q17 == "Strongly Agree"] <- 3
data_f20$Q17_B[data_f20$Q17 == "Agree"] <- 2
data_f20$Q17_B[data_f20$Q17 == "Disagree"] <- 1
data_f20$Q17_B[data_f20$Q17 == "Strongly Disagree"] <- 0
data_f20$Q17_B[data_f20$Q17 == ""] <- 1.5


data_f20$Q22_B[data_f20$Q22 == "Strongly Agree"] <- 3
data_f20$Q22_B[data_f20$Q22 == "Agree"] <- 2
data_f20$Q22_B[data_f20$Q22 == "Disagree"] <- 1
data_f20$Q22_B[data_f20$Q22 == "Strongly Disagree"] <- 0
data_f20$Q22_B[data_f20$Q22 == ""] <- 1.5


data_f20$Q27_B[data_f20$Q27 == "Strongly Agree"] <- 3
data_f20$Q27_B[data_f20$Q27 == "Agree"] <- 2
data_f20$Q27_B[data_f20$Q27 == "Disagree"] <- 1
data_f20$Q27_B[data_f20$Q27 == "Strongly Disagree"] <- 0
data_f20$Q27_B[data_f20$Q27 == ""] <- 1.5

data_f20$USEFULNESS <- data_f20$Q7_B + data_f20$Q12_B + data_f20$Q17_B + data_f20$Q22_B + data_f20$Q27_B


# ENCOURAGEMENT
# Q8, Q14, Q18, Q23, Q28

data_f20$Q8_B[data_f20$Q8 == "Strongly Agree"] <- 3
data_f20$Q8_B[data_f20$Q8 == "Agree"] <- 2
data_f20$Q8_B[data_f20$Q8 == "Disagree"] <- 1
data_f20$Q8_B[data_f20$Q8 == "Strongly Disagree"] <- 0
data_f20$Q8_B[data_f20$Q8 == ""] <- 1.5

data_f20$Q14_B[data_f20$Q14 == "Strongly Agree"] <- 3
data_f20$Q14_B[data_f20$Q14 == "Agree"] <- 2
data_f20$Q14_B[data_f20$Q14 == "Disagree"] <- 1
data_f20$Q14_B[data_f20$Q14 == "Strongly Disagree"] <- 0
data_f20$Q14_B[data_f20$Q14 == ""] <- 1.5

data_f20$Q18_B[data_f20$Q18 == "Strongly Agree"] <- 3
data_f20$Q18_B[data_f20$Q18 == "Agree"] <- 2
data_f20$Q18_B[data_f20$Q18 == "Disagree"] <- 1
data_f20$Q18_B[data_f20$Q18 == "Strongly Disagree"] <- 0
data_f20$Q18_B[data_f20$Q18 == ""] <- 1.5


data_f20$Q23_B[data_f20$Q23 == "Strongly Agree"] <- 3
data_f20$Q23_B[data_f20$Q23 == "Agree"] <- 2
data_f20$Q23_B[data_f20$Q23 == "Disagree"] <- 1
data_f20$Q23_B[data_f20$Q23 == "Strongly Disagree"] <- 0
data_f20$Q23_B[data_f20$Q23 == ""] <- 1.5


data_f20$Q28_B[data_f20$Q28 == "Strongly Agree"] <- 3
data_f20$Q28_B[data_f20$Q28 == "Agree"] <- 2
data_f20$Q28_B[data_f20$Q28 == "Disagree"] <- 1
data_f20$Q28_B[data_f20$Q28 == "Strongly Disagree"] <- 0
data_f20$Q28_B[data_f20$Q28 == ""] <- 1.5

data_f20$ENCOURAGEMENT <- data_f20$Q8_B + data_f20$Q14_B + data_f20$Q18_B + data_f20$Q23_B + data_f20$Q28_B

# Attitudes in general
#I don't know where these are coming from...
table(data_f20$Q1)
table(data_f20$Q33)
table(data_f20$Q32)
table(data_f20$Q30)
table(data_f20$Q2)
table(data_f20$Q4)
table(data_f20$Q35)
names(data_f20)

table(data_f20$BELONGINGNESS)

data_f20_saved <- data_f20

data_f20 <- data_f20_saved


data_f20_week3 <- data_f20[,names(data_f20_saved) %in% c("cum_gpa_ug_to_date","gender_cd","ethnic_cd","orig_admit_type_cd","Q2","Q4","Q35","Intended.majorCS","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT","Recitation.2..1129729.", "Recitation.3..1129730.", "SUCCESS")]
#data_f20_week3 <- data_f20_trunc[,names(data_f20_trunc) %in% c("cum_gpa_ug_to_date","gender_cd","ethnic_cd","orig_admit_type_cd","Q2","Q4","Q35","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT","Recitation.2..1129729.", "Recitation.3..1129730.")]
str(data_f20_week3)

data_f20_same_transf <- data_f20
str(data_f20_week3)

y <- as.factor(data_f20_week3$SUCCESS)

#x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
#y <- data_f20[,names(data_f20) %in% c("SUCCESS")]

data_f20_week3_temp <- data_f20_week3[, !names(data_f20_week3) %in% c("SUCCESS")]
data_f20_week3 <- data_f20_week3_temp

# turn all variables to numeric, using one-hot encoding
dummy <- dummyVars(" ~ .", data = data_f20_week3)
newdata <- data.frame(predict(dummy, newdata = data_f20_week3)) 
#names(newdata)
#str(newdata)

# COPY ML CODE

# 2.3. Create a Validation Dataset

data_f20 <- newdata
data_f20$SUCCESS <- y

str(data_f20)
# create a list of 80% of the rows in the original dataset we can use for training
validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)

# select 20% of the data for validation
validation <- data_f20[-validation_index,]
validation_same_transf <- data_f20_saved[-validation_index,]
# use the remaining 80% of data to training and testing the models
data_f20 <- data_f20[validation_index,]
str(data_f20)
y <- data_f20$SUCCESS
names(data_f20)
# 3. Summarize Dataset

# dimensions of dataset
dim(data_f20)

names(data_f20)

# list types for each attribute
sapply(data_f20, class)

# list the levels for the class
levels(data_f20$SUCCESS)

# 3.5. Class Distribution

# summarize the class distribution
percentage <- prop.table(table(data_f20$SUCCESS)) * 100
cbind(freq=table(data_f20$SUCCESS), percentage=percentage)

# summarize attribute distributions
summary(data_f20)

# 4. Visualize Dataset

# 4.1 Univariate Plots

# split input and output
#x <- data_f20[,1:160]
# data[column!="c3"]
x<- data_f20

#y <- data_f20_week3[,names(data_f20) %in% c("SUCCESS")]


#data_f20_numeric_attributes_0_to_15 <- data_f20[,names(data_f20) %in% c("BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]
#data_f20_numeric_attributes_0_to_10 <- data_f20[,names(data_f20) %in% c("X1..HelloWorld..1067474.", "X2..Wind.Chill..1067488.", "X3..Order.Check..1067507.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.","X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X0..Pseudocode..1127307.", "X16..Assignment.8...Complexity.Analysis..1129495.")]
#data_f20_numeric_attributes_0_to_100 <- data_f20[,names(data_f20) %in% c("Quiz.2..1127309.","Quiz.4..1129289.", "Quiz.1..1068907.", "Quiz.3..1127314.")]
#data_f20_numeric_attributes <- data_f20[,names(data_f20) %in% c("cum_gpa_ug_to_date","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT")]

sapply(data_f20, class)

# Seclect all numeric attributes..

#num_cols <- unlist(lapply(data_f20, is.numeric)) # Identify numeric columns

#data_num <- data_f20[ , num_cols]  # Subset numeric columns of data
#names(data_num)
#str(data_f20)


# distribution of each attribute: univariate version
# Recitation..
par(mfrow=c(1,2))
for(i in 1:2) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}

# Gender..
par(mfrow=c(3,4))
for(i in 3:4) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}



# EXAMS
par(mfrow=c(1,4))
for(i in 1:4) {
  boxplot(data_f20_numeric_attributes_0_to_100[,i], main=names(data_f20_numeric_attributes_0_to_100)[i])
}

# ASSIGNMENTS
par(mfrow=c(1,6))
for(i in 1:6) {
  boxplot(data_f20_numeric_attributes_0_to_10[,i], main=names(data_f20_numeric_attributes_0_to_10)[i])
}


# Distribution of the predicted attribute
plot(y)

# Attributes
#x <- data_f20_numeric_attributes_0_to_15[,1:5]


# 4.2 Multivariate Plots: Interactions between variables

# Scatterplots of all pairs of attributes and color the points by class
# Also, because scatterplots show that points for each class are separate, 
# we can draw ellipses around them
featurePlot(x=x, y=y, plot="ellipse")


# We can also look at box and whisker plots of each input variable again, 
# but this time broken down into separate plots for each class. This can help to 
# tease out obvious linear separations between the classes.

featurePlot(x=x, y=y, plot="box")


# Section 5.1.

# Run algorithms using 10-fold cross validation
set.seed(123)
control <- trainControl(method="cv", number=10)
metric <- "Accuracy"

# Section 5.2. Build Models
names(x)
dataset <- x
dataset$SUCCESS <- y 
str(x)

dataset <- dataset[complete.cases(dataset), ]

x<- dataset[, !names(dataset) %in% c("SUCCESS")]
y <- dataset$SUCCESS

#dataset1 <- data_canvas_and_sas_f20_111

# identify columns that are numeric
#num_cols <- unlist(lapply(dataset1, is.numeric))         # Identify numeric columns
#num_cols
#data_num1 <- dataset1[ , num_cols]
#data_num1$SUCCESS <- data_canvas_and_sas_f20_111$SUCCESS
# x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
#names(data_num1)
#data_num1 <- data_num1[, !names(data_num1) %in% c("Intro.Survey..1068919.","Exit.Survey..1127030.","year","unit_of_reg_cd", "subj_cd", "course_no", "sat_math_highest_rec", "housing_status_cd", "deg_earned_curric_cd1", "deg_minor_curric_cd1")]
#data_num1 <- data_num1[complete.cases(data_num1), ]

# almost constant column, only 1 1 and the rest, 0.
dataset <- dataset[, !names(dataset) %in% c("Q2.It.fulfills.another.requirement..Please.explain.", "")]


# Find collinear variables ...
library(corrplot)
corrplot(cor(x))
library(caret)

# missing values in x?
#str(x)
#data.without_na <- na.omit(x)
#cor_matrix <- cor(data.without_na)

# delete constrant column..
x <- x[, !names(x) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2")]
dataset <- dataset[, !names(dataset) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2")]
validation <- validation[, !names(validation) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2")]



# requires no NAs and only numeric attributes
indexesToDrop <- findCorrelation(cor(x), cutoff = 0.8)

# Find correlated columns ...

names(x)
corrplot(cor(x[,-indexesToDrop]))

x_no_corr <- x[,-indexesToDrop]

# get rid of correlated variables in dataset
dataset_no_corr <- dataset[,-indexesToDrop]
names(dataset)

# variables with very low variance 
#names(dataset[, sapply(dataset, function(v) var(v, na.rm=TRUE)==0)])

no0variance <- dataset[,apply(dataset, 2, var, na.rm=TRUE) != 0]
names(no0variance)
indexesToDrop1 <- findCorrelation(cor(no0variance), cutoff = 0.8)

#no_na <- no0variance[complete.cases(no0variance), ] 
names(dataset_no_corr)

x_var = nearZeroVar(dataset_no_corr, saveMetrics = TRUE)
str(x_var, vec.len=2)

x_var[x_var[,"zeroVar"] > 0, ] 
columns <- x_var[x_var[,"zeroVar"] + x_var[,"nzv"] > 0, ] 
low_var_cols <- columns[1]

# GETTING RID OF COLINEAR VARIABLES
dataset_no_corr <- dataset_no_corr[, !names(dataset_no_corr) %in% c("Recitation.2..1129729.", "ethnic_cd", "ethnic_cd5", "ethnic_cdN", "ethnic_cdT", "Q2It.fulfills.another.requirement..Please.explain.", "Q2It.is.an.elective", "Q4Other..please.explain", "Q35")]
names(dataset_no_corr)

# a) linear algorithms
# LDA needs no correlated variables, or else there will be warnings
set.seed(7)
fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)
#fit.lda <- train(SUCCESS~., data=no0variance, method="lda", metric=metric, trControl=control)
#summary(fit.lda)
# SEEING THE COEFFICIENTS OF THE LINEAR MODEL!

names(dataset_no_corr)

require(MASS)
r <- lda(formula = SUCCESS~ ., 
         data =  no0variance, 
         prior = c(0.82, 0.11, 0.07))

r$prior
r$counts

# the combination of linear coefficients
r$scaling



# b) nonlinear algorithms
# CART
set.seed(7)
#fit.cart <- train(SUCCESS~., data=no0variance, method="rpart", metric=metric, trControl=control)
fit.cart <- train(SUCCESS~., data=dataset_no_corr, method="rpart", metric=metric, trControl=control)


# kNN
set.seed(7)
#fit.knn <- train(SUCCESS~., data=no0variance, method="knn", metric=metric, trControl=control)
fit.knn <- train(SUCCESS~., data=dataset_no_corr, method="knn", metric=metric, trControl=control)
# c) advanced algorithms
# SVM
set.seed(7)
#fit.svm <- train(SUCCESS~., data=no0variance, method="svmRadial", metric=metric, trControl=control)
fit.svm <- train(SUCCESS~., data=dataset_no_corr, method="svmRadial", metric=metric, trControl=control)
# Random Forest
set.seed(7)
#fit.rf <- train(SUCCESS~., data=no0variance, method="rf", metric=metric, trControl=control)
fit.rf <- train(SUCCESS~., data=dataset_no_corr, method="rf", metric=metric, trControl=control)

# 5.3 Select Best Model

# summarize accuracy of models
results <- resamples(list(lda=fit.lda, cart=fit.cart, knn=fit.knn, svm=fit.svm, rf=fit.rf))
summary(results)

# compare accuracy of models
dotplot(results)

# summarize Best Model
print(fit.rf) # ACCURACY = 57%
#print(fit.knn) # ACCURACY = 86%

names(dataset_no_corr)


# Section 6. Make Predictions

# get rid of columns in validation that are not in training data

validation_same_columns<- validation[, names(validation) %in% names(dataset_no_corr)]

#validation_same_transf <- data_f20_same_transf[-validation_index,]
#validation_same_transf<- validation_same_transf[, names(validation_same_transf) %in% c("NetID", "RUID", "grade", "gender_cd", "ethnic_cd", "cum_gpa_ug_to_date","orig_admit_type_cd")]

validation_nona <- na.omit(validation_same_columns)

validation_nona_same_transf1 <- validation_same_transf[, !names(validation_same_transf) %in% c("Notes", "Surveys.Current.Points", "Surveys.Final.Points","Surveys.Current.Score", "Surveys.Unposted.Current.Score", "Surveys.Final.Score", "Surveys.Unposted.Final.Score", "ap_exam_test_score","deg_sought1", "housing_status_cd", "student_support_ind", "visa_status_cd","tran_ug_or_grad_credit_cd","deg_earned_curric_cd1", "deg_minor_curric_cd1",  "dual_deg_ind","joint_deg_ind", "sat_math_highest_rec", "Q2_8_TEXT", "Q2_6_TEXT", "Q44", "Q44_8_TEXT", "Q44_6_TEXT", "Q4_6_TEXT", "Q34", "Q43", "Q43_B")]




names(validation_nona)

#va <- subset(validation_nona_same_transf1, select=Q39_2:Q28_B)

va1 <- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% c("NetID","RUID","Current.Points", "Final.Points","Unposted.Final.Score", "Final.Score","Current.Grade", "Unposted.Current.Grade", "Final.Grade", "grade", "ethnic_cd", "gender_cd" )]
va2<- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% names(validation_same_columns)]




#validation_nona_same_transf <- na.omit(validation_nona_same_transf1)
validation_nona_same_transf <- cbind(va1, va2)

validation_nona_same_transf2 <- na.omit(validation_nona_same_transf)
names(validation_nona_same_transf)

validation_nona_same_transf <- validation_nona_same_transf2


# check that it's the same people in both datasets
table(validation_nona$ethnic_cd.3)
table(validation_nona$ethnic_cd.4)
table(validation_nona$ethnic_cd.5)
table(validation_nona$ethnic_cd.6)
table(validation_nona$ethnic_cd.8)
table(validation_nona_same_transf2$ethnic_cd)

table(validation_nona$gender_cd.F)
table(validation_nona$gender_cd.M)
table(validation_nona_same_transf2$gender_cd)
# checked!

names(validation_nona_same_transf1)
#names(validation_nona_same_transf1)
# estimate skill of RF on the validation dataset

str(validation_nona)

predictions <- predict(fit.rf, validation_nona)
confusionMatrix(predictions, as.factor(validation_nona$SUCCESS))
dim(validation_nona)
length(predictions)
str(validation_nona)
# FIND MISMATCHES


str(validation_nona)

# This next part is not necessary, skip to line 

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
# 2-class case..
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "0"] <- 0

validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "0"] <- 0

# 3-class case..
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "2"] <- 2
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "3"] <- 3

validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "2"] <- 2
validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "3"] <- 3

table(validation_nona_same_transf$SUCCESS_num)


# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

#get rid of temporary variable
#validation<- validation[, !names(validation) %in% c("SUCCESS_num")]

# STEP 1 DONE!

# STEP 2
#predictions <- as.numeric(predictions)-1

# indeces in validation of mismatches

# 2-class case
mismatched_indeces <- which(abs(as.numeric(predictions)-1 - validation_nona$SUCCESS_num)==1)

# 3-class case
#mismatched_indeces <- which(as.numeric(predictions)!=validation_nona$SUCCESS_num)
mismatched_indeces <- which(predictions!=validation_nona$SUCCESS)
# accuracy = 1 - (100*#mispredicted)/#total
accuracy = 1 - length(mismatched_indeces)/nrow(validation_nona)
accuracy

#mismatched <- validation_nona_same_transf[mismatched_indeces,]
mismatched <- validation_same_transf[mismatched_indeces,]


# write them in a file!

write.csv(mismatched, "RF_mismatched_WEEK3_ids_3_classes.csv")

predictions[mismatched_indeces]



# Models Week 4!

data_f20_week4 <- data_f20_saved[,names(data_f20_saved) %in% c("cum_gpa_ug_to_date","gender_cd","ethnic_cd","orig_admit_type_cd","Q2","Q4","Q35","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT","Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733.","X0..Pseudocode..1127307.")]
str(data_f20_week4)
data_f20_same_transf <- data_f20_saved

y <- data_f20_saved$SUCCESS

# turn all variables to numeric, using one-hot encoding
dummy <- dummyVars(" ~ .", data = data_f20_week4)
newdata <- data.frame(predict(dummy, newdata = data_f20_week4)) 
names(newdata)
str(newdata)

# COPY ML CODE

# 2.3. Create a Validation Dataset

data_f20 <- newdata
data_f20$SUCCESS <- data_f20_saved$SUCCESS
str(data_f20)
# create a list of 80% of the rows in the original dataset we can use for training
validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)


# select 20% of the data for validation
validation <- data_f20[-validation_index,]
validation_same_transf <- data_f20_saved[-validation_index,]

# use the remaining 80% of data to training and testing the models
data_f20 <- data_f20[validation_index,]
y <- as.factor(data_f20$SUCCESS)

# 3. Summarize Dataset

# dimensions of dataset
dim(data_f20)

names(data_f20)

# list types for each attribute
sapply(data_f20, class)

# list the levels for the class
levels(data_f20$SUCCESS)

# 3.5. Class Distribution

# summarize the class distribution
percentage <- prop.table(table(data_f20$SUCCESS)) * 100
cbind(freq=table(data_f20$SUCCESS), percentage=percentage)

# summarize attribute distributions
summary(data_f20)

# 4. Visualize Dataset

# 4.1 Univariate Plots

# split input and output
#x <- data_f20[,1:160]
# data[column!="c3"]
x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
#y <- data_f20[,names(data_f20) %in% c("SUCCESS")]
length(y)
sapply(data_f20, class)

# distribution of each attribute: univariate version
# Recitation..
par(mfrow=c(1,2))
for(i in 1:2) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}

# Gender..
par(mfrow=c(3,4))
for(i in 3:4) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}



# EXAMS
par(mfrow=c(1,4))
for(i in 1:4) {
  boxplot(data_f20_numeric_attributes_0_to_100[,i], main=names(data_f20_numeric_attributes_0_to_100)[i])
}

# ASSIGNMENTS
par(mfrow=c(1,6))
for(i in 1:6) {
  boxplot(data_f20_numeric_attributes_0_to_10[,i], main=names(data_f20_numeric_attributes_0_to_10)[i])
}


# Distribution of the predicted attribute
plot(y)

# Attributes
#x <- data_f20_numeric_attributes_0_to_15[,1:5]


# 4.2 Multivariate Plots: Interactions between variables

# Scatterplots of all pairs of attributes and color the points by class
# Also, because scatterplots show that points for each class are separate, 
# we can draw ellipses around them
featurePlot(x=x, y=y, plot="ellipse")


# We can also look at box and whisker plots of each input variable again, 
# but this time broken down into separate plots for each class. This can help to 
# tease out obvious linear separations between the classes.

featurePlot(x=x, y=y, plot="box")


# Section 5.1.

# Run algorithms using 10-fold cross validation
set.seed(123)
control <- trainControl(method="cv", number=10)
metric <- "Accuracy"

# Section 5.2. Build Models

dataset <- x
dataset$SUCCESS <- y

dataset <- dataset[complete.cases(dataset), ]

x<- dataset[, !names(dataset) %in% c("SUCCESS")]



# almost constant column, only 1 1 and the rest, 0.
dataset <- dataset[, !names(dataset) %in% c("Q2.It.fulfills.another.requirement..Please.explain.")]


# Find collinear variables ...
# correlation DOES NOT WORK with one-hot encoding...
library(corrplot)
corrplot(cor(x))
library(caret)

#figure out which columns are almost constant so we can eliminate them
x_var = nearZeroVar(x, saveMetrics = TRUE)
str(x_var, vec.len=2)

x_var[x_var[,"zeroVar"] > 0, ] 
columns <- x_var[x_var[,"zeroVar"] + x_var[,"nzv"] > 0, ] 
low_var_cols <- columns[1]


# delete constrant column..
x <- x[, !names(x) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2", "Recitation.2..1129729.")]
dataset <- dataset[, !names(dataset) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2", "Recitation.2..1129729.")]
validation <- validation[, !names(validation) %in% c("Q35Very.Easy", "Q2Other..please.explain", "Q4", "Q2", "Recitation.2..1129729.")]



# requires no NAs and only numeric attributes
indexesToDrop <- findCorrelation(cor(x), cutoff = 0.8)

# Find correlated columns ...

names(x)
corrplot(cor(x[,-indexesToDrop]))

x_no_corr <- x[,-indexesToDrop]

# get rid of correlated variables in dataset

dataset_no_corr <- dataset[,-indexesToDrop]
names(dataset)

# variables with very low variance 
#names(dataset[, sapply(dataset, function(v) var(v, na.rm=TRUE)==0)])

no0variance <- dataset[,apply(dataset_no_corr, 2, var, na.rm=TRUE) != 0]



# GETTING RID OF COLINEAR VARIABLES
dataset_no_corr <- dataset_no_corr[, !names(dataset_no_corr) %in% c("Recitation.2..1129729.", "ethnic_cd", "ethnic_cd5", "ethnic_cdN", "ethnic_cdT", "Q2It.fulfills.another.requirement..Please.explain.", "Q2It.is.an.elective", "Q4Other..please.explain", "Q35")]
names(dataset_no_corr)
dataset_no_corr$ethnic_cd


# a) linear algorithms
# LDA needs no correlated variables, or else there will be warnings
set.seed(7)
#fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)
fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)

# b) nonlinear algorithms
# CART
set.seed(7)
fit.cart <- train(SUCCESS~., data=dataset, method="rpart", metric=metric, trControl=control)
# kNN
set.seed(7)
fit.knn <- train(SUCCESS~., data=dataset, method="knn", metric=metric, trControl=control)
# c) advanced algorithms
# SVM
set.seed(7)
fit.svm <- train(SUCCESS~., data=dataset_no_corr, method="svmRadial", metric=metric, trControl=control)
# Random Forest
set.seed(7)
fit.rf <- train(SUCCESS~., data=dataset, method="rf", metric=metric, trControl=control)

# finding constant columns
table(dataset_no_corr$Q35Very.Easy)


# 5.3 Select Best Model

# summarize accuracy of models
results <- resamples(list(lda=fit.lda, cart=fit.cart, knn=fit.knn, svm=fit.svm, rf=fit.rf))
summary(results)

# compare accuracy of models
dotplot(results)

# summarize Best Model
print(fit.rf)

# Section 6. Make Predictions

# get rid of columns in validation that are not in training data

validation_same_columns<- validation[, names(validation) %in% names(dataset)]
names(dataset)
#validation_same_transf <- data_f20_same_transf[-validation_index,]
#validation_same_transf<- validation_same_transf[, names(validation_same_transf) %in% c("NetID", "RUID", "grade", "gender_cd", "ethnic_cd", "cum_gpa_ug_to_date","orig_admit_type_cd")]

validation_nona <- na.omit(validation_same_columns)

validation_nona_same_transf1 <- validation_same_transf[, !names(validation_same_transf) %in% c("Notes", "Surveys.Current.Points", "Surveys.Final.Points","Surveys.Current.Score", "Surveys.Unposted.Current.Score", "Surveys.Final.Score", "Surveys.Unposted.Final.Score", "ap_exam_test_score","deg_sought1", "housing_status_cd", "student_support_ind", "visa_status_cd","tran_ug_or_grad_credit_cd","deg_earned_curric_cd1", "deg_minor_curric_cd1",  "dual_deg_ind","joint_deg_ind", "sat_math_highest_rec", "Q2_8_TEXT", "Q2_6_TEXT", "Q44", "Q44_8_TEXT", "Q44_6_TEXT", "Q4_6_TEXT", "Q34", "Q43", "Q43_B")]

va1 <- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% c("NetID","RUID","Current.Points", "Final.Points","Unposted.Final.Score", "Final.Score","Current.Grade", "Unposted.Current.Grade", "Final.Grade", "grade", "ethnic_cd", "gender_cd" )]
va2<- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% names(validation_same_columns)]




#validation_nona_same_transf <- na.omit(validation_nona_same_transf1)
validation_nona_same_transf <- cbind(va1, va2)

validation_nona_same_transf2 <- na.omit(validation_nona_same_transf)
names(validation_nona_same_transf)

validation_nona_same_transf <- validation_nona_same_transf2




# old

#validation_same_columns<- validation[, names(validation) %in% names(dataset)]

#validation_same_transf <- data_f20_same_transf[-validation_index,]
#validation_same_transf<- validation_same_transf[, names(validation_same_transf) %in% c("NetID", "RUID", "grade", "gender_cd", "ethnic_cd", "cum_gpa_ug_to_date","orig_admit_type_cd")]

#validation_nona <- na.omit(validation_same_columns)
#validation_nona_same_transf <- na.omit(validation_same_transf)
#names(validation_same_transf)
# estimate skill of RF on the validation dataset

predictions <- predict(fit.rf, validation_nona)
confusionMatrix(predictions, as.factor(validation_nona$SUCCESS))
names(validation_nona)
names(validation_same_columns)

dim(validation_nona)
length(predictions)
# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "2"] <- 2
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "3"] <- 3

validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "1"] <- 1
validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "2"] <- 2
validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "3"] <- 3

# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

#get rid of temporary variable
#validation<- validation[, !names(validation) %in% c("SUCCESS_num")]

# STEP 1 DONE!

# STEP 2
#predictions <- as.numeric(predictions)-1

# indeces in validation of mismatches
mismatched_indeces <- which(as.numeric(predictions)!=validation_nona$SUCCESS)
accuracy = 1 - length(mismatched_indeces)/nrow(validation_nona)
accuracy

#mismatched <- validation_nona_same_transf[mismatched_indeces,]
mismatched <- validation_same_transf[mismatched_indeces,]


# write them in a file!

write.csv(mismatched, "RF_mismatched_WEEK4_ids.csv")

predictions[mismatched_indeces]



# Models Week 7!

data_f20_week7 <- data_f20_saved[,names(data_f20_saved) %in% c("cum_gpa_ug_to_date","gender_cd","ethnic_cd","orig_admit_type_cd","Q2","Q4","Q35","BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT","Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733.","Recitation.5..1129735.","Recitation.6..1129726.","Recitation.7..1129732.","X0..Pseudocode..1127307.", "X1..HelloWorld..1067474.", "Quiz.1..1068907.")]
data_f20_same_transf <- data_f20_saved
str(data_f20_week7)

y <- data_f20_saved$SUCCESS

# turn all variables to numeric, using one-hot encoding
dummy <- dummyVars(" ~ .", data = data_f20_week7)
newdata <- data.frame(predict(dummy, newdata = data_f20_week7)) 
names(newdata)
str(newdata)

table(newdata$orig_admit_type_cd.2)

# COPY ML CODE

# 2.3. Create a Validation Dataset


data_f20 <- newdata
data_f20$SUCCESS <- data_f20_saved$SUCCESS
str(data_f20)
# create a list of 80% of the rows in the original dataset we can use for training
validation_index <- createDataPartition(data_f20$SUCCESS, p=0.80, list=FALSE)

# select 20% of the data for validation
validation <- data_f20[-validation_index,]
validation_same_transf <- data_f20_saved[-validation_index,]
# use the remaining 80% of data to training and testing the models
data_f20 <- data_f20[validation_index,]

# 3. Summarize Dataset

# dimensions of dataset
dim(data_f20)

names(data_f20)

# list types for each attribute
sapply(data_f20, class)

# list the levels for the class
levels(data_f20$SUCCESS)

# 3.5. Class Distribution

# summarize the class distribution
percentage <- prop.table(table(data_f20$SUCCESS)) * 100
cbind(freq=table(data_f20$SUCCESS), percentage=percentage)

# summarize attribute distributions
summary(data_f20)

# 4. Visualize Dataset

# 4.1 Univariate Plots

# split input and output
x<- data_f20[, !names(data_f20) %in% c("SUCCESS")]
y <- data_f20[,names(data_f20) %in% c("SUCCESS")]

sapply(data_f20, class)

# Seclect all numeric attributes..

#num_cols <- unlist(lapply(data_f20, is.numeric)) # Identify numeric columns

#data_num <- data_f20[ , num_cols]  # Subset numeric columns of data
#names(data_num)
#str(data_f20)


# distribution of each attribute: univariate version
# Recitation..
par(mfrow=c(1,2))
for(i in 1:2) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}

# Gender..
par(mfrow=c(3,4))
for(i in 3:4) {
  boxplot(data_f20[,i], main=names(data_f20)[i])
}



# EXAMS
par(mfrow=c(1,4))
for(i in 1:4) {
  boxplot(data_f20_numeric_attributes_0_to_100[,i], main=names(data_f20_numeric_attributes_0_to_100)[i])
}

# ASSIGNMENTS
par(mfrow=c(1,6))
for(i in 1:6) {
  boxplot(data_f20_numeric_attributes_0_to_10[,i], main=names(data_f20_numeric_attributes_0_to_10)[i])
}


# Distribution of the predicted attribute
plot(y)

# Attributes
#x <- data_f20_numeric_attributes_0_to_15[,1:5]


# 4.2 Multivariate Plots: Interactions between variables

# Scatterplots of all pairs of attributes and color the points by class
# Also, because scatterplots show that points for each class are separate, 
# we can draw ellipses around them
featurePlot(x=x, y=y, plot="ellipse")


# We can also look at box and whisker plots of each input variable again, 
# but this time broken down into separate plots for each class. This can help to 
# tease out obvious linear separations between the classes.

featurePlot(x=x, y=y, plot="box")


# Section 5.1.

# Run algorithms using 10-fold cross validation
set.seed(123)
control <- trainControl(method="cv", number=10)
metric <- "Accuracy"

# Section 5.2. Build Models

dataset <- x
dataset$SUCCESS <- y

dataset <- dataset[complete.cases(dataset), ]

x<- dataset[, !names(dataset) %in% c("SUCCESS")]


#figure out which columns are almost constant so we can eliminate them
x_var = nearZeroVar(x, saveMetrics = TRUE)
str(x_var, vec.len=2)

x_var[x_var[,"zeroVar"] > 0, ] 
columns <- x_var[x_var[,"zeroVar"] + x_var[,"nzv"] > 0, ] 
low_var_cols <- columns[1]


# delete constrant column..
x <- x[, !names(x) %in% c("ethnic_cd", "Recitation.2..1129729.", "Q2Other..please.explain")]
dataset <- dataset[, !names(dataset) %in% c("ethnic_cd", "Recitation.2..1129729.", "Q2Other..please.explain")]
validation <- validation[, !names(validation) %in% c("ethnic_cd", "Recitation.2..1129729.", "Q2Other..please.explain")]



# almost constant column, only 1 1 and the rest, 0.
#dataset <- dataset[, !names(dataset) %in% c("Q2.It.fulfills.another.requirement..Please.explain.")]


# Find collinear variables ...
library(corrplot)
#corrplot(cor(x))
library(caret)

# requires no NAs and only numeric attributes
indexesToDrop <- findCorrelation(cor(x), cutoff = 0.8)
names(x)

# Find correlated columns ...

names(x)
corrplot(cor(x[,-indexesToDrop]))

x_no_corr <- x[,-indexesToDrop]
names(x_no_corr)

# get rid of correlated variables in dataset

dataset_no_corr <- dataset[,-indexesToDrop]
names(dataset_no_corr)

# variables with very low variance 
#names(dataset[, sapply(dataset, function(v) var(v, na.rm=TRUE)==0)])

no0variance <- dataset_no_corr[,apply(dataset_no_corr, 2, var, na.rm=TRUE) != 0]
dataset_no_corr$SUCCESS <- as.factor(dataset_no_corr$SUCCESS)
dataset$SUCCESS <- as.factor(dataset$SUCCESS)

names(dataset_no_corr)

# a) linear algorithms
# LDA needs no correlated variables, or else there will be warnings
set.seed(7)
#fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)
fit.lda <- train(SUCCESS~., data=dataset_no_corr, method="lda", metric=metric, trControl=control)

# b) nonlinear algorithms
# CART
set.seed(7)
fit.cart <- train(SUCCESS~., data=dataset, method="rpart", metric=metric, trControl=control)
# kNN
set.seed(7)
fit.knn <- train(SUCCESS~., data=dataset, method="knn", metric=metric, trControl=control)
# c) advanced algorithms
# SVM
set.seed(7)
fit.svm <- train(SUCCESS~., data=dataset_no_corr, method="svmRadial", metric=metric, trControl=control)
# Random Forest
set.seed(7)
fit.rf <- train(SUCCESS~., data=dataset, method="rf", metric=metric, trControl=control)

# 5.3 Select Best Model

# summarize accuracy of models
results <- resamples(list(lda=fit.lda, cart=fit.cart, knn=fit.knn, svm=fit.svm, rf=fit.rf))
summary(results)

# compare accuracy of models
dotplot(results)

# summarize Best Model
print(fit.cart) # ACCURACY = 59%
#print(fit.knn) # ACCURACY = 86%




# Section 6. Make Predictions

# get rid of columns in validation that are not in training data

validation_same_columns<- validation[, names(validation) %in% names(dataset)]

#validation_same_transf <- data_f20_same_transf[-validation_index,]
#validation_same_transf<- validation_same_transf[, names(validation_same_transf) %in% c("NetID", "RUID", "grade", "gender_cd", "ethnic_cd", "cum_gpa_ug_to_date","orig_admit_type_cd")]

validation_nona <- na.omit(validation_same_columns)

validation_nona_same_transf1 <- validation_same_transf[, !names(validation_same_transf) %in% c("Notes", "Surveys.Current.Points", "Surveys.Final.Points","Surveys.Current.Score", "Surveys.Unposted.Current.Score", "Surveys.Final.Score", "Surveys.Unposted.Final.Score", "ap_exam_test_score","deg_sought1", "housing_status_cd", "student_support_ind", "visa_status_cd","tran_ug_or_grad_credit_cd","deg_earned_curric_cd1", "deg_minor_curric_cd1",  "dual_deg_ind","joint_deg_ind", "sat_math_highest_rec", "Q2_8_TEXT", "Q2_6_TEXT", "Q44", "Q44_8_TEXT", "Q44_6_TEXT", "Q4_6_TEXT", "Q34", "Q43", "Q43_B")]




names(validation_nona)

#va <- subset(validation_nona_same_transf1, select=Q39_2:Q28_B)

va1 <- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% c("NetID","RUID","Current.Points", "Final.Points","Unposted.Final.Score", "Final.Score","Current.Grade", "Unposted.Current.Grade", "Final.Grade", "grade", "ethnic_cd", "gender_cd" )]
va2<- validation_nona_same_transf1[, names(validation_nona_same_transf1) %in% names(validation_same_columns)]




#validation_nona_same_transf <- na.omit(validation_nona_same_transf1)
validation_nona_same_transf <- cbind(va1, va2)

validation_nona_same_transf2 <- na.omit(validation_nona_same_transf)
names(validation_nona_same_transf)

validation_nona_same_transf <- validation_nona_same_transf2


# check that it's the same people in both datasets
table(validation_nona$ethnic_cd.3)
table(validation_nona$ethnic_cd.4)
table(validation_nona$ethnic_cd.5)
table(validation_nona$ethnic_cd.6)
table(validation_nona$ethnic_cd.8)
table(validation_nona_same_transf2$ethnic_cd)

table(validation_nona$gender_cd.F)
table(validation_nona$gender_cd.M)
table(validation_nona_same_transf2$gender_cd)
# checked!

names(validation_nona_same_transf1)
#names(validation_nona_same_transf1)
# estimate skill of RF on the validation dataset
names(validation_nona)
names(fit.rf)
validation_nona <- plyr::rename(validation_nona, c("ethnic_cd." = "gender_cd.F"))


predictions <- predict(fit.cart, validation_nona)

confusionMatrix(predictions, as.factor(validation_nona$SUCCESS))
dim(validation_nona)
length(predictions)
str(validation_nona)
# FIND MISMATCHES

# STEP 1: turn SUCCESS variable from a factor into a number.
# temporary variable a number
# 2-class case..
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "0"] <- 0

validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona_same_transf$SUCCESS_num[validation_nona$SUCCESS == "0"] <- 0

# 3-class case..
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "1"] <- 1
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "2"] <- 2
validation_nona$SUCCESS_num[validation_nona$SUCCESS == "3"] <- 3

validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "1"] <- 1
validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "2"] <- 2
validation_nona_same_transf$SUCCESS_num[validation_nona_same_transf$SUCCESS == "3"] <- 3

table(validation_nona_same_transf$SUCCESS_num)


# copy it into the SUCESS variable
#validation$SUCCESS <- validation$SUCCESS_num

#get rid of temporary variable
#validation<- validation[, !names(validation) %in% c("SUCCESS_num")]

# STEP 1 DONE!

# STEP 2
#predictions <- as.numeric(predictions)-1

# indeces in validation of mismatches

# 2-class case
mismatched_indeces <- which(abs(as.numeric(predictions)-1 - validation_nona$SUCCESS_num)==1)

# 3-class case
mismatched_indeces <- which(predictions!=validation_nona$SUCCESS)
# accuracy = 1 - (100*#mispredicted)/#total
accuracy = 1 - length(mismatched_indeces)/nrow(validation_nona)
accuracy

mismatched <- validation_same_transf[mismatched_indeces,]

# write them in a file!

write.csv(mismatched, "RF_mismatched_WEEK7_ids_3_classes.csv")

predictions[mismatched_indeces]


# -----------------------------------------

# --------------------------------------------
# ------ Train on Data from Fall 2020 -------- 
# ------ Test on Data from Fall 2021  --------
# --------------------------------------------

# -------------------------------------

# more or less BALANCED!
table(data_f20_saved$SUCCESS)




# -----------------------------------------

# ---------------------------------------------
#   --------     3-class Classification  ------
# -----------------------------------------------




# Neural Net for Data Including Canvas  - latest version below

# Choosing ONLY numeric attributes...
# identify columns that are numeric
num_cols <- unlist(lapply(data_f20, is.numeric))         # Identify numeric columns
num_cols
data_num <- data_f20[ , num_cols]

data_f20_numeric_attributes <- data_num[,names(data_num) %in% c("cum_gpa_ug_to_date", "orig_admit_type_cd", "curr_admit_type_cd", "BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Recitation.10..1129728.", "Recitation.11..1129738.", "Recitation.12..1129734.", "Recitation.13..1129737.", "Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733." , "Recitation.5..1129735.","Recitation.6..1129726.", "Recitation.7..1129732.", "Recitation.8..1129736.", "Recitation.9..1129727.", "Quiz.1..1068907.","Quiz.2..1127309.","Quiz.3..1127314.","Quiz.4..1129289.","X0..Pseudocode..1127307.","X1..HelloWorld..1067474.","X3..Order.Check..1067507.","X2..Wind.Chill..1067488.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X16..Assignment.8...Complexity.Analysis..1129495.")]

# fit neural network
data_f20_numeric_attributes$SUCCESS <- y
# get rid of NA
data_f20_numeric_attributes <- data_f20_numeric_attributes[complete.cases(data_f20_numeric_attributes), ]


# Neural Network Complete Code for Data F20 with Canvas

setwd("")
data_canvas_and_sas <- read.csv("data_canvas_and_sas_f20_111.csv", header = TRUE)

data_canvas_and_sas_f20_111 <- data_canvas_and_sas

data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$grade == "A"] <- 1
data_canvas_and_sas_f20_111$SUCCESS[grep( "B", data_canvas_and_sas_f20_111$grade)] <-1
data_canvas_and_sas_f20_111$SUCCESS[grep("C", data_canvas_and_sas_f20_111$grade)] <-1
data_canvas_and_sas_f20_111$SUCCESS[grep("D", data_canvas_and_sas_f20_111$grade)] <-0
data_canvas_and_sas_f20_111$SUCCESS[grep("F", data_canvas_and_sas_f20_111$grade)] <-0
data_canvas_and_sas_f20_111$SUCCESS[grep("W", data_canvas_and_sas_f20_111$grade)] <-0
data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$grade == "PA"] <- 1
data_canvas_and_sas_f20_111$SUCCESS[data_canvas_and_sas_f20_111$grade == "NC"] <- 0

y <- data_canvas_and_sas_f20_111$SUCCESS

# Need all column to be numeric ...
num_cols <- unlist(lapply(data_canvas_and_sas_f20_111, is.numeric))         # Identify numeric columns
num_cols
data_num <- data_canvas_and_sas_f20_111[ , num_cols]
names(data_num)

data_f20_numeric_attributes <- data_num[,names(data_num) %in% c("cum_gpa_ug_to_date", "orig_admit_type_cd", "curr_admit_type_cd", "BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Recitation.10..1129728.", "Recitation.11..1129738.", "Recitation.12..1129734.", "Recitation.13..1129737.", "Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733." , "Recitation.5..1129735.","Recitation.6..1129726.", "Recitation.7..1129732.", "Recitation.8..1129736.", "Recitation.9..1129727.", "Quiz.1..1068907.","Quiz.2..1127309.","Quiz.3..1127314.","Quiz.4..1129289.","X0..Pseudocode..1127307.","X1..HelloWorld..1067474.","X3..Order.Check..1067507.","X2..Wind.Chill..1067488.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X16..Assignment.8...Complexity.Analysis..1129495.")]
# add SUCCESS
data_f20_numeric_attributes$SUCCESS <- y

# get rid of NA
data_f20_numeric_attributes <- data_f20_numeric_attributes[complete.cases(data_f20_numeric_attributes), ]

# double check! no NA
apply(data_f20_numeric_attributes,2,function(x) sum(is.na(x)))



# We proceed by randomly splitting the data into a train and a test set,
# then we fit a linear regression model and test it on the test set. 
# Note that I am using the gml() function instead of the lm() 
# this will become useful later when cross validating the linear model.
index <- sample(1:nrow(data_f20_numeric_attributes),round(0.75*nrow(data_f20_numeric_attributes)))
train <- data_f20_numeric_attributes[index,]
test <- data_f20_numeric_attributes[-index,]
lm.fit <- glm(SUCCESS~., data=train)
summary(lm.fit)
pr.lm <- predict(lm.fit,test)
MSE.lm <- sum((pr.lm - test$SUCCESS)^2)/nrow(test)

# Before fitting a neural network, some preparation need to be done. 
# Neural networks are not that easy to train and tune. As a first step, 
# we are going to address data preprocessing. It is good practice 
# to normalize your data before training a neural network. 
# I cannot emphasize enough how important this step is: depending on your dataset,
# avoiding normalization may lead to useless results or to a very difficult
# training process (most of the times the algorithm will not converge 
# before the number of maximum iterations allowed). You can choose different
# methods to scale the data (z-normalization, min-max scale, etc). 
# I chose to use the min-max method and scale the data in the interval [0,1]. 
# Usually scaling in the intervals [0,1] or [-1,1] tends to give better results.
# We therefore scale and split the data before moving on:

maxs <- apply(data_f20_numeric_attributes, 2, max) 
mins <- apply(data_f20_numeric_attributes, 2, min)
scaled <- as.data.frame(scale(data_f20_numeric_attributes, center = mins, scale = maxs - mins))
train_ <- scaled[index,]
test_ <- scaled[-index,]

# As far as I know there is no fixed rule as to how many layers and neurons 
# to use although there are several more or less accepted rules of thumb. 
# Usually, if at all necessary, one hidden layer is enough for a vast numbers
# of applications. As far as the number of neurons is concerned, it should be between
# the input layer size and the output layer size, usually 2/3 of the input size. 
# At least in my brief experience testing again and again is the best solution since
# there is no guarantee that any of these rules will fit your model best.
# Since this is a toy example, we are going to use 2 hidden layers with
# this configuration: 13:5:3:1. The input layer has 13 inputs, the two hidden layers
# have 5 and 3 neurons and the output layer has, of course, a single output
# since we are doing regression. Lets fit the net:

library(neuralnet)
n <- names(train_)
f <- as.formula(paste("SUCCESS ~", paste(n[!n %in% "SUCCESS"], collapse = " + ")))
nn <- neuralnet(f,data=train_,hidden=c(5,3),linear.output=T)
# previous version ...
#nn=neuralnet(SUCCESS~.,data=data_f20_numeric_attributes, hidden=3,act.fct = "logistic",
#             linear.output = FALSE)

# plot neural network
plot(nn)

# Now we can try to predict the values for the test set and calculate the MSE.
# Remember that the net will output a normalized prediction, so we need to
# scale it back in order to make a meaningful comparison (or just a simple prediction).

# data_f20_numeric_attributes <- data_num[,names(data_num) %in% c("cum_gpa_ug_to_date", "orig_admit_type_cd", "curr_admit_type_cd", "BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Recitation.10..1129728.", "Recitation.11..1129738.", "Recitation.12..1129734.", "Recitation.13..1129737.", "Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733." , "Recitation.5..1129735.","Recitation.6..1129726.", "Recitation.7..1129732.", "Recitation.8..1129736.", "Recitation.9..1129727.", "Quiz.1..1068907.","Quiz.2..1127309.","Quiz.3..1127314.","Quiz.4..1129289.","X0..Pseudocode..1127307.","X1..HelloWorld..1067474.","X3..Order.Check..1067507.","X2..Wind.Chill..1067488.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X16..Assignment.8...Complexity.Analysis..1129495.")]

test_data <- test_[,!names(data_f20_numeric_attributes) %in% c("SUCCESS")]
pr.nn <- compute(nn,test_data)
pr.nn_ <- pr.nn$net.result*(max(data_f20_numeric_attributes$SUCCESS)-min(data_f20_numeric_attributes$SUCCESS))+min(data_f20_numeric_attributes$SUCCESS)
test.r <- (test_$SUCCESS)*(max(data_f20_numeric_attributes$SUCCESS)-min(data_f20_numeric_attributes$SUCCESS))+min(data_f20_numeric_attributes$SUCCESS)
MSE.nn <- sum((test.r - pr.nn_)^2)/nrow(test_)

test$SUCCESS - pr.nn_
pr.nn_

test$SUCCESS[c(2, 21, 29, 31, 94, 99, 116, 130, 137, 168, 188, 210, 223, 233, 250)]
pr.nn$net.result[c(2, 21, 29, 31, 94, 99, 116, 130, 137, 168, 188, 210, 223, 233, 250)]
# students[c(1,3,4),] would select rows 1, 3 and 4,
data_mispred <- test[c(2, 21, 29, 31, 94, 99, 116, 130, 137, 168, 188, 210, 223, 233, 250),] 
data_mispred$prediction <- pr.nn$net.result[c(2, 21, 29, 31, 94, 99, 116, 130, 137, 168, 188, 210, 223, 233, 250)]
write.csv(data_mispred, "mispredicted.csv")
getwd()


# we then compare the two MSEs
print(paste(MSE.lm,MSE.nn))

# A first visual approach to the performance of the network and the linear model
# on the test set is plotted below

par(mfrow=c(1,2))
plot(test$SUCCESS,pr.nn_,col='red',main='Real vs predicted NN',pch=18,cex=0.7)
abline(0,1,lwd=2)
legend('bottomright',legend='NN',pch=18,col='red', bty='n')
plot(test$SUCCESS,pr.lm,col='blue',main='Real vs predicted lm',pch=18, cex=0.7)
abline(0,1,lwd=2)
legend('bottomright',legend='LM',pch=18,col='blue', bty='n', cex=.95)

# Another visual, both on the same graph...

plot(test$SUCCESS,pr.nn_,col='red',main='Real vs predicted NN',pch=18,cex=0.7)
points(test$SUCCESS,pr.lm,col='blue',pch=18,cex=0.7)
abline(0,1,lwd=2)
legend('bottomright',legend=c('NN','LM'),pch=18,col=c('red','blue'))

# We are going to implement a fast cross validation using a for loop for
# the neural network and the cv.glm() function in the boot package for the linear model.
# As far as I know, there is no built-in function in R to perform cross-validation
# on this kind of neural network

library(boot)
set.seed(200)
lm.fit <- glm(SUCCESS~.,data=data_f20_numeric_attributes)
cv.glm(data_f20_numeric_attributes,lm.fit,K=10)$delta[1]

# Now the net. Note that I am splitting the data in this way: 90% train set
# and 10% test set in a random way for 10 times. I am also initializing a progress
# bar using the plyr library because I want to keep an eye on the status of the
# process since the fitting of the neural network may take a while.

set.seed(450)
cv.error <- NULL
k <- 10
library(plyr) 
pbar <- create_progress_bar('text')
pbar$init(k)
for(i in 1:k){
  index <- sample(1:nrow(data_f20_numeric_attributes),round(0.9*nrow(data_f20_numeric_attributes)))
  train.cv <- scaled[index,]
  test.cv <- scaled[-index,]
  nn <- neuralnet(f,data=train.cv,hidden=c(5,2),linear.output=T)   
  # test.cv[,!names(data_f20_numeric_attributes) %in% c("SUCCESS")]
  pr.nn <- compute(nn,test.cv[,!names(data_f20_numeric_attributes) %in% c("SUCCESS")])
  pr.nn <- pr.nn$net.result*(max(data_f20_numeric_attributes$SUCCESS)-min(data_f20_numeric_attributes$SUCCESS))+min(data_f20_numeric_attributes$SUCCESS)   
  test.cv.r <- (test.cv$SUCCESS)*(max(data_f20_numeric_attributes$SUCCESS)-min(data_f20_numeric_attributes$SUCCESS))+min(data_f20_numeric_attributes$SUCCESS)   
  cv.error[i] <- sum((test.cv.r - pr.nn)^2)/nrow(test.cv)    
  pbar$step()
}

# After a while, the process is done, we calculate the average MSE
# and plot the results as a boxplot

mean(cv.error)
cv.error

# The code for the box plot:

boxplot(cv.error,xlab='MSE CV',col='cyan',
        border='blue',names='CV error (MSE)',
        main='CV error (MSE) for NN',horizontal=TRUE)




names(validation1)
names(data_num1)
validation1_num <- validation1[, !names(validation1) %in% c("NetID","Intro.Survey..1068919.","Exit.Survey..1127030.","year","unit_of_reg_cd", "subj_cd", "course_no", "sat_math_highest_rec", "housing_status_cd", "deg_earned_curric_cd1", "deg_minor_curric_cd1")]
validation1_num <- validation1_num[complete.cases(validation1_num), ]

validation1_num <- validation1[,names(validation1) %in% c("cum_gpa_ug_to_date", "orig_admit_type_cd", "curr_admit_type_cd", "BELONGINGNESS","CONFIDENCE", "INTEREST", "USEFULNESS", "ENCOURAGEMENT", "Recitation.10..1129728.", "Recitation.11..1129738.", "Recitation.12..1129734.", "Recitation.13..1129737.", "Recitation.2..1129729.", "Recitation.3..1129730.","Recitation.4..1129733." , "Recitation.5..1129735.","Recitation.6..1129726.", "Recitation.7..1129732.", "Recitation.8..1129736.", "Recitation.9..1129727.", "Quiz.1..1068907.","Quiz.2..1127309.","Quiz.3..1127314.","Quiz.4..1129289.","X0..Pseudocode..1127307.","X1..HelloWorld..1067474.","X3..Order.Check..1067507.","X2..Wind.Chill..1067488.","X4..Largest.Of.Five..1067512.","X5..Check.Digit..1067522.", "X6..Two.Smallest..1067529.","X7..Random.Walker..1067533.","X8..Find.Duplicate..1067540.","X9..RU.Rotten.Tomatoes..1067618.","X10..Polygon.Transform..1126937.", "X11..Sierpinski..1126948.","X12..Weather.Generator..1126951.","X13..RecursiveAppend..1126971.","X14..Vehicle.Scenario.Analysis..1126976.","X15..Heart.Transplant..1126986.", "X16..Assignment.8...Complexity.Analysis..1129495.")]



# logistic regression

# inspect the data ...
sample_n(data_f20, 3)

# Split the data into training and test set
set.seed(123)
training.samples <- data_f20$SUCCESS %>% 
  createDataPartition(p = 0.8, list = FALSE)
train.data  <- data_f20[training.samples, ]
test.data <- data_f20[-training.samples, ]



#mylogit <- glm(SUCCESS ~ gender_cd + ethnic_cd + cum_gpa_ug_to_date + course_repeat_ind + CONFIDENCE + ENCOURAGEMENT + INTEREST + BELONGINGNESS + USEFULNESS +  Q4 + Q35.x, data = data_f20, family = "binomial")
mylogit <- glm(SUCCESS ~ gender_cd + ethnic_cd + cum_gpa_ug_to_date + course_repeat_ind + CONFIDENCE + ENCOURAGEMENT + INTEREST + BELONGINGNESS + USEFULNESS , data = train.data, family = "binomial")
#mylogit <- glm(SUCCESS ~ ., data = train.data, family = "binomial")

summary(mylogit)

# Make predictions
probabilities <- mylogit %>% predict(test.data, type = "response")
predicted.classes <- ifelse(probabilities > 0.5,  1, 0)
# Model accuracy
mean(predicted.classes == test.data$SUCCESS)






# Other ML algorithms


install.packages("caret")
install.packages("caret", dependencies=c("Depends", "Suggests"))
library(caret)




# Duration..in.seconds..x




data_all$RACE <- factor(data_all$RACE)
data_all$GENDER <- factor(data_all$GENDER)

names(data_all)

mylogit <- glm(SUCCESS ~ gender_cd + ethnic_cd + cum_gpa_ug_to_date + course_repeat_ind, data = data_all, family = "binomial")
summary(mylogit)









# ---------------   ALL THE DATA   ------------------------

data_19 <- read.csv("Student_data_2019.csv", header = TRUE)
data_18 <- read.csv("Student_data_2018.csv", header = TRUE)
data_17 <- read.csv("Student_data_2017.csv", header = TRUE)
data_16 <- read.csv("Student_data_2016.csv", header = TRUE)
data_15 <- read.csv("Student_data_2015.csv", header = TRUE)
data_14 <- read.csv("Student_data_2014.csv", header = TRUE)
data_13 <- read.csv("Student_data_2013.csv", header = TRUE)


# select CS111 
data_19 <- data_19[data_19$unit_of_reg_cd=="1"&data_19$subj_cd=="198"&data_19$course_no=="111",]
data_18 <- data_18[data_18$unit_of_reg_cd=="1"&data_18$subj_cd=="198"&data_18$course_no=="111",]
data_17 <- data_17[data_17$unit_of_reg_cd=="1"&data_17$subj_cd=="198"&data_17$course_no=="111",]
data_16 <- data_16[data_16$unit_of_reg_cd=="1"&data_16$subj_cd=="198"&data_16$course_no=="111",]
data_15 <- data_15[data_15$unit_of_reg_cd=="1"&data_15$subj_cd=="198"&data_15$course_no=="111",]
data_14 <- data_14[data_14$unit_of_reg_cd=="1"&data_14$subj_cd=="198"&data_14$course_no=="111",]
data_13 <- data_13[data_13$unit_of_reg_cd=="1"&data_13$subj_cd=="198"&data_13$course_no=="111",]

data_all <- rbind(data_19, data_18, data_17, data_16, data_15, data_14, data_13)


# make a GENDER variable, 1 for men and 0 for women
data_19$GENDER[data_19$gender_cd == "M"] <- 1
data_19$GENDER[data_19$gender_cd == "F"] <- 0

# By semester...
data_18$GENDER[data_18$gender_cd == "M"] <- 1
data_18$GENDER[data_18$gender_cd == "F"] <- 0

data_17$GENDER[data_17$gender_cd == "M"] <- 1
data_17$GENDER[data_17$gender_cd == "F"] <- 0

data_16$GENDER[data_16$gender_cd == "M"] <- 1
data_16$GENDER[data_16$gender_cd == "F"] <- 0

data_15$GENDER[data_15$gender_cd == "M"] <- 1
data_15$GENDER[data_15$gender_cd == "F"] <- 0

data_14$GENDER[data_14$gender_cd == "M"] <- 1
data_14$GENDER[data_14$gender_cd == "F"] <- 0

data_13$GENDER[data_13$gender_cd == "M"] <- 1
data_13$GENDER[data_13$gender_cd == "F"] <- 0

data_all$GENDER[data_all$GENDER == "M"] <- 1
data_all$GENDER[data_all$GENDER == "F"] <- 0

# make a RACE variable, 1 for White/Asian, 0 for the rest
data_all$RACE <- 0
data_all$RACE[data_all$ethnic_cd == "6"] <-1
data_all$RACE[data_all$ethnic_cd == "8"] <-1

data_19$RACE <- 0
data_19$RACE[data_19$ethnic_cd == "6"] <-1
data_19$RACE[data_19$ethnic_cd == "8"] <-1

data_18$RACE <- 0
data_18$RACE[data_18$ethnic_cd == "6"] <-1
data_18$RACE[data_18$ethnic_cd == "8"] <-1

data_17$RACE <- 0
data_17$RACE[data_17$ethnic_cd == "6"] <-1
data_17$RACE[data_17$ethnic_cd == "8"] <-1

data_16$RACE <- 0
data_16$RACE[data_16$ethnic_cd == "6"] <-1
data_16$RACE[data_16$ethnic_cd == "8"] <-1

data_15$RACE <- 0
data_15$RACE[data_15$ethnic_cd == "6"] <-1
data_15$RACE[data_15$ethnic_cd == "8"] <-1

data_14$RACE <- 0
data_14$RACE[data_14$ethnic_cd == "6"] <-1
data_14$RACE[data_14$ethnic_cd == "8"] <-1

data_13$RACE <- 0
data_13$RACE[data_13$ethnic_cd == "6"] <-1
data_13$RACE[data_13$ethnic_cd == "8"] <-1


# make a SUCCESS variable, 1 for C and above and 0 for D and below
data_all$SUCCESS[data_all$grade == "A"] <- 1
data_all$SUCCESS[grep( "B", data_all$grade)] <-1
data_all$SUCCESS[grep("C", data_all$grade)] <-1
data_all$SUCCESS[grep("D", data_all$grade)] <-0
data_all$SUCCESS[grep("F", data_all$grade)] <-0
data_all$SUCCESS[grep("W", data_all$grade)] <-0


data_19$SUCCESS[data_19$grade == "A"] <- 1
data_19$SUCCESS[grep( "B", data_19$grade)] <-1
data_19$SUCCESS[grep("C", data_19$grade)] <-1
data_19$SUCCESS[grep("D", data_19$grade)] <-0
data_19$SUCCESS[grep("F", data_19$grade)] <-0
data_19$SUCCESS[grep("W", data_19$grade)] <-0

data_18$SUCCESS[data_18$grade == "A"] <- 1
data_18$SUCCESS[grep( "B", data_18$grade)] <-1
data_18$SUCCESS[grep("C", data_18$grade)] <-1
data_18$SUCCESS[grep("D", data_18$grade)] <-0
data_18$SUCCESS[grep("F", data_18$grade)] <-0
data_18$SUCCESS[grep("W", data_18$grade)] <-0

data_17$SUCCESS[data_17$grade == "A"] <- 1
data_17$SUCCESS[grep( "B", data_17$grade)] <-1
data_17$SUCCESS[grep("C", data_17$grade)] <-1
data_17$SUCCESS[grep("D", data_17$grade)] <-0
data_17$SUCCESS[grep("F", data_17$grade)] <-0
data_17$SUCCESS[grep("W", data_17$grade)] <-0

data_16$SUCCESS[data_16$grade == "A"] <- 1
data_16$SUCCESS[grep( "B", data_16$grade)] <-1
data_16$SUCCESS[grep("C", data_16$grade)] <-1
data_16$SUCCESS[grep("D", data_16$grade)] <-0
data_16$SUCCESS[grep("F", data_16$grade)] <-0
data_16$SUCCESS[grep("W", data_16$grade)] <-0

data_15$SUCCESS[data_15$grade == "A"] <- 1
data_15$SUCCESS[grep( "B", data_15$grade)] <-1
data_15$SUCCESS[grep("C", data_15$grade)] <-1
data_15$SUCCESS[grep("D", data_15$grade)] <-0
data_15$SUCCESS[grep("F", data_15$grade)] <-0
data_15$SUCCESS[grep("W", data_15$grade)] <-0

data_14$SUCCESS[data_14$grade == "A"] <- 1
data_14$SUCCESS[grep( "B", data_14$grade)] <-1
data_14$SUCCESS[grep("C", data_14$grade)] <-1
data_14$SUCCESS[grep("D", data_14$grade)] <-0
data_14$SUCCESS[grep("F", data_14$grade)] <-0
data_14$SUCCESS[grep("W", data_14$grade)] <-0

data_13$SUCCESS[data_13$grade == "A"] <- 1
data_13$SUCCESS[grep( "B", data_13$grade)] <-1
data_13$SUCCESS[grep("C", data_13$grade)] <-1
data_13$SUCCESS[grep("D", data_13$grade)] <-0
data_13$SUCCESS[grep("F", data_13$grade)] <-0
data_13$SUCCESS[grep("W", data_13$grade)] <-0

# select a few columns of interest and also to minimize N/As
data_all <- data_all[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE", "SUCCESS")]

names(data_19)
names(data_all)

data_19 <- data_19[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_18 <- data_18[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_17 <- data_17[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_16 <- data_16[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_15 <- data_15[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_14 <- data_14[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
data_13 <- data_13[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]

data_19_fall <- data_19[data_19$semester=="Fall",]
data_19_spring <- data_19[data_19$semester=="Spring",]

data_18_fall <- data_18[data_18$semester=="Fall",]
data_18_spring <- data_18[data_18$semester=="Spring",]

data_17_fall <- data_17[data_17$semester=="Fall",]
data_17_spring <- data_17[data_17$semester=="Spring",]

data_16_fall <- data_16[data_16$semester=="Fall",]
data_16_spring <- data_16[data_16$semester=="Spring",]

data_15_fall <- data_15[data_15$semester=="Fall",]
data_15_spring <- data_15[data_15$semester=="Spring",]

data_14_fall <- data_14[data_14$semester=="Fall",]
data_14_spring <- data_14[data_14$semester=="Spring",]

data_13_fall <- data_13[data_13$semester=="Fall",]
data_13_spring <- data_13[data_13$semester=="Spring",]

# still have 1-2 NAs so we'll eliminate columns
data_19 <- data_19[complete.cases(data_19), ]
data_18 <- data_18[complete.cases(data_18), ]
data_17 <- data_17[complete.cases(data_17), ]
data_16 <- data_16[complete.cases(data_16), ]
data_15 <- data_15[complete.cases(data_15), ]
data_14 <- data_14[complete.cases(data_14), ]
data_13 <- data_13[complete.cases(data_13), ]




# success and gender need to be numerical
names(data_all)
data_all <- plyr::rename(data_all, c("gender_cd" = "GENDER"))
data_all$GENDER <- as.numeric(data_all$GENDER)
data_all$SUCCESS <- as.numeric(data_all$SUCCESS)
data_all$RACE <- as.numeric(data_all$RACE)

data_19$GENDER <- as.numeric(data_19$GENDER)
data_19$SUCCESS <- as.numeric(data_19$SUCCESS)
data_19$RACE <- as.numeric(data_19$RACE)

data_19_fall$GENDER <- as.numeric(data_19_fall$GENDER)
data_19_fall$SUCCESS <- as.numeric(data_19_fall$SUCCESS)
data_19_fall$RACE <- as.numeric(data_19_fall$RACE)

data_19_spring$GENDER <- as.numeric(data_19_spring$GENDER)
data_19_spring$SUCCESS <- as.numeric(data_19_spring$SUCCESS)
data_19_spring$RACE <- as.numeric(data_19_spring$RACE)

data_18$GENDER <- as.numeric(data_18$GENDER)
data_18$SUCCESS <- as.numeric(data_18$SUCCESS)
data_18$RACE <- as.numeric(data_18$RACE)

data_18_fall$GENDER <- as.numeric(data_18_fall$GENDER)
data_18_fall$SUCCESS <- as.numeric(data_18_fall$SUCCESS)
data_18_fall$RACE <- as.numeric(data_18_fall$RACE)

data_18_spring$GENDER <- as.numeric(data_18_spring$GENDER)
data_18_spring$SUCCESS <- as.numeric(data_18_spring$SUCCESS)
data_18_spring$RACE <- as.numeric(data_18_spring$RACE)

data_17$GENDER <- as.numeric(data_17$GENDER)
data_17$SUCCESS <- as.numeric(data_17$SUCCESS)
data_17$RACE <- as.numeric(data_17$RACE)

data_17_fall$GENDER <- as.numeric(data_17_fall$GENDER)
data_17_fall$SUCCESS <- as.numeric(data_17_fall$SUCCESS)
data_17_fall$RACE <- as.numeric(data_17_fall$RACE)

data_17_spring$GENDER <- as.numeric(data_17_spring$GENDER)
data_17_spring$SUCCESS <- as.numeric(data_17_spring$SUCCESS)
data_17_spring$RACE <- as.numeric(data_17_spring$RACE)


data_16$GENDER <- as.numeric(data_16$GENDER)
data_16$SUCCESS <- as.numeric(data_16$SUCCESS)
data_16$RACE <- as.numeric(data_16$RACE)

data_16_fall$GENDER <- as.numeric(data_16_fall$GENDER)
data_16_fall$SUCCESS <- as.numeric(data_16_fall$SUCCESS)
data_16_fall$RACE <- as.numeric(data_16_fall$RACE)

data_16_spring$GENDER <- as.numeric(data_16_spring$GENDER)
data_16_spring$SUCCESS <- as.numeric(data_16_spring$SUCCESS)
data_16_spring$RACE <- as.numeric(data_16_spring$RACE)

data_15$GENDER <- as.numeric(data_15$GENDER)
data_15$SUCCESS <- as.numeric(data_15$SUCCESS)
data_15$RACE <- as.numeric(data_15$RACE)

data_15_fall$GENDER <- as.numeric(data_15_fall$GENDER)
data_15_fall$SUCCESS <- as.numeric(data_15_fall$SUCCESS)
data_15_fall$RACE <- as.numeric(data_15_fall$RACE)

data_15_spring$GENDER <- as.numeric(data_15_spring$GENDER)
data_15_spring$SUCCESS <- as.numeric(data_15_spring$SUCCESS)
data_15_spring$RACE <- as.numeric(data_15_spring$RACE)

data_14$GENDER <- as.numeric(data_14$GENDER)
data_14$SUCCESS <- as.numeric(data_14$SUCCESS)
data_14$RACE <- as.numeric(data_14$RACE)

data_14_fall$GENDER <- as.numeric(data_14_fall$GENDER)
data_14_fall$SUCCESS <- as.numeric(data_14_fall$SUCCESS)
data_14_fall$RACE <- as.numeric(data_14_fall$RACE)

data_14_spring$GENDER <- as.numeric(data_14_spring$GENDER)
data_14_spring$SUCCESS <- as.numeric(data_14_spring$SUCCESS)
data_14_spring$RACE <- as.numeric(data_14_spring$RACE)

data_13$GENDER <- as.numeric(data_13$GENDER)
data_13$SUCCESS <- as.numeric(data_13$SUCCESS)
data_13$RACE <- as.numeric(data_13$RACE)

data_13_fall$GENDER <- as.numeric(data_13_fall$GENDER)
data_13_fall$SUCCESS <- as.numeric(data_13_fall$SUCCESS)
data_13_fall$RACE <- as.numeric(data_13_fall$RACE)

data_13_spring$GENDER <- as.numeric(data_13_spring$GENDER)
data_13_spring$SUCCESS <- as.numeric(data_13_spring$SUCCESS)
data_13_spring$RACE <- as.numeric(data_13_spring$RACE)

# Choose only numeric attributes
install.packages("plyr")
data_all <- plyr::rename(data_all, c("gender_cd" = "GENDER"))

data_all_short <- data_all[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_19_short <- data_19[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_19_fall_short <- data_19_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_19_spring_short <- data_19_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_18_short <- data_18[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_18_fall_short <- data_18_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_18_spring_short <- data_18_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_17_short <- data_17[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_17_fall_short <- data_17_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_17_spring_short <- data_17_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_16_short <- data_16[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_16_fall_short <- data_16_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_16_spring_short <- data_16_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_15_short <- data_15[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_15_fall_short <- data_15_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_15_spring_short <- data_15_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_14_short <- data_14[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_14_fall_short <- data_14_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_14_spring_short <- data_14_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]

data_13_short <- data_13[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_13_fall_short <- data_13_fall[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
data_13_spring_short <- data_13_spring[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]



## FORMAT THE DATA SET TO AIF360 format
# Defines protected attributes, etc.

## ALL DATA .....

formatted_dataset_gender <- aif360::aif_dataset(data_path = data_all_short, 
                                                favor_label = 1, 
                                                unfavor_label = 0, 
                                                unprivileged_protected_attribute = 0, 
                                                privileged_protected_attribute = 1, 
                                                target_column = "SUCCESS", 
                                                protected_attribute = "GENDER")

# Detect bias... BINARY LABEL DATASET METRIC
privileged_groups <- list("GENDER", 1)
unprivileged_groups <- list("GENDER", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_gender,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Gender Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()
bm$base_rate()
bm$consistency()
bm$mean_difference()
bm$num_negatives()
bm$num_positives()
bm$num_instances()
bm$smoothed_empirical_differential_fairness()

# RACIAL BIAS

formatted_dataset_race <- aif360::aif_dataset(data_path = data_all_short, 
                                              favor_label = 1, 
                                              unfavor_label = 0, 
                                              unprivileged_protected_attribute = 0, 
                                              privileged_protected_attribute = 1, 
                                              target_column = "SUCCESS", 
                                              protected_attribute = "RACE")


# Detect bias... BINARY LABEL DATASET METRIC
privileged_groups <- list("RACE", 1)
unprivileged_groups <- list("RACE", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_race,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Racial Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()

# BY SEMESTER ...

# FALL 2019

formatted_dataset_gender <- aif360::aif_dataset(data_path = data_19_spring_short, 
                                                favor_label = 1, 
                                                unfavor_label = 0, 
                                                unprivileged_protected_attribute = 0, 
                                                privileged_protected_attribute = 1, 
                                                target_column = "SUCCESS", 
                                                protected_attribute = "GENDER")

# Detect bias... BINARY LABEL DATASET METRIC
privileged_groups <- list("GENDER", 1)
unprivileged_groups <- list("GENDER", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_gender,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Gender Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()

# RACIAL BIAS

# S19

formatted_dataset_race <- aif360::aif_dataset(data_path = data_19_spring_short, 
                                              favor_label = 1, 
                                              unfavor_label = 0, 
                                              unprivileged_protected_attribute = 0, 
                                              privileged_protected_attribute = 1, 
                                              target_column = "SUCCESS", 
                                              protected_attribute = "RACE")


# Detect bias... BINARY LABEL DATASET METRIC
privileged_groups <- list("RACE", 1)
unprivileged_groups <- list("RACE", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_race,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Racial Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()


# BIAS MITIGATION!!

# Compute the reweighing of the training set instances
rw <- reweighing(unprivileged_groups,privileged_groups)
fdr <- rw$fit(formatted_dataset_race)

# transformed data sets
ad_transformed <- rw$transform(formatted_dataset_race)
ad_fit_transformed <- rw$fit_transform(formatted_dataset_race)

names(ad_transformed)
names(ad_fit_transformed)
str(ad_transformed)
str(ad_fit_transformed)
head(data_19_spring_short)

bm <- binary_label_dataset_metric(data = ad_transformed,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)
cat("Racial Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()

# TEST DISPARATE IMPACT REMOVER

load_aif360_lib()
ad <- adult_dataset()
p <- list("race", 1)
u <- list("race", 0)

di <- disparate_impact_remover(repair_level = 1.0, sensitive_attribute = "race")
rp <- di$fit_transform(ad)

# DONE TESTING


# Apply ML!!

# Split data into Train, Test, Validate sets
spec = c(train = .6, test = .2, validate = .2)

g = sample(cut(
  seq(nrow(data_all)), 
  nrow(data_all)*cumsum(c(0,spec)),
  labels = names(spec)
))

set.seed(1)
res = split(data_all, g)

# Done splitting data~

dim(res$train)
names(res$train)
dim(res$validate)
dim(res$test)

# define priviledged and unpriviledged groups in training set...

# select only numeric columns..
data_short <- res$train[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
head(res$train, 10)
names(data_short)
str(data_short)


################   1. GENDER     ########################  


# Format dataset to include priviledged and unpriviledged groups
formatted_dataset_gender <- aif360::aif_dataset(data_path = data_short, 
                                              favor_label = 1, 
                                              unfavor_label = 0, 
                                              unprivileged_protected_attribute = 0, 
                                              privileged_protected_attribute = 1, 
                                              target_column = "SUCCESS", 
                                              protected_attribute = "GENDER")

privileged_groups <- list("GENDER", 1)
unprivileged_groups <- list("GENDER", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_gender,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Gender Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()

# Explainer ???
#explainer_train_gender <- metric_text_explainer?

# Train Logistic Regression on original model...
names(res$train)
str(res$train)
#data_s20 <- data_s20[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
#mylogit <- glm(SUCCESS ~  grade + GENDER + RACE + course_repeat_ind + cum_gpa_ug_to_date, res$train, family = "beta")
#mylogit <- glm(SUCCESS ~  year + semester + grade + gender_cd + ethnic_cd + course_repeat_ind +cum_gpa_ug_to_date + RACE + GENDER, res$train, family = "beta")

mylogit <- glm(SUCCESS ~ course_repeat_ind + cum_gpa_ug_to_date + RACE + GENDER, res$train, family = "binomial")
summary(mylogit)

test_results <- predict(mylogit, newdata=res$test, type="response")
test_results <- as.numeric(test_results>0.5)

validate_results <- predict(mylogit, newdata=res$validate, type="response")
validate_results <- as.numeric(validate_results>0.5)

# double check
head(test_results, 30)
head(res$train$SUCCESS, 30)

# double check
head(validate_results, 30)
head(res$validate$SUCCESS, 30)

classified_validate <- res$validate
classified_validate$SUCCESS <- validate_results

# Create aif compatible classified dataset
classified_short <- classified_validate[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
orig_validate <- res$validate[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]


formatted_dataset_validate <- aif360::aif_dataset(data_path = orig_validate, 
                                                favor_label = 1, 
                                                unfavor_label = 0, 
                                                unprivileged_protected_attribute = 0, 
                                                privileged_protected_attribute = 1, 
                                                target_column = "SUCCESS", 
                                                protected_attribute = "GENDER")



pred <- aif360::aif_dataset(data_path = classified_short,  
                            favor_label = 1, 
                            unfavor_label = 0,
                            unprivileged_protected_attribute = 0,
                            privileged_protected_attribute = 1,
                            target_column = "SUCCESS", 
                            protected_attribute = "GENDER")

names(classified_short)
names(data_short)

# Create an instance of classification metric
cm <- classification_metric(formatted_dataset_validate, pred, list('GENDER', 1), list('GENDER', 0))
# Access metric functions
cm$disparate_impact()
cm$statistical_parity_difference()


# TESTING MODEL ON TEST SET
test_results <- predict(mylogit, newdata=res$test, type="response")
test_results <- as.numeric(test_results>0.5)

classified_testing <- res$test
classified_testing$SUCCESS <- test_results

agreement <- round(100*sum(as.numeric(test_results == res$test$SUCCESS))/length(test_results), digits=2)
cat("Classifier accuracy on test set: ", agreement)


# CHECK BIAS
cat("Checking for added bias in testing set ... ")

# Create aif compatible classified dataset
classified_short <- classified_testing[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
orig_test <- res$test[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]


formatted_dataset_testing <- aif360::aif_dataset(data_path = orig_test, 
                                                  favor_label = 1, 
                                                  unfavor_label = 0, 
                                                  unprivileged_protected_attribute = 0, 
                                                  privileged_protected_attribute = 1, 
                                                  target_column = "SUCCESS", 
                                                  protected_attribute = "GENDER")



pred <- aif360::aif_dataset(data_path = classified_short,  
                            favor_label = 1, 
                            unfavor_label = 0,
                            unprivileged_protected_attribute = 0,
                            privileged_protected_attribute = 1,
                            target_column = "SUCCESS", 
                            protected_attribute = "GENDER")

# Create an instance of classification metric
cm <- classification_metric(formatted_dataset_testing, pred, list('GENDER', 1), list('GENDER', 0))
# Access metric functions
cm$disparate_impact()
cm$statistical_parity_difference()


########   LOGISTIC REGRESSION MODELS  ##########################



################   1. RACE/ETHNICITY     ########################  


# Format dataset to include priviledged and unpriviledged groups
formatted_dataset_race <- aif360::aif_dataset(data_path = data_short, 
                                                favor_label = 1, 
                                                unfavor_label = 0, 
                                                unprivileged_protected_attribute = 0, 
                                                privileged_protected_attribute = 1, 
                                                target_column = "SUCCESS", 
                                                protected_attribute = "RACE")

privileged_groups <- list("RACE", 1)
unprivileged_groups <- list("RACE", 0)
bm <- binary_label_dataset_metric(data = formatted_dataset_race,
                                  privileged_groups = privileged_groups,
                                  unprivileged_groups = unprivileged_groups)

cat("Racial Difference ...")
bm$mean_difference()
bm$statistical_parity_difference()
bm$disparate_impact()

# Explainer ???
#explainer_train_gender <- metric_text_explainer?

# Train Logistic Regression on original model...
#data_s20 <- data_s20[c("rutgers_id","year", "semester", "section_no", "grade","gender_cd", "ethnic_cd", "course_repeat_ind","cum_gpa_ug_to_date", "RACE","GENDER", "SUCCESS")]
#mylogit <- glm(SUCCESS ~  grade + GENDER + RACE + course_repeat_ind + cum_gpa_ug_to_date, res$train, family = "beta")
#mylogit <- glm(SUCCESS ~  year + semester + grade + gender_cd + ethnic_cd + course_repeat_ind +cum_gpa_ug_to_date + RACE + GENDER, res$train, family = "beta")

mylogit <- glm(SUCCESS ~ course_repeat_ind + cum_gpa_ug_to_date + RACE + GENDER, res$train, family = "binomial")
summary(mylogit)

# VALIDATION SET ...

validate_results <- predict(mylogit, newdata=res$validate, type="response")
validate_results <- as.numeric(validate_results>0.5)

# double check
head(validate_results, 30)
head(res$validate$SUCCESS, 30)

classified_validate <- res$validate
classified_validate$SUCCESS <- validate_results

# Create aif compatible classified dataset
classified_short <- classified_validate[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
orig_validate <- res$validate[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]


formatted_dataset_validate <- aif360::aif_dataset(data_path = orig_validate, 
                                                  favor_label = 1, 
                                                  unfavor_label = 0, 
                                                  unprivileged_protected_attribute = 0, 
                                                  privileged_protected_attribute = 1, 
                                                  target_column = "SUCCESS", 
                                                  protected_attribute = "RACE")



pred <- aif360::aif_dataset(data_path = classified_short,  
                            favor_label = 1, 
                            unfavor_label = 0,
                            unprivileged_protected_attribute = 0,
                            privileged_protected_attribute = 1,
                            target_column = "SUCCESS", 
                            protected_attribute = "RACE")

names(classified_short)
names(data_short)

# Create an instance of classification metric
cat("Checking for racial bias in validation set ... ")
cm <- classification_metric(formatted_dataset_validate, pred, list('RACE', 1), list('RACE', 0))
# Access metric functions
cm$disparate_impact()
cm$statistical_parity_difference()


# TESTING MODEL ON TEST SET
test_results <- predict(mylogit, newdata=res$test, type="response")
test_results <- as.numeric(test_results>0.5)

classified_testing <- res$test
classified_testing$SUCCESS <- test_results

agreement <- round(100*sum(as.numeric(test_results == res$test$SUCCESS))/length(test_results), digits=2)
cat("Classifier accuracy on test set: ", agreement)


# CHECK BIAS
cat("Checking for added bias in testing set ... ")

# Create aif compatible classified dataset
classified_short <- classified_testing[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]
orig_test <- res$test[c("year","GENDER","SUCCESS","RACE", "cum_gpa_ug_to_date")]


formatted_dataset_testing <- aif360::aif_dataset(data_path = orig_test, 
                                                 favor_label = 1, 
                                                 unfavor_label = 0, 
                                                 unprivileged_protected_attribute = 0, 
                                                 privileged_protected_attribute = 1, 
                                                 target_column = "SUCCESS", 
                                                 protected_attribute = "RACE")



pred <- aif360::aif_dataset(data_path = classified_short,  
                            favor_label = 1, 
                            unfavor_label = 0,
                            unprivileged_protected_attribute = 0,
                            privileged_protected_attribute = 1,
                            target_column = "SUCCESS", 
                            protected_attribute = "RACE")

# Create an instance of classification metric
cm <- classification_metric(formatted_dataset_testing, pred, list('RACE', 1), list('RACE', 0))
# Access metric functions
cm$disparate_impact()
cm$statistical_parity_difference()




# BUILD ML MODELS



# reset data to initial format ...

# select CS111 
data_19 <- data_19[data_19$unit_of_reg_cd=="1"&data_19$subj_cd=="198"&data_19$course_no=="111",]
data_18 <- data_18[data_18$unit_of_reg_cd=="1"&data_18$subj_cd=="198"&data_18$course_no=="111",]
data_17 <- data_17[data_17$unit_of_reg_cd=="1"&data_17$subj_cd=="198"&data_17$course_no=="111",]
data_16 <- data_16[data_16$unit_of_reg_cd=="1"&data_16$subj_cd=="198"&data_16$course_no=="111",]
data_15 <- data_15[data_15$unit_of_reg_cd=="1"&data_15$subj_cd=="198"&data_15$course_no=="111",]
data_14 <- data_14[data_14$unit_of_reg_cd=="1"&data_14$subj_cd=="198"&data_14$course_no=="111",]
data_13 <- data_13[data_13$unit_of_reg_cd=="1"&data_13$subj_cd=="198"&data_13$course_no=="111",]

